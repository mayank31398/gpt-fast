[2024-09-13 07:57:28,451] torch.distributed.run: [WARNING] 
[2024-09-13 07:57:28,451] torch.distributed.run: [WARNING] *****************************************
[2024-09-13 07:57:28,451] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-09-13 07:57:28,451] torch.distributed.run: [WARNING] *****************************************
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8Using device=cuda
our tp world size is our tp world size is our tp world size is our tp world size is
our tp world size is our tp world size is Loading model ...
8
88
 8our tp world size is 8
8
our tp world size is our tp world size is 
our tp world size is 
8our tp world size isour tp world size is our tp world size is 8
8
our tp world size is 8

 88
8
our tp world size is our tp world size is 8our tp world size is our tp world size is 
our tp world size isour tp world size is our tp world size is 8
8

8
8 88
8
our tp world size is our tp world size is our tp world size is our tp world size is 

our tp world size isour tp world size is our tp world size is 8
8
8
8
our tp world size is 88
8
our tp world size is our tp world size is our tp world size isour tp world size is  
our tp world size is our tp world size is 8
8
 88
8
our tp world size is 8
8
our tp world size is our tp world size is 
our tp world size is our tp world size is 8
our tp world size is our tp world size is8
8
our tp world size is8
8
our tp world size is 8 8our tp world size is our tp world size is  8our tp world size is 8

we finish operating the TP!
8
8

8
our tp world size is our tp world size is 
our tp world size is our tp world size is our tp world size isour tp world size isour tp world size is 8
8
8
8
 8 88
our tp world size isour tp world size is our tp world size is our tp world size is 

our tp world size is  88
8
8
our tp world size isour tp world size is8

our tp world size is our tp world size isour tp world size is   8our tp world size is our tp world size is 8
 8
8

8
8our tp world size is8
our tp world size is our tp world size isour tp world size is our tp world size is
 our tp world size is 8
 8
 our tp world size is 8
8
our tp world size is 8
our tp world size is 8
8our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is 
88our tp world size is 8
our tp world size is 8
our tp world size is

8
our tp world size is 8
our tp world size is  our tp world size is our tp world size is our tp world size is 8our tp world size is 8
88
8
8
8
our tp world size is
our tp world size isour tp world size is 
our tp world size isour tp world size is  8our tp world size is  88
our tp world size is  88

8

our tp world size is 8

our tp world size isour tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 88
8
8
our tp world size is 8
 
our tp world size is our tp world size is our tp world size is 8
our tp world size is 8our tp world size is 88
8
our tp world size is 8

8

our tp world size is our tp world size is 8
our tp world size is our tp world size isour tp world size is our tp world size is 8
8
our tp world size is 8
 8
8our tp world size is our tp world size is 8
our tp world size is 8our tp world size is 
8
8
our tp world size is 8

8
our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size isour tp world size is 8
8
8
our tp world size is 8
 8
our tp world size isour tp world size is our tp world size is 8
our tp world size is 8
our tp world size is  888
our tp world size is 8
our tp world size is 8


our tp world size is8our tp world size is 8
our tp world size is our tp world size is our tp world size is 
our tp world size is8
our tp world size is 88
 8
 8our tp world size is 8

our tp world size is8
our tp world size is 
8
our tp world size is our tp world size is 8our tp world size is 8
our tp world size isour tp world size is 8
 8
8our tp world size is  88
our tp world size is
our tp world size is 
8
our tp world size isour tp world size is our tp world size is 8
our tp world size is 
  88
8
our tp world size is 8our tp world size is 8
our tp world size is our tp world size is 8

8

our tp world size is8
8
our tp world size is our tp world size isour tp world size is our tp world size is  8our tp world size isour tp world size is 8
 88
8

 8
our tp world size is 
our tp world size is our tp world size is our tp world size is 8our tp world size is 8
our tp world size is 8
88

8
our tp world size is 8
our tp world size is 
our tp world size is our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is8
8
8
our tp world size is 8
our tp world size is  our tp world size isour tp world size is our tp world size is 8
our tp world size is 8
8
 888
our tp world size is 8
our tp world size is our tp world size is

our tp world size is 8
our tp world size is 8
 8our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is 
8
8
our tp world size is 8
our tp world size is 8
our tp world size is our tp world size is our tp world size is 8
our tp world size is8
our tp world size is 8
8
8
our tp world size is  our tp world size is8
our tp world size is our tp world size is our tp world size is 8
8
 8our tp world size is 8
8
8
our tp world size is our tp world size is 
our tp world size is8
our tp world size is our tp world size is our tp world size is 8
8
 8our tp world size is 8
8
8
our tp world size isour tp world size is 
8
our tp world size is Applying tensor parallel to model ...
our tp world size is  88
our tp world size is 8
we finish operating the TP!
8

we finish operating the TP!8
our tp world size is we finish operating the TP!our tp world size isour tp world size is 
our tp world size is 8

 8
8
8
we finish operating the TP!our tp world size is our tp world size is 
8
8we finish operating the TP!

we finish operating the TP!
our tp world size is 8
we finish operating the TP!
GPTResidual(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x TurboTransformerBlock(
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
models all reduce stream is None
Time to load model: 1.10 seconds
tokens we generated: 1024
Time for prefill: 41.52 sec
Time for inference -4: 124.74 sec total, 8.21 tokens/sec
Bandwidth achieved: 22.95 GB/s
FLOPS achieved: 0.05 TF/s

tokens we generated: 1024
Time for prefill: 0.38 sec
Time for inference -3: 2.94 sec total, 348.87 tokens/sec
Bandwidth achieved: 975.46 GB/s
FLOPS achieved: 1.95 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference -2: 2.40 sec total, 426.35 tokens/sec
Bandwidth achieved: 1192.10 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference -1: 2.40 sec total, 427.37 tokens/sec
Bandwidth achieved: 1194.94 GB/s
FLOPS achieved: 2.39 TF/s

Compilation time: 2.40 seconds
tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 1: 2.41 sec total, 425.52 tokens/sec
Bandwidth achieved: 1189.77 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 2: 2.40 sec total, 425.97 tokens/sec
Bandwidth achieved: 1191.04 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 3: 2.41 sec total, 424.20 tokens/sec
Bandwidth achieved: 1186.07 GB/s
FLOPS achieved: 2.37 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 4: 2.43 sec total, 421.74 tokens/sec
Bandwidth achieved: 1179.19 GB/s
FLOPS achieved: 2.36 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 5: 2.40 sec total, 426.10 tokens/sec
Bandwidth achieved: 1191.40 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 6: 2.40 sec total, 426.38 tokens/sec
Bandwidth achieved: 1192.16 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 7: 2.40 sec total, 426.08 tokens/sec
Bandwidth achieved: 1191.34 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 8: 2.43 sec total, 421.73 tokens/sec
Bandwidth achieved: 1179.16 GB/s
FLOPS achieved: 2.36 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 9: 2.39 sec total, 427.66 tokens/sec
Bandwidth achieved: 1195.76 GB/s
FLOPS achieved: 2.39 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 10: 2.39 sec total, 427.60 tokens/sec
Bandwidth achieved: 1195.59 GB/s
FLOPS achieved: 2.39 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 11: 2.39 sec total, 427.80 tokens/sec
Bandwidth achieved: 1196.14 GB/s
FLOPS achieved: 2.39 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 12: 2.43 sec total, 421.68 tokens/sec
Bandwidth achieved: 1179.02 GB/s
FLOPS achieved: 2.36 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 13: 2.40 sec total, 426.12 tokens/sec
Bandwidth achieved: 1191.44 GB/s
FLOPS achieved: 2.38 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 14: 2.42 sec total, 423.51 tokens/sec
Bandwidth achieved: 1184.14 GB/s
FLOPS achieved: 2.37 TF/s

tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 15: 2.42 sec total, 422.88 tokens/sec
Bandwidth achieved: 1182.38 GB/s
FLOPS achieved: 2.36 TF/s

STAGE:2024-09-13 08:00:25 4129200:4129200 ActivityProfilerController.cpp:314] Completed Stage: Warm Up
STAGE:2024-09-13 08:00:25 4129200:4129200 ActivityProfilerController.cpp:320] Completed Stage: Collection
STAGE:2024-09-13 08:00:25 4129200:4129200 ActivityProfilerController.cpp:324] Completed Stage: Post Processing
tokens we generated: 1024
Time for prefill: 0.01 sec
Time for inference 16: 2.50 sec total, 409.44 tokens/sec
Bandwidth achieved: 1144.82 GB/s
FLOPS achieved: 2.29 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 1024
Average prefill latency: 0.03 sec
Average tokens/sec: 420.37
Memory used: 5.01 GB
