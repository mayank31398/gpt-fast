W0920 07:09:05.502000 23031717377856 torch/distributed/run.py:779] 
W0920 07:09:05.502000 23031717377856 torch/distributed/run.py:779] *****************************************
W0920 07:09:05.502000 23031717377856 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:09:05.502000 23031717377856 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.11 seconds
Prefill latency: 0.6988156884908676 sec
Decode latency: 8.961290117353201 sec
Compilation time: 9.72 seconds
Compilation time: 9.66 secondsCompilation time: 9.66 seconds

Compilation time: 9.66 seconds
Prefill latency: 0.7014499884098768 sec
Decode latency: 8.961083630099893 sec
Prefill latency: 0.7005956750363111 sec
Decode latency: 8.959670739248395 sec
Prefill latency: 0.703032374382019 sec
Decode latency: 8.946805719286203 sec
Prefill latency: 0.7039293963462114 sec
Decode latency: 8.956803359091282 sec
Prefill latency: 0.7039972636848688 sec
Decode latency: 8.954709829762578 sec
Time for inference 1: 9.66 sec total, 212.01 tokens/sec
Decode latency: 8.95 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7702.36 GB/s
FLOPS achieved: 38.51 TF/s

Prefill latency: 0.7021439522504807 sec
Decode latency: 8.956392524763942 sec
Time for inference 2: 9.66 sec total, 212.02 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7702.52 GB/s
FLOPS achieved: 38.51 TF/s

Prefill latency: 0.7041266858577728 sec
Decode latency: 8.957297937944531 sec
Time for inference 3: 9.66 sec total, 211.96 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7700.31 GB/s
FLOPS achieved: 38.50 TF/s

Prefill latency: 0.7049951739609241 sec
Decode latency: 8.955685164779425 sec
Time for inference 4: 9.66 sec total, 211.97 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7700.82 GB/s
FLOPS achieved: 38.50 TF/s

Prefill latency: 0.7052919920533895 sec
Decode latency: 8.955317579209805 sec
Time for inference 5: 9.66 sec total, 211.97 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 7700.91 GB/s
FLOPS achieved: 38.50 TF/s

Prefill latency: 0.7062453087419271 sec
Decode latency: 8.955230385065079 sec
Time for inference 6: 9.66 sec total, 211.96 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 7700.25 GB/s
FLOPS achieved: 38.50 TF/s

Prefill latency: 0.702408092096448 sec
Decode latency: 8.957322634756565 sec
Time for inference 7: 9.66 sec total, 211.99 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7701.54 GB/s
FLOPS achieved: 38.51 TF/s

Prefill latency: 0.7024344801902771 sec
Decode latency: 8.956224411725998 sec
Time for inference 8: 9.66 sec total, 212.02 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7702.47 GB/s
FLOPS achieved: 38.51 TF/s

Prefill latency: 0.701421121135354 sec
Decode latency: 8.957217756658792 sec
Time for inference 9: 9.66 sec total, 212.02 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7702.50 GB/s
FLOPS achieved: 38.51 TF/s

Prefill latency: 0.7027940209954977 sec
Decode latency: 8.956391954794526 sec
Time for inference 10: 9.66 sec total, 212.00 tokens/sec
Decode latency: 8.96 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 7701.93 GB/s
FLOPS achieved: 38.51 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.9562 sec
Average prefill latency: 0.7036 sec
Average tokens/sec: 211.99
Memory used: 72.22 GB
