W0920 07:12:55.949000 23440257951552 torch/distributed/run.py:779] 
W0920 07:12:55.949000 23440257951552 torch/distributed/run.py:779] *****************************************
W0920 07:12:55.949000 23440257951552 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:12:55.949000 23440257951552 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.58 seconds
Prefill latency: 0.4247450493276119 sec
Decode latency: 6.712207268923521 sec
Compilation time: 7.24 seconds
Compilation time: 7.17 seconds
Compilation time: 7.14 seconds
Compilation time: 7.17 secondsCompilation time: 7.17 seconds

Compilation time: 7.14 seconds
Compilation time: 7.18 seconds
Compilation time: 7.16 seconds
Prefill latency: 0.4234911296516657 sec
Decode latency: 6.7127661891281605 sec
Prefill latency: 0.42545695044100285 sec
Decode latency: 6.712186457589269 sec
Prefill latency: 0.42476447485387325 sec
Decode latency: 6.711145903915167 sec
Prefill latency: 0.4256718587130308 sec
Decode latency: 6.712621668353677 sec
Prefill latency: 0.4264204725623131 sec
Decode latency: 6.711320418864489 sec
Time for inference 1: 7.14 sec total, 286.89 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5513.06 GB/s
FLOPS achieved: 27.57 TF/s

Prefill latency: 0.4252129253000021 sec
Decode latency: 6.6373370829969645 sec
Time for inference 2: 7.06 sec total, 289.94 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5571.70 GB/s
FLOPS achieved: 27.86 TF/s

Prefill latency: 0.4246238600462675 sec
Decode latency: 6.6819748263806105 sec
Time for inference 3: 7.11 sec total, 288.14 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 5537.11 GB/s
FLOPS achieved: 27.69 TF/s

Prefill latency: 0.4258055351674557 sec
Decode latency: 6.672645140439272 sec
Time for inference 4: 7.10 sec total, 288.48 tokens/sec
Decode latency: 6.67 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5543.67 GB/s
FLOPS achieved: 27.72 TF/s

Prefill latency: 0.4260062202811241 sec
Decode latency: 6.617867365479469 sec
Time for inference 5: 7.04 sec total, 290.72 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5586.60 GB/s
FLOPS achieved: 27.93 TF/s

Prefill latency: 0.42670249193906784 sec
Decode latency: 6.711256271228194 sec
Time for inference 6: 7.14 sec total, 286.88 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5512.94 GB/s
FLOPS achieved: 27.56 TF/s

Prefill latency: 0.42532629147171974 sec
Decode latency: 6.712181631475687 sec
Time for inference 7: 7.14 sec total, 286.90 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5513.21 GB/s
FLOPS achieved: 27.57 TF/s

Prefill latency: 0.4246552027761936 sec
Decode latency: 6.712779097259045 sec
Time for inference 8: 7.14 sec total, 286.91 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 5513.39 GB/s
FLOPS achieved: 27.57 TF/s

Prefill latency: 0.42602987959980965 sec
Decode latency: 6.709609691053629 sec
Time for inference 9: 7.14 sec total, 286.98 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 5514.76 GB/s
FLOPS achieved: 27.57 TF/s

Prefill latency: 0.4249832797795534 sec
Decode latency: 6.709668096154928 sec
Time for inference 10: 7.14 sec total, 287.02 tokens/sec
Decode latency: 6.71 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 5515.58 GB/s
FLOPS achieved: 27.58 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6877 sec
Average prefill latency: 0.4256 sec
Average tokens/sec: 287.88
Memory used: 46.28 GB
