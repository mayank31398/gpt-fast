W0920 07:22:28.881000 22912424097600 torch/distributed/run.py:779] 
W0920 07:22:28.881000 22912424097600 torch/distributed/run.py:779] *****************************************
W0920 07:22:28.881000 22912424097600 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:22:28.881000 22912424097600 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.39 seconds
Prefill latency: 0.8298457767814398 sec
Decode latency: 7.854188729077578 sec
Compilation time: 8.72 seconds
Compilation time: 8.75 secondsCompilation time: 8.75 secondsCompilation time: 8.74 secondsCompilation time: 8.69 seconds



Compilation time: 8.71 seconds
Compilation time: 8.70 seconds
Compilation time: 8.69 seconds
Prefill latency: 0.8306342326104641 sec
Decode latency: 7.856019964441657 sec
Prefill latency: 0.8361295964568853 sec
Decode latency: 7.855660781264305 sec
Prefill latency: 0.8361834213137627 sec
Decode latency: 7.852740902453661 sec
Prefill latency: 0.8376257121562958 sec
Decode latency: 7.853981846943498 sec
Prefill latency: 0.8367255683988333 sec
Decode latency: 7.8558690547943115 sec
Time for inference 1: 8.69 sec total, 471.16 tokens/sec
Decode latency: 7.86 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9054.13 GB/s
FLOPS achieved: 45.27 TF/s

Prefill latency: 0.838681248947978 sec
Decode latency: 7.85524638928473 sec
Time for inference 2: 8.69 sec total, 471.09 tokens/sec
Decode latency: 7.86 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9052.77 GB/s
FLOPS achieved: 45.26 TF/s

Prefill latency: 0.8371921870857477 sec
Decode latency: 7.854833567515016 sec
Time for inference 3: 8.69 sec total, 471.19 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9054.73 GB/s
FLOPS achieved: 45.27 TF/s

Prefill latency: 0.8383572082966566 sec
Decode latency: 7.853476449847221 sec
Time for inference 4: 8.69 sec total, 471.19 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9054.83 GB/s
FLOPS achieved: 45.27 TF/s

Prefill latency: 0.8404457587748766 sec
Decode latency: 7.853888502344489 sec
Time for inference 5: 8.70 sec total, 471.06 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9052.32 GB/s
FLOPS achieved: 45.26 TF/s

Prefill latency: 0.839050529524684 sec
Decode latency: 7.850509414449334 sec
Time for inference 6: 8.69 sec total, 471.32 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9057.32 GB/s
FLOPS achieved: 45.29 TF/s

Prefill latency: 0.8374966885894537 sec
Decode latency: 7.852716760709882 sec
Time for inference 7: 8.69 sec total, 471.29 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9056.66 GB/s
FLOPS achieved: 45.28 TF/s

Prefill latency: 0.8383833132684231 sec
Decode latency: 7.851184267550707 sec
Time for inference 8: 8.69 sec total, 471.32 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9057.25 GB/s
FLOPS achieved: 45.29 TF/s

Prefill latency: 0.8373898956924677 sec
Decode latency: 7.8540406953543425 sec
Time for inference 9: 8.69 sec total, 471.22 tokens/sec
Decode latency: 7.85 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9055.31 GB/s
FLOPS achieved: 45.28 TF/s

Prefill latency: 0.8390257116407156 sec
Decode latency: 7.812377244234085 sec
Time for inference 10: 8.65 sec total, 473.40 tokens/sec
Decode latency: 7.81 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 9097.25 GB/s
FLOPS achieved: 45.49 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.8494 sec
Average prefill latency: 0.8383 sec
Average tokens/sec: 471.43
Memory used: 71.13 GB
