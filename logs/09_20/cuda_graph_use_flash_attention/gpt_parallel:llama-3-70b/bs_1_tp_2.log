W0920 07:40:56.468000 22474473477952 torch/distributed/run.py:779] 
W0920 07:40:56.468000 22474473477952 torch/distributed/run.py:779] *****************************************
W0920 07:40:56.468000 22474473477952 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:40:56.468000 22474473477952 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.1712769977748394 sec
Decode latency: 10.02994155138731 sec
Compilation time: 10.22 seconds
Compilation time: 10.20 seconds
Prefill latency: 0.17109114490449429 sec
Decode latency: 10.031326353549957 sec
Prefill latency: 0.17018920555710793 sec
Decode latency: 10.029019892215729 sec
Prefill latency: 0.1712566763162613 sec
Decode latency: 10.029054619371891 sec
Prefill latency: 0.17016932740807533 sec
Decode latency: 10.029297668486834 sec
Prefill latency: 0.17050041817128658 sec
Decode latency: 10.029141031205654 sec
Time for inference 1: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.69 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.16893231309950352 sec
Decode latency: 10.026858750730753 sec
Time for inference 2: 10.20 sec total, 25.11 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1771.34 GB/s
FLOPS achieved: 8.86 TF/s

Prefill latency: 0.1717528197914362 sec
Decode latency: 10.02667698636651 sec
Time for inference 3: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.90 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.17096656933426857 sec
Decode latency: 10.026471007615328 sec
Time for inference 4: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1771.07 GB/s
FLOPS achieved: 8.86 TF/s

Prefill latency: 0.17122332379221916 sec
Decode latency: 10.027715479955077 sec
Time for inference 5: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.80 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.17226281575858593 sec
Decode latency: 10.027653340250254 sec
Time for inference 6: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.63 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.17141787707805634 sec
Decode latency: 10.027053589001298 sec
Time for inference 7: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.87 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.17160979099571705 sec
Decode latency: 10.027509422972798 sec
Time for inference 8: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.77 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.16946468502283096 sec
Decode latency: 10.028713695704937 sec
Time for inference 9: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1770.92 GB/s
FLOPS achieved: 8.85 TF/s

Prefill latency: 0.1706474870443344 sec
Decode latency: 10.026871636509895 sec
Time for inference 10: 10.20 sec total, 25.10 tokens/sec
Decode latency: 10.03 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1771.05 GB/s
FLOPS achieved: 8.86 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.0275 sec
Average prefill latency: 0.1709 sec
Average tokens/sec: 25.10
Memory used: 75.76 GB
[rank1]:[E920 07:53:39.090575867 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 600000 ms
[rank0]:[E920 07:53:39.090723192 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 600000 ms
