flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.49 seconds
[rank0]:[W920 01:07:21.315135175 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.0380021296441555 sec
Decode latency: 2.9061523508280516 sec
Compilation time: 2.95 seconds
Prefill latency: 0.037685807794332504 sec
Decode latency: 2.9159830771386623 sec
Prefill latency: 0.03778933174908161 sec
Decode latency: 2.91306659206748 sec
Prefill latency: 0.03789948485791683 sec
Decode latency: 2.8800854925066233 sec
Prefill latency: 0.03777851350605488 sec
Decode latency: 2.822314651682973 sec
Prefill latency: 0.037812408059835434 sec
Decode latency: 2.8663732912391424 sec
Time for inference 1: 2.90 sec total, 88.13 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.82 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03786792419850826 sec
Decode latency: 2.917683793231845 sec
Time for inference 2: 2.96 sec total, 86.60 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1299.80 GB/s
FLOPS achieved: 6.50 TF/s

Prefill latency: 0.037865232676267624 sec
Decode latency: 2.90358872897923 sec
Time for inference 3: 2.94 sec total, 87.01 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.03 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03776215948164463 sec
Decode latency: 2.916964154690504 sec
Time for inference 4: 2.96 sec total, 86.62 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1300.18 GB/s
FLOPS achieved: 6.50 TF/s

Prefill latency: 0.03788234293460846 sec
Decode latency: 2.877578053623438 sec
Time for inference 5: 2.92 sec total, 87.79 tokens/sec
Decode latency: 2.88 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1317.68 GB/s
FLOPS achieved: 6.59 TF/s

Prefill latency: 0.03778341971337795 sec
Decode latency: 2.847974820062518 sec
Time for inference 6: 2.89 sec total, 88.69 tokens/sec
Decode latency: 2.85 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1331.23 GB/s
FLOPS achieved: 6.66 TF/s

Prefill latency: 0.037799444049596786 sec
Decode latency: 2.9182073920965195 sec
Time for inference 7: 2.96 sec total, 86.59 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1299.63 GB/s
FLOPS achieved: 6.50 TF/s

Prefill latency: 0.037897562608122826 sec
Decode latency: 2.831781879067421 sec
Time for inference 8: 2.87 sec total, 89.19 tokens/sec
Decode latency: 2.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1338.75 GB/s
FLOPS achieved: 6.69 TF/s

Prefill latency: 0.03782333992421627 sec
Decode latency: 2.901879608631134 sec
Time for inference 9: 2.94 sec total, 87.06 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.80 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.037853168323636055 sec
Decode latency: 2.9164092242717743 sec
Time for inference 10: 2.96 sec total, 86.63 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1300.32 GB/s
FLOPS achieved: 6.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8898 sec
Average prefill latency: 0.0378 sec
Average tokens/sec: 87.43
Memory used: 17.46 GB
