W0920 01:08:54.427000 23404513797952 torch/distributed/run.py:779] 
W0920 01:08:54.427000 23404513797952 torch/distributed/run.py:779] *****************************************
W0920 01:08:54.427000 23404513797952 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 01:08:54.427000 23404513797952 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.11 seconds
Prefill latency: 0.03545903041958809 sec
Decode latency: 1.8042608946561813 sec
Compilation time: 1.86 secondsCompilation time: 1.82 seconds

Compilation time: 1.88 seconds
Compilation time: 1.84 seconds
Prefill latency: 0.01816321723163128 sec
Decode latency: 1.8027962539345026 sec
Prefill latency: 0.01818368025124073 sec
Decode latency: 1.8030408807098866 sec
Prefill latency: 0.018159255385398865 sec
Decode latency: 1.8034199140965939 sec
Prefill latency: 0.01818949356675148 sec
Decode latency: 1.8015841878950596 sec
Prefill latency: 0.018182402476668358 sec
Decode latency: 1.8023960795253515 sec
Time for inference 1: 1.82 sec total, 140.57 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.29 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018156178295612335 sec
Decode latency: 1.8026615362614393 sec
Time for inference 2: 1.82 sec total, 140.54 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.18 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018182676285505295 sec
Decode latency: 1.8016095962375402 sec
Time for inference 3: 1.82 sec total, 140.63 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.56 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018145963549613953 sec
Decode latency: 1.8003227058798075 sec
Time for inference 4: 1.82 sec total, 140.73 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 639.04 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.018186135217547417 sec
Decode latency: 1.8028159737586975 sec
Time for inference 5: 1.82 sec total, 140.53 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.14 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018179871141910553 sec
Decode latency: 1.7999286744743586 sec
Time for inference 6: 1.82 sec total, 140.76 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 639.17 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01814327761530876 sec
Decode latency: 1.8030878324061632 sec
Time for inference 7: 1.82 sec total, 140.51 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.06 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018183289095759392 sec
Decode latency: 1.7959606293588877 sec
Time for inference 8: 1.81 sec total, 141.06 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.54 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.018152471631765366 sec
Decode latency: 1.801972022280097 sec
Time for inference 9: 1.82 sec total, 140.60 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 638.43 GB/s
FLOPS achieved: 3.19 TF/s

Prefill latency: 0.018166303634643555 sec
Decode latency: 1.7575118243694305 sec
Time for inference 10: 1.78 sec total, 144.12 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 654.41 GB/s
FLOPS achieved: 3.27 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.7968 sec
Average prefill latency: 0.0182 sec
Average tokens/sec: 141.00
Memory used: 6.17 GB
