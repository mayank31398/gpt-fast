flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.59 seconds
[rank0]:[W920 01:10:33.554696928 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.14454139210283756 sec
Decode latency: 3.6050663590431213 sec
Compilation time: 3.75 seconds
Prefill latency: 0.14481482841074467 sec
Decode latency: 3.6034064646810293 sec
Prefill latency: 0.14556088484823704 sec
Decode latency: 3.6033424716442823 sec
Prefill latency: 0.14495769329369068 sec
Decode latency: 3.6007394418120384 sec
Prefill latency: 0.14615072682499886 sec
Decode latency: 3.5838858652859926 sec
Prefill latency: 0.14501222595572472 sec
Decode latency: 3.600168578326702 sec
Time for inference 1: 3.75 sec total, 273.38 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4103.33 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.1454023402184248 sec
Decode latency: 3.6010270323604345 sec
Time for inference 2: 3.75 sec total, 273.29 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4101.97 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.1448961477726698 sec
Decode latency: 3.601042438298464 sec
Time for inference 3: 3.75 sec total, 273.31 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4102.37 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.1449838075786829 sec
Decode latency: 3.6007591914385557 sec
Time for inference 4: 3.75 sec total, 273.33 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4102.67 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.14607521519064903 sec
Decode latency: 3.6025586370378733 sec
Time for inference 5: 3.75 sec total, 273.12 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4099.55 GB/s
FLOPS achieved: 20.50 TF/s

Prefill latency: 0.14445296488702297 sec
Decode latency: 3.600459983572364 sec
Time for inference 6: 3.75 sec total, 273.40 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4103.63 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.14552678540349007 sec
Decode latency: 3.601028561592102 sec
Time for inference 7: 3.75 sec total, 273.28 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4101.89 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.1447119191288948 sec
Decode latency: 3.601585628464818 sec
Time for inference 8: 3.75 sec total, 273.30 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4102.16 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.1449295412749052 sec
Decode latency: 3.600737141445279 sec
Time for inference 9: 3.75 sec total, 273.34 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4102.84 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.1458295974880457 sec
Decode latency: 3.601639421656728 sec
Time for inference 10: 3.75 sec total, 273.21 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4100.87 GB/s
FLOPS achieved: 20.50 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6011 sec
Average prefill latency: 0.1452 sec
Average tokens/sec: 273.30
Memory used: 21.21 GB
