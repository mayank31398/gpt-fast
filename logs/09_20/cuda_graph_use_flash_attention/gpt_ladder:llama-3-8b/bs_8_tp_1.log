flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.45 seconds
[rank0]:[W920 02:42:20.817659862 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.284344719722867 sec
Decode latency: 4.5104311890900135 sec
Compilation time: 4.80 seconds
Prefill latency: 0.2855893038213253 sec
Decode latency: 4.538292707875371 sec
Prefill latency: 0.2874399945139885 sec
Decode latency: 4.539302535355091 sec
Prefill latency: 0.28623753041028976 sec
Decode latency: 4.538521179929376 sec
Prefill latency: 0.28672230802476406 sec
Decode latency: 4.534814676269889 sec
Prefill latency: 0.2859902400523424 sec
Decode latency: 4.533203536644578 sec
Time for inference 1: 4.82 sec total, 424.91 tokens/sec
Decode latency: 4.53 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6377.79 GB/s
FLOPS achieved: 31.89 TF/s

Prefill latency: 0.2868517283350229 sec
Decode latency: 4.533169738948345 sec
Time for inference 2: 4.82 sec total, 424.83 tokens/sec
Decode latency: 4.53 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6376.69 GB/s
FLOPS achieved: 31.88 TF/s

Prefill latency: 0.28673419170081615 sec
Decode latency: 4.533653670921922 sec
Time for inference 3: 4.82 sec total, 424.80 tokens/sec
Decode latency: 4.53 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6376.14 GB/s
FLOPS achieved: 31.88 TF/s

Prefill latency: 0.28843328543007374 sec
Decode latency: 4.535074640065432 sec
Time for inference 4: 4.82 sec total, 424.51 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6371.84 GB/s
FLOPS achieved: 31.86 TF/s

Prefill latency: 0.28684081323444843 sec
Decode latency: 4.5364230293780565 sec
Time for inference 5: 4.82 sec total, 424.53 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6372.18 GB/s
FLOPS achieved: 31.86 TF/s

Prefill latency: 0.28835805132985115 sec
Decode latency: 4.536169342696667 sec
Time for inference 6: 4.83 sec total, 424.43 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6370.61 GB/s
FLOPS achieved: 31.85 TF/s

Prefill latency: 0.28740887343883514 sec
Decode latency: 4.535123340785503 sec
Time for inference 7: 4.82 sec total, 424.61 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6373.33 GB/s
FLOPS achieved: 31.87 TF/s

Prefill latency: 0.2868641521781683 sec
Decode latency: 4.500046297907829 sec
Time for inference 8: 4.79 sec total, 427.77 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6420.76 GB/s
FLOPS achieved: 32.10 TF/s

Prefill latency: 0.2870598118752241 sec
Decode latency: 4.537864703685045 sec
Time for inference 9: 4.83 sec total, 424.40 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6370.15 GB/s
FLOPS achieved: 31.85 TF/s

Prefill latency: 0.28734583780169487 sec
Decode latency: 4.535565992817283 sec
Time for inference 10: 4.82 sec total, 424.57 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 6372.71 GB/s
FLOPS achieved: 31.86 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5316 sec
Average prefill latency: 0.2872 sec
Average tokens/sec: 424.94
Memory used: 26.20 GB
