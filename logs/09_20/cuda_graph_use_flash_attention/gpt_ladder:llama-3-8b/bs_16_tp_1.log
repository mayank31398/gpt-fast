flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.53 seconds
[rank0]:[W920 04:14:31.378041968 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.570215467363596 sec
Decode latency: 6.640306232497096 sec
Compilation time: 7.21 seconds
Prefill latency: 0.573224451392889 sec
Decode latency: 6.638428051024675 sec
Prefill latency: 0.5716535784304142 sec
Decode latency: 6.641395239159465 sec
Prefill latency: 0.5741556826978922 sec
Decode latency: 6.640869410708547 sec
Prefill latency: 0.574106452986598 sec
Decode latency: 6.642067577689886 sec
Prefill latency: 0.5746350418776274 sec
Decode latency: 6.643078962340951 sec
Time for inference 1: 7.22 sec total, 567.43 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8517.06 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.5731288194656372 sec
Decode latency: 6.639851998537779 sec
Time for inference 2: 7.21 sec total, 567.81 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8522.74 GB/s
FLOPS achieved: 42.61 TF/s

Prefill latency: 0.5724676046520472 sec
Decode latency: 6.640171440318227 sec
Time for inference 3: 7.21 sec total, 567.84 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8523.18 GB/s
FLOPS achieved: 42.62 TF/s

Prefill latency: 0.5735335815697908 sec
Decode latency: 6.569605236873031 sec
Time for inference 4: 7.14 sec total, 573.35 tokens/sec
Decode latency: 6.57 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8605.90 GB/s
FLOPS achieved: 43.03 TF/s

Prefill latency: 0.5739475917071104 sec
Decode latency: 6.641692735254765 sec
Time for inference 5: 7.22 sec total, 567.60 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8519.53 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.5724186338484287 sec
Decode latency: 6.536397552117705 sec
Time for inference 6: 7.11 sec total, 576.13 tokens/sec
Decode latency: 6.54 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8647.56 GB/s
FLOPS achieved: 43.24 TF/s

Prefill latency: 0.5750218946486712 sec
Decode latency: 6.6348303239792585 sec
Time for inference 7: 7.21 sec total, 568.06 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 8526.44 GB/s
FLOPS achieved: 42.63 TF/s

Prefill latency: 0.5729840658605099 sec
Decode latency: 6.562514854595065 sec
Time for inference 8: 7.14 sec total, 573.96 tokens/sec
Decode latency: 6.56 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8615.13 GB/s
FLOPS achieved: 43.08 TF/s

Prefill latency: 0.573832880705595 sec
Decode latency: 6.642418529838324 sec
Time for inference 9: 7.22 sec total, 567.55 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8518.86 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.5738570112735033 sec
Decode latency: 6.639711098745465 sec
Time for inference 10: 7.21 sec total, 567.76 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8522.02 GB/s
FLOPS achieved: 42.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6150 sec
Average prefill latency: 0.5736 sec
Average tokens/sec: 569.75
Memory used: 36.19 GB
