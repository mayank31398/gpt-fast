W0920 06:41:10.523000 22992368281408 torch/distributed/run.py:779] 
W0920 06:41:10.523000 22992368281408 torch/distributed/run.py:779] *****************************************
W0920 06:41:10.523000 22992368281408 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 06:41:10.523000 22992368281408 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.78 seconds
Prefill latency: 0.038268160074949265 sec
Decode latency: 1.6626770440489054 sec
Compilation time: 1.68 secondsCompilation time: 1.68 seconds

Compilation time: 1.68 seconds
Compilation time: 1.73 seconds
Compilation time: 1.68 seconds
Compilation time: 1.68 seconds
Compilation time: 1.74 seconds
Compilation time: 1.70 seconds
Prefill latency: 0.015172164887189865 sec
Decode latency: 1.6629029717296362 sec
Prefill latency: 0.015166250988841057 sec
Decode latency: 1.6639855336397886 sec
Prefill latency: 0.015170013532042503 sec
Decode latency: 1.6641267444938421 sec
Prefill latency: 0.015171559527516365 sec
Decode latency: 1.6638939511030912 sec
Prefill latency: 0.015167366713285446 sec
Decode latency: 1.6635653208941221 sec
Time for inference 1: 1.68 sec total, 152.45 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.24 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015167953446507454 sec
Decode latency: 1.6638881787657738 sec
Time for inference 2: 1.68 sec total, 152.42 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.16 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015174159780144691 sec
Decode latency: 1.6634251289069653 sec
Time for inference 3: 1.68 sec total, 152.46 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.28 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015157001093029976 sec
Decode latency: 1.6640589367598295 sec
Time for inference 4: 1.68 sec total, 152.40 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.12 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015169180929660797 sec
Decode latency: 1.6641004160046577 sec
Time for inference 5: 1.68 sec total, 152.40 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.11 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015160180628299713 sec
Decode latency: 1.6637844871729612 sec
Time for inference 6: 1.68 sec total, 152.43 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.20 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015168819576501846 sec
Decode latency: 1.6638164594769478 sec
Time for inference 7: 1.68 sec total, 152.43 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.19 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015162944793701172 sec
Decode latency: 1.6637191139161587 sec
Time for inference 8: 1.68 sec total, 152.44 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.22 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.01516454666852951 sec
Decode latency: 1.6638188231736422 sec
Time for inference 9: 1.68 sec total, 152.43 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.19 GB/s
FLOPS achieved: 2.13 TF/s

Prefill latency: 0.015173925086855888 sec
Decode latency: 1.6636544540524483 sec
Time for inference 10: 1.68 sec total, 152.44 tokens/sec
Decode latency: 1.66 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 426.23 GB/s
FLOPS achieved: 2.13 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.6638 sec
Average prefill latency: 0.0152 sec
Average tokens/sec: 152.43
Memory used: 4.35 GB
