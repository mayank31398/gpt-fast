W0920 07:18:30.835000 22845007128384 torch/distributed/run.py:779] 
W0920 07:18:30.835000 22845007128384 torch/distributed/run.py:779] *****************************************
W0920 07:18:30.835000 22845007128384 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:18:30.835000 22845007128384 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.70 seconds
Prefill latency: 0.17178627662360668 sec
Decode latency: 3.07235668040812 sec
Compilation time: 3.26 seconds
Compilation time: 3.25 seconds
Prefill latency: 0.17203459702432156 sec
Decode latency: 3.075755113735795 sec
Prefill latency: 0.17192526534199715 sec
Decode latency: 3.075981205329299 sec
Prefill latency: 0.17189932614564896 sec
Decode latency: 3.0685610231012106 sec
Prefill latency: 0.17272581160068512 sec
Decode latency: 3.0687076915055513 sec
Prefill latency: 0.171726880595088 sec
Decode latency: 3.0753125678747892 sec
Time for inference 1: 3.25 sec total, 630.60 tokens/sec
Decode latency: 3.08 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5064.02 GB/s
FLOPS achieved: 25.32 TF/s

Prefill latency: 0.17285172082483768 sec
Decode latency: 3.0745442416518927 sec
Time for inference 2: 3.25 sec total, 630.54 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5063.53 GB/s
FLOPS achieved: 25.32 TF/s

Prefill latency: 0.1719456296414137 sec
Decode latency: 3.0733497869223356 sec
Time for inference 3: 3.25 sec total, 630.93 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5066.69 GB/s
FLOPS achieved: 25.33 TF/s

Prefill latency: 0.17222538776695728 sec
Decode latency: 3.0665918085724115 sec
Time for inference 4: 3.24 sec total, 632.20 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5076.87 GB/s
FLOPS achieved: 25.38 TF/s

Prefill latency: 0.17205229587852955 sec
Decode latency: 3.0719244983047247 sec
Time for inference 5: 3.24 sec total, 631.20 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5068.86 GB/s
FLOPS achieved: 25.34 TF/s

Prefill latency: 0.17230876348912716 sec
Decode latency: 3.075625440105796 sec
Time for inference 6: 3.25 sec total, 630.42 tokens/sec
Decode latency: 3.08 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5062.59 GB/s
FLOPS achieved: 25.31 TF/s

Prefill latency: 0.17219153232872486 sec
Decode latency: 3.072632882744074 sec
Time for inference 7: 3.25 sec total, 631.04 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5067.58 GB/s
FLOPS achieved: 25.34 TF/s

Prefill latency: 0.1717089805752039 sec
Decode latency: 3.075117724016309 sec
Time for inference 8: 3.25 sec total, 630.66 tokens/sec
Decode latency: 3.08 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5064.49 GB/s
FLOPS achieved: 25.32 TF/s

Prefill latency: 0.17372389882802963 sec
Decode latency: 3.0729808155447245 sec
Time for inference 9: 3.25 sec total, 630.63 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5064.32 GB/s
FLOPS achieved: 25.32 TF/s

Prefill latency: 0.17223511636257172 sec
Decode latency: 3.068365227431059 sec
Time for inference 10: 3.24 sec total, 631.84 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5074.00 GB/s
FLOPS achieved: 25.37 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0726 sec
Average prefill latency: 0.1723 sec
Average tokens/sec: 631.00
Memory used: 20.29 GB
