flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.46 seconds
Prefill latency: 0.14490759000182152 sec
Decode latency: 3.6021002493798733 sec
Compilation time: 3.75 seconds
Prefill latency: 0.14435609243810177 sec
Decode latency: 3.600581916049123 sec
Prefill latency: 0.14423482678830624 sec
Decode latency: 3.5992700327187777 sec
Prefill latency: 0.1437511183321476 sec
Decode latency: 3.5990380942821503 sec
Prefill latency: 0.1445932537317276 sec
Decode latency: 3.5988119170069695 sec
Prefill latency: 0.1447101216763258 sec
Decode latency: 3.5998055897653103 sec
Time for inference 1: 3.75 sec total, 273.41 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4103.87 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.144639253616333 sec
Decode latency: 3.5984370689839125 sec
Time for inference 2: 3.74 sec total, 273.52 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4105.45 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.14429942332208157 sec
Decode latency: 3.598321845754981 sec
Time for inference 3: 3.74 sec total, 273.56 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4106.06 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.14407669194042683 sec
Decode latency: 3.598513485863805 sec
Time for inference 4: 3.74 sec total, 273.56 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4106.02 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.14406479708850384 sec
Decode latency: 3.5977675765752792 sec
Time for inference 5: 3.74 sec total, 273.62 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4106.94 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.14470488019287586 sec
Decode latency: 3.5993157774209976 sec
Time for inference 6: 3.74 sec total, 273.45 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4104.37 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.14421565644443035 sec
Decode latency: 3.59873871691525 sec
Time for inference 7: 3.74 sec total, 273.53 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4105.68 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.1443315390497446 sec
Decode latency: 3.599302874878049 sec
Time for inference 8: 3.74 sec total, 273.49 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4104.98 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.14461198635399342 sec
Decode latency: 3.59951002150774 sec
Time for inference 9: 3.74 sec total, 273.45 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4104.40 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.1442437507212162 sec
Decode latency: 3.5993924532085657 sec
Time for inference 10: 3.74 sec total, 273.48 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 4104.84 GB/s
FLOPS achieved: 20.52 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5989 sec
Average prefill latency: 0.1444 sec
Average tokens/sec: 273.50
Memory used: 21.23 GB
