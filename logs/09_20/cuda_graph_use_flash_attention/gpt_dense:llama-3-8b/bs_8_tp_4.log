W0920 07:21:25.571000 23280006137664 torch/distributed/run.py:779] 
W0920 07:21:25.571000 23280006137664 torch/distributed/run.py:779] *****************************************
W0920 07:21:25.571000 23280006137664 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:21:25.571000 23280006137664 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.48 seconds
Prefill latency: 0.11632675677537918 sec
Decode latency: 2.3845194913446903 sec
Compilation time: 2.50 secondsCompilation time: 2.50 seconds

Compilation time: 2.50 seconds
Compilation time: 2.50 seconds
Prefill latency: 0.10974662192165852 sec
Decode latency: 2.382223829627037 sec
Prefill latency: 0.10976633615791798 sec
Decode latency: 2.3824858497828245 sec
Prefill latency: 0.10974696092307568 sec
Decode latency: 2.3851432111114264 sec
Prefill latency: 0.1098677609115839 sec
Decode latency: 2.381389930844307 sec
Prefill latency: 0.10988756082952023 sec
Decode latency: 2.3812926560640335 sec
Time for inference 1: 2.49 sec total, 821.86 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3731.97 GB/s
FLOPS achieved: 18.66 TF/s

Prefill latency: 0.10980070009827614 sec
Decode latency: 2.3847864232957363 sec
Time for inference 2: 2.50 sec total, 820.77 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3727.02 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.10982642695307732 sec
Decode latency: 2.3817812595516443 sec
Time for inference 3: 2.49 sec total, 821.77 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3731.55 GB/s
FLOPS achieved: 18.66 TF/s

Prefill latency: 0.10981948859989643 sec
Decode latency: 2.3823957294225693 sec
Time for inference 4: 2.49 sec total, 821.57 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3730.64 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.10996651649475098 sec
Decode latency: 2.383958214893937 sec
Time for inference 5: 2.49 sec total, 821.01 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3728.08 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.11001794971525669 sec
Decode latency: 2.3819129783660173 sec
Time for inference 6: 2.49 sec total, 821.67 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3731.07 GB/s
FLOPS achieved: 18.66 TF/s

Prefill latency: 0.10985933803021908 sec
Decode latency: 2.3832153398543596 sec
Time for inference 7: 2.49 sec total, 821.29 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3729.37 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.10996665991842747 sec
Decode latency: 2.3827162589877844 sec
Time for inference 8: 2.49 sec total, 821.42 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3729.96 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.10985695943236351 sec
Decode latency: 2.3822240754961967 sec
Time for inference 9: 2.49 sec total, 821.63 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3730.91 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.10976906679570675 sec
Decode latency: 2.3826740328222513 sec
Time for inference 10: 2.49 sec total, 821.51 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 3730.36 GB/s
FLOPS achieved: 18.65 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3827 sec
Average prefill latency: 0.1099 sec
Average tokens/sec: 821.45
Memory used: 14.65 GB
