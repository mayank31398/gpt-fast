W0920 07:30:33.280000 23244606732096 torch/distributed/run.py:779] 
W0920 07:30:33.280000 23244606732096 torch/distributed/run.py:779] *****************************************
W0920 07:30:33.280000 23244606732096 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:30:33.280000 23244606732096 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.4078932851552963 sec
Decode latency: 4.017082694917917 sec
Compilation time: 4.36 seconds
Compilation time: 4.43 seconds
Prefill latency: 0.3364672716706991 sec
Decode latency: 4.012181533500552 sec
Prefill latency: 0.3370212148874998 sec
Decode latency: 4.0027126763015985 sec
Prefill latency: 0.3368591833859682 sec
Decode latency: 4.014677952975035 sec
Prefill latency: 0.33925801888108253 sec
Decode latency: 4.010506613180041 sec
Prefill latency: 0.33778808824718 sec
Decode latency: 4.016491424292326 sec
Time for inference 1: 4.36 sec total, 940.52 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7552.88 GB/s
FLOPS achieved: 37.76 TF/s

Prefill latency: 0.3367250021547079 sec
Decode latency: 4.01471896097064 sec
Time for inference 2: 4.35 sec total, 941.16 tokens/sec
Decode latency: 4.01 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7557.97 GB/s
FLOPS achieved: 37.79 TF/s

Prefill latency: 0.33741391636431217 sec
Decode latency: 4.015084492042661 sec
Time for inference 3: 4.35 sec total, 940.92 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7556.07 GB/s
FLOPS achieved: 37.78 TF/s

Prefill latency: 0.33856056071817875 sec
Decode latency: 4.012313287705183 sec
Time for inference 4: 4.35 sec total, 941.28 tokens/sec
Decode latency: 4.01 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7558.95 GB/s
FLOPS achieved: 37.79 TF/s

Prefill latency: 0.33874040842056274 sec
Decode latency: 4.015459204092622 sec
Time for inference 5: 4.35 sec total, 940.54 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7553.02 GB/s
FLOPS achieved: 37.77 TF/s

Prefill latency: 0.337759492918849 sec
Decode latency: 4.012591077014804 sec
Time for inference 6: 4.35 sec total, 941.35 tokens/sec
Decode latency: 4.01 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7559.54 GB/s
FLOPS achieved: 37.80 TF/s

Prefill latency: 0.33860523253679276 sec
Decode latency: 4.016485219821334 sec
Time for inference 7: 4.36 sec total, 940.35 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7551.49 GB/s
FLOPS achieved: 37.76 TF/s

Prefill latency: 0.33730844408273697 sec
Decode latency: 4.0134141985327005 sec
Time for inference 8: 4.35 sec total, 941.29 tokens/sec
Decode latency: 4.01 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7559.06 GB/s
FLOPS achieved: 37.80 TF/s

Prefill latency: 0.3371772486716509 sec
Decode latency: 4.016704695299268 sec
Time for inference 9: 4.35 sec total, 940.63 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7553.72 GB/s
FLOPS achieved: 37.77 TF/s

Prefill latency: 0.3387078810483217 sec
Decode latency: 4.019023263826966 sec
Time for inference 10: 4.36 sec total, 939.79 tokens/sec
Decode latency: 4.02 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 7546.99 GB/s
FLOPS achieved: 37.73 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.0152 sec
Average prefill latency: 0.3379 sec
Average tokens/sec: 940.78
Memory used: 31.35 GB
