W0920 06:39:40.681000 22597812709184 torch/distributed/run.py:779] 
W0920 06:39:40.681000 22597812709184 torch/distributed/run.py:779] *****************************************
W0920 06:39:40.681000 22597812709184 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 06:39:40.681000 22597812709184 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.98 seconds
Prefill latency: 0.04846987873315811 sec
Decode latency: 2.228747207671404 sec
Compilation time: 2.25 seconds
Compilation time: 2.28 seconds
Prefill latency: 0.0238645039498806 sec
Decode latency: 2.2293760050088167 sec
Prefill latency: 0.02392113208770752 sec
Decode latency: 2.229046804830432 sec
Prefill latency: 0.023931734263896942 sec
Decode latency: 2.2277188282459974 sec
Prefill latency: 0.023883303627371788 sec
Decode latency: 2.2279020752757788 sec
Prefill latency: 0.02391447313129902 sec
Decode latency: 2.2281785998493433 sec
Time for inference 1: 2.25 sec total, 113.63 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.54 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.02384268306195736 sec
Decode latency: 2.22810067422688 sec
Time for inference 2: 2.25 sec total, 113.65 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.65 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.02385050430893898 sec
Decode latency: 2.2283467892557383 sec
Time for inference 3: 2.25 sec total, 113.63 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.55 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.023975573480129242 sec
Decode latency: 2.2281543370336294 sec
Time for inference 4: 2.25 sec total, 113.64 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.57 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.023872023448348045 sec
Decode latency: 2.2283226493746042 sec
Time for inference 5: 2.25 sec total, 113.63 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.54 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.02385888434946537 sec
Decode latency: 2.228180579841137 sec
Time for inference 6: 2.25 sec total, 113.64 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.61 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.02389254793524742 sec
Decode latency: 2.228528084233403 sec
Time for inference 7: 2.25 sec total, 113.63 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.48 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.023895850405097008 sec
Decode latency: 2.228315683081746 sec
Time for inference 8: 2.25 sec total, 113.64 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.56 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.023855596780776978 sec
Decode latency: 2.228243123739958 sec
Time for inference 9: 2.25 sec total, 113.64 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.61 GB/s
FLOPS achieved: 4.56 TF/s

Prefill latency: 0.023883868008852005 sec
Decode latency: 2.2282091695815325 sec
Time for inference 10: 2.25 sec total, 113.64 tokens/sec
Decode latency: 2.23 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 912.62 GB/s
FLOPS achieved: 4.56 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2283 sec
Average prefill latency: 0.0239 sec
Average tokens/sec: 113.64
Memory used: 9.69 GB
