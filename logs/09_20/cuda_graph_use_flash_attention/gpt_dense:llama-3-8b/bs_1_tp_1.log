flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.74 seconds
[rank0]:[W920 06:38:52.405034404 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.037903644144535065 sec
Decode latency: 2.869698842987418 sec
Compilation time: 2.91 seconds
Prefill latency: 0.03777395002543926 sec
Decode latency: 2.921338090673089 sec
Prefill latency: 0.03770307078957558 sec
Decode latency: 2.9243995510041714 sec
Prefill latency: 0.0377343837171793 sec
Decode latency: 2.9228409994393587 sec
Prefill latency: 0.037799276411533356 sec
Decode latency: 2.925338216125965 sec
Prefill latency: 0.03766864910721779 sec
Decode latency: 2.922509955242276 sec
Time for inference 1: 2.96 sec total, 86.46 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.82 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.03770582564175129 sec
Decode latency: 2.924343477934599 sec
Time for inference 2: 2.96 sec total, 86.41 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.01 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.03777327574789524 sec
Decode latency: 2.923984117805958 sec
Time for inference 3: 2.96 sec total, 86.42 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.15 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.0376867949962616 sec
Decode latency: 2.921891065314412 sec
Time for inference 4: 2.96 sec total, 86.48 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1298.11 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.037825632840394974 sec
Decode latency: 2.9251846075057983 sec
Time for inference 5: 2.96 sec total, 86.38 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1296.59 GB/s
FLOPS achieved: 6.48 TF/s

Prefill latency: 0.03772897459566593 sec
Decode latency: 2.9229584764689207 sec
Time for inference 6: 2.96 sec total, 86.45 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.62 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.037711210548877716 sec
Decode latency: 2.9253870975226164 sec
Time for inference 7: 2.96 sec total, 86.38 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1296.57 GB/s
FLOPS achieved: 6.48 TF/s

Prefill latency: 0.03781804069876671 sec
Decode latency: 2.922034628689289 sec
Time for inference 8: 2.96 sec total, 86.47 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.94 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.037705233320593834 sec
Decode latency: 2.923168685287237 sec
Time for inference 9: 2.96 sec total, 86.44 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.44 GB/s
FLOPS achieved: 6.49 TF/s

Prefill latency: 0.03770877793431282 sec
Decode latency: 2.9232157450169325 sec
Time for inference 10: 2.96 sec total, 86.44 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1297.45 GB/s
FLOPS achieved: 6.49 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9235 sec
Average prefill latency: 0.0377 sec
Average tokens/sec: 86.43
Memory used: 17.46 GB
