flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.52 seconds
Prefill latency: 0.5691513679921627 sec
Decode latency: 6.656239323318005 sec
Compilation time: 7.23 seconds
Prefill latency: 0.572039159014821 sec
Decode latency: 6.650534115731716 sec
Prefill latency: 0.5745443236082792 sec
Decode latency: 6.641945539042354 sec
Prefill latency: 0.5730100274085999 sec
Decode latency: 6.646605473011732 sec
Prefill latency: 0.5711871180683374 sec
Decode latency: 6.6503652315586805 sec
Prefill latency: 0.5739970821887255 sec
Decode latency: 6.607683144509792 sec
Time for inference 1: 7.18 sec total, 570.28 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8559.83 GB/s
FLOPS achieved: 42.80 TF/s

Prefill latency: 0.5723370779305696 sec
Decode latency: 6.649256216362119 sec
Time for inference 2: 7.22 sec total, 567.13 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8512.49 GB/s
FLOPS achieved: 42.56 TF/s

Prefill latency: 0.5745191313326359 sec
Decode latency: 6.611046057194471 sec
Time for inference 3: 7.19 sec total, 569.97 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8555.14 GB/s
FLOPS achieved: 42.78 TF/s

Prefill latency: 0.5726071950048208 sec
Decode latency: 6.649617901071906 sec
Time for inference 4: 7.22 sec total, 567.08 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8511.78 GB/s
FLOPS achieved: 42.56 TF/s

Prefill latency: 0.5726903639733791 sec
Decode latency: 6.628505889326334 sec
Time for inference 5: 7.20 sec total, 568.74 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8536.68 GB/s
FLOPS achieved: 42.68 TF/s

Prefill latency: 0.573428688570857 sec
Decode latency: 6.649606980383396 sec
Time for inference 6: 7.22 sec total, 567.01 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8510.79 GB/s
FLOPS achieved: 42.55 TF/s

Prefill latency: 0.5736436098814011 sec
Decode latency: 6.6520539708435535 sec
Time for inference 7: 7.23 sec total, 566.80 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8507.63 GB/s
FLOPS achieved: 42.54 TF/s

Prefill latency: 0.572103651240468 sec
Decode latency: 6.547612726688385 sec
Time for inference 8: 7.12 sec total, 575.24 tokens/sec
Decode latency: 6.55 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8634.26 GB/s
FLOPS achieved: 43.17 TF/s

Prefill latency: 0.5736038088798523 sec
Decode latency: 6.648583203554153 sec
Time for inference 9: 7.22 sec total, 567.08 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8511.81 GB/s
FLOPS achieved: 42.56 TF/s

Prefill latency: 0.5711445044726133 sec
Decode latency: 6.649470889940858 sec
Time for inference 10: 7.22 sec total, 567.21 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.57 sec
Bandwidth achieved: 8513.66 GB/s
FLOPS achieved: 42.57 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6293 sec
Average prefill latency: 0.5730 sec
Average tokens/sec: 568.65
Memory used: 36.26 GB
