W0920 03:09:47.485000 23010838038336 torch/distributed/run.py:779] 
W0920 03:09:47.485000 23010838038336 torch/distributed/run.py:779] *****************************************
W0920 03:09:47.485000 23010838038336 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 03:09:47.485000 23010838038336 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.89 seconds
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Prefill latency: 4.083002658560872 sec
Decode latency: 11.868046117946506 sec
Compilation time: 15.97 seconds
Compilation time: 15.95 seconds
Prefill latency: 1.1327021159231663 sec
Decode latency: 11.699745962396264 sec
Prefill latency: 1.1321465782821178 sec
Decode latency: 11.676282400265336 sec
Prefill latency: 1.1305958312004805 sec
Decode latency: 11.650390364229679 sec
Prefill latency: 1.1306357439607382 sec
Decode latency: 11.672959491610527 sec
Prefill latency: 1.131508408114314 sec
Decode latency: 11.667865114286542 sec
Time for inference 1: 12.80 sec total, 160.00 tokens/sec
Decode latency: 11.67 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11288.64 GB/s
FLOPS achieved: 56.44 TF/s

Prefill latency: 1.1305185053497553 sec
Decode latency: 11.680558562278748 sec
Time for inference 2: 12.81 sec total, 159.85 tokens/sec
Decode latency: 11.68 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11278.36 GB/s
FLOPS achieved: 56.39 TF/s

Prefill latency: 1.131115410476923 sec
Decode latency: 11.568213468417525 sec
Time for inference 3: 12.70 sec total, 161.26 tokens/sec
Decode latency: 11.57 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11377.55 GB/s
FLOPS achieved: 56.89 TF/s

Prefill latency: 1.1298807337880135 sec
Decode latency: 11.575881972908974 sec
Time for inference 4: 12.71 sec total, 161.18 tokens/sec
Decode latency: 11.58 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11371.82 GB/s
FLOPS achieved: 56.86 TF/s

Prefill latency: 1.129676092416048 sec
Decode latency: 11.558648427948356 sec
Time for inference 5: 12.69 sec total, 161.40 tokens/sec
Decode latency: 11.56 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11387.43 GB/s
FLOPS achieved: 56.94 TF/s

Prefill latency: 1.13091192394495 sec
Decode latency: 11.5555356182158 sec
Time for inference 6: 12.69 sec total, 161.42 tokens/sec
Decode latency: 11.56 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11389.16 GB/s
FLOPS achieved: 56.95 TF/s

Prefill latency: 1.1346383299678564 sec
Decode latency: 11.584183804690838 sec
Time for inference 7: 12.72 sec total, 161.01 tokens/sec
Decode latency: 11.58 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11360.10 GB/s
FLOPS achieved: 56.80 TF/s

Prefill latency: 1.131225973367691 sec
Decode latency: 11.554568311199546 sec
Time for inference 8: 12.69 sec total, 161.43 tokens/sec
Decode latency: 11.55 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11389.71 GB/s
FLOPS achieved: 56.95 TF/s

Prefill latency: 1.1297878809273243 sec
Decode latency: 11.562292708083987 sec
Time for inference 9: 12.69 sec total, 161.35 tokens/sec
Decode latency: 11.56 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11384.08 GB/s
FLOPS achieved: 56.92 TF/s

Prefill latency: 1.1294266767799854 sec
Decode latency: 11.569779831916094 sec
Time for inference 10: 12.70 sec total, 161.26 tokens/sec
Decode latency: 11.57 sec
Prefill latency: 1.13 sec
Bandwidth achieved: 11377.69 GB/s
FLOPS achieved: 56.89 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 11.5878 sec
Average prefill latency: 1.1309 sec
Average tokens/sec: 161.02
Memory used: 78.32 GB
