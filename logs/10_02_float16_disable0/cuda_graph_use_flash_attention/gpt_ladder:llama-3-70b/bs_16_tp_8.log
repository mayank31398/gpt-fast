W1002 00:27:53.453000 22593812961088 torch/distributed/run.py:779] 
W1002 00:27:53.453000 22593812961088 torch/distributed/run.py:779] *****************************************
W1002 00:27:53.453000 22593812961088 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1002 00:27:53.453000 22593812961088 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.47 seconds
[rank4]:[W1002 00:29:14.758424041 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.74715412594378 sec
Decode latency: 4.383450124994852 sec
Compilation time: 5.13 seconds
Compilation time: 5.11 seconds
Compilation time: 5.09 seconds
Compilation time: 5.10 seconds
Compilation time: 5.09 seconds
Compilation time: 5.13 seconds
Compilation time: 5.09 seconds
Compilation time: 5.13 seconds
Prefill latency: 0.7065411540679634 sec
Decode latency: 4.386694910004735 sec
Prefill latency: 0.7084606239804998 sec
Decode latency: 4.385721954051405 sec
Prefill latency: 0.7083251479780301 sec
Decode latency: 4.385183773003519 sec
Prefill latency: 0.7077752320328727 sec
Decode latency: 4.386416947003454 sec
Prefill latency: 0.7080782509874552 sec
Decode latency: 4.385796514921822 sec
Time for inference 1: 5.09 sec total, 803.96 tokens/sec
Decode latency: 4.39 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15449.41 GB/s
FLOPS achieved: 77.25 TF/s

Prefill latency: 0.7086030739592388 sec
Decode latency: 4.384144781972282 sec
Time for inference 2: 5.09 sec total, 804.11 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15452.40 GB/s
FLOPS achieved: 77.26 TF/s

Prefill latency: 0.711278592934832 sec
Decode latency: 4.383839130983688 sec
Time for inference 3: 5.10 sec total, 803.73 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15445.16 GB/s
FLOPS achieved: 77.23 TF/s

Prefill latency: 0.7124776589917019 sec
Decode latency: 4.385018195956945 sec
Time for inference 4: 5.10 sec total, 803.34 tokens/sec
Decode latency: 4.39 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15437.58 GB/s
FLOPS achieved: 77.19 TF/s

Prefill latency: 0.7108590919524431 sec
Decode latency: 4.38452566601336 sec
Time for inference 5: 5.10 sec total, 803.72 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15444.79 GB/s
FLOPS achieved: 77.22 TF/s

Prefill latency: 0.7135442179860547 sec
Decode latency: 4.3842377020046115 sec
Time for inference 6: 5.10 sec total, 803.32 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15437.27 GB/s
FLOPS achieved: 77.19 TF/s

Prefill latency: 0.7143264930928126 sec
Decode latency: 4.383931710966863 sec
Time for inference 7: 5.10 sec total, 803.27 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15436.16 GB/s
FLOPS achieved: 77.18 TF/s

Prefill latency: 0.7129039689898491 sec
Decode latency: 4.38354285096284 sec
Time for inference 8: 5.10 sec total, 803.55 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15441.61 GB/s
FLOPS achieved: 77.21 TF/s

Prefill latency: 0.7106218870030716 sec
Decode latency: 4.384138894965872 sec
Time for inference 9: 5.10 sec total, 803.78 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15446.02 GB/s
FLOPS achieved: 77.23 TF/s

Prefill latency: 0.7135681749787182 sec
Decode latency: 4.383233692031354 sec
Time for inference 10: 5.10 sec total, 803.47 tokens/sec
Decode latency: 4.38 sec
Prefill latency: 0.71 sec
Bandwidth achieved: 15440.15 GB/s
FLOPS achieved: 77.20 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.3842 sec
Average prefill latency: 0.7116 sec
Average tokens/sec: 803.62
Memory used: 71.11 GB
Done. we are killing the process
