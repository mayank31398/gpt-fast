W1001 21:13:12.348000 22469686363968 torch/distributed/run.py:779] 
W1001 21:13:12.348000 22469686363968 torch/distributed/run.py:779] *****************************************
W1001 21:13:12.348000 22469686363968 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 21:13:12.348000 22469686363968 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.49 seconds
[rank0]:[W1001 21:13:26.921905793 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank5]:[W1001 21:13:26.925508802 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank4]:[W1001 21:13:27.217727723 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.07378815393894911 sec
Decode latency: 3.787720444961451 sec
Compilation time: 3.86 seconds
Compilation time: 3.91 seconds
Compilation time: 3.90 seconds
Compilation time: 3.85 secondsCompilation time: 3.92 seconds

Compilation time: 3.87 seconds
Compilation time: 3.86 seconds
Compilation time: 3.90 seconds
Prefill latency: 0.062271350994706154 sec
Decode latency: 3.7862746770260856 sec
Prefill latency: 0.06216148508246988 sec
Decode latency: 3.7870524439495057 sec
Prefill latency: 0.062292549991980195 sec
Decode latency: 3.786750597995706 sec
Prefill latency: 0.06224770797416568 sec
Decode latency: 3.7865120240021497 sec
Prefill latency: 0.062151935999281704 sec
Decode latency: 3.7871120360214263 sec
Time for inference 1: 3.85 sec total, 66.49 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.72 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.062204062938690186 sec
Decode latency: 3.7871191820595413 sec
Time for inference 2: 3.85 sec total, 66.49 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.74 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06244770507328212 sec
Decode latency: 3.7876080020796508 sec
Time for inference 3: 3.85 sec total, 66.48 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.44 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06217962608207017 sec
Decode latency: 3.787137644016184 sec
Time for inference 4: 3.85 sec total, 66.49 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.72 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.0622425670735538 sec
Decode latency: 3.7872180509148166 sec
Time for inference 5: 3.85 sec total, 66.49 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.71 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06224490096792579 sec
Decode latency: 3.7868378499988467 sec
Time for inference 6: 3.85 sec total, 66.50 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.82 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06233081000391394 sec
Decode latency: 3.786760797025636 sec
Time for inference 7: 3.85 sec total, 66.50 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.83 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06226472300477326 sec
Decode latency: 3.7873100690776482 sec
Time for inference 8: 3.85 sec total, 66.49 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.66 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.062191547942347825 sec
Decode latency: 3.7860825209645554 sec
Time for inference 9: 3.85 sec total, 66.51 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1278.06 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.06227045401465148 sec
Decode latency: 3.7871918809833005 sec
Time for inference 10: 3.85 sec total, 66.48 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1277.59 GB/s
FLOPS achieved: 6.39 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.7870 sec
Average prefill latency: 0.0623 sec
Average tokens/sec: 66.49
Memory used: 24.88 GB
Done. we are killing the process
