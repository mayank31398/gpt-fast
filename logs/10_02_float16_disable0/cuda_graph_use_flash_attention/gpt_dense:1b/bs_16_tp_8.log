W1001 20:08:29.136000 22384695936832 torch/distributed/run.py:779] 
W1001 20:08:29.136000 22384695936832 torch/distributed/run.py:779] *****************************************
W1001 20:08:29.136000 22384695936832 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:08:29.136000 22384695936832 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.11128371208906174 sec
Compilation time: 3.43 secondsCompilation time: 3.42 seconds
Compilation time: 3.44 seconds
Compilation time: 3.41 secondsCompilation time: 3.40 secondsCompilation time: 3.41 seconds



Compilation time: 3.40 seconds
Decode latency: 3.2814145089359954 sec
Compilation time: 3.40 seconds
Prefill latency: 0.10724828904494643 sec
Decode latency: 3.2569503870327026 sec
Prefill latency: 0.10840609099250287 sec
Decode latency: 3.221896487986669 sec
Prefill latency: 0.10759691090788692 sec
Decode latency: 3.158015741035342 sec
Prefill latency: 0.10564110102131963 sec
Decode latency: 3.2094429490389302 sec
Prefill latency: 0.10822217806708068 sec
Decode latency: 3.200572273111902 sec
Time for inference 1: 3.31 sec total, 1236.07 tokens/sec
Decode latency: 3.20 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 536.90 GB/s
FLOPS achieved: 2.68 TF/s

Prefill latency: 0.1081593839917332 sec
Decode latency: 3.2243594879982993 sec
Time for inference 2: 3.34 sec total, 1227.09 tokens/sec
Decode latency: 3.22 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 533.00 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.10348728206008673 sec
Decode latency: 3.2574460780015215 sec
Time for inference 3: 3.37 sec total, 1217.16 tokens/sec
Decode latency: 3.26 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 528.68 GB/s
FLOPS achieved: 2.64 TF/s

Prefill latency: 0.11043380305636674 sec
Decode latency: 3.2734142799163237 sec
Time for inference 4: 3.39 sec total, 1208.68 tokens/sec
Decode latency: 3.27 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 525.00 GB/s
FLOPS achieved: 2.63 TF/s

Prefill latency: 0.10842340101953596 sec
Decode latency: 3.27675861294847 sec
Time for inference 5: 3.39 sec total, 1208.71 tokens/sec
Decode latency: 3.28 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 525.01 GB/s
FLOPS achieved: 2.63 TF/s

Prefill latency: 0.10864504799246788 sec
Decode latency: 3.3050378089537844 sec
Time for inference 6: 3.42 sec total, 1198.19 tokens/sec
Decode latency: 3.31 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 520.44 GB/s
FLOPS achieved: 2.60 TF/s

Prefill latency: 0.10817011399194598 sec
Decode latency: 3.301662920974195 sec
Time for inference 7: 3.42 sec total, 1198.98 tokens/sec
Decode latency: 3.30 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 520.79 GB/s
FLOPS achieved: 2.60 TF/s

Prefill latency: 0.11076091602444649 sec
Decode latency: 3.2883219410432503 sec
Time for inference 8: 3.40 sec total, 1203.44 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 522.73 GB/s
FLOPS achieved: 2.61 TF/s

Prefill latency: 0.10918494302313775 sec
Decode latency: 3.2500443479511887 sec
Time for inference 9: 3.36 sec total, 1217.42 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 528.80 GB/s
FLOPS achieved: 2.64 TF/s

Prefill latency: 0.10755330906249583 sec
Decode latency: 3.2263440650422126 sec
Time for inference 10: 3.34 sec total, 1227.33 tokens/sec
Decode latency: 3.23 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 533.10 GB/s
FLOPS achieved: 2.67 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.2604 sec
Average prefill latency: 0.1083 sec
Average tokens/sec: 1214.31
Memory used: 7.49 GB
Done. we are killing the process
