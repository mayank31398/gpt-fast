W1001 20:07:27.973000 23090401711936 torch/distributed/run.py:779] 
W1001 20:07:27.973000 23090401711936 torch/distributed/run.py:779] *****************************************
W1001 20:07:27.973000 23090401711936 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:07:27.973000 23090401711936 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.88 seconds
Prefill latency: 0.1406706590205431 sec
Decode latency: 3.150117087061517 sec
Compilation time: 3.29 seconds
Compilation time: 3.32 seconds
Compilation time: 3.29 seconds
Compilation time: 3.30 seconds
Prefill latency: 0.12479241995606571 sec
Decode latency: 3.1423694120021537 sec
Prefill latency: 0.1363977980799973 sec
Decode latency: 3.1543866948923096 sec
Prefill latency: 0.14284091896843165 sec
Decode latency: 3.165936351986602 sec
Prefill latency: 0.13828373793512583 sec
Decode latency: 3.162863338016905 sec
Prefill latency: 0.14005240297410637 sec
Decode latency: 3.183714070939459 sec
Time for inference 1: 3.33 sec total, 1230.35 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 882.75 GB/s
FLOPS achieved: 4.41 TF/s

Prefill latency: 0.1401558390352875 sec
Decode latency: 3.2057954920455813 sec
Time for inference 2: 3.35 sec total, 1222.64 tokens/sec
Decode latency: 3.21 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 877.21 GB/s
FLOPS achieved: 4.39 TF/s

Prefill latency: 0.14115105394739658 sec
Decode latency: 3.2223891119938344 sec
Time for inference 3: 3.37 sec total, 1216.09 tokens/sec
Decode latency: 3.22 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 872.51 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.14076336799189448 sec
Decode latency: 3.2202081779250875 sec
Time for inference 4: 3.37 sec total, 1216.90 tokens/sec
Decode latency: 3.22 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 873.09 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.14122438500635326 sec
Decode latency: 3.2305379710160196 sec
Time for inference 5: 3.38 sec total, 1212.99 tokens/sec
Decode latency: 3.23 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 870.29 GB/s
FLOPS achieved: 4.35 TF/s

Prefill latency: 0.1397510910173878 sec
Decode latency: 3.1879666600143537 sec
Time for inference 6: 3.33 sec total, 1228.31 tokens/sec
Decode latency: 3.19 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 881.28 GB/s
FLOPS achieved: 4.41 TF/s

Prefill latency: 0.14011817693244666 sec
Decode latency: 3.1746730090817437 sec
Time for inference 7: 3.32 sec total, 1234.46 tokens/sec
Decode latency: 3.17 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 885.70 GB/s
FLOPS achieved: 4.43 TF/s

Prefill latency: 0.1397936790017411 sec
Decode latency: 3.165954345022328 sec
Time for inference 8: 3.31 sec total, 1237.19 tokens/sec
Decode latency: 3.17 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 887.65 GB/s
FLOPS achieved: 4.44 TF/s

Prefill latency: 0.13872167991939932 sec
Decode latency: 3.1264091649791226 sec
Time for inference 9: 3.27 sec total, 1251.73 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 898.08 GB/s
FLOPS achieved: 4.49 TF/s

Prefill latency: 0.13766328408382833 sec
Decode latency: 3.1342412260128185 sec
Time for inference 10: 3.28 sec total, 1249.86 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 896.74 GB/s
FLOPS achieved: 4.48 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1852 sec
Average prefill latency: 0.1399 sec
Average tokens/sec: 1230.05
Memory used: 9.08 GB
Done. we are killing the process
