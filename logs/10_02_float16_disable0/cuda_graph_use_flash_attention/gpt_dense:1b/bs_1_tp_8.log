W1001 20:06:32.726000 22779619686208 torch/distributed/run.py:779] 
W1001 20:06:32.726000 22779619686208 torch/distributed/run.py:779] *****************************************
W1001 20:06:32.726000 22779619686208 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:06:32.726000 22779619686208 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.34 seconds
Prefill latency: 0.023496309062466025 sec
Decode latency: 2.5087036269251257 sec
Compilation time: 2.57 seconds
Compilation time: 2.57 seconds
Compilation time: 2.58 seconds
Compilation time: 2.58 seconds
Compilation time: 2.56 seconds
Compilation time: 2.56 seconds
Compilation time: 2.58 seconds
Compilation time: 2.54 seconds
Prefill latency: 0.022625030018389225 sec
Decode latency: 2.51844734698534 sec
Prefill latency: 0.024533701012842357 sec
Decode latency: 2.5235253480495885 sec
Prefill latency: 0.02499336702749133 sec
Decode latency: 2.5275618380401284 sec
Prefill latency: 0.02477562299463898 sec
Decode latency: 2.4986907520797104 sec
Prefill latency: 0.02036386600229889 sec
Decode latency: 2.476528440020047 sec
Time for inference 1: 2.50 sec total, 102.23 tokens/sec
Decode latency: 2.48 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.41 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.020613291999325156 sec
Decode latency: 2.4996619620360434 sec
Time for inference 2: 2.53 sec total, 101.37 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.03 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.024722500005736947 sec
Decode latency: 2.4383897989755496 sec
Time for inference 3: 2.47 sec total, 103.80 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 45.09 GB/s
FLOPS achieved: 0.23 TF/s

Prefill latency: 0.025019182940013707 sec
Decode latency: 2.446983876056038 sec
Time for inference 4: 2.47 sec total, 103.48 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 44.95 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.023163253907114267 sec
Decode latency: 2.448446822934784 sec
Time for inference 5: 2.48 sec total, 103.38 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.90 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.022590538021177053 sec
Decode latency: 2.4533275299472734 sec
Time for inference 6: 2.48 sec total, 103.20 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.83 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.02475228300318122 sec
Decode latency: 2.463089769007638 sec
Time for inference 7: 2.49 sec total, 102.81 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.66 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.025073983008041978 sec
Decode latency: 2.468077289988287 sec
Time for inference 8: 2.50 sec total, 102.57 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 44.55 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.024500371073372662 sec
Decode latency: 2.481470525963232 sec
Time for inference 9: 2.51 sec total, 102.10 tokens/sec
Decode latency: 2.48 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.35 GB/s
FLOPS achieved: 0.22 TF/s

Prefill latency: 0.024908473016694188 sec
Decode latency: 2.49747851700522 sec
Time for inference 10: 2.52 sec total, 101.40 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 44.04 GB/s
FLOPS achieved: 0.22 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4673 sec
Average prefill latency: 0.0236 sec
Average tokens/sec: 102.64
Memory used: 1.17 GB
Done. we are killing the process
