W1001 18:57:55.566000 22513914496832 torch/distributed/run.py:779] 
W1001 18:57:55.566000 22513914496832 torch/distributed/run.py:779] *****************************************
W1001 18:57:55.566000 22513914496832 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 18:57:55.566000 22513914496832 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.11 seconds
Prefill latency: 0.07202086108736694 sec
Decode latency: 1.4367860270431265 sec
Compilation time: 1.49 seconds
Compilation time: 1.45 seconds
Compilation time: 1.48 secondsCompilation time: 1.49 seconds

Compilation time: 1.48 seconds
Compilation time: 1.50 seconds
Compilation time: 1.48 seconds
Compilation time: 1.51 seconds
Prefill latency: 0.01618599402718246 sec
Decode latency: 1.4358534889761358 sec
Prefill latency: 0.016167960944585502 sec
Decode latency: 1.4357561650685966 sec
Prefill latency: 0.01612391695380211 sec
Decode latency: 1.435569338966161 sec
Prefill latency: 0.016185383079573512 sec
Decode latency: 1.4355981670087203 sec
Prefill latency: 0.016160727944225073 sec
Decode latency: 1.435595946968533 sec
Time for inference 1: 1.45 sec total, 176.25 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.80 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016160249011591077 sec
Decode latency: 1.435640336945653 sec
Time for inference 2: 1.45 sec total, 176.23 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.75 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016190513037145138 sec
Decode latency: 1.4361893000314012 sec
Time for inference 3: 1.45 sec total, 176.18 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.60 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016263968078419566 sec
Decode latency: 1.4356597289443016 sec
Time for inference 4: 1.45 sec total, 176.23 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.74 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016131510958075523 sec
Decode latency: 1.4359544289764017 sec
Time for inference 5: 1.45 sec total, 176.21 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.68 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016099191969260573 sec
Decode latency: 1.4358483409741893 sec
Time for inference 6: 1.45 sec total, 176.23 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.74 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016157487989403307 sec
Decode latency: 1.4354001469910145 sec
Time for inference 7: 1.45 sec total, 176.28 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.88 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016198972007259727 sec
Decode latency: 1.4353451549541205 sec
Time for inference 8: 1.45 sec total, 176.29 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.90 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.01614701293874532 sec
Decode latency: 1.4357266779989004 sec
Time for inference 9: 1.45 sec total, 176.24 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.77 GB/s
FLOPS achieved: 2.46 TF/s

Prefill latency: 0.016096540028229356 sec
Decode latency: 1.4359493110096082 sec
Time for inference 10: 1.45 sec total, 176.21 tokens/sec
Decode latency: 1.44 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 492.68 GB/s
FLOPS achieved: 2.46 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.4357 sec
Average prefill latency: 0.0162 sec
Average tokens/sec: 176.23
Memory used: 4.98 GB
Done. we are killing the process
