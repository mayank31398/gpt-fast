W1001 18:59:09.978000 23130378553152 torch/distributed/run.py:779] 
W1001 18:59:09.978000 23130378553152 torch/distributed/run.py:779] *****************************************
W1001 18:59:09.978000 23130378553152 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 18:59:09.978000 23130378553152 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.01 seconds
[rank6]:[W1001 18:59:23.247342259 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.10713953792583197 sec
Decode latency: 1.5925440000137314 sec
Compilation time: 1.70 seconds
Compilation time: 1.72 secondsCompilation time: 1.66 seconds

Compilation time: 1.68 secondsCompilation time: 1.64 seconds

Compilation time: 1.70 seconds
Compilation time: 1.63 seconds
Compilation time: 1.67 seconds
Prefill latency: 0.04105454799719155 sec
Decode latency: 1.5917326950002462 sec
Prefill latency: 0.04099885898176581 sec
Decode latency: 1.5906788290012628 sec
Prefill latency: 0.04088715498801321 sec
Decode latency: 1.5911614040378481 sec
Prefill latency: 0.04092612094245851 sec
Decode latency: 1.590849404106848 sec
Prefill latency: 0.0409152569482103 sec
Decode latency: 1.5910102659836411 sec
Time for inference 1: 1.63 sec total, 627.20 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.67 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.04121513897553086 sec
Decode latency: 1.591067292029038 sec
Time for inference 2: 1.63 sec total, 627.10 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.39 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.040980427991598845 sec
Decode latency: 1.5910027819918469 sec
Time for inference 3: 1.63 sec total, 627.22 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.74 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.04095225397031754 sec
Decode latency: 1.5905305750202388 sec
Time for inference 4: 1.63 sec total, 627.39 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1754.21 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.04090326698496938 sec
Decode latency: 1.590984754031524 sec
Time for inference 5: 1.63 sec total, 627.20 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.67 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.041106306947767735 sec
Decode latency: 1.5910903270123526 sec
Time for inference 6: 1.63 sec total, 627.10 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.39 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.04100527102127671 sec
Decode latency: 1.5905118919909 sec
Time for inference 7: 1.63 sec total, 627.34 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1754.06 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.04090325394645333 sec
Decode latency: 1.5907822879962623 sec
Time for inference 8: 1.63 sec total, 627.35 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1754.09 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.041494311997666955 sec
Decode latency: 1.5912294409936294 sec
Time for inference 9: 1.63 sec total, 626.89 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1752.80 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.0408782270969823 sec
Decode latency: 1.5908327549695969 sec
Time for inference 10: 1.63 sec total, 627.29 tokens/sec
Decode latency: 1.59 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1753.93 GB/s
FLOPS achieved: 8.77 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.5909 sec
Average prefill latency: 0.0410 sec
Average tokens/sec: 627.21
Memory used: 7.44 GB
Done. we are killing the process
