W1001 18:58:33.559000 22496123098944 torch/distributed/run.py:779] 
W1001 18:58:33.559000 22496123098944 torch/distributed/run.py:779] *****************************************
W1001 18:58:33.559000 22496123098944 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 18:58:33.559000 22496123098944 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.90 seconds
Prefill latency: 0.05488605203572661 sec
Decode latency: 1.6429962071124464 sec
Compilation time: 1.78 seconds
Compilation time: 1.70 seconds
Compilation time: 1.75 seconds
Compilation time: 1.70 seconds
Prefill latency: 0.054348082980141044 sec
Decode latency: 1.6420448500430211 sec
Prefill latency: 0.05450172396376729 sec
Decode latency: 1.6420605030143633 sec
Prefill latency: 0.05452763196080923 sec
Decode latency: 1.6440749069442973 sec
Prefill latency: 0.05455204809550196 sec
Decode latency: 1.645099965040572 sec
Prefill latency: 0.054600195959210396 sec
Decode latency: 1.6444300769362599 sec
Time for inference 1: 1.70 sec total, 602.45 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2735.66 GB/s
FLOPS achieved: 13.68 TF/s

Prefill latency: 0.05460834410041571 sec
Decode latency: 1.6441296810517088 sec
Time for inference 2: 1.70 sec total, 602.60 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2736.31 GB/s
FLOPS achieved: 13.68 TF/s

Prefill latency: 0.05442472896538675 sec
Decode latency: 1.6445512260543182 sec
Time for inference 3: 1.70 sec total, 602.48 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2735.80 GB/s
FLOPS achieved: 13.68 TF/s

Prefill latency: 0.05471362604293972 sec
Decode latency: 1.643678550957702 sec
Time for inference 4: 1.70 sec total, 602.67 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2736.65 GB/s
FLOPS achieved: 13.68 TF/s

Prefill latency: 0.054632680024951696 sec
Decode latency: 1.6434725990984589 sec
Time for inference 5: 1.70 sec total, 602.80 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2737.25 GB/s
FLOPS achieved: 13.69 TF/s

Prefill latency: 0.054608964012004435 sec
Decode latency: 1.6438807089580223 sec
Time for inference 6: 1.70 sec total, 602.66 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2736.60 GB/s
FLOPS achieved: 13.68 TF/s

Prefill latency: 0.05455668503418565 sec
Decode latency: 1.6435030159773305 sec
Time for inference 7: 1.70 sec total, 602.80 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2737.21 GB/s
FLOPS achieved: 13.69 TF/s

Prefill latency: 0.05468586494680494 sec
Decode latency: 1.643357516033575 sec
Time for inference 8: 1.70 sec total, 602.82 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2737.33 GB/s
FLOPS achieved: 13.69 TF/s

Prefill latency: 0.054586556972935796 sec
Decode latency: 1.6428840960143134 sec
Time for inference 9: 1.70 sec total, 603.02 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2738.24 GB/s
FLOPS achieved: 13.69 TF/s

Prefill latency: 0.0546125469263643 sec
Decode latency: 1.6419336969265714 sec
Time for inference 10: 1.70 sec total, 603.37 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2739.82 GB/s
FLOPS achieved: 13.70 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.6436 sec
Average prefill latency: 0.0546 sec
Average tokens/sec: 602.77
Memory used: 10.18 GB
Done. we are killing the process
