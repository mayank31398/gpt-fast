W1001 18:57:21.691000 22678848116544 torch/distributed/run.py:779] 
W1001 18:57:21.691000 22678848116544 torch/distributed/run.py:779] *****************************************
W1001 18:57:21.691000 22678848116544 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 18:57:21.691000 22678848116544 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.020979842985980213 sec
Decode latency: 1.4938676219899207 sec
Compilation time: 1.54 seconds
Compilation time: 1.54 seconds
Compilation time: 1.51 seconds
Compilation time: 1.52 seconds
Prefill latency: 0.01884465094190091 sec
Decode latency: 1.4920727510470897 sec
Prefill latency: 0.018825608072802424 sec
Decode latency: 1.4925855739274994 sec
Prefill latency: 0.01900376402772963 sec
Decode latency: 1.4930497910827398 sec
Prefill latency: 0.018829892040230334 sec
Decode latency: 1.4926765990676358 sec
Prefill latency: 0.018860221025533974 sec
Decode latency: 1.4909243120346218 sec
Time for inference 1: 1.51 sec total, 169.50 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.66 GB/s
FLOPS achieved: 3.85 TF/s

Prefill latency: 0.018823735998012125 sec
Decode latency: 1.4920717959757894 sec
Time for inference 2: 1.51 sec total, 169.37 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.09 GB/s
FLOPS achieved: 3.85 TF/s

Prefill latency: 0.018868550076149404 sec
Decode latency: 1.4914501800667495 sec
Time for inference 3: 1.51 sec total, 169.43 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.38 GB/s
FLOPS achieved: 3.85 TF/s

Prefill latency: 0.01886098994873464 sec
Decode latency: 1.4933809849899262 sec
Time for inference 4: 1.51 sec total, 169.21 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 768.36 GB/s
FLOPS achieved: 3.84 TF/s

Prefill latency: 0.01873768900986761 sec
Decode latency: 1.492348411004059 sec
Time for inference 5: 1.51 sec total, 169.36 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.02 GB/s
FLOPS achieved: 3.85 TF/s

Prefill latency: 0.018916714005172253 sec
Decode latency: 1.4913280160399154 sec
Time for inference 6: 1.51 sec total, 169.44 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.42 GB/s
FLOPS achieved: 3.85 TF/s

Prefill latency: 0.01879259303677827 sec
Decode latency: 1.4940117719816044 sec
Time for inference 7: 1.51 sec total, 169.16 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 768.12 GB/s
FLOPS achieved: 3.84 TF/s

Prefill latency: 0.01885166298598051 sec
Decode latency: 1.4942012779647484 sec
Time for inference 8: 1.51 sec total, 169.10 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 767.86 GB/s
FLOPS achieved: 3.84 TF/s

Prefill latency: 0.018712802906520665 sec
Decode latency: 1.4938113420503214 sec
Time for inference 9: 1.51 sec total, 169.18 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 768.20 GB/s
FLOPS achieved: 3.84 TF/s

Prefill latency: 0.018840392935089767 sec
Decode latency: 1.4914432629011571 sec
Time for inference 10: 1.51 sec total, 169.43 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 769.37 GB/s
FLOPS achieved: 3.85 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.4925 sec
Average prefill latency: 0.0188 sec
Average tokens/sec: 169.32
Memory used: 6.78 GB
Done. we are killing the process
