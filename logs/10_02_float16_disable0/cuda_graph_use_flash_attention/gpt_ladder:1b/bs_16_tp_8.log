W1001 20:04:53.454000 23274186655552 torch/distributed/run.py:779] 
W1001 20:04:53.454000 23274186655552 torch/distributed/run.py:779] *****************************************
W1001 20:04:53.454000 23274186655552 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:04:53.454000 23274186655552 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.16 seconds
Prefill latency: 0.11857568402774632 sec
Decode latency: 2.394758441951126 sec
Compilation time: 2.52 seconds
Compilation time: 2.53 seconds
Compilation time: 2.53 seconds
Compilation time: 2.49 secondsCompilation time: 2.52 seconds

Compilation time: 2.52 seconds
Compilation time: 2.55 seconds
Compilation time: 2.52 seconds
Prefill latency: 0.09212213498540223 sec
Decode latency: 2.3965859999880195 sec
Prefill latency: 0.09213910903781652 sec
Decode latency: 2.399107998004183 sec
Prefill latency: 0.08900433592498302 sec
Decode latency: 2.36304767196998 sec
Prefill latency: 0.08865101600531489 sec
Decode latency: 2.3580979959806427 sec
Prefill latency: 0.08876393502578139 sec
Decode latency: 2.348079452989623 sec
Time for inference 1: 2.44 sec total, 1677.10 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 728.47 GB/s
FLOPS achieved: 3.64 TF/s

Prefill latency: 0.09092973091173917 sec
Decode latency: 2.3143096099374816 sec
Time for inference 2: 2.41 sec total, 1699.44 tokens/sec
Decode latency: 2.31 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 738.17 GB/s
FLOPS achieved: 3.69 TF/s

Prefill latency: 0.08591945597436279 sec
Decode latency: 2.3212381890043616 sec
Time for inference 3: 2.41 sec total, 1698.49 tokens/sec
Decode latency: 2.32 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 737.75 GB/s
FLOPS achieved: 3.69 TF/s

Prefill latency: 0.08954841294325888 sec
Decode latency: 2.332033279002644 sec
Time for inference 4: 2.42 sec total, 1690.23 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 734.17 GB/s
FLOPS achieved: 3.67 TF/s

Prefill latency: 0.08928218099754304 sec
Decode latency: 2.3283995559904724 sec
Time for inference 5: 2.42 sec total, 1692.16 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 735.01 GB/s
FLOPS achieved: 3.68 TF/s

Prefill latency: 0.08900312997866422 sec
Decode latency: 2.3382575889118016 sec
Time for inference 6: 2.43 sec total, 1684.82 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 731.82 GB/s
FLOPS achieved: 3.66 TF/s

Prefill latency: 0.08969593804795295 sec
Decode latency: 2.3376027869526297 sec
Time for inference 7: 2.43 sec total, 1685.45 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 732.09 GB/s
FLOPS achieved: 3.66 TF/s

Prefill latency: 0.08838892704807222 sec
Decode latency: 2.349512988002971 sec
Time for inference 8: 2.44 sec total, 1676.66 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 728.27 GB/s
FLOPS achieved: 3.64 TF/s

Prefill latency: 0.08946840395219624 sec
Decode latency: 2.3704557759920135 sec
Time for inference 9: 2.47 sec total, 1661.64 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 721.75 GB/s
FLOPS achieved: 3.61 TF/s

Prefill latency: 0.09040465299040079 sec
Decode latency: 2.37165352597367 sec
Time for inference 10: 2.46 sec total, 1662.03 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 721.92 GB/s
FLOPS achieved: 3.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3412 sec
Average prefill latency: 0.0891 sec
Average tokens/sec: 1682.80
Memory used: 7.49 GB
Done. we are killing the process
