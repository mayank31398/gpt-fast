W1001 18:56:15.978000 22653299517248 torch/distributed/run.py:779] 
W1001 18:56:15.978000 22653299517248 torch/distributed/run.py:779] *****************************************
W1001 18:56:15.978000 22653299517248 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 18:56:15.978000 22653299517248 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W1001 18:56:23.090841965 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.04744979494716972 sec
Decode latency: 1.397668570978567 sec
Compilation time: 1.46 seconds
Compilation time: 1.50 secondsCompilation time: 1.45 secondsCompilation time: 1.46 seconds


Prefill latency: 0.04709704592823982 sec
Decode latency: 1.3977564650122076 sec
Prefill latency: 0.047209923970513046 sec
Decode latency: 1.3968788259662688 sec
Prefill latency: 0.04758694896008819 sec
Decode latency: 1.3973579090088606 sec
Prefill latency: 0.04749430203810334 sec
Decode latency: 1.3984165189322084 sec
Prefill latency: 0.047423804993741214 sec
Decode latency: 1.3972100720275193 sec
Time for inference 1: 1.45 sec total, 708.53 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3217.35 GB/s
FLOPS achieved: 16.09 TF/s

Prefill latency: 0.047493295976892114 sec
Decode latency: 1.3968250380130485 sec
Time for inference 2: 1.44 sec total, 708.66 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3217.94 GB/s
FLOPS achieved: 16.09 TF/s

Prefill latency: 0.04747699003200978 sec
Decode latency: 1.3983007189817727 sec
Time for inference 3: 1.45 sec total, 707.97 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3214.79 GB/s
FLOPS achieved: 16.07 TF/s

Prefill latency: 0.04752868297509849 sec
Decode latency: 1.3974756579846144 sec
Time for inference 4: 1.45 sec total, 708.35 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3216.53 GB/s
FLOPS achieved: 16.08 TF/s

Prefill latency: 0.04742641607299447 sec
Decode latency: 1.397578850039281 sec
Time for inference 5: 1.45 sec total, 708.39 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3216.72 GB/s
FLOPS achieved: 16.08 TF/s

Prefill latency: 0.04741247289348394 sec
Decode latency: 1.3975239749997854 sec
Time for inference 6: 1.45 sec total, 708.33 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3216.41 GB/s
FLOPS achieved: 16.08 TF/s

Prefill latency: 0.04750084108673036 sec
Decode latency: 1.3986223860410973 sec
Time for inference 7: 1.45 sec total, 707.76 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3213.86 GB/s
FLOPS achieved: 16.07 TF/s

Prefill latency: 0.0473126060096547 sec
Decode latency: 1.396990378969349 sec
Time for inference 8: 1.44 sec total, 708.71 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3218.14 GB/s
FLOPS achieved: 16.09 TF/s

Prefill latency: 0.04750332096591592 sec
Decode latency: 1.3969686940545216 sec
Time for inference 9: 1.45 sec total, 708.60 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3217.66 GB/s
FLOPS achieved: 16.09 TF/s

Prefill latency: 0.04755506094079465 sec
Decode latency: 1.3980288039892912 sec
Time for inference 10: 1.45 sec total, 708.07 tokens/sec
Decode latency: 1.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3215.24 GB/s
FLOPS achieved: 16.08 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.3976 sec
Average prefill latency: 0.0475 sec
Average tokens/sec: 708.34
Memory used: 10.16 GB
Done. we are killing the process
