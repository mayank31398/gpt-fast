W1001 20:33:29.992000 23244322211648 torch/distributed/run.py:779] 
W1001 20:33:29.992000 23244322211648 torch/distributed/run.py:779] *****************************************
W1001 20:33:29.992000 23244322211648 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:33:29.992000 23244322211648 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.22 seconds
Prefill latency: 0.017247659037820995 sec
Decode latency: 1.6262512190733105 sec
Compilation time: 1.71 seconds
Compilation time: 1.66 seconds
Compilation time: 1.65 seconds
Compilation time: 1.64 seconds
Prefill latency: 0.016697645070962608 sec
Decode latency: 1.6255998170236126 sec
Prefill latency: 0.01668675197288394 sec
Decode latency: 1.6258685060311109 sec
Prefill latency: 0.016636695014312863 sec
Decode latency: 1.6260929530253634 sec
Prefill latency: 0.016683507012203336 sec
Decode latency: 1.6247686400311068 sec
Prefill latency: 0.016676102997735143 sec
Decode latency: 1.625763745047152 sec
Time for inference 1: 1.64 sec total, 155.81 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.01 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016668947064317763 sec
Decode latency: 1.6248700710712 sec
Time for inference 2: 1.64 sec total, 155.88 tokens/sec
Decode latency: 1.62 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.16 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016673506936058402 sec
Decode latency: 1.6256510249804705 sec
Time for inference 3: 1.64 sec total, 155.81 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.02 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016857065027579665 sec
Decode latency: 1.6256538219749928 sec
Time for inference 4: 1.64 sec total, 155.80 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 299.99 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.01659661903977394 sec
Decode latency: 1.626135102007538 sec
Time for inference 5: 1.64 sec total, 155.75 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 299.91 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016701087937690318 sec
Decode latency: 1.6249101050198078 sec
Time for inference 6: 1.64 sec total, 155.86 tokens/sec
Decode latency: 1.62 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.12 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.01671312900725752 sec
Decode latency: 1.626540195895359 sec
Time for inference 7: 1.64 sec total, 155.72 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 299.84 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016660055029205978 sec
Decode latency: 1.6250669970177114 sec
Time for inference 8: 1.64 sec total, 155.86 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.12 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016622856026515365 sec
Decode latency: 1.6259321250254288 sec
Time for inference 9: 1.64 sec total, 155.78 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 299.97 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.016625609947368503 sec
Decode latency: 1.6258944179862738 sec
Time for inference 10: 1.64 sec total, 155.80 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 300.00 GB/s
FLOPS achieved: 1.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.6256 sec
Average prefill latency: 0.0167 sec
Average tokens/sec: 155.81
Memory used: 3.01 GB
Done. we are killing the process
