W0920 08:56:49.796000 22939359385408 torch/distributed/run.py:779] 
W0920 08:56:49.796000 22939359385408 torch/distributed/run.py:779] *****************************************
W0920 08:56:49.796000 22939359385408 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:56:49.796000 22939359385408 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.86 seconds
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Prefill latency: 3.266900757327676 sec
Decode latency: 15.879619209095836 sec
Compilation time: 18.96 seconds
Compilation time: 19.15 seconds
Prefill latency: 0.17156331054866314 sec
Decode latency: 15.499786036089063 sec
Prefill latency: 0.16977951303124428 sec
Decode latency: 15.497066328302026 sec
Prefill latency: 0.16976353526115417 sec
Decode latency: 15.668818339705467 sec
Prefill latency: 0.1709915790706873 sec
Decode latency: 16.211756939068437 sec
Prefill latency: 0.1701998058706522 sec
Decode latency: 15.926998237147927 sec
Time for inference 1: 16.10 sec total, 15.90 tokens/sec
Decode latency: 15.93 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1122.00 GB/s
FLOPS achieved: 5.61 TF/s

Prefill latency: 0.17038379795849323 sec
Decode latency: 15.396870696917176 sec
Time for inference 2: 15.57 sec total, 16.44 tokens/sec
Decode latency: 15.40 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1160.19 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.17153135687112808 sec
Decode latency: 15.40583822503686 sec
Time for inference 3: 15.58 sec total, 16.43 tokens/sec
Decode latency: 15.41 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1159.44 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.17002577893435955 sec
Decode latency: 15.635042537003756 sec
Time for inference 4: 15.81 sec total, 16.20 tokens/sec
Decode latency: 15.64 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1142.73 GB/s
FLOPS achieved: 5.71 TF/s

Prefill latency: 0.16955466754734516 sec
Decode latency: 15.421998340636492 sec
Time for inference 5: 15.59 sec total, 16.42 tokens/sec
Decode latency: 15.42 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1158.38 GB/s
FLOPS achieved: 5.79 TF/s

Prefill latency: 0.16926422715187073 sec
Decode latency: 15.420153783634305 sec
Time for inference 6: 15.59 sec total, 16.42 tokens/sec
Decode latency: 15.42 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1158.54 GB/s
FLOPS achieved: 5.79 TF/s

Prefill latency: 0.17165610007941723 sec
Decode latency: 15.36370195262134 sec
Time for inference 7: 15.54 sec total, 16.48 tokens/sec
Decode latency: 15.36 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1162.57 GB/s
FLOPS achieved: 5.81 TF/s

Prefill latency: 0.16915682144463062 sec
Decode latency: 15.595785552635789 sec
Time for inference 8: 15.77 sec total, 16.24 tokens/sec
Decode latency: 15.60 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1145.64 GB/s
FLOPS achieved: 5.73 TF/s

Prefill latency: 0.17054352536797523 sec
Decode latency: 15.513387339189649 sec
Time for inference 9: 15.68 sec total, 16.32 tokens/sec
Decode latency: 15.51 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1151.56 GB/s
FLOPS achieved: 5.76 TF/s

Prefill latency: 0.16994062438607216 sec
Decode latency: 15.378397088497877 sec
Time for inference 10: 15.55 sec total, 16.46 tokens/sec
Decode latency: 15.38 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1161.60 GB/s
FLOPS achieved: 5.81 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 15.5058 sec
Average prefill latency: 0.1702 sec
Average tokens/sec: 16.33
Memory used: 73.48 GB
