W0920 08:09:14.326000 23033348380480 torch/distributed/run.py:779] 
W0920 08:09:14.326000 23033348380480 torch/distributed/run.py:779] *****************************************
W0920 08:09:14.326000 23033348380480 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:09:14.326000 23033348380480 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.26 seconds
Prefill latency: 0.06550794094800949 sec
Decode latency: 5.073430065065622 sec
Compilation time: 5.16 secondsCompilation time: 5.16 seconds
Compilation time: 5.16 seconds

Compilation time: 5.18 seconds
Compilation time: 5.18 seconds
Compilation time: 5.15 seconds
Compilation time: 5.14 seconds
Compilation time: 5.17 seconds
Prefill latency: 0.06489809229969978 sec
Decode latency: 5.074269559234381 sec
Prefill latency: 0.06493000872433186 sec
Decode latency: 5.073975522071123 sec
Prefill latency: 0.06493949145078659 sec
Decode latency: 5.074841700494289 sec
Prefill latency: 0.06499055214226246 sec
Decode latency: 5.0750010665506124 sec
Prefill latency: 0.06491043418645859 sec
Decode latency: 5.075565781444311 sec
Time for inference 1: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.79 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06493348069489002 sec
Decode latency: 5.075359661132097 sec
Time for inference 2: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.82 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06491157226264477 sec
Decode latency: 5.075571751222014 sec
Time for inference 3: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.78 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06490875594317913 sec
Decode latency: 5.07574119605124 sec
Time for inference 4: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.75 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06502386555075645 sec
Decode latency: 5.076178936287761 sec
Time for inference 5: 5.14 sec total, 49.78 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 956.66 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06494762562215328 sec
Decode latency: 5.075214486569166 sec
Time for inference 6: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.86 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.0649507287889719 sec
Decode latency: 5.075229303911328 sec
Time for inference 7: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.85 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06494079530239105 sec
Decode latency: 5.076321819797158 sec
Time for inference 8: 5.14 sec total, 49.78 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 956.64 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06503613665699959 sec
Decode latency: 5.075564794242382 sec
Time for inference 9: 5.14 sec total, 49.79 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 956.76 GB/s
FLOPS achieved: 4.78 TF/s

Prefill latency: 0.06502650864422321 sec
Decode latency: 5.076484682038426 sec
Time for inference 10: 5.14 sec total, 49.78 tokens/sec
Decode latency: 5.08 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 956.61 GB/s
FLOPS achieved: 4.78 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.0757 sec
Average prefill latency: 0.0650 sec
Average tokens/sec: 49.79
Memory used: 24.90 GB
