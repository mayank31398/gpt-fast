W0920 08:20:41.822000 22357202278208 torch/distributed/run.py:779] 
W0920 08:20:41.822000 22357202278208 torch/distributed/run.py:779] *****************************************
W0920 08:20:41.822000 22357202278208 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:20:41.822000 22357202278208 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.19 seconds
Prefill latency: 0.6871507558971643 sec
Decode latency: 8.827038560062647 sec
Compilation time: 9.52 seconds
Compilation time: 9.55 secondsCompilation time: 9.51 seconds

Compilation time: 9.52 seconds
Prefill latency: 0.691278513520956 sec
Decode latency: 8.825401686131954 sec
Prefill latency: 0.6900201607495546 sec
Decode latency: 8.824563244357705 sec
Prefill latency: 0.6897392552345991 sec
Decode latency: 8.824133099988103 sec
Prefill latency: 0.6907554939389229 sec
Decode latency: 8.824177637696266 sec
Prefill latency: 0.6917298138141632 sec
Decode latency: 8.824147950857878 sec
Time for inference 1: 9.52 sec total, 215.19 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7817.62 GB/s
FLOPS achieved: 39.09 TF/s

Prefill latency: 0.689533730968833 sec
Decode latency: 8.82424915023148 sec
Time for inference 2: 9.52 sec total, 215.24 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7819.48 GB/s
FLOPS achieved: 39.10 TF/s

Prefill latency: 0.6928259152919054 sec
Decode latency: 8.824429854750633 sec
Time for inference 3: 9.52 sec total, 215.16 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7816.65 GB/s
FLOPS achieved: 39.08 TF/s

Prefill latency: 0.6938190553337336 sec
Decode latency: 8.824540201574564 sec
Time for inference 4: 9.52 sec total, 215.13 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7815.69 GB/s
FLOPS achieved: 39.08 TF/s

Prefill latency: 0.6923814564943314 sec
Decode latency: 8.824944734573364 sec
Time for inference 5: 9.52 sec total, 215.16 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7816.59 GB/s
FLOPS achieved: 39.08 TF/s

Prefill latency: 0.6879325956106186 sec
Decode latency: 8.825595298781991 sec
Time for inference 6: 9.51 sec total, 215.24 tokens/sec
Decode latency: 8.83 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7819.64 GB/s
FLOPS achieved: 39.10 TF/s

Prefill latency: 0.6929541882127523 sec
Decode latency: 8.824869429692626 sec
Time for inference 7: 9.52 sec total, 215.15 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7816.17 GB/s
FLOPS achieved: 39.08 TF/s

Prefill latency: 0.6917666867375374 sec
Decode latency: 8.825551761314273 sec
Time for inference 8: 9.52 sec total, 215.16 tokens/sec
Decode latency: 8.83 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7816.59 GB/s
FLOPS achieved: 39.08 TF/s

Prefill latency: 0.6912139393389225 sec
Decode latency: 8.824534811079502 sec
Time for inference 9: 9.52 sec total, 215.20 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7817.94 GB/s
FLOPS achieved: 39.09 TF/s

Prefill latency: 0.6913005467504263 sec
Decode latency: 8.82669087126851 sec
Time for inference 10: 9.52 sec total, 215.14 tokens/sec
Decode latency: 8.83 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7815.90 GB/s
FLOPS achieved: 39.08 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.8250 sec
Average prefill latency: 0.6915 sec
Average tokens/sec: 215.18
Memory used: 72.14 GB
