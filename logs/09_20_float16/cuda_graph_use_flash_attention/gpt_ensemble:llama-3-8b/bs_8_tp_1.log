flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.03 seconds
Prefill latency: 0.6685870215296745 sec
Decode latency: 7.181649382226169 sec
Compilation time: 7.85 seconds
Prefill latency: 0.4661481073126197 sec
Decode latency: 7.606008296832442 sec
Prefill latency: 0.6396724991500378 sec
Decode latency: 9.608878378756344 sec
Prefill latency: 0.639736290089786 sec
Decode latency: 8.223908985033631 sec
Prefill latency: 0.630755634047091 sec
Decode latency: 7.084981783293188 sec
Prefill latency: 0.5389395225793123 sec
Decode latency: 7.4574723448604345 sec
Time for inference 1: 8.00 sec total, 256.04 tokens/sec
Decode latency: 7.46 sec
Prefill latency: 0.54 sec
Bandwidth achieved: 3843.10 GB/s
FLOPS achieved: 19.22 TF/s

Prefill latency: 0.36355183832347393 sec
Decode latency: 7.353395543061197 sec
Time for inference 2: 7.72 sec total, 265.29 tokens/sec
Decode latency: 7.35 sec
Prefill latency: 0.36 sec
Bandwidth achieved: 3981.89 GB/s
FLOPS achieved: 19.91 TF/s

Prefill latency: 0.6703004613518715 sec
Decode latency: 7.102083665318787 sec
Time for inference 3: 7.78 sec total, 263.32 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.67 sec
Bandwidth achieved: 3952.35 GB/s
FLOPS achieved: 19.76 TF/s

Prefill latency: 0.5233649341389537 sec
Decode latency: 7.6925436006858945 sec
Time for inference 4: 8.22 sec total, 249.18 tokens/sec
Decode latency: 7.69 sec
Prefill latency: 0.52 sec
Bandwidth achieved: 3740.19 GB/s
FLOPS achieved: 18.70 TF/s

Prefill latency: 0.6504229018464684 sec
Decode latency: 7.287749354727566 sec
Time for inference 5: 7.94 sec total, 257.89 tokens/sec
Decode latency: 7.29 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 3870.87 GB/s
FLOPS achieved: 19.35 TF/s

Prefill latency: 0.45083894580602646 sec
Decode latency: 7.544299578294158 sec
Time for inference 6: 8.00 sec total, 255.99 tokens/sec
Decode latency: 7.54 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 3842.39 GB/s
FLOPS achieved: 19.21 TF/s

Prefill latency: 0.6224967986345291 sec
Decode latency: 7.298257688060403 sec
Time for inference 7: 7.92 sec total, 258.46 tokens/sec
Decode latency: 7.30 sec
Prefill latency: 0.62 sec
Bandwidth achieved: 3879.41 GB/s
FLOPS achieved: 19.40 TF/s

Prefill latency: 0.49415354058146477 sec
Decode latency: 7.578791542910039 sec
Time for inference 8: 8.07 sec total, 253.65 tokens/sec
Decode latency: 7.58 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 3807.30 GB/s
FLOPS achieved: 19.04 TF/s

Prefill latency: 0.3636368475854397 sec
Decode latency: 7.254287408664823 sec
Time for inference 9: 7.62 sec total, 268.73 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 0.36 sec
Bandwidth achieved: 4033.63 GB/s
FLOPS achieved: 20.17 TF/s

Prefill latency: 0.6322889225557446 sec
Decode latency: 7.2255080454051495 sec
Time for inference 10: 7.86 sec total, 260.46 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3909.43 GB/s
FLOPS achieved: 19.55 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.3794 sec
Average prefill latency: 0.5310 sec
Average tokens/sec: 258.90
Memory used: 21.53 GB
