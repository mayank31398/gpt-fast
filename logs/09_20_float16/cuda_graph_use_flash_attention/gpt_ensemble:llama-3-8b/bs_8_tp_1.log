flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.6537661561742425 sec
Decode latency: 9.603793386369944 sec
Compilation time: 10.26 seconds
Prefill latency: 0.6558353491127491 sec
Decode latency: 8.418248321861029 sec
Prefill latency: 0.3003848921507597 sec
Decode latency: 8.642824705690145 sec
Prefill latency: 0.6525841522961855 sec
Decode latency: 9.623302582651377 sec
Prefill latency: 0.6492324210703373 sec
Decode latency: 7.454339901916683 sec
Prefill latency: 0.3009398691356182 sec
Decode latency: 9.432472781278193 sec
Time for inference 1: 9.74 sec total, 210.35 tokens/sec
Decode latency: 9.43 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 3157.30 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.6628539506345987 sec
Decode latency: 9.629774143919349 sec
Time for inference 2: 10.30 sec total, 198.84 tokens/sec
Decode latency: 9.63 sec
Prefill latency: 0.66 sec
Bandwidth achieved: 2984.55 GB/s
FLOPS achieved: 14.92 TF/s

Prefill latency: 0.6524931909516454 sec
Decode latency: 7.062773433513939 sec
Time for inference 3: 7.72 sec total, 265.20 tokens/sec
Decode latency: 7.06 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 3980.66 GB/s
FLOPS achieved: 19.90 TF/s

Prefill latency: 0.649419728666544 sec
Decode latency: 9.595949751324952 sec
Time for inference 4: 10.25 sec total, 199.75 tokens/sec
Decode latency: 9.60 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 2998.27 GB/s
FLOPS achieved: 14.99 TF/s

Prefill latency: 0.6516328705474734 sec
Decode latency: 9.656332180835307 sec
Time for inference 5: 10.31 sec total, 198.58 tokens/sec
Decode latency: 9.66 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 2980.69 GB/s
FLOPS achieved: 14.90 TF/s

Prefill latency: 0.6494893385097384 sec
Decode latency: 6.970786524936557 sec
Time for inference 6: 7.63 sec total, 268.50 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4030.17 GB/s
FLOPS achieved: 20.15 TF/s

Prefill latency: 0.6528510535135865 sec
Decode latency: 9.587539058178663 sec
Time for inference 7: 10.25 sec total, 199.85 tokens/sec
Decode latency: 9.59 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 2999.74 GB/s
FLOPS achieved: 15.00 TF/s

Prefill latency: 0.6626833043992519 sec
Decode latency: 9.670939020812511 sec
Time for inference 8: 10.34 sec total, 198.05 tokens/sec
Decode latency: 9.67 sec
Prefill latency: 0.66 sec
Bandwidth achieved: 2972.71 GB/s
FLOPS achieved: 14.86 TF/s

Prefill latency: 0.6493715420365334 sec
Decode latency: 6.874523834325373 sec
Time for inference 9: 7.53 sec total, 271.94 tokens/sec
Decode latency: 6.87 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4081.73 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.6521217664703727 sec
Decode latency: 9.60546893440187 sec
Time for inference 10: 10.26 sec total, 199.52 tokens/sec
Decode latency: 9.61 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 2994.70 GB/s
FLOPS achieved: 14.97 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.8087 sec
Average prefill latency: 0.6184 sec
Average tokens/sec: 221.06
Memory used: 21.53 GB
