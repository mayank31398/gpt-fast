W0927 13:50:54.475000 22757555074880 torch/distributed/run.py:779] 
W0927 13:50:54.475000 22757555074880 torch/distributed/run.py:779] *****************************************
W0927 13:50:54.475000 22757555074880 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 13:50:54.475000 22757555074880 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.88 seconds
Prefill latency: 1.3961484510218725 sec
Decode latency: 10.285721355001442 sec
Compilation time: 11.68 seconds
Compilation time: 11.68 seconds
Prefill latency: 1.3948090249905363 sec
Decode latency: 10.288532028032932 sec
Prefill latency: 1.3908763869549148 sec
Decode latency: 10.287472415016964 sec
Prefill latency: 1.392891781986691 sec
Decode latency: 10.289058281981852 sec
Prefill latency: 1.3890570279909298 sec
Decode latency: 10.289959723013453 sec
Prefill latency: 1.3873493099818006 sec
Decode latency: 10.287785625027027 sec
Time for inference 1: 11.68 sec total, 1403.24 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11268.74 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 1.392168833001051 sec
Decode latency: 10.288630828959867 sec
Time for inference 2: 11.68 sec total, 1402.55 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11263.21 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 1.3878355519846082 sec
Decode latency: 10.287805766973179 sec
Time for inference 3: 11.68 sec total, 1403.17 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11268.18 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 1.3953195019857958 sec
Decode latency: 10.2873573229881 sec
Time for inference 4: 11.68 sec total, 1402.30 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.40 sec
Bandwidth achieved: 11261.21 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 1.3916854319977574 sec
Decode latency: 10.287412388017401 sec
Time for inference 5: 11.68 sec total, 1402.74 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11264.75 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 1.3911518300301395 sec
Decode latency: 10.288518529967405 sec
Time for inference 6: 11.68 sec total, 1402.68 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11264.28 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 1.3892224159790203 sec
Decode latency: 10.290915696998127 sec
Time for inference 7: 11.68 sec total, 1402.62 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11263.79 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 1.3881662000203505 sec
Decode latency: 10.288336144003551 sec
Time for inference 8: 11.68 sec total, 1403.06 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11267.31 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 1.388069121981971 sec
Decode latency: 10.288450258027297 sec
Time for inference 9: 11.68 sec total, 1403.05 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11267.23 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 1.3915554709965363 sec
Decode latency: 10.287189428985585 sec
Time for inference 10: 11.68 sec total, 1402.79 tokens/sec
Decode latency: 10.29 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11265.11 GB/s
FLOPS achieved: 56.33 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.2882 sec
Average prefill latency: 1.3903 sec
Average tokens/sec: 1402.82
Memory used: 39.47 GB
[rank1]:[E927 13:55:00.746969173 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E927 13:55:00.747002303 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
