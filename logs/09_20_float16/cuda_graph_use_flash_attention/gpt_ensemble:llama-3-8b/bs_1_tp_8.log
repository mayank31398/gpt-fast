W0920 11:47:21.869000 22616397621056 torch/distributed/run.py:779] 
W0920 11:47:21.869000 22616397621056 torch/distributed/run.py:779] *****************************************
W0920 11:47:21.869000 22616397621056 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 11:47:21.869000 22616397621056 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.05023687053471804 sec
Compilation time: 4.42 seconds
Compilation time: 4.43 seconds
Decode latency: 4.391108199954033 sec
Compilation time: 4.44 seconds
Compilation time: 4.46 seconds
Compilation time: 4.42 seconds
Compilation time: 4.43 seconds
Compilation time: 4.43 seconds
Compilation time: 4.45 seconds
Prefill latency: 0.027147687040269375 sec
Decode latency: 5.094980742782354 sec
Prefill latency: 0.026881343685090542 sec
Decode latency: 3.191020954400301 sec
Prefill latency: 0.013193280436098576 sec
Decode latency: 2.81112065538764 sec
Prefill latency: 0.013712593354284763 sec
Decode latency: 2.6675393292680383 sec
Prefill latency: 0.024939989671111107 sec
Decode latency: 4.758578197099268 sec
Time for inference 1: 4.79 sec total, 53.48 tokens/sec
Decode latency: 4.76 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 149.54 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.03130927216261625 sec
Decode latency: 5.090942179784179 sec
Time for inference 2: 5.13 sec total, 49.91 tokens/sec
Decode latency: 5.09 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 139.55 GB/s
FLOPS achieved: 0.70 TF/s

Prefill latency: 0.0313904145732522 sec
Decode latency: 3.109317308291793 sec
Time for inference 3: 3.15 sec total, 81.32 tokens/sec
Decode latency: 3.11 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 227.39 GB/s
FLOPS achieved: 1.14 TF/s

Prefill latency: 0.026045436039566994 sec
Decode latency: 3.011030573397875 sec
Time for inference 4: 3.04 sec total, 84.09 tokens/sec
Decode latency: 3.01 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 235.12 GB/s
FLOPS achieved: 1.18 TF/s

Prefill latency: 0.0269089350476861 sec
Decode latency: 3.1368651604279876 sec
Time for inference 5: 3.17 sec total, 80.78 tokens/sec
Decode latency: 3.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 225.87 GB/s
FLOPS achieved: 1.13 TF/s

Prefill latency: 0.013935414142906666 sec
Decode latency: 3.50358928181231 sec
Time for inference 6: 3.52 sec total, 72.72 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 203.32 GB/s
FLOPS achieved: 1.02 TF/s

Prefill latency: 0.025281285867094994 sec
Decode latency: 3.362844011746347 sec
Time for inference 7: 3.39 sec total, 75.48 tokens/sec
Decode latency: 3.36 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 211.04 GB/s
FLOPS achieved: 1.06 TF/s

Prefill latency: 0.030353546142578125 sec
Decode latency: 4.910682984627783 sec
Time for inference 8: 4.95 sec total, 51.74 tokens/sec
Decode latency: 4.91 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 144.66 GB/s
FLOPS achieved: 0.72 TF/s

Prefill latency: 0.02682726550847292 sec
Decode latency: 3.162629016675055 sec
Time for inference 9: 3.20 sec total, 80.10 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 223.96 GB/s
FLOPS achieved: 1.12 TF/s

Prefill latency: 0.013124508783221245 sec
Decode latency: 3.879647492431104 sec
Time for inference 10: 3.89 sec total, 65.75 tokens/sec
Decode latency: 3.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 183.83 GB/s
FLOPS achieved: 0.92 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.7926 sec
Average prefill latency: 0.0250 sec
Average tokens/sec: 69.54
Memory used: 4.35 GB
