W0927 13:11:46.428000 23229025978176 torch/distributed/run.py:779] 
W0927 13:11:46.428000 23229025978176 torch/distributed/run.py:779] *****************************************
W0927 13:11:46.428000 23229025978176 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 13:11:46.428000 23229025978176 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.02644917299039662 sec
Decode latency: 1.5117126880213618 sec
Compilation time: 1.55 seconds
Compilation time: 1.53 secondsCompilation time: 1.55 seconds

Compilation time: 1.53 seconds
Compilation time: 1.57 seconds
Compilation time: 1.54 secondsCompilation time: 1.54 seconds

Compilation time: 1.53 seconds
Prefill latency: 0.011403569020330906 sec
Decode latency: 1.5085838439990766 sec
Prefill latency: 0.011366204009391367 sec
Decode latency: 1.51014311297331 sec
Prefill latency: 0.01143584301462397 sec
Decode latency: 1.5087398589821532 sec
Prefill latency: 0.011490164964925498 sec
Decode latency: 1.509392398991622 sec
Prefill latency: 0.011383527016732842 sec
Decode latency: 1.5097803820390254 sec
Time for inference 1: 1.52 sec total, 168.20 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.29 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011368073988705873 sec
Decode latency: 1.5098671090090647 sec
Time for inference 2: 1.52 sec total, 168.21 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.31 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.01138959702802822 sec
Decode latency: 1.509598481003195 sec
Time for inference 3: 1.52 sec total, 168.25 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.43 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011492046993225813 sec
Decode latency: 1.5097766230464913 sec
Time for inference 4: 1.52 sec total, 168.20 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.30 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011382857977878302 sec
Decode latency: 1.5100417920039035 sec
Time for inference 5: 1.52 sec total, 168.19 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.25 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011402833042666316 sec
Decode latency: 1.509701811010018 sec
Time for inference 6: 1.52 sec total, 168.22 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.36 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011390317988116294 sec
Decode latency: 1.5093950710142963 sec
Time for inference 7: 1.52 sec total, 168.25 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.43 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011406017001718283 sec
Decode latency: 1.5089956549927592 sec
Time for inference 8: 1.52 sec total, 168.29 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.56 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011423484014812857 sec
Decode latency: 1.5099542739917524 sec
Time for inference 9: 1.52 sec total, 168.20 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.29 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011407156998757273 sec
Decode latency: 1.5089197059860453 sec
Time for inference 10: 1.52 sec total, 168.32 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.64 GB/s
FLOPS achieved: 2.35 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.5096 sec
Average prefill latency: 0.0114 sec
Average tokens/sec: 168.23
Memory used: 4.35 GB
[rank1]:[E927 13:13:24.958451280 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E927 13:13:24.958490895 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
[rank2]:[E927 13:13:24.958491704 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 2] Future for ProcessGroup abort timed out after 60000 ms
[rank4]:[E927 13:13:24.958490277 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 4] Future for ProcessGroup abort timed out after 60000 ms
[rank3]:[E927 13:13:24.958494019 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 3] Future for ProcessGroup abort timed out after 60000 ms
[rank7]:[E927 13:13:24.958525927 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 7] Future for ProcessGroup abort timed out after 60000 ms
[rank5]:[E927 13:13:24.958530695 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 5] Future for ProcessGroup abort timed out after 60000 ms
[rank6]:[E927 13:13:24.958531425 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 6] Future for ProcessGroup abort timed out after 60000 ms
