flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.93 seconds
Prefill latency: 0.5910096729930956 sec
Decode latency: 6.513660152006196 sec
Compilation time: 7.11 seconds
Prefill latency: 0.595830248988932 sec
Decode latency: 6.581180727982428 sec
Prefill latency: 0.5973944790021051 sec
Decode latency: 6.586541868018685 sec
Prefill latency: 0.59627720201388 sec
Decode latency: 6.585801133012865 sec
Prefill latency: 0.5960535809863359 sec
Decode latency: 6.585674785019364 sec
Prefill latency: 0.5979854829784017 sec
Decode latency: 6.488000629993621 sec
Time for inference 1: 7.09 sec total, 577.97 tokens/sec
Decode latency: 6.49 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8675.28 GB/s
FLOPS achieved: 43.38 TF/s

Prefill latency: 0.5997266679769382 sec
Decode latency: 6.543568168010097 sec
Time for inference 2: 7.14 sec total, 573.34 tokens/sec
Decode latency: 6.54 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8605.78 GB/s
FLOPS achieved: 43.03 TF/s

Prefill latency: 0.598741699999664 sec
Decode latency: 6.497263765020762 sec
Time for inference 3: 7.10 sec total, 577.16 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8663.15 GB/s
FLOPS achieved: 43.32 TF/s

Prefill latency: 0.5987218910013326 sec
Decode latency: 6.588573004002683 sec
Time for inference 4: 7.19 sec total, 569.83 tokens/sec
Decode latency: 6.59 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8553.02 GB/s
FLOPS achieved: 42.77 TF/s

Prefill latency: 0.5999857400020119 sec
Decode latency: 6.541023736004718 sec
Time for inference 5: 7.14 sec total, 573.53 tokens/sec
Decode latency: 6.54 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8608.57 GB/s
FLOPS achieved: 43.04 TF/s

Prefill latency: 0.598456419975264 sec
Decode latency: 6.54982550398563 sec
Time for inference 6: 7.15 sec total, 572.95 tokens/sec
Decode latency: 6.55 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8599.91 GB/s
FLOPS achieved: 43.00 TF/s

Prefill latency: 0.5991481060045771 sec
Decode latency: 6.553368777997093 sec
Time for inference 7: 7.15 sec total, 572.61 tokens/sec
Decode latency: 6.55 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8594.77 GB/s
FLOPS achieved: 42.97 TF/s

Prefill latency: 0.5989115870033856 sec
Decode latency: 6.501065963995643 sec
Time for inference 8: 7.10 sec total, 576.84 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8658.24 GB/s
FLOPS achieved: 43.29 TF/s

Prefill latency: 0.5991409069974907 sec
Decode latency: 6.4961535740003455 sec
Time for inference 9: 7.10 sec total, 577.22 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8664.03 GB/s
FLOPS achieved: 43.32 TF/s

Prefill latency: 0.5988123819988687 sec
Decode latency: 6.4988865990017075 sec
Time for inference 10: 7.10 sec total, 577.03 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8661.15 GB/s
FLOPS achieved: 43.31 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.5258 sec
Average prefill latency: 0.5990 sec
Average tokens/sec: 574.85
Memory used: 26.86 GB
