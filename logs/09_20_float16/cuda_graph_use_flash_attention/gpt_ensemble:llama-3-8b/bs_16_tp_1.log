flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.13 seconds
Prefill latency: 1.281415244564414 sec
Decode latency: 14.363860612735152 sec
Compilation time: 15.65 seconds
Prefill latency: 1.2787621403113008 sec
Decode latency: 14.386770658195019 sec
Prefill latency: 1.2827841974794865 sec
Decode latency: 14.387707192450762 sec
Prefill latency: 1.2827230915427208 sec
Decode latency: 14.387643894180655 sec
Prefill latency: 1.282986605539918 sec
Decode latency: 14.382370145060122 sec
Prefill latency: 1.2827957076951861 sec
Decode latency: 14.382438510656357 sec
Time for inference 1: 15.67 sec total, 261.35 tokens/sec
Decode latency: 14.38 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3922.84 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2829590160399675 sec
Decode latency: 14.387575608678162 sec
Time for inference 2: 15.68 sec total, 261.26 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.53 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2827336294576526 sec
Decode latency: 14.383252002298832 sec
Time for inference 3: 15.67 sec total, 261.34 tokens/sec
Decode latency: 14.38 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3922.68 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2826772285625339 sec
Decode latency: 14.387374205514789 sec
Time for inference 4: 15.68 sec total, 261.27 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.66 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2830253662541509 sec
Decode latency: 14.387651436962187 sec
Time for inference 5: 15.68 sec total, 261.26 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.50 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.283144749701023 sec
Decode latency: 14.38758257869631 sec
Time for inference 6: 15.68 sec total, 261.26 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.49 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2833403823897243 sec
Decode latency: 14.386734484694898 sec
Time for inference 7: 15.68 sec total, 261.27 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.65 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.283094317652285 sec
Decode latency: 14.387803182937205 sec
Time for inference 8: 15.68 sec total, 261.26 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.45 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.2828496098518372 sec
Decode latency: 14.388063403777778 sec
Time for inference 9: 15.68 sec total, 261.26 tokens/sec
Decode latency: 14.39 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3921.43 GB/s
FLOPS achieved: 19.61 TF/s

Prefill latency: 1.283024369738996 sec
Decode latency: 14.383672171272337 sec
Time for inference 10: 15.67 sec total, 261.33 tokens/sec
Decode latency: 14.38 sec
Prefill latency: 1.28 sec
Bandwidth achieved: 3922.49 GB/s
FLOPS achieved: 19.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 14.3862 sec
Average prefill latency: 1.2830 sec
Average tokens/sec: 261.29
Memory used: 26.86 GB
