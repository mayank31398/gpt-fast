W0927 13:18:52.264000 22589953861440 torch/distributed/run.py:779] 
W0927 13:18:52.264000 22589953861440 torch/distributed/run.py:779] *****************************************
W0927 13:18:52.264000 22589953861440 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 13:18:52.264000 22589953861440 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.89 seconds
Prefill latency: 0.08004755200818181 sec
Decode latency: 2.591910563991405 sec
Compilation time: 2.67 seconds
Compilation time: 2.67 seconds
Prefill latency: 0.08044888998847455 sec
Decode latency: 2.5900093220407143 sec
Prefill latency: 0.08139129698975012 sec
Decode latency: 2.5921698889578693 sec
Prefill latency: 0.08157596399541944 sec
Decode latency: 2.5904512720298953 sec
Prefill latency: 0.08094078401336446 sec
Decode latency: 2.5909051849739626 sec
Prefill latency: 0.08108783297939226 sec
Decode latency: 2.5912208040244877 sec
Time for inference 1: 2.67 sec total, 383.11 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.54 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08113135601161048 sec
Decode latency: 2.5895675529609434 sec
Time for inference 2: 2.67 sec total, 383.33 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3078.37 GB/s
FLOPS achieved: 15.39 TF/s

Prefill latency: 0.08150040998589247 sec
Decode latency: 2.592301136988681 sec
Time for inference 3: 2.67 sec total, 382.86 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3074.58 GB/s
FLOPS achieved: 15.37 TF/s

Prefill latency: 0.08103175403084606 sec
Decode latency: 2.5913841809961013 sec
Time for inference 4: 2.67 sec total, 383.08 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.32 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08094745100243017 sec
Decode latency: 2.5909494510269724 sec
Time for inference 5: 2.67 sec total, 383.16 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.98 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08135977596975863 sec
Decode latency: 2.590989752963651 sec
Time for inference 6: 2.67 sec total, 383.10 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.52 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08162995503516868 sec
Decode latency: 2.5911230400088243 sec
Time for inference 7: 2.67 sec total, 383.03 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3075.93 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08048320404486731 sec
Decode latency: 2.590350963000674 sec
Time for inference 8: 2.67 sec total, 383.31 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3078.20 GB/s
FLOPS achieved: 15.39 TF/s

Prefill latency: 0.08109079697169363 sec
Decode latency: 2.591832523990888 sec
Time for inference 9: 2.67 sec total, 383.03 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3075.95 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08156546601094306 sec
Decode latency: 2.5910702280234545 sec
Time for inference 10: 2.67 sec total, 383.07 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.29 GB/s
FLOPS achieved: 15.38 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5911 sec
Average prefill latency: 0.0812 sec
Average tokens/sec: 383.11
Memory used: 11.11 GB
[rank1]:[E927 13:20:38.238836500 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E927 13:20:38.238887835 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
