W0924 23:54:07.631000 22943629018944 torch/distributed/run.py:779] 
W0924 23:54:07.631000 22943629018944 torch/distributed/run.py:779] *****************************************
W0924 23:54:07.631000 22943629018944 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0924 23:54:07.631000 22943629018944 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.83 seconds
Prefill latency: 0.1817125305533409 sec
Decode latency: 5.65810173843056 sec
Compilation time: 5.86 seconds
Compilation time: 5.84 seconds
Prefill latency: 0.18207438103854656 sec
Decode latency: 5.67895885463804 sec
Prefill latency: 0.17821065988391638 sec
Decode latency: 5.730250323191285 sec
Prefill latency: 0.1787338238209486 sec
Decode latency: 5.533238793723285 sec
Prefill latency: 0.17118218541145325 sec
Decode latency: 5.652351065538824 sec
Prefill latency: 0.18112550675868988 sec
Decode latency: 5.692999000661075 sec
Time for inference 1: 5.88 sec total, 174.11 tokens/sec
Decode latency: 5.69 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1398.19 GB/s
FLOPS achieved: 6.99 TF/s

Prefill latency: 0.1817566892132163 sec
Decode latency: 5.626388002187014 sec
Time for inference 2: 5.82 sec total, 176.09 tokens/sec
Decode latency: 5.63 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1414.06 GB/s
FLOPS achieved: 7.07 TF/s

Prefill latency: 0.18162888940423727 sec
Decode latency: 5.724883100949228 sec
Time for inference 3: 5.91 sec total, 173.16 tokens/sec
Decode latency: 5.72 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1390.55 GB/s
FLOPS achieved: 6.95 TF/s

Prefill latency: 0.18167371582239866 sec
Decode latency: 5.473668887279928 sec
Time for inference 4: 5.66 sec total, 180.84 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1452.23 GB/s
FLOPS achieved: 7.26 TF/s

Prefill latency: 0.18191097863018513 sec
Decode latency: 5.591042514890432 sec
Time for inference 5: 5.78 sec total, 177.16 tokens/sec
Decode latency: 5.59 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1422.67 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.1812536595389247 sec
Decode latency: 5.675798054784536 sec
Time for inference 6: 5.86 sec total, 174.62 tokens/sec
Decode latency: 5.68 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1402.27 GB/s
FLOPS achieved: 7.01 TF/s

Prefill latency: 0.18273604195564985 sec
Decode latency: 5.719414106570184 sec
Time for inference 7: 5.91 sec total, 173.29 tokens/sec
Decode latency: 5.72 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1391.59 GB/s
FLOPS achieved: 6.96 TF/s

Prefill latency: 0.181452302262187 sec
Decode latency: 5.658922449685633 sec
Time for inference 8: 5.85 sec total, 175.17 tokens/sec
Decode latency: 5.66 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 1406.71 GB/s
FLOPS achieved: 7.03 TF/s

Prefill latency: 0.1722317859530449 sec
Decode latency: 5.592787314206362 sec
Time for inference 9: 5.77 sec total, 177.54 tokens/sec
Decode latency: 5.59 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1425.75 GB/s
FLOPS achieved: 7.13 TF/s

Prefill latency: 0.18574958760291338 sec
Decode latency: 5.6455988166853786 sec
Time for inference 10: 5.84 sec total, 175.39 tokens/sec
Decode latency: 5.65 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 1408.45 GB/s
FLOPS achieved: 7.04 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.6402 sec
Average prefill latency: 0.1812 sec
Average tokens/sec: 175.74
Memory used: 11.11 GB
[rank1]:[E925 00:05:42.350334214 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 600000 ms
[rank0]:[E925 00:05:42.350761998 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 600000 ms
