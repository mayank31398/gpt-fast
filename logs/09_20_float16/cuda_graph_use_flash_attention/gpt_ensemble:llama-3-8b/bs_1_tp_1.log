flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.08651725202798843 sec
Decode latency: 4.582623202353716 sec
Compilation time: 4.67 seconds
Prefill latency: 0.046307098120450974 sec
Decode latency: 4.5467087952420115 sec
Prefill latency: 0.04644056223332882 sec
Decode latency: 4.590386886149645 sec
Prefill latency: 0.05872085317969322 sec
Decode latency: 4.6851470889523625 sec
Prefill latency: 0.07051204983144999 sec
Decode latency: 4.774937866255641 sec
Prefill latency: 0.08683117292821407 sec
Decode latency: 4.653566456399858 sec
Time for inference 1: 4.75 sec total, 53.94 tokens/sec
Decode latency: 4.65 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 809.65 GB/s
FLOPS achieved: 4.05 TF/s

Prefill latency: 0.04672587104141712 sec
Decode latency: 4.5527017414569855 sec
Time for inference 2: 4.60 sec total, 55.64 tokens/sec
Decode latency: 4.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 835.21 GB/s
FLOPS achieved: 4.18 TF/s

Prefill latency: 0.04617261979728937 sec
Decode latency: 4.598188809119165 sec
Time for inference 3: 4.65 sec total, 55.11 tokens/sec
Decode latency: 4.60 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 827.14 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.07746833004057407 sec
Decode latency: 4.71565336920321 sec
Time for inference 4: 4.80 sec total, 53.35 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 800.84 GB/s
FLOPS achieved: 4.00 TF/s

Prefill latency: 0.08646172937005758 sec
Decode latency: 4.8233259823173285 sec
Time for inference 5: 4.92 sec total, 52.06 tokens/sec
Decode latency: 4.82 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 781.47 GB/s
FLOPS achieved: 3.91 TF/s

Prefill latency: 0.046870107762515545 sec
Decode latency: 4.565880371257663 sec
Time for inference 6: 4.61 sec total, 55.47 tokens/sec
Decode latency: 4.57 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 832.63 GB/s
FLOPS achieved: 4.16 TF/s

Prefill latency: 0.04659126698970795 sec
Decode latency: 4.552500870078802 sec
Time for inference 7: 4.60 sec total, 55.65 tokens/sec
Decode latency: 4.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 835.28 GB/s
FLOPS achieved: 4.18 TF/s

Prefill latency: 0.04628613591194153 sec
Decode latency: 4.723397391848266 sec
Time for inference 8: 4.77 sec total, 53.64 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 805.10 GB/s
FLOPS achieved: 4.03 TF/s

Prefill latency: 0.07568017765879631 sec
Decode latency: 4.804979614913464 sec
Time for inference 9: 4.89 sec total, 52.40 tokens/sec
Decode latency: 4.80 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 786.48 GB/s
FLOPS achieved: 3.93 TF/s

Prefill latency: 0.08639227971434593 sec
Decode latency: 4.645581640303135 sec
Time for inference 10: 4.74 sec total, 54.04 tokens/sec
Decode latency: 4.65 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 811.13 GB/s
FLOPS achieved: 4.06 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.6636 sec
Average prefill latency: 0.0645 sec
Average tokens/sec: 54.13
Memory used: 16.87 GB
