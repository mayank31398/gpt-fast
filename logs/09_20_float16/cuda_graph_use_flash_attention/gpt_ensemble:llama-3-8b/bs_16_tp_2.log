W0925 00:16:49.498000 22747416274752 torch/distributed/run.py:779] 
W0925 00:16:49.498000 22747416274752 torch/distributed/run.py:779] *****************************************
W0925 00:16:49.498000 22747416274752 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0925 00:16:49.498000 22747416274752 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.82 seconds
Prefill latency: 0.31709928301279433 sec
Decode latency: 3.944344914983958 sec
Compilation time: 4.27 seconds
Compilation time: 4.26 seconds
Prefill latency: 0.31982193602016196 sec
Decode latency: 3.9426387529820204 sec
Prefill latency: 0.3200454019824974 sec
Decode latency: 3.9412078939785715 sec
Prefill latency: 0.31999671799712814 sec
Decode latency: 3.9414885900041554 sec
Prefill latency: 0.31946028899983503 sec
Decode latency: 3.9414451840275433 sec
Prefill latency: 0.31976093200501055 sec
Decode latency: 3.9404661509906873 sec
Time for inference 1: 4.26 sec total, 961.29 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7719.71 GB/s
FLOPS achieved: 38.60 TF/s

Prefill latency: 0.31930468199425377 sec
Decode latency: 3.9417809279984795 sec
Time for inference 2: 4.26 sec total, 961.10 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7718.17 GB/s
FLOPS achieved: 38.59 TF/s

Prefill latency: 0.3205655640049372 sec
Decode latency: 3.9423240430187434 sec
Time for inference 3: 4.26 sec total, 960.64 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7714.43 GB/s
FLOPS achieved: 38.57 TF/s

Prefill latency: 0.3197534730134066 sec
Decode latency: 3.9410515939816833 sec
Time for inference 4: 4.26 sec total, 961.12 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7718.32 GB/s
FLOPS achieved: 38.59 TF/s

Prefill latency: 0.3205488770036027 sec
Decode latency: 3.9435367769910954 sec
Time for inference 5: 4.26 sec total, 960.40 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7712.55 GB/s
FLOPS achieved: 38.56 TF/s

Prefill latency: 0.3210644829960074 sec
Decode latency: 3.9427172479918227 sec
Time for inference 6: 4.26 sec total, 960.48 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7713.17 GB/s
FLOPS achieved: 38.57 TF/s

Prefill latency: 0.3200363460055087 sec
Decode latency: 3.9428972320165485 sec
Time for inference 7: 4.26 sec total, 960.68 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7714.74 GB/s
FLOPS achieved: 38.57 TF/s

Prefill latency: 0.32097670901566744 sec
Decode latency: 3.9439505049958825 sec
Time for inference 8: 4.27 sec total, 960.19 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7710.85 GB/s
FLOPS achieved: 38.55 TF/s

Prefill latency: 0.3222126530017704 sec
Decode latency: 3.9430701679957565 sec
Time for inference 9: 4.27 sec total, 960.14 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7710.43 GB/s
FLOPS achieved: 38.55 TF/s

Prefill latency: 0.32102261899854057 sec
Decode latency: 3.9430016730038915 sec
Time for inference 10: 4.26 sec total, 960.42 tokens/sec
Decode latency: 3.94 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7712.65 GB/s
FLOPS achieved: 38.56 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.9425 sec
Average prefill latency: 0.3205 sec
Average tokens/sec: 960.65
Memory used: 16.79 GB
