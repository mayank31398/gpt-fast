flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.17 seconds
Prefill latency: 0.3285708921030164 sec
Decode latency: 5.746475165709853 sec
Compilation time: 6.08 seconds
Prefill latency: 0.2587413750588894 sec
Decode latency: 5.915747058577836 sec
Prefill latency: 0.1812577834352851 sec
Decode latency: 5.995081308297813 sec
Prefill latency: 0.18198678456246853 sec
Decode latency: 5.99313838686794 sec
Prefill latency: 0.1821179436519742 sec
Decode latency: 5.821667466312647 sec
Prefill latency: 0.3398084510117769 sec
Decode latency: 5.594553352333605 sec
Time for inference 1: 5.94 sec total, 172.34 tokens/sec
Decode latency: 5.59 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 2586.83 GB/s
FLOPS achieved: 12.93 TF/s

Prefill latency: 0.32013557106256485 sec
Decode latency: 5.678686870262027 sec
Time for inference 2: 6.00 sec total, 170.55 tokens/sec
Decode latency: 5.68 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 2559.91 GB/s
FLOPS achieved: 12.80 TF/s

Prefill latency: 0.28466783463954926 sec
Decode latency: 5.859055550768971 sec
Time for inference 3: 6.15 sec total, 166.59 tokens/sec
Decode latency: 5.86 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 2500.51 GB/s
FLOPS achieved: 12.50 TF/s

Prefill latency: 0.18193312548100948 sec
Decode latency: 5.973244848661125 sec
Time for inference 4: 6.16 sec total, 166.34 tokens/sec
Decode latency: 5.97 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2496.67 GB/s
FLOPS achieved: 12.48 TF/s

Prefill latency: 0.1820065537467599 sec
Decode latency: 5.955890795215964 sec
Time for inference 5: 6.14 sec total, 166.75 tokens/sec
Decode latency: 5.96 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2502.83 GB/s
FLOPS achieved: 12.51 TF/s

Prefill latency: 0.20524570997804403 sec
Decode latency: 5.6869240161031485 sec
Time for inference 6: 5.90 sec total, 173.64 tokens/sec
Decode latency: 5.69 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2606.27 GB/s
FLOPS achieved: 13.03 TF/s

Prefill latency: 0.33849501330405474 sec
Decode latency: 5.683900771662593 sec
Time for inference 7: 6.03 sec total, 169.85 tokens/sec
Decode latency: 5.68 sec
Prefill latency: 0.34 sec
Bandwidth achieved: 2549.46 GB/s
FLOPS achieved: 12.75 TF/s

Prefill latency: 0.28517484199255705 sec
Decode latency: 5.753875196911395 sec
Time for inference 8: 6.04 sec total, 169.44 tokens/sec
Decode latency: 5.75 sec
Prefill latency: 0.29 sec
Bandwidth achieved: 2543.30 GB/s
FLOPS achieved: 12.72 TF/s

Prefill latency: 0.3013460095971823 sec
Decode latency: 5.842444933950901 sec
Time for inference 9: 6.15 sec total, 166.57 tokens/sec
Decode latency: 5.84 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 2500.22 GB/s
FLOPS achieved: 12.50 TF/s

Prefill latency: 0.1812654184177518 sec
Decode latency: 6.158527039922774 sec
Time for inference 10: 6.34 sec total, 161.44 tokens/sec
Decode latency: 6.16 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2423.21 GB/s
FLOPS achieved: 12.12 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.8187 sec
Average prefill latency: 0.2620 sec
Average tokens/sec: 168.35
Memory used: 18.88 GB
