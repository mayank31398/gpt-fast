flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.84 seconds
Prefill latency: 0.1478309910162352 sec
Decode latency: 3.568366012943443 sec
Compilation time: 3.72 seconds
Prefill latency: 0.14947913499781862 sec
Decode latency: 3.568749663012568 sec
Prefill latency: 0.14964982500532642 sec
Decode latency: 3.5683019849820994 sec
Prefill latency: 0.14976810803636909 sec
Decode latency: 3.5676121789729223 sec
Prefill latency: 0.1498389120097272 sec
Decode latency: 3.567553611996118 sec
Prefill latency: 0.1498587639653124 sec
Decode latency: 3.5686779060051776 sec
Time for inference 1: 3.72 sec total, 275.33 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4132.73 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14981504302704707 sec
Decode latency: 3.5698621929623187 sec
Time for inference 2: 3.72 sec total, 275.24 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.32 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14977744303178042 sec
Decode latency: 3.571228537999559 sec
Time for inference 3: 3.72 sec total, 275.14 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4129.86 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14925586199387908 sec
Decode latency: 3.5702409960213117 sec
Time for inference 4: 3.72 sec total, 275.26 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.67 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14880199101753533 sec
Decode latency: 3.5714616700424813 sec
Time for inference 5: 3.72 sec total, 275.20 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.78 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14976349502103403 sec
Decode latency: 3.570980577962473 sec
Time for inference 6: 3.72 sec total, 275.17 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.24 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14990509598283097 sec
Decode latency: 3.5708629160071723 sec
Time for inference 7: 3.72 sec total, 275.17 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.27 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14998534799087793 sec
Decode latency: 3.571669611032121 sec
Time for inference 8: 3.72 sec total, 275.11 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4129.29 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14939936297014356 sec
Decode latency: 3.5699160280055366 sec
Time for inference 9: 3.72 sec total, 275.28 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.88 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14946967200376093 sec
Decode latency: 3.4987572690006346 sec
Time for inference 10: 3.65 sec total, 280.64 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4212.35 GB/s
FLOPS achieved: 21.06 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5634 sec
Average prefill latency: 0.1496 sec
Average tokens/sec: 275.75
Memory used: 18.88 GB
