flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.94 seconds
[rank0]:[W920 16:29:37.961338227 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 2.628984546288848 sec
Decode latency: 19.163549742661417 sec
Compilation time: 21.79 seconds
Prefill latency: 2.6298114685341716 sec
Decode latency: 19.23366591706872 sec
Prefill latency: 2.6287551801651716 sec
Decode latency: 19.256403976120055 sec
Prefill latency: 2.640077833086252 sec
Decode latency: 19.256344088353217 sec
Prefill latency: 2.643381468951702 sec
Decode latency: 19.1760181421414 sec
Prefill latency: 2.6383056826889515 sec
Decode latency: 19.16535670310259 sec
Time for inference 1: 21.80 sec total, 751.40 tokens/sec
Decode latency: 19.17 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11278.45 GB/s
FLOPS achieved: 56.39 TF/s

Prefill latency: 2.6377068562433124 sec
Decode latency: 19.25813873577863 sec
Time for inference 2: 21.90 sec total, 748.24 tokens/sec
Decode latency: 19.26 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11230.95 GB/s
FLOPS achieved: 56.15 TF/s

Prefill latency: 2.624614658765495 sec
Decode latency: 19.14882503822446 sec
Time for inference 3: 21.77 sec total, 752.45 tokens/sec
Decode latency: 19.15 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11294.12 GB/s
FLOPS achieved: 56.47 TF/s

Prefill latency: 2.645166271366179 sec
Decode latency: 19.25733461882919 sec
Time for inference 4: 21.90 sec total, 748.01 tokens/sec
Decode latency: 19.26 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11227.56 GB/s
FLOPS achieved: 56.14 TF/s

Prefill latency: 2.6451708637177944 sec
Decode latency: 19.148675355128944 sec
Time for inference 5: 21.79 sec total, 751.74 tokens/sec
Decode latency: 19.15 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11283.54 GB/s
FLOPS achieved: 56.42 TF/s

Prefill latency: 2.6257249722257257 sec
Decode latency: 19.255828827619553 sec
Time for inference 6: 21.88 sec total, 748.73 tokens/sec
Decode latency: 19.26 sec
Prefill latency: 2.63 sec
Bandwidth achieved: 11238.29 GB/s
FLOPS achieved: 56.19 TF/s

Prefill latency: 2.6214693943038583 sec
Decode latency: 19.20347740035504 sec
Time for inference 7: 21.83 sec total, 750.67 tokens/sec
Decode latency: 19.20 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11267.46 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 2.6421082513406873 sec
Decode latency: 19.198983426205814 sec
Time for inference 8: 21.84 sec total, 750.12 tokens/sec
Decode latency: 19.20 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11259.14 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.6483797896653414 sec
Decode latency: 19.20884675346315 sec
Time for inference 9: 21.86 sec total, 749.56 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11250.85 GB/s
FLOPS achieved: 56.25 TF/s

Prefill latency: 2.637023914605379 sec
Decode latency: 19.257418130524457 sec
Time for inference 10: 21.90 sec total, 748.29 tokens/sec
Decode latency: 19.26 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11231.70 GB/s
FLOPS achieved: 56.16 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2103 sec
Average prefill latency: 2.6366 sec
Average tokens/sec: 749.92
Memory used: 58.80 GB
