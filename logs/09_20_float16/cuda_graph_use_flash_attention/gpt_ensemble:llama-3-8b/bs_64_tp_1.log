flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.84 seconds
[rank0]:[W925 01:16:18.159450046 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 2.6068342209910043 sec
Decode latency: 19.223036626994144 sec
Compilation time: 21.83 seconds
Prefill latency: 2.607872098014923 sec
Decode latency: 19.231831370998407 sec
Prefill latency: 2.607871123997029 sec
Decode latency: 19.13718444100232 sec
Prefill latency: 2.6075529389781877 sec
Decode latency: 19.135301181988325 sec
Prefill latency: 2.6106766079901718 sec
Decode latency: 19.228305865981383 sec
Prefill latency: 2.6158963500056416 sec
Decode latency: 19.225492939993273 sec
Time for inference 1: 21.84 sec total, 750.10 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11258.92 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.615239256003406 sec
Decode latency: 19.222768214007374 sec
Time for inference 2: 21.84 sec total, 750.21 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11260.59 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.617027764004888 sec
Decode latency: 19.22079893699265 sec
Time for inference 3: 21.84 sec total, 750.22 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11260.76 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.61129718599841 sec
Decode latency: 19.222277485998347 sec
Time for inference 4: 21.83 sec total, 750.37 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11262.98 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.607838420983171 sec
Decode latency: 19.222385071014287 sec
Time for inference 5: 21.83 sec total, 750.49 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11264.75 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 2.6111720819899347 sec
Decode latency: 19.21312419397873 sec
Time for inference 6: 21.83 sec total, 750.69 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11267.81 GB/s
FLOPS achieved: 56.34 TF/s

Prefill latency: 2.607975725986762 sec
Decode latency: 19.222749331005616 sec
Time for inference 7: 21.83 sec total, 750.47 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11264.42 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 2.6100296289951075 sec
Decode latency: 19.228076841012808 sec
Time for inference 8: 21.84 sec total, 750.22 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11260.64 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.611341200012248 sec
Decode latency: 19.22590886001126 sec
Time for inference 9: 21.84 sec total, 750.25 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11261.09 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.618303274997743 sec
Decode latency: 19.226372739009093 sec
Time for inference 10: 21.85 sec total, 749.99 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11257.27 GB/s
FLOPS achieved: 56.29 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2230 sec
Average prefill latency: 2.6126 sec
Average tokens/sec: 750.30
Memory used: 58.80 GB
