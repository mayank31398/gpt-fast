W0927 13:27:39.941000 22676615554880 torch/distributed/run.py:779] 
W0927 13:27:39.941000 22676615554880 torch/distributed/run.py:779] *****************************************
W0927 13:27:39.941000 22676615554880 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 13:27:39.941000 22676615554880 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.69 seconds
Prefill latency: 0.1597581189707853 sec
Decode latency: 2.9999155519763008 sec
Compilation time: 3.17 seconds
Compilation time: 3.16 seconds
Prefill latency: 0.16170607798267156 sec
Decode latency: 2.9968496930086985 sec
Prefill latency: 0.16093431098852307 sec
Decode latency: 2.9975858160178177 sec
Prefill latency: 0.16149519599275663 sec
Decode latency: 2.9974969350150786 sec
Prefill latency: 0.16079818597063422 sec
Decode latency: 2.9975702469819225 sec
Prefill latency: 0.16219298000214621 sec
Decode latency: 2.9975327079882845 sec
Time for inference 1: 3.16 sec total, 647.99 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5203.73 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.16205609898315743 sec
Decode latency: 2.9983196479734033 sec
Time for inference 2: 3.16 sec total, 647.88 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5202.83 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.16264061001129448 sec
Decode latency: 2.997646481031552 sec
Time for inference 3: 3.16 sec total, 647.89 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5202.90 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.16219935298431665 sec
Decode latency: 2.997507766005583 sec
Time for inference 4: 3.16 sec total, 647.99 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5203.74 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.16200483596185222 sec
Decode latency: 2.997195966017898 sec
Time for inference 5: 3.16 sec total, 648.10 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5204.60 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.1620101099833846 sec
Decode latency: 2.9987150680390187 sec
Time for inference 6: 3.16 sec total, 647.78 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5201.98 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.1621813329984434 sec
Decode latency: 2.9972538269939832 sec
Time for inference 7: 3.16 sec total, 648.06 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5204.24 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.1613355219596997 sec
Decode latency: 2.9974630799843 sec
Time for inference 8: 3.16 sec total, 648.21 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5205.48 GB/s
FLOPS achieved: 26.03 TF/s

Prefill latency: 0.16144045302644372 sec
Decode latency: 2.997332655999344 sec
Time for inference 9: 3.16 sec total, 648.18 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5205.22 GB/s
FLOPS achieved: 26.03 TF/s

Prefill latency: 0.16183850297238678 sec
Decode latency: 2.9978962750174105 sec
Time for inference 10: 3.16 sec total, 647.96 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5203.44 GB/s
FLOPS achieved: 26.02 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9977 sec
Average prefill latency: 0.1620 sec
Average tokens/sec: 648.00
Memory used: 13.01 GB
