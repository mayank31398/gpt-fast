W0920 08:38:39.972000 22358541817664 torch/distributed/run.py:779] 
W0920 08:38:39.972000 22358541817664 torch/distributed/run.py:779] *****************************************
W0920 08:38:39.972000 22358541817664 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:38:39.972000 22358541817664 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.12 seconds
Prefill latency: 0.017755750566720963 sec
Decode latency: 1.9204360395669937 sec
Compilation time: 1.94 seconds
Compilation time: 1.95 seconds
Compilation time: 1.94 seconds
Compilation time: 1.94 seconds
Compilation time: 1.95 seconds
Compilation time: 1.94 seconds
Compilation time: 1.95 seconds
Compilation time: 1.94 seconds
Prefill latency: 0.017139527946710587 sec
Decode latency: 1.9186627604067326 sec
Prefill latency: 0.017238087952136993 sec
Decode latency: 1.919971527531743 sec
Prefill latency: 0.017390666529536247 sec
Decode latency: 1.9195686616003513 sec
Prefill latency: 0.017078520730137825 sec
Decode latency: 1.9193919822573662 sec
Prefill latency: 0.01715274341404438 sec
Decode latency: 1.91895373724401 sec
Time for inference 1: 1.94 sec total, 132.18 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.58 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017066841945052147 sec
Decode latency: 1.9184811748564243 sec
Time for inference 2: 1.94 sec total, 132.22 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.70 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017090506851673126 sec
Decode latency: 1.9193314705044031 sec
Time for inference 3: 1.94 sec total, 132.15 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.51 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017211323603987694 sec
Decode latency: 1.9200421068817377 sec
Time for inference 4: 1.94 sec total, 132.10 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.35 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017222434282302856 sec
Decode latency: 1.9194421730935574 sec
Time for inference 5: 1.94 sec total, 132.13 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.43 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017128773033618927 sec
Decode latency: 1.919800816103816 sec
Time for inference 6: 1.94 sec total, 132.12 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.42 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017115289345383644 sec
Decode latency: 1.919512003660202 sec
Time for inference 7: 1.94 sec total, 132.14 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.48 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017116516828536987 sec
Decode latency: 1.9210607763379812 sec
Time for inference 8: 1.94 sec total, 132.03 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.17 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.017161035910248756 sec
Decode latency: 1.919557260349393 sec
Time for inference 9: 1.94 sec total, 132.14 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.47 GB/s
FLOPS achieved: 1.85 TF/s

Prefill latency: 0.01719476468861103 sec
Decode latency: 1.9198110606521368 sec
Time for inference 10: 1.94 sec total, 132.12 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 369.41 GB/s
FLOPS achieved: 1.85 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9196 sec
Average prefill latency: 0.0171 sec
Average tokens/sec: 132.13
Memory used: 5.00 GB
