W0920 09:18:54.118000 23131766048576 torch/distributed/run.py:779] 
W0920 09:18:54.118000 23131766048576 torch/distributed/run.py:779] *****************************************
W0920 09:18:54.118000 23131766048576 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:18:54.118000 23131766048576 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.36 seconds
Prefill latency: 0.8957227636128664 sec
Decode latency: 6.145429080352187 sec
Compilation time: 7.04 seconds
Compilation time: 7.01 secondsCompilation time: 7.04 seconds
Compilation time: 7.03 seconds

Prefill latency: 0.8561682552099228 sec
Decode latency: 6.156168311834335 sec
Prefill latency: 0.8566621039062738 sec
Decode latency: 6.158188473433256 sec
Prefill latency: 0.854440838098526 sec
Decode latency: 6.15642124786973 sec
Prefill latency: 0.8620655611157417 sec
Decode latency: 6.149330671876669 sec
Prefill latency: 0.8625030443072319 sec
Decode latency: 6.149951944127679 sec
Time for inference 1: 7.01 sec total, 2336.19 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10608.32 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8626649584621191 sec
Decode latency: 6.152493571862578 sec
Time for inference 2: 7.02 sec total, 2335.25 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10604.04 GB/s
FLOPS achieved: 53.02 TF/s

Prefill latency: 0.8602734412997961 sec
Decode latency: 6.1522731352597475 sec
Time for inference 3: 7.01 sec total, 2336.12 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10608.03 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8592284359037876 sec
Decode latency: 6.153312016278505 sec
Time for inference 4: 7.01 sec total, 2336.13 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10608.06 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8614058829843998 sec
Decode latency: 6.150942603126168 sec
Time for inference 5: 7.01 sec total, 2336.20 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10608.38 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8614026103168726 sec
Decode latency: 6.1536977998912334 sec
Time for inference 6: 7.02 sec total, 2335.28 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10604.22 GB/s
FLOPS achieved: 53.02 TF/s

Prefill latency: 0.8613158911466599 sec
Decode latency: 6.151404654607177 sec
Time for inference 7: 7.01 sec total, 2336.09 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10607.86 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8622522111982107 sec
Decode latency: 6.1505353804677725 sec
Time for inference 8: 7.01 sec total, 2336.04 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10607.65 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8631541449576616 sec
Decode latency: 6.149577936157584 sec
Time for inference 9: 7.01 sec total, 2336.05 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10607.70 GB/s
FLOPS achieved: 53.04 TF/s

Prefill latency: 0.8624173887073994 sec
Decode latency: 6.150416940450668 sec
Time for inference 10: 7.01 sec total, 2336.01 tokens/sec
Decode latency: 6.15 sec
Prefill latency: 0.86 sec
Bandwidth achieved: 10607.52 GB/s
FLOPS achieved: 53.04 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.1515 sec
Average prefill latency: 0.8617 sec
Average tokens/sec: 2335.94
Memory used: 77.21 GB
