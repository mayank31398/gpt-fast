W0920 08:44:35.116000 22613617796928 torch/distributed/run.py:779] 
W0920 08:44:35.116000 22613617796928 torch/distributed/run.py:779] *****************************************
W0920 08:44:35.116000 22613617796928 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:44:35.116000 22613617796928 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.31 seconds
Prefill latency: 0.09080337919294834 sec
Decode latency: 2.3439905550330877 sec
Compilation time: 2.43 seconds
Compilation time: 2.44 seconds
Compilation time: 2.40 seconds
Compilation time: 2.44 seconds
Prefill latency: 0.05841626599431038 sec
Decode latency: 2.343538399785757 sec
Prefill latency: 0.058638205751776695 sec
Decode latency: 2.343094864860177 sec
Prefill latency: 0.05884203501045704 sec
Decode latency: 2.3437519501894712 sec
Prefill latency: 0.058392422273755074 sec
Decode latency: 2.341760354116559 sec
Prefill latency: 0.05829020403325558 sec
Decode latency: 2.3410983197391033 sec
Time for inference 1: 2.40 sec total, 426.65 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1937.36 GB/s
FLOPS achieved: 9.69 TF/s

Prefill latency: 0.05858701281249523 sec
Decode latency: 2.3420116771012545 sec
Time for inference 2: 2.40 sec total, 426.42 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1936.30 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.05843804031610489 sec
Decode latency: 2.3421271089464426 sec
Time for inference 3: 2.40 sec total, 426.43 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1936.38 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.05873168632388115 sec
Decode latency: 2.3430626187473536 sec
Time for inference 4: 2.40 sec total, 426.23 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1935.45 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.0585817638784647 sec
Decode latency: 2.34247213229537 sec
Time for inference 5: 2.40 sec total, 426.35 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1936.02 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.058409642428159714 sec
Decode latency: 2.3438386786729097 sec
Time for inference 6: 2.40 sec total, 426.14 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1935.05 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.05867662839591503 sec
Decode latency: 2.342556757852435 sec
Time for inference 7: 2.40 sec total, 426.31 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1935.83 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.058326298370957375 sec
Decode latency: 2.3413215279579163 sec
Time for inference 8: 2.40 sec total, 426.61 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1937.16 GB/s
FLOPS achieved: 9.69 TF/s

Prefill latency: 0.05881871096789837 sec
Decode latency: 2.341755822300911 sec
Time for inference 9: 2.40 sec total, 426.43 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1936.37 GB/s
FLOPS achieved: 9.68 TF/s

Prefill latency: 0.058366408571600914 sec
Decode latency: 2.3408951591700315 sec
Time for inference 10: 2.40 sec total, 426.67 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1937.44 GB/s
FLOPS achieved: 9.69 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3421 sec
Average prefill latency: 0.0585 sec
Average tokens/sec: 426.42
Memory used: 10.20 GB
