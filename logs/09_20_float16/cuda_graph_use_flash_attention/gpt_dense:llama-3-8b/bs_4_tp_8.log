W0920 08:47:27.894000 22979958257472 torch/distributed/run.py:779] 
W0920 08:47:27.894000 22979958257472 torch/distributed/run.py:779] *****************************************
W0920 08:47:27.894000 22979958257472 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:47:27.894000 22979958257472 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.04873509332537651 sec
Decode latency: 2.1973726507276297 sec
Compilation time: 2.26 seconds
Compilation time: 2.27 seconds
Compilation time: 2.26 seconds
Compilation time: 2.25 seconds
Compilation time: 2.25 seconds
Compilation time: 2.25 seconds
Compilation time: 2.24 seconds
Compilation time: 2.25 seconds
Prefill latency: 0.04328354075551033 sec
Decode latency: 2.197232162579894 sec
Prefill latency: 0.04318801686167717 sec
Decode latency: 2.197911197319627 sec
Prefill latency: 0.04315560683608055 sec
Decode latency: 2.1990165263414383 sec
Prefill latency: 0.04318231903016567 sec
Decode latency: 2.196552388370037 sec
Prefill latency: 0.04314378835260868 sec
Decode latency: 2.197659555822611 sec
Time for inference 1: 2.24 sec total, 456.84 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.33 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.04323885589838028 sec
Decode latency: 2.1986812110990286 sec
Time for inference 2: 2.24 sec total, 456.60 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1276.68 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.04317912459373474 sec
Decode latency: 2.1997682452201843 sec
Time for inference 3: 2.24 sec total, 456.40 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1276.12 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.04336317256093025 sec
Decode latency: 2.196935659274459 sec
Time for inference 4: 2.24 sec total, 456.94 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.63 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.04318644478917122 sec
Decode latency: 2.1981232203543186 sec
Time for inference 5: 2.24 sec total, 456.74 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.05 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.043198758736252785 sec
Decode latency: 2.197849279269576 sec
Time for inference 6: 2.24 sec total, 456.76 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.12 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.04310891963541508 sec
Decode latency: 2.1993174608796835 sec
Time for inference 7: 2.24 sec total, 456.47 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1276.32 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.04316125437617302 sec
Decode latency: 2.1974888145923615 sec
Time for inference 8: 2.24 sec total, 456.85 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.38 GB/s
FLOPS achieved: 6.39 TF/s

Prefill latency: 0.04328220896422863 sec
Decode latency: 2.198446113616228 sec
Time for inference 9: 2.24 sec total, 456.64 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1276.78 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.043198561295866966 sec
Decode latency: 2.1976246368139982 sec
Time for inference 10: 2.24 sec total, 456.84 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1277.33 GB/s
FLOPS achieved: 6.39 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.1982 sec
Average prefill latency: 0.0432 sec
Average tokens/sec: 456.71
Memory used: 7.46 GB
