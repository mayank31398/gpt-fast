flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 2.14 seconds
[rank0]:[W920 09:04:13.739387793 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.5941521506756544 sec
Decode latency: 6.6712542828172445 sec
Compilation time: 7.27 seconds
Prefill latency: 0.5969668924808502 sec
Decode latency: 6.664111079648137 sec
Prefill latency: 0.599370464682579 sec
Decode latency: 6.5728049743920565 sec
Prefill latency: 0.599693676456809 sec
Decode latency: 6.661060499027371 sec
Prefill latency: 0.5998343154788017 sec
Decode latency: 6.574658514931798 sec
Prefill latency: 0.5990578513592482 sec
Decode latency: 6.66204795986414 sec
Time for inference 1: 7.26 sec total, 564.05 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8466.24 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.5988615863025188 sec
Decode latency: 6.662581626325846 sec
Time for inference 2: 7.26 sec total, 564.01 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.67 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.5995633788406849 sec
Decode latency: 6.616517450660467 sec
Time for inference 3: 7.22 sec total, 567.57 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8519.07 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.6003254037350416 sec
Decode latency: 6.662504691630602 sec
Time for inference 4: 7.26 sec total, 563.91 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8464.22 GB/s
FLOPS achieved: 42.32 TF/s

Prefill latency: 0.6015255991369486 sec
Decode latency: 6.664067551493645 sec
Time for inference 5: 7.27 sec total, 563.70 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8461.03 GB/s
FLOPS achieved: 42.31 TF/s

Prefill latency: 0.6002882365137339 sec
Decode latency: 6.564489878714085 sec
Time for inference 6: 7.17 sec total, 571.63 tokens/sec
Decode latency: 6.56 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8580.01 GB/s
FLOPS achieved: 42.90 TF/s

Prefill latency: 0.6002670396119356 sec
Decode latency: 6.631114739924669 sec
Time for inference 7: 7.23 sec total, 566.36 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8501.01 GB/s
FLOPS achieved: 42.51 TF/s

Prefill latency: 0.599175475537777 sec
Decode latency: 6.664406206458807 sec
Time for inference 8: 7.26 sec total, 563.85 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8463.29 GB/s
FLOPS achieved: 42.32 TF/s

Prefill latency: 0.5975245963782072 sec
Decode latency: 6.649907248094678 sec
Time for inference 9: 7.25 sec total, 565.11 tokens/sec
Decode latency: 6.65 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8482.23 GB/s
FLOPS achieved: 42.41 TF/s

Prefill latency: 0.6004688628017902 sec
Decode latency: 6.661371758207679 sec
Time for inference 10: 7.26 sec total, 563.98 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.33 GB/s
FLOPS achieved: 42.33 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6439 sec
Average prefill latency: 0.5997 sec
Average tokens/sec: 565.42
Memory used: 36.26 GB
