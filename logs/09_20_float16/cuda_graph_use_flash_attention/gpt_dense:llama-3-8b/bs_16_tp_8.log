W0920 09:13:46.401000 22508740953920 torch/distributed/run.py:779] 
W0920 09:13:46.401000 22508740953920 torch/distributed/run.py:779] *****************************************
W0920 09:13:46.401000 22508740953920 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:13:46.401000 22508740953920 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.36 seconds
Prefill latency: 0.14834023267030716 sec
Decode latency: 2.6081937830895185 sec
Compilation time: 2.80 secondsCompilation time: 2.81 seconds

Compilation time: 2.79 seconds
Compilation time: 2.81 seconds
Compilation time: 2.78 seconds
Compilation time: 2.76 seconds
Compilation time: 2.78 seconds
Compilation time: 2.80 seconds
Prefill latency: 0.14750000461935997 sec
Decode latency: 2.609213076531887 sec
Prefill latency: 0.14745625481009483 sec
Decode latency: 2.609477426856756 sec
Prefill latency: 0.1475595347583294 sec
Decode latency: 2.608733916655183 sec
Prefill latency: 0.14755703508853912 sec
Decode latency: 2.607819117605686 sec
Prefill latency: 0.14775904640555382 sec
Decode latency: 2.608107876032591 sec
Time for inference 1: 2.76 sec total, 1485.81 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4154.37 GB/s
FLOPS achieved: 20.77 TF/s

Prefill latency: 0.1476683635264635 sec
Decode latency: 2.6088306847959757 sec
Time for inference 2: 2.76 sec total, 1485.52 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4153.58 GB/s
FLOPS achieved: 20.77 TF/s

Prefill latency: 0.14755181223154068 sec
Decode latency: 2.608957923948765 sec
Time for inference 3: 2.76 sec total, 1485.50 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4153.51 GB/s
FLOPS achieved: 20.77 TF/s

Prefill latency: 0.1476696878671646 sec
Decode latency: 2.6080610156059265 sec
Time for inference 4: 2.76 sec total, 1485.91 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4154.67 GB/s
FLOPS achieved: 20.77 TF/s

Prefill latency: 0.14768482372164726 sec
Decode latency: 2.607596715912223 sec
Time for inference 5: 2.76 sec total, 1486.16 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4155.36 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.14767396450042725 sec
Decode latency: 2.606844447553158 sec
Time for inference 6: 2.76 sec total, 1486.54 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.41 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.1476814579218626 sec
Decode latency: 2.607276499271393 sec
Time for inference 7: 2.76 sec total, 1486.41 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.04 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.1480078287422657 sec
Decode latency: 2.609242554754019 sec
Time for inference 8: 2.76 sec total, 1485.04 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4152.24 GB/s
FLOPS achieved: 20.76 TF/s

Prefill latency: 0.1477060355246067 sec
Decode latency: 2.608301093801856 sec
Time for inference 9: 2.76 sec total, 1485.70 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4154.08 GB/s
FLOPS achieved: 20.77 TF/s

Prefill latency: 0.14778687991201878 sec
Decode latency: 2.608961582183838 sec
Time for inference 10: 2.76 sec total, 1485.39 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4153.22 GB/s
FLOPS achieved: 20.77 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6082 sec
Average prefill latency: 0.1477 sec
Average tokens/sec: 1485.80
Memory used: 18.72 GB
