W0920 09:22:48.823000 22875548940096 torch/distributed/run.py:779] 
W0920 09:22:48.823000 22875548940096 torch/distributed/run.py:779] *****************************************
W0920 09:22:48.823000 22875548940096 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:22:48.823000 22875548940096 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.42 seconds
Prefill latency: 0.5865016672760248 sec
Decode latency: 4.434088975191116 sec
Compilation time: 5.04 secondsCompilation time: 5.04 seconds
Compilation time: 5.05 seconds

Compilation time: 5.05 seconds
Compilation time: 5.02 secondsCompilation time: 5.05 seconds

Compilation time: 5.04 seconds
Compilation time: 5.03 seconds
Prefill latency: 0.5762884318828583 sec
Decode latency: 4.435317579656839 sec
Prefill latency: 0.577272055670619 sec
Decode latency: 4.433287162333727 sec
Prefill latency: 0.5790011007338762 sec
Decode latency: 4.43367825075984 sec
Prefill latency: 0.5732820890843868 sec
Decode latency: 4.4389027170836926 sec
Prefill latency: 0.5785390958189964 sec
Decode latency: 4.43442958407104 sec
Time for inference 1: 5.01 sec total, 3267.76 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9136.76 GB/s
FLOPS achieved: 45.68 TF/s

Prefill latency: 0.5778264086693525 sec
Decode latency: 4.434267301112413 sec
Time for inference 2: 5.01 sec total, 3268.37 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9138.48 GB/s
FLOPS achieved: 45.69 TF/s

Prefill latency: 0.5783874150365591 sec
Decode latency: 4.434569772332907 sec
Time for inference 3: 5.01 sec total, 3267.79 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9136.87 GB/s
FLOPS achieved: 45.68 TF/s

Prefill latency: 0.5790313743054867 sec
Decode latency: 4.433695759624243 sec
Time for inference 4: 5.01 sec total, 3268.02 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9137.50 GB/s
FLOPS achieved: 45.69 TF/s

Prefill latency: 0.5792147796601057 sec
Decode latency: 4.4364212322980165 sec
Time for inference 5: 5.02 sec total, 3266.02 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9131.90 GB/s
FLOPS achieved: 45.66 TF/s

Prefill latency: 0.5784809477627277 sec
Decode latency: 4.435272131115198 sec
Time for inference 6: 5.01 sec total, 3267.26 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9135.37 GB/s
FLOPS achieved: 45.68 TF/s

Prefill latency: 0.5779676586389542 sec
Decode latency: 4.434994116425514 sec
Time for inference 7: 5.01 sec total, 3267.76 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9136.78 GB/s
FLOPS achieved: 45.68 TF/s

Prefill latency: 0.5773504842072725 sec
Decode latency: 4.437383119016886 sec
Time for inference 8: 5.02 sec total, 3266.67 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9133.71 GB/s
FLOPS achieved: 45.67 TF/s

Prefill latency: 0.5805339254438877 sec
Decode latency: 4.433606820181012 sec
Time for inference 9: 5.01 sec total, 3267.02 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9134.69 GB/s
FLOPS achieved: 45.67 TF/s

Prefill latency: 0.5797940567135811 sec
Decode latency: 4.432246197015047 sec
Time for inference 10: 5.01 sec total, 3268.43 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.58 sec
Bandwidth achieved: 9138.64 GB/s
FLOPS achieved: 45.69 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4347 sec
Average prefill latency: 0.5787 sec
Average tokens/sec: 3267.51
Memory used: 64.63 GB
