flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.45 seconds
Prefill latency: 0.14758868142962456 sec
Decode latency: 3.509207956492901 sec
Compilation time: 3.66 seconds
Prefill latency: 0.1483877208083868 sec
Decode latency: 3.573147263377905 sec
Prefill latency: 0.14816581644117832 sec
Decode latency: 3.6006015092134476 sec
Prefill latency: 0.14864870719611645 sec
Decode latency: 3.5841292086988688 sec
Prefill latency: 0.148624487221241 sec
Decode latency: 3.598957711830735 sec
Prefill latency: 0.14865065924823284 sec
Decode latency: 3.573562001809478 sec
Time for inference 1: 3.72 sec total, 275.04 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4128.34 GB/s
FLOPS achieved: 20.64 TF/s

Prefill latency: 0.14886568672955036 sec
Decode latency: 3.513580910861492 sec
Time for inference 2: 3.66 sec total, 279.54 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4195.85 GB/s
FLOPS achieved: 20.98 TF/s

Prefill latency: 0.1484976541250944 sec
Decode latency: 3.5920196045190096 sec
Time for inference 3: 3.74 sec total, 273.71 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4108.28 GB/s
FLOPS achieved: 20.54 TF/s

Prefill latency: 0.1482265666127205 sec
Decode latency: 3.5378840304911137 sec
Time for inference 4: 3.69 sec total, 277.75 tokens/sec
Decode latency: 3.54 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4168.92 GB/s
FLOPS achieved: 20.84 TF/s

Prefill latency: 0.14924761839210987 sec
Decode latency: 3.58275543153286 sec
Time for inference 5: 3.73 sec total, 274.32 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4117.53 GB/s
FLOPS achieved: 20.59 TF/s

Prefill latency: 0.14933765307068825 sec
Decode latency: 3.598765706643462 sec
Time for inference 6: 3.75 sec total, 273.15 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4100.01 GB/s
FLOPS achieved: 20.50 TF/s

Prefill latency: 0.14882930926978588 sec
Decode latency: 3.596844704821706 sec
Time for inference 7: 3.75 sec total, 273.34 tokens/sec
Decode latency: 3.60 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4102.79 GB/s
FLOPS achieved: 20.51 TF/s

Prefill latency: 0.14809059537947178 sec
Decode latency: 3.491340395063162 sec
Time for inference 8: 3.64 sec total, 281.30 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4222.31 GB/s
FLOPS achieved: 21.11 TF/s

Prefill latency: 0.14822428859770298 sec
Decode latency: 3.5086015723645687 sec
Time for inference 9: 3.66 sec total, 279.95 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4202.03 GB/s
FLOPS achieved: 21.01 TF/s

Prefill latency: 0.14903603680431843 sec
Decode latency: 3.49247033521533 sec
Time for inference 10: 3.64 sec total, 281.13 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4219.71 GB/s
FLOPS achieved: 21.10 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5488 sec
Average prefill latency: 0.1487 sec
Average tokens/sec: 276.92
Memory used: 21.23 GB
