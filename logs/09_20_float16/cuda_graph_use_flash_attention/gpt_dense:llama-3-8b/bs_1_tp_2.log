W0920 08:34:57.834000 22798410028864 torch/distributed/run.py:779] 
W0920 08:34:57.834000 22798410028864 torch/distributed/run.py:779] *****************************************
W0920 08:34:57.834000 22798410028864 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:34:57.834000 22798410028864 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.75 seconds
Prefill latency: 0.03985408693552017 sec
Decode latency: 2.414639787748456 sec
Compilation time: 2.46 seconds
Compilation time: 2.44 seconds
Prefill latency: 0.02572060562670231 sec
Decode latency: 2.4137735068798065 sec
Prefill latency: 0.02554395981132984 sec
Decode latency: 2.4136682879179716 sec
Prefill latency: 0.025581859052181244 sec
Decode latency: 2.411660447716713 sec
Prefill latency: 0.025587119162082672 sec
Decode latency: 2.410937048494816 sec
Prefill latency: 0.025571944192051888 sec
Decode latency: 2.411108337342739 sec
Time for inference 1: 2.44 sec total, 105.03 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 843.48 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.02565256878733635 sec
Decode latency: 2.4093586169183254 sec
Time for inference 2: 2.44 sec total, 105.10 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.04 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025583581998944283 sec
Decode latency: 2.409837456420064 sec
Time for inference 3: 2.44 sec total, 105.08 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 843.85 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025555504485964775 sec
Decode latency: 2.409587437286973 sec
Time for inference 4: 2.44 sec total, 105.09 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 843.93 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025560738518834114 sec
Decode latency: 2.4087972417473793 sec
Time for inference 5: 2.43 sec total, 105.13 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.28 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025546004995703697 sec
Decode latency: 2.4083340484648943 sec
Time for inference 6: 2.43 sec total, 105.15 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.44 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.02560161054134369 sec
Decode latency: 2.4089177511632442 sec
Time for inference 7: 2.44 sec total, 105.13 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.21 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025548448786139488 sec
Decode latency: 2.4088455326855183 sec
Time for inference 8: 2.44 sec total, 105.13 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.23 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025525841861963272 sec
Decode latency: 2.4083641301840544 sec
Time for inference 9: 2.43 sec total, 105.15 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.42 GB/s
FLOPS achieved: 4.22 TF/s

Prefill latency: 0.025549324229359627 sec
Decode latency: 2.4082346502691507 sec
Time for inference 10: 2.43 sec total, 105.16 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 844.49 GB/s
FLOPS achieved: 4.22 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4091 sec
Average prefill latency: 0.0256 sec
Average tokens/sec: 105.12
Memory used: 10.59 GB
