flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 2.13 seconds
Prefill latency: 0.596076400950551 sec
Decode latency: 6.5774846244603395 sec
Compilation time: 7.17 seconds
Prefill latency: 0.6008706092834473 sec
Decode latency: 6.603330383077264 sec
Prefill latency: 0.6008616965264082 sec
Decode latency: 6.618205236271024 sec
Prefill latency: 0.5982381645590067 sec
Decode latency: 6.53709926456213 sec
Prefill latency: 0.601112587377429 sec
Decode latency: 6.61807562969625 sec
Prefill latency: 0.6012784726917744 sec
Decode latency: 6.6196186281740665 sec
Time for inference 1: 7.22 sec total, 567.18 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8513.34 GB/s
FLOPS achieved: 42.57 TF/s

Prefill latency: 0.6007728204131126 sec
Decode latency: 6.618688490241766 sec
Time for inference 2: 7.22 sec total, 567.30 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8515.08 GB/s
FLOPS achieved: 42.58 TF/s

Prefill latency: 0.5979613326489925 sec
Decode latency: 6.6143811997026205 sec
Time for inference 3: 7.21 sec total, 567.85 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8523.35 GB/s
FLOPS achieved: 42.62 TF/s

Prefill latency: 0.5982535053044558 sec
Decode latency: 6.620122354477644 sec
Time for inference 4: 7.22 sec total, 567.38 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8516.34 GB/s
FLOPS achieved: 42.58 TF/s

Prefill latency: 0.5996028948575258 sec
Decode latency: 6.617113756015897 sec
Time for inference 5: 7.22 sec total, 567.51 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8518.26 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.5991086885333061 sec
Decode latency: 6.620305836200714 sec
Time for inference 6: 7.22 sec total, 567.30 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8515.14 GB/s
FLOPS achieved: 42.58 TF/s

Prefill latency: 0.6011146083474159 sec
Decode latency: 6.610362501814961 sec
Time for inference 7: 7.21 sec total, 567.92 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8524.42 GB/s
FLOPS achieved: 42.62 TF/s

Prefill latency: 0.6001392193138599 sec
Decode latency: 6.6194758247584105 sec
Time for inference 8: 7.22 sec total, 567.28 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8514.83 GB/s
FLOPS achieved: 42.57 TF/s

Prefill latency: 0.5993122570216656 sec
Decode latency: 6.61766660772264 sec
Time for inference 9: 7.22 sec total, 567.49 tokens/sec
Decode latency: 6.62 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8517.95 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.5996772926300764 sec
Decode latency: 6.608265280723572 sec
Time for inference 10: 7.21 sec total, 568.20 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8528.64 GB/s
FLOPS achieved: 42.64 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6166 sec
Average prefill latency: 0.5997 sec
Average tokens/sec: 567.54
Memory used: 26.86 GB
