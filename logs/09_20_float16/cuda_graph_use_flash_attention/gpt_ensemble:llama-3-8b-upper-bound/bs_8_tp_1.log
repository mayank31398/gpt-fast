flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.2957853265106678 sec
Decode latency: 4.499094871804118 sec
Compilation time: 4.80 seconds
Prefill latency: 0.2978976834565401 sec
Decode latency: 4.499214353039861 sec
Prefill latency: 0.2945894878357649 sec
Decode latency: 4.499272340908647 sec
Prefill latency: 0.29643511585891247 sec
Decode latency: 4.498129863291979 sec
Prefill latency: 0.29541194066405296 sec
Decode latency: 4.501480992883444 sec
Prefill latency: 0.2960117422044277 sec
Decode latency: 4.500294120982289 sec
Time for inference 1: 4.80 sec total, 426.92 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6408.07 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.2956911977380514 sec
Decode latency: 4.500385496765375 sec
Time for inference 2: 4.80 sec total, 426.96 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6408.53 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.2964562512934208 sec
Decode latency: 4.499452039599419 sec
Time for inference 3: 4.80 sec total, 426.96 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6408.60 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.2971157766878605 sec
Decode latency: 4.498677354305983 sec
Time for inference 4: 4.80 sec total, 426.98 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6408.92 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.29748421534895897 sec
Decode latency: 4.499027967453003 sec
Time for inference 5: 4.80 sec total, 426.91 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6407.88 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.2982915099710226 sec
Decode latency: 4.498574830591679 sec
Time for inference 6: 4.80 sec total, 426.88 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6407.43 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.29608432576060295 sec
Decode latency: 4.500690648332238 sec
Time for inference 7: 4.80 sec total, 426.89 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6407.54 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.29788932763040066 sec
Decode latency: 4.500758344307542 sec
Time for inference 8: 4.80 sec total, 426.73 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6405.20 GB/s
FLOPS achieved: 32.03 TF/s

Prefill latency: 0.2961562182754278 sec
Decode latency: 4.500674542039633 sec
Time for inference 9: 4.80 sec total, 426.88 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6407.36 GB/s
FLOPS achieved: 32.04 TF/s

Prefill latency: 0.29695257358253 sec
Decode latency: 4.500418139621615 sec
Time for inference 10: 4.80 sec total, 426.83 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6406.63 GB/s
FLOPS achieved: 32.03 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4999 sec
Average prefill latency: 0.2968 sec
Average tokens/sec: 426.89
Memory used: 21.53 GB
