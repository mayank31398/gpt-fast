W0920 09:53:39.896000 22745249675072 torch/distributed/run.py:779] 
W0920 09:53:39.896000 22745249675072 torch/distributed/run.py:779] *****************************************
W0920 09:53:39.896000 22745249675072 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:53:39.896000 22745249675072 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.31 seconds
Prefill latency: 0.43511596508324146 sec
Compilation time: 3.87 seconds
Compilation time: 3.92 seconds
Compilation time: 3.93 seconds
Compilation time: 3.91 seconds
Compilation time: 3.93 seconds
Decode latency: 3.4767503552138805 sec
Compilation time: 3.92 seconds
Compilation time: 3.94 seconds
Compilation time: 4.00 seconds
Prefill latency: 0.4368916191160679 sec
Decode latency: 3.503245882689953 sec
Prefill latency: 0.436227036640048 sec
Decode latency: 3.504826730117202 sec
Prefill latency: 0.4363088347017765 sec
Decode latency: 3.4994360618293285 sec
Prefill latency: 0.4359609894454479 sec
Decode latency: 3.5046731177717447 sec
Prefill latency: 0.4394226875156164 sec
Decode latency: 3.436373485252261 sec
Time for inference 1: 3.88 sec total, 4226.62 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11817.77 GB/s
FLOPS achieved: 59.09 TF/s

Prefill latency: 0.4370227623730898 sec
Decode latency: 3.50690745934844 sec
Time for inference 2: 3.94 sec total, 4153.61 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11613.66 GB/s
FLOPS achieved: 58.07 TF/s

Prefill latency: 0.43761615082621574 sec
Decode latency: 3.4994120839983225 sec
Time for inference 3: 3.94 sec total, 4160.85 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11633.89 GB/s
FLOPS achieved: 58.17 TF/s

Prefill latency: 0.43830996938049793 sec
Decode latency: 3.5038411542773247 sec
Time for inference 4: 3.94 sec total, 4155.49 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11618.89 GB/s
FLOPS achieved: 58.09 TF/s

Prefill latency: 0.4365367740392685 sec
Decode latency: 3.4677003026008606 sec
Time for inference 5: 3.90 sec total, 4195.82 tokens/sec
Decode latency: 3.47 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11731.66 GB/s
FLOPS achieved: 58.66 TF/s

Prefill latency: 0.43764794431626797 sec
Decode latency: 3.5028679873794317 sec
Time for inference 6: 3.94 sec total, 4157.16 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11623.57 GB/s
FLOPS achieved: 58.12 TF/s

Prefill latency: 0.4357434343546629 sec
Decode latency: 3.50245706923306 sec
Time for inference 7: 3.94 sec total, 4159.64 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11630.51 GB/s
FLOPS achieved: 58.15 TF/s

Prefill latency: 0.4349581580609083 sec
Decode latency: 3.468459190800786 sec
Time for inference 8: 3.90 sec total, 4196.76 tokens/sec
Decode latency: 3.47 sec
Prefill latency: 0.43 sec
Bandwidth achieved: 11734.28 GB/s
FLOPS achieved: 58.67 TF/s

Prefill latency: 0.43798108398914337 sec
Decode latency: 3.4542804565280676 sec
Time for inference 9: 3.89 sec total, 4208.76 tokens/sec
Decode latency: 3.45 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11767.84 GB/s
FLOPS achieved: 58.84 TF/s

Prefill latency: 0.43668330647051334 sec
Decode latency: 3.503748608753085 sec
Time for inference 10: 3.94 sec total, 4156.99 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 11623.10 GB/s
FLOPS achieved: 58.12 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.4846 sec
Average prefill latency: 0.4372 sec
Average tokens/sec: 4177.17
Memory used: 26.05 GB
