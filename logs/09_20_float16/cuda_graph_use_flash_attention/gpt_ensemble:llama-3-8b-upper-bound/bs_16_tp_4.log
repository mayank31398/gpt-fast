W0920 09:40:48.895000 23018027833152 torch/distributed/run.py:779] 
W0920 09:40:48.895000 23018027833152 torch/distributed/run.py:779] *****************************************
W0920 09:40:48.895000 23018027833152 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:40:48.895000 23018027833152 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.18711122125387192 sec
Compilation time: 2.84 seconds
Compilation time: 2.85 seconds
Decode latency: 2.6659827269613743 sec
Compilation time: 2.85 seconds
Compilation time: 2.84 seconds
Prefill latency: 0.1873491406440735 sec
Decode latency: 2.6662492472678423 sec
Prefill latency: 0.18432996235787868 sec
Decode latency: 2.6661561895161867 sec
Prefill latency: 0.18617267534136772 sec
Decode latency: 2.666977049782872 sec
Prefill latency: 0.1847482081502676 sec
Decode latency: 2.665226075798273 sec
Prefill latency: 0.18644443154335022 sec
Decode latency: 2.664606910198927 sec
Time for inference 1: 2.85 sec total, 1436.39 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6522.45 GB/s
FLOPS achieved: 32.61 TF/s

Prefill latency: 0.18577526323497295 sec
Decode latency: 2.6638621855527163 sec
Time for inference 2: 2.85 sec total, 1437.10 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6525.67 GB/s
FLOPS achieved: 32.63 TF/s

Prefill latency: 0.1863642167299986 sec
Decode latency: 2.6643488127738237 sec
Time for inference 3: 2.85 sec total, 1436.53 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6523.09 GB/s
FLOPS achieved: 32.62 TF/s

Prefill latency: 0.18660932779312134 sec
Decode latency: 2.6639384143054485 sec
Time for inference 4: 2.85 sec total, 1436.63 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6523.56 GB/s
FLOPS achieved: 32.62 TF/s

Prefill latency: 0.18552677147090435 sec
Decode latency: 2.663562573492527 sec
Time for inference 5: 2.85 sec total, 1437.38 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6526.94 GB/s
FLOPS achieved: 32.63 TF/s

Prefill latency: 0.1848629880696535 sec
Decode latency: 2.665270447731018 sec
Time for inference 6: 2.85 sec total, 1436.85 tokens/sec
Decode latency: 2.67 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 6524.52 GB/s
FLOPS achieved: 32.62 TF/s

Prefill latency: 0.18638959899544716 sec
Decode latency: 2.6641665380448103 sec
Time for inference 7: 2.85 sec total, 1436.57 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6523.26 GB/s
FLOPS achieved: 32.62 TF/s

Prefill latency: 0.18631240725517273 sec
Decode latency: 2.664615735411644 sec
Time for inference 8: 2.85 sec total, 1436.41 tokens/sec
Decode latency: 2.66 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6522.55 GB/s
FLOPS achieved: 32.61 TF/s

Prefill latency: 0.1865307167172432 sec
Decode latency: 2.6653102077543736 sec
Time for inference 9: 2.85 sec total, 1435.97 tokens/sec
Decode latency: 2.67 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6520.54 GB/s
FLOPS achieved: 32.60 TF/s

Prefill latency: 0.18688980676233768 sec
Decode latency: 2.6654097344726324 sec
Time for inference 10: 2.85 sec total, 1435.59 tokens/sec
Decode latency: 2.67 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6518.80 GB/s
FLOPS achieved: 32.59 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6645 sec
Average prefill latency: 0.1862 sec
Average tokens/sec: 1436.54
Memory used: 12.03 GB
