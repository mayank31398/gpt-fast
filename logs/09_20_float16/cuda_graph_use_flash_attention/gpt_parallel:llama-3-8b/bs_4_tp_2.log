W0920 10:20:23.746000 23350640797504 torch/distributed/run.py:779] 
W0920 10:20:23.746000 23350640797504 torch/distributed/run.py:779] *****************************************
W0920 10:20:23.746000 23350640797504 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 10:20:23.746000 23350640797504 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.29 seconds
Prefill latency: 0.08502488397061825 sec
Decode latency: 2.6956153474748135 sec
Compilation time: 2.78 seconds
Compilation time: 2.78 seconds
Prefill latency: 0.08576667122542858 sec
Decode latency: 2.6968764066696167 sec
Prefill latency: 0.08472993224859238 sec
Decode latency: 2.695679496973753 sec
Prefill latency: 0.0844598188996315 sec
Decode latency: 2.695841707289219 sec
Prefill latency: 0.08520921878516674 sec
Decode latency: 2.6958727054297924 sec
Prefill latency: 0.08558293990790844 sec
Decode latency: 2.695147590711713 sec
Time for inference 1: 2.78 sec total, 368.15 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2956.45 GB/s
FLOPS achieved: 14.78 TF/s

Prefill latency: 0.0850311927497387 sec
Decode latency: 2.6951650213450193 sec
Time for inference 2: 2.78 sec total, 368.23 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2957.05 GB/s
FLOPS achieved: 14.79 TF/s

Prefill latency: 0.086013063788414 sec
Decode latency: 2.6956046279519796 sec
Time for inference 3: 2.78 sec total, 368.02 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2955.40 GB/s
FLOPS achieved: 14.78 TF/s

Prefill latency: 0.08518854342401028 sec
Decode latency: 2.6970580276101828 sec
Time for inference 4: 2.78 sec total, 367.91 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2954.51 GB/s
FLOPS achieved: 14.77 TF/s

Prefill latency: 0.08603866025805473 sec
Decode latency: 2.6959823593497276 sec
Time for inference 5: 2.78 sec total, 367.96 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2954.93 GB/s
FLOPS achieved: 14.77 TF/s

Prefill latency: 0.08516749553382397 sec
Decode latency: 2.6966138556599617 sec
Time for inference 6: 2.78 sec total, 368.01 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2955.30 GB/s
FLOPS achieved: 14.78 TF/s

Prefill latency: 0.08595088124275208 sec
Decode latency: 2.6951329186558723 sec
Time for inference 7: 2.78 sec total, 368.11 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2956.09 GB/s
FLOPS achieved: 14.78 TF/s

Prefill latency: 0.08568675816059113 sec
Decode latency: 2.6958386600017548 sec
Time for inference 8: 2.78 sec total, 368.05 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2955.61 GB/s
FLOPS achieved: 14.78 TF/s

Prefill latency: 0.08460737206041813 sec
Decode latency: 2.695087430998683 sec
Time for inference 9: 2.78 sec total, 368.30 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 2957.62 GB/s
FLOPS achieved: 14.79 TF/s

Prefill latency: 0.08503235317766666 sec
Decode latency: 2.695280645042658 sec
Time for inference 10: 2.78 sec total, 368.21 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 2956.88 GB/s
FLOPS achieved: 14.78 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6957 sec
Average prefill latency: 0.0854 sec
Average tokens/sec: 368.09
Memory used: 12.87 GB
