flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.605297785019502 sec
Decode latency: 6.640803313988727 sec
Compilation time: 7.25 seconds
Prefill latency: 0.6067683669971302 sec
Decode latency: 6.605838277027942 sec
Prefill latency: 0.6076708500040695 sec
Decode latency: 6.633425129984971 sec
Prefill latency: 0.6067476670141332 sec
Decode latency: 6.6346514710457996 sec
Prefill latency: 0.6123089409666136 sec
Decode latency: 6.6342660980299115 sec
Prefill latency: 0.6099398069782183 sec
Decode latency: 6.635294719017111 sec
Time for inference 1: 7.25 sec total, 565.27 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8484.66 GB/s
FLOPS achieved: 42.42 TF/s

Prefill latency: 0.6061271480284631 sec
Decode latency: 6.63286605803296 sec
Time for inference 2: 7.24 sec total, 565.76 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8492.04 GB/s
FLOPS achieved: 42.46 TF/s

Prefill latency: 0.6073100509820506 sec
Decode latency: 6.634256909950636 sec
Time for inference 3: 7.24 sec total, 565.57 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8489.05 GB/s
FLOPS achieved: 42.45 TF/s

Prefill latency: 0.6068666019709781 sec
Decode latency: 6.633594047976658 sec
Time for inference 4: 7.24 sec total, 565.65 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8490.34 GB/s
FLOPS achieved: 42.45 TF/s

Prefill latency: 0.6085436959983781 sec
Decode latency: 6.6348937670118175 sec
Time for inference 5: 7.24 sec total, 565.42 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8486.89 GB/s
FLOPS achieved: 42.43 TF/s

Prefill latency: 0.6094573910231702 sec
Decode latency: 6.635259890987072 sec
Time for inference 6: 7.25 sec total, 565.32 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8485.43 GB/s
FLOPS achieved: 42.43 TF/s

Prefill latency: 0.6104312389506958 sec
Decode latency: 6.634796936006751 sec
Time for inference 7: 7.25 sec total, 565.29 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8484.84 GB/s
FLOPS achieved: 42.42 TF/s

Prefill latency: 0.6096987450146116 sec
Decode latency: 6.633300415996928 sec
Time for inference 8: 7.24 sec total, 565.44 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8487.23 GB/s
FLOPS achieved: 42.44 TF/s

Prefill latency: 0.6095636750105768 sec
Decode latency: 6.633803928969428 sec
Time for inference 9: 7.24 sec total, 565.42 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8486.83 GB/s
FLOPS achieved: 42.43 TF/s

Prefill latency: 0.6114649510127492 sec
Decode latency: 6.634408794983756 sec
Time for inference 10: 7.25 sec total, 565.23 tokens/sec
Decode latency: 6.63 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8483.96 GB/s
FLOPS achieved: 42.42 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6342 sec
Average prefill latency: 0.6089 sec
Average tokens/sec: 565.44
Memory used: 31.56 GB
