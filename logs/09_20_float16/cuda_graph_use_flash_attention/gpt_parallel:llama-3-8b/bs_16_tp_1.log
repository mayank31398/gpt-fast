flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.597519051283598 sec
Decode latency: 6.619327589869499 sec
Compilation time: 7.22 seconds
Prefill latency: 0.5992341805249453 sec
Decode latency: 6.618957664817572 sec
Prefill latency: 0.6032644845545292 sec
Decode latency: 6.617834784090519 sec
Prefill latency: 0.6015535276383162 sec
Decode latency: 6.610832007601857 sec
Prefill latency: 0.6026795282959938 sec
Decode latency: 6.577241273596883 sec
Prefill latency: 0.6028705313801765 sec
Decode latency: 6.612104495987296 sec
Time for inference 1: 7.22 sec total, 567.62 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8519.88 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.6043021474033594 sec
Decode latency: 6.611798906698823 sec
Time for inference 2: 7.22 sec total, 567.54 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8518.65 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.6027846317738295 sec
Decode latency: 6.614047599956393 sec
Time for inference 3: 7.22 sec total, 567.49 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8517.89 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.6020489539951086 sec
Decode latency: 6.6126938965171576 sec
Time for inference 4: 7.22 sec total, 567.65 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8520.36 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.6023305300623178 sec
Decode latency: 6.612178901210427 sec
Time for inference 5: 7.22 sec total, 567.67 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8520.59 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.6015142053365707 sec
Decode latency: 6.611543159931898 sec
Time for inference 6: 7.21 sec total, 567.78 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8522.34 GB/s
FLOPS achieved: 42.61 TF/s

Prefill latency: 0.6026657111942768 sec
Decode latency: 6.611305298283696 sec
Time for inference 7: 7.21 sec total, 567.71 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8521.19 GB/s
FLOPS achieved: 42.61 TF/s

Prefill latency: 0.6036285944283009 sec
Decode latency: 6.611269427463412 sec
Time for inference 8: 7.22 sec total, 567.64 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8520.20 GB/s
FLOPS achieved: 42.60 TF/s

Prefill latency: 0.6002403683960438 sec
Decode latency: 6.61313584074378 sec
Time for inference 9: 7.21 sec total, 567.76 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8521.95 GB/s
FLOPS achieved: 42.61 TF/s

Prefill latency: 0.6023146752268076 sec
Decode latency: 6.6127155516296625 sec
Time for inference 10: 7.22 sec total, 567.57 tokens/sec
Decode latency: 6.61 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8519.21 GB/s
FLOPS achieved: 42.60 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6123 sec
Average prefill latency: 0.6025 sec
Average tokens/sec: 567.64
Memory used: 31.56 GB
