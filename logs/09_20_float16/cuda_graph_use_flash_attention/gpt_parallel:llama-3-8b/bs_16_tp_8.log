W0927 12:30:36.653000 22527998396224 torch/distributed/run.py:779] 
W0927 12:30:36.653000 22527998396224 torch/distributed/run.py:779] *****************************************
W0927 12:30:36.653000 22527998396224 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 12:30:36.653000 22527998396224 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.12919170502573252 sec
Decode latency: 2.348790025978815 sec
Compilation time: 2.52 seconds
Compilation time: 2.48 seconds
Compilation time: 2.51 seconds
Compilation time: 2.48 seconds
Compilation time: 2.50 seconds
Compilation time: 2.50 seconds
Compilation time: 2.51 seconds
Compilation time: 2.53 seconds
Prefill latency: 0.12913186399964616 sec
Decode latency: 2.3484849350061268 sec
Prefill latency: 0.12932179198833182 sec
Decode latency: 2.3493382849846967 sec
Prefill latency: 0.12970766698708758 sec
Decode latency: 2.3487677790108137 sec
Prefill latency: 0.12961147201713175 sec
Decode latency: 2.3485529460012913 sec
Prefill latency: 0.12976066803094 sec
Decode latency: 2.3483417779789306 sec
Time for inference 1: 2.48 sec total, 1652.37 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4620.09 GB/s
FLOPS achieved: 23.10 TF/s

Prefill latency: 0.12984249601140618 sec
Decode latency: 2.3489630320109427 sec
Time for inference 2: 2.48 sec total, 1651.90 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4618.78 GB/s
FLOPS achieved: 23.09 TF/s

Prefill latency: 0.1289519020356238 sec
Decode latency: 2.3491297949803993 sec
Time for inference 3: 2.48 sec total, 1652.39 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4620.15 GB/s
FLOPS achieved: 23.10 TF/s

Prefill latency: 0.1291565079591237 sec
Decode latency: 2.3480466509936377 sec
Time for inference 4: 2.48 sec total, 1652.98 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4621.80 GB/s
FLOPS achieved: 23.11 TF/s

Prefill latency: 0.12975661602104083 sec
Decode latency: 2.349833815009333 sec
Time for inference 5: 2.48 sec total, 1651.43 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4617.45 GB/s
FLOPS achieved: 23.09 TF/s

Prefill latency: 0.12931667704833671 sec
Decode latency: 2.3493986789835617 sec
Time for inference 6: 2.48 sec total, 1651.92 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4618.82 GB/s
FLOPS achieved: 23.09 TF/s

Prefill latency: 0.12938245700206608 sec
Decode latency: 2.3511124289943837 sec
Time for inference 7: 2.48 sec total, 1650.85 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4615.83 GB/s
FLOPS achieved: 23.08 TF/s

Prefill latency: 0.1296396050020121 sec
Decode latency: 2.350861128012184 sec
Time for inference 8: 2.48 sec total, 1650.81 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4615.73 GB/s
FLOPS achieved: 23.08 TF/s

Prefill latency: 0.12886423204327002 sec
Decode latency: 2.349010326026473 sec
Time for inference 9: 2.48 sec total, 1652.52 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4620.50 GB/s
FLOPS achieved: 23.10 TF/s

Prefill latency: 0.13017784396652132 sec
Decode latency: 2.3496009900118224 sec
Time for inference 10: 2.48 sec total, 1651.22 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4616.86 GB/s
FLOPS achieved: 23.08 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3494 sec
Average prefill latency: 0.1295 sec
Average tokens/sec: 1651.84
Memory used: 15.19 GB
