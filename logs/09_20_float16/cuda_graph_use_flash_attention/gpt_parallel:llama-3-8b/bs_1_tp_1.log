flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.60 seconds
Prefill latency: 0.0384849663823843 sec
Decode latency: 2.883167764171958 sec
Compilation time: 2.92 seconds
Prefill latency: 0.0378978680819273 sec
Decode latency: 2.8865883462131023 sec
Prefill latency: 0.03795086592435837 sec
Decode latency: 2.8859946597367525 sec
Prefill latency: 0.03799072280526161 sec
Decode latency: 2.8864262234419584 sec
Prefill latency: 0.037910813465714455 sec
Decode latency: 2.887150140479207 sec
Prefill latency: 0.03791939094662666 sec
Decode latency: 2.8864472582936287 sec
Time for inference 1: 2.93 sec total, 87.52 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.68 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03805289790034294 sec
Decode latency: 2.886025905609131 sec
Time for inference 2: 2.92 sec total, 87.53 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.75 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03797760792076588 sec
Decode latency: 2.8867711536586285 sec
Time for inference 3: 2.93 sec total, 87.51 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.50 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03788946755230427 sec
Decode latency: 2.88622154481709 sec
Time for inference 4: 2.92 sec total, 87.53 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.82 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03793571889400482 sec
Decode latency: 2.886560518294573 sec
Time for inference 5: 2.93 sec total, 87.52 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.65 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03806384839117527 sec
Decode latency: 2.8860903084278107 sec
Time for inference 6: 2.92 sec total, 87.53 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.82 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03796825185418129 sec
Decode latency: 2.8865694403648376 sec
Time for inference 7: 2.93 sec total, 87.52 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.65 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.0379186924546957 sec
Decode latency: 2.8868370465934277 sec
Time for inference 8: 2.93 sec total, 87.51 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.56 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.03787844255566597 sec
Decode latency: 2.886702759191394 sec
Time for inference 9: 2.93 sec total, 87.52 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.63 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.037994932383298874 sec
Decode latency: 2.8863747734576464 sec
Time for inference 10: 2.92 sec total, 87.52 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1313.74 GB/s
FLOPS achieved: 6.57 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8865 sec
Average prefill latency: 0.0380 sec
Average tokens/sec: 87.52
Memory used: 17.16 GB
