flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.55 seconds
Prefill latency: 0.1490117385983467 sec
Decode latency: 3.492114992812276 sec
Compilation time: 3.64 seconds
Prefill latency: 0.1484246477484703 sec
Decode latency: 3.5755067467689514 sec
Prefill latency: 0.14803076721727848 sec
Decode latency: 3.470422476530075 sec
Prefill latency: 0.14882710576057434 sec
Decode latency: 3.575048517435789 sec
Prefill latency: 0.14898833446204662 sec
Decode latency: 3.57559896633029 sec
Prefill latency: 0.14874042570590973 sec
Decode latency: 3.5759900007396936 sec
Time for inference 1: 3.73 sec total, 274.87 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4125.78 GB/s
FLOPS achieved: 20.63 TF/s

Prefill latency: 0.1487457025796175 sec
Decode latency: 3.575745902955532 sec
Time for inference 2: 3.73 sec total, 274.89 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4126.00 GB/s
FLOPS achieved: 20.63 TF/s

Prefill latency: 0.14874668419361115 sec
Decode latency: 3.572020100429654 sec
Time for inference 3: 3.72 sec total, 275.16 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.18 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14892555586993694 sec
Decode latency: 3.573450291529298 sec
Time for inference 4: 3.72 sec total, 275.05 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4128.46 GB/s
FLOPS achieved: 20.64 TF/s

Prefill latency: 0.1495551709085703 sec
Decode latency: 3.5161327105015516 sec
Time for inference 5: 3.67 sec total, 279.29 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4192.17 GB/s
FLOPS achieved: 20.96 TF/s

Prefill latency: 0.1489608008414507 sec
Decode latency: 3.5755944158881903 sec
Time for inference 6: 3.73 sec total, 274.87 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4125.81 GB/s
FLOPS achieved: 20.63 TF/s

Prefill latency: 0.14891868270933628 sec
Decode latency: 3.5739637725055218 sec
Time for inference 7: 3.72 sec total, 275.01 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4127.80 GB/s
FLOPS achieved: 20.64 TF/s

Prefill latency: 0.1487380601465702 sec
Decode latency: 3.5732722617685795 sec
Time for inference 8: 3.72 sec total, 275.07 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4128.79 GB/s
FLOPS achieved: 20.64 TF/s

Prefill latency: 0.14893714524805546 sec
Decode latency: 3.571021795272827 sec
Time for inference 9: 3.72 sec total, 275.23 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.10 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.1491722073405981 sec
Decode latency: 3.5728172920644283 sec
Time for inference 10: 3.72 sec total, 275.07 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4128.80 GB/s
FLOPS achieved: 20.64 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5680 sec
Average prefill latency: 0.1489 sec
Average tokens/sec: 275.45
Memory used: 19.94 GB
