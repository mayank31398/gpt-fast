W0920 10:11:46.043000 23058320205632 torch/distributed/run.py:779] 
W0920 10:11:46.043000 23058320205632 torch/distributed/run.py:779] *****************************************
W0920 10:11:46.043000 23058320205632 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 10:11:46.043000 23058320205632 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 1.4245515298098326 sec
Decode latency: 11.283992635086179 sec
Compilation time: 12.70 secondsCompilation time: 12.70 seconds

Compilation time: 12.71 seconds
Compilation time: 12.71 seconds
Prefill latency: 1.4111820813268423 sec
Decode latency: 11.276793269440532 sec
Prefill latency: 1.4151318464428186 sec
Decode latency: 11.273955984041095 sec
Prefill latency: 1.4147267118096352 sec
Decode latency: 11.277173286303878 sec
Prefill latency: 1.4178073648363352 sec
Decode latency: 11.273767814040184 sec
Prefill latency: 1.4131743479520082 sec
Decode latency: 11.278200719505548 sec
Time for inference 1: 12.69 sec total, 322.71 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.41 sec
Bandwidth achieved: 11723.87 GB/s
FLOPS achieved: 58.62 TF/s

Prefill latency: 1.414781192317605 sec
Decode latency: 11.27626034244895 sec
Time for inference 2: 12.69 sec total, 322.72 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.41 sec
Bandwidth achieved: 11724.19 GB/s
FLOPS achieved: 58.62 TF/s

Prefill latency: 1.4139518849551678 sec
Decode latency: 11.2786103785038 sec
Time for inference 3: 12.69 sec total, 322.68 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.41 sec
Bandwidth achieved: 11722.64 GB/s
FLOPS achieved: 58.61 TF/s

Prefill latency: 1.4123972058296204 sec
Decode latency: 11.278852246701717 sec
Time for inference 4: 12.69 sec total, 322.71 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.41 sec
Bandwidth achieved: 11723.97 GB/s
FLOPS achieved: 58.62 TF/s

Prefill latency: 1.4161768574267626 sec
Decode latency: 11.27610575594008 sec
Time for inference 5: 12.69 sec total, 322.69 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.42 sec
Bandwidth achieved: 11723.16 GB/s
FLOPS achieved: 58.62 TF/s

Prefill latency: 1.4179625641554594 sec
Decode latency: 11.276374666020274 sec
Time for inference 6: 12.70 sec total, 322.64 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.42 sec
Bandwidth achieved: 11721.18 GB/s
FLOPS achieved: 58.61 TF/s

Prefill latency: 1.416767818853259 sec
Decode latency: 11.27816066518426 sec
Time for inference 7: 12.70 sec total, 322.62 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.42 sec
Bandwidth achieved: 11720.55 GB/s
FLOPS achieved: 58.60 TF/s

Prefill latency: 1.4164132922887802 sec
Decode latency: 11.279135040938854 sec
Time for inference 8: 12.70 sec total, 322.60 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.42 sec
Bandwidth achieved: 11720.00 GB/s
FLOPS achieved: 58.60 TF/s

Prefill latency: 1.4163565747439861 sec
Decode latency: 11.27709205262363 sec
Time for inference 9: 12.69 sec total, 322.66 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.42 sec
Bandwidth achieved: 11721.96 GB/s
FLOPS achieved: 58.61 TF/s

Prefill latency: 1.4136203955858946 sec
Decode latency: 11.279663803055882 sec
Time for inference 10: 12.69 sec total, 322.66 tokens/sec
Decode latency: 11.28 sec
Prefill latency: 1.41 sec
Bandwidth achieved: 11722.03 GB/s
FLOPS achieved: 58.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 11.2778 sec
Average prefill latency: 1.4152 sec
Average tokens/sec: 322.67
Memory used: 68.49 GB
