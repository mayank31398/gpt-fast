W0920 09:26:14.056000 22451625875264 torch/distributed/run.py:779] 
W0920 09:26:14.056000 22451625875264 torch/distributed/run.py:779] *****************************************
W0920 09:26:14.056000 22451625875264 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:26:14.056000 22451625875264 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 0.06232929788529873 sec
Decode latency: 5.40109988860786 sec
Compilation time: 5.49 seconds
Compilation time: 5.47 secondsCompilation time: 5.47 seconds

Compilation time: 5.52 secondsCompilation time: 5.47 seconds

Compilation time: 5.46 seconds
Compilation time: 5.53 secondsCompilation time: 5.56 seconds

Prefill latency: 0.06124155968427658 sec
Decode latency: 5.401675131171942 sec
Prefill latency: 0.061102503910660744 sec
Decode latency: 5.401848159730434 sec
Prefill latency: 0.06112447567284107 sec
Decode latency: 5.402220010757446 sec
Prefill latency: 0.06112372688949108 sec
Decode latency: 5.401986248791218 sec
Prefill latency: 0.06131674535572529 sec
Decode latency: 5.4029704835265875 sec
Time for inference 1: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.16 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061206839978694916 sec
Decode latency: 5.403243727982044 sec
Time for inference 2: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.13 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061405567452311516 sec
Decode latency: 5.402747441083193 sec
Time for inference 3: 5.46 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.19 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061309970915317535 sec
Decode latency: 5.402971001341939 sec
Time for inference 4: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.15 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061176445335149765 sec
Decode latency: 5.403631843626499 sec
Time for inference 5: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.06 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.06155950389802456 sec
Decode latency: 5.403364652767777 sec
Time for inference 6: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.05 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.06124146841466427 sec
Decode latency: 5.4039018508046865 sec
Time for inference 7: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.02 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061502572149038315 sec
Decode latency: 5.40322957187891 sec
Time for inference 8: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.09 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.061266299337148666 sec
Decode latency: 5.403756095096469 sec
Time for inference 9: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.03 GB/s
FLOPS achieved: 4.50 TF/s

Prefill latency: 0.06127236410975456 sec
Decode latency: 5.403706384822726 sec
Time for inference 10: 5.47 sec total, 46.84 tokens/sec
Decode latency: 5.40 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 900.04 GB/s
FLOPS achieved: 4.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.4034 sec
Average prefill latency: 0.0613 sec
Average tokens/sec: 46.84
Memory used: 23.23 GB
