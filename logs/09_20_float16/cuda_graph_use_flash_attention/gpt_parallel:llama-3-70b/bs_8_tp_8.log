W0920 09:53:01.771000 23055498442560 torch/distributed/run.py:779] 
W0920 09:53:01.771000 23055498442560 torch/distributed/run.py:779] *****************************************
W0920 09:53:01.771000 23055498442560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:53:01.771000 23055498442560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.72 seconds
Prefill latency: 0.41929432936012745 sec
Decode latency: 6.799048187211156 sec
Compilation time: 7.21 seconds
Compilation time: 7.22 seconds
Compilation time: 7.23 seconds
Compilation time: 7.19 seconds
Compilation time: 7.21 seconds
Compilation time: 7.23 seconds
Compilation time: 7.22 seconds
Compilation time: 7.21 seconds
Prefill latency: 0.3944455236196518 sec
Decode latency: 6.8005419839173555 sec
Prefill latency: 0.39598417468369007 sec
Decode latency: 6.798896588385105 sec
Prefill latency: 0.39666211791336536 sec
Decode latency: 6.798586232587695 sec
Prefill latency: 0.39522708021104336 sec
Decode latency: 6.7990300469100475 sec
Prefill latency: 0.39558684453368187 sec
Decode latency: 6.798995278775692 sec
Time for inference 1: 7.20 sec total, 284.63 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5469.58 GB/s
FLOPS achieved: 27.35 TF/s

Prefill latency: 0.39636291190981865 sec
Decode latency: 6.799045797437429 sec
Time for inference 2: 7.20 sec total, 284.58 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5468.79 GB/s
FLOPS achieved: 27.34 TF/s

Prefill latency: 0.39649051055312157 sec
Decode latency: 6.795847976580262 sec
Time for inference 3: 7.19 sec total, 284.71 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5471.15 GB/s
FLOPS achieved: 27.36 TF/s

Prefill latency: 0.3973224628716707 sec
Decode latency: 6.795529138296843 sec
Time for inference 4: 7.19 sec total, 284.69 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5470.83 GB/s
FLOPS achieved: 27.35 TF/s

Prefill latency: 0.396999754011631 sec
Decode latency: 6.795211676508188 sec
Time for inference 5: 7.19 sec total, 284.71 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5471.25 GB/s
FLOPS achieved: 27.36 TF/s

Prefill latency: 0.3976230267435312 sec
Decode latency: 6.795038187876344 sec
Time for inference 6: 7.19 sec total, 284.69 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5470.87 GB/s
FLOPS achieved: 27.35 TF/s

Prefill latency: 0.39557881839573383 sec
Decode latency: 6.79463117569685 sec
Time for inference 7: 7.19 sec total, 284.79 tokens/sec
Decode latency: 6.79 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5472.78 GB/s
FLOPS achieved: 27.36 TF/s

Prefill latency: 0.39658812806010246 sec
Decode latency: 6.79579540155828 sec
Time for inference 8: 7.19 sec total, 284.70 tokens/sec
Decode latency: 6.80 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5471.04 GB/s
FLOPS achieved: 27.36 TF/s

Prefill latency: 0.3977355435490608 sec
Decode latency: 6.79373013228178 sec
Time for inference 9: 7.19 sec total, 284.74 tokens/sec
Decode latency: 6.79 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5471.81 GB/s
FLOPS achieved: 27.36 TF/s

Prefill latency: 0.3970980290323496 sec
Decode latency: 6.794674050062895 sec
Time for inference 10: 7.19 sec total, 284.73 tokens/sec
Decode latency: 6.79 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5471.55 GB/s
FLOPS achieved: 27.36 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.7958 sec
Average prefill latency: 0.3967 sec
Average tokens/sec: 284.70
Memory used: 35.56 GB
[rank4]:[E920 10:05:17.176187660 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 4] Future for ProcessGroup abort timed out after 600000 ms
[rank7]:[E920 10:05:17.176208615 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 7] Future for ProcessGroup abort timed out after 600000 ms
[rank3]:[E920 10:05:17.176209746 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 3] Future for ProcessGroup abort timed out after 600000 ms
[rank1]:[E920 10:05:17.176208105 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 600000 ms
[rank6]:[E920 10:05:17.176209090 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 6] Future for ProcessGroup abort timed out after 600000 ms
[rank5]:[E920 10:05:17.176209295 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 5] Future for ProcessGroup abort timed out after 600000 ms
[rank2]:[E920 10:05:17.176247876 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 2] Future for ProcessGroup abort timed out after 600000 ms
[rank0]:[E920 10:05:17.176443108 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 600000 ms
