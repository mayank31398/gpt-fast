W0925 00:16:03.662000 22489214105408 torch/distributed/run.py:779] 
W0925 00:16:03.662000 22489214105408 torch/distributed/run.py:779] *****************************************
W0925 00:16:03.662000 22489214105408 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0925 00:16:03.662000 22489214105408 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.1883983351290226 sec
Decode latency: 10.018060529604554 sec
Compilation time: 10.21 seconds
Compilation time: 10.19 seconds
Prefill latency: 0.1677488125860691 sec
Decode latency: 10.017588222399354 sec
Prefill latency: 0.1693508680909872 sec
Decode latency: 10.014270205050707 sec
Prefill latency: 0.16708115115761757 sec
Decode latency: 10.014937927946448 sec
Prefill latency: 0.1688036322593689 sec
Decode latency: 10.016320714727044 sec
Prefill latency: 0.16819632053375244 sec
Decode latency: 10.015971383079886 sec
Time for inference 1: 10.19 sec total, 25.13 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.39 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16892223246395588 sec
Decode latency: 10.015869334340096 sec
Time for inference 2: 10.19 sec total, 25.13 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.30 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16906014271080494 sec
Decode latency: 10.01593461073935 sec
Time for inference 3: 10.19 sec total, 25.13 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.24 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16961865685880184 sec
Decode latency: 10.015982689335942 sec
Time for inference 4: 10.19 sec total, 25.13 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.14 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16777750849723816 sec
Decode latency: 10.015697540715337 sec
Time for inference 5: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.51 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16849428974092007 sec
Decode latency: 10.015209518373013 sec
Time for inference 6: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.47 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16839277371764183 sec
Decode latency: 10.015209013596177 sec
Time for inference 7: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.48 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16851122118532658 sec
Decode latency: 10.01520442776382 sec
Time for inference 8: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.44 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16791089065372944 sec
Decode latency: 10.015358749777079 sec
Time for inference 9: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.52 GB/s
FLOPS achieved: 8.87 TF/s

Prefill latency: 0.16837699711322784 sec
Decode latency: 10.01535339653492 sec
Time for inference 10: 10.18 sec total, 25.14 tokens/sec
Decode latency: 10.02 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1773.47 GB/s
FLOPS achieved: 8.87 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.0156 sec
Average prefill latency: 0.1685 sec
Average tokens/sec: 25.13
Memory used: 75.76 GB
