W0920 10:36:13.941000 22427815438144 torch/distributed/run.py:779] 
W0920 10:36:13.941000 22427815438144 torch/distributed/run.py:779] *****************************************
W0920 10:36:13.941000 22427815438144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 10:36:13.941000 22427815438144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.31 seconds
Prefill latency: 0.13276605866849422 sec
Decode latency: 6.968792263418436 sec
Compilation time: 7.08 seconds
Compilation time: 7.07 seconds
Compilation time: 7.08 secondsCompilation time: 7.10 seconds

Prefill latency: 0.09910925850272179 sec
Decode latency: 6.967306587845087 sec
Prefill latency: 0.09987924620509148 sec
Decode latency: 6.968579567968845 sec
Prefill latency: 0.09968848712742329 sec
Decode latency: 6.970948804169893 sec
Prefill latency: 0.09984450228512287 sec
Decode latency: 6.970601856708527 sec
Prefill latency: 0.09927957691252232 sec
Decode latency: 6.97018145211041 sec
Time for inference 1: 7.07 sec total, 36.21 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.39 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10003731213510036 sec
Decode latency: 6.971559533849359 sec
Time for inference 2: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1314.97 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.10079712048172951 sec
Decode latency: 6.971043003723025 sec
Time for inference 3: 7.07 sec total, 36.19 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1314.93 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.10035490803420544 sec
Decode latency: 6.970115568488836 sec
Time for inference 4: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.20 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10017193667590618 sec
Decode latency: 6.971473714336753 sec
Time for inference 5: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1314.98 GB/s
FLOPS achieved: 6.57 TF/s

Prefill latency: 0.10017485916614532 sec
Decode latency: 6.970885517075658 sec
Time for inference 6: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.10 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10059472359716892 sec
Decode latency: 6.9709461983293295 sec
Time for inference 7: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.01 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10020330548286438 sec
Decode latency: 6.970952894538641 sec
Time for inference 8: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.08 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10003195330500603 sec
Decode latency: 6.971459733322263 sec
Time for inference 9: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.01 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.09992668218910694 sec
Decode latency: 6.971092799678445 sec
Time for inference 10: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.05 GB/s
FLOPS achieved: 6.58 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.9710 sec
Average prefill latency: 0.1002 sec
Average tokens/sec: 36.20
Memory used: 40.42 GB
