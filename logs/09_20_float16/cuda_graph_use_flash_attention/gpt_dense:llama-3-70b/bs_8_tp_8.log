W0920 09:04:02.321000 22465324746560 torch/distributed/run.py:779] 
W0920 09:04:02.321000 22465324746560 torch/distributed/run.py:779] *****************************************
W0920 09:04:02.321000 22465324746560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:04:02.321000 22465324746560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.450956042855978 sec
Decode latency: 7.357081960886717 sec
Compilation time: 7.80 seconds
Compilation time: 7.82 seconds
Compilation time: 7.82 seconds
Compilation time: 7.80 seconds
Compilation time: 7.82 seconds
Compilation time: 7.84 seconds
Compilation time: 7.84 seconds
Compilation time: 7.81 seconds
Prefill latency: 0.4385240636765957 sec
Decode latency: 7.357672784477472 sec
Prefill latency: 0.43893327936530113 sec
Decode latency: 7.357207482680678 sec
Prefill latency: 0.43882493674755096 sec
Decode latency: 7.357494963333011 sec
Prefill latency: 0.43980594724416733 sec
Decode latency: 7.357655243948102 sec
Prefill latency: 0.4393114075064659 sec
Decode latency: 7.35697747208178 sec
Time for inference 1: 7.80 sec total, 262.65 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5047.25 GB/s
FLOPS achieved: 25.24 TF/s

Prefill latency: 0.43948182836174965 sec
Decode latency: 7.357666123658419 sec
Time for inference 2: 7.80 sec total, 262.62 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5046.68 GB/s
FLOPS achieved: 25.23 TF/s

Prefill latency: 0.4398995768278837 sec
Decode latency: 7.35783676058054 sec
Time for inference 3: 7.80 sec total, 262.60 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5046.29 GB/s
FLOPS achieved: 25.23 TF/s

Prefill latency: 0.4392692353576422 sec
Decode latency: 7.357781467959285 sec
Time for inference 4: 7.80 sec total, 262.63 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5046.80 GB/s
FLOPS achieved: 25.23 TF/s

Prefill latency: 0.4399234540760517 sec
Decode latency: 7.355723235756159 sec
Time for inference 5: 7.80 sec total, 262.67 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5047.61 GB/s
FLOPS achieved: 25.24 TF/s

Prefill latency: 0.43977122008800507 sec
Decode latency: 7.355314465239644 sec
Time for inference 6: 7.80 sec total, 262.69 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5047.99 GB/s
FLOPS achieved: 25.24 TF/s

Prefill latency: 0.4401298388838768 sec
Decode latency: 7.3562967497855425 sec
Time for inference 7: 7.80 sec total, 262.64 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5047.18 GB/s
FLOPS achieved: 25.24 TF/s

Prefill latency: 0.43953430838882923 sec
Decode latency: 7.357693353667855 sec
Time for inference 8: 7.80 sec total, 262.62 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5046.64 GB/s
FLOPS achieved: 25.23 TF/s

Prefill latency: 0.4400424137711525 sec
Decode latency: 7.356344152241945 sec
Time for inference 9: 7.80 sec total, 262.64 tokens/sec
Decode latency: 7.36 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5047.07 GB/s
FLOPS achieved: 25.24 TF/s

Prefill latency: 0.44081714376807213 sec
Decode latency: 7.3519670981913805 sec
Time for inference 10: 7.79 sec total, 262.76 tokens/sec
Decode latency: 7.35 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 5049.47 GB/s
FLOPS achieved: 25.25 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.3564 sec
Average prefill latency: 0.4398 sec
Average tokens/sec: 262.65
Memory used: 46.30 GB
