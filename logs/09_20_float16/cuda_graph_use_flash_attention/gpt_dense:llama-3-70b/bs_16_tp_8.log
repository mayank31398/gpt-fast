W0920 09:08:05.189000 23236936296256 torch/distributed/run.py:779] 
W0920 09:08:05.189000 23236936296256 torch/distributed/run.py:779] *****************************************
W0920 09:08:05.189000 23236936296256 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 09:08:05.189000 23236936296256 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.8757474757730961 sec
Decode latency: 8.442841028794646 sec
Compilation time: 9.32 seconds
Compilation time: 9.32 secondsCompilation time: 9.37 seconds

Compilation time: 9.36 seconds
Compilation time: 9.32 seconds
Compilation time: 9.40 secondsCompilation time: 9.36 seconds

Compilation time: 9.39 seconds
Prefill latency: 0.8749343156814575 sec
Decode latency: 8.444146240130067 sec
Prefill latency: 0.8772581983357668 sec
Decode latency: 8.443332383409142 sec
Prefill latency: 0.8776193000376225 sec
Decode latency: 8.448426030576229 sec
Prefill latency: 0.8789170011878014 sec
Decode latency: 8.44587797857821 sec
Prefill latency: 0.8776701800525188 sec
Decode latency: 8.4402676820755 sec
Time for inference 1: 9.32 sec total, 439.53 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8446.29 GB/s
FLOPS achieved: 42.23 TF/s

Prefill latency: 0.8799109105020761 sec
Decode latency: 8.443368988111615 sec
Time for inference 2: 9.32 sec total, 439.27 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8441.25 GB/s
FLOPS achieved: 42.21 TF/s

Prefill latency: 0.8760362956672907 sec
Decode latency: 8.450036795809865 sec
Time for inference 3: 9.33 sec total, 439.14 tokens/sec
Decode latency: 8.45 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8438.84 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.8816939555108547 sec
Decode latency: 8.444365223869681 sec
Time for inference 4: 9.33 sec total, 439.14 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8438.81 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.8798981849104166 sec
Decode latency: 8.44156856276095 sec
Time for inference 5: 9.32 sec total, 439.36 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8443.05 GB/s
FLOPS achieved: 42.22 TF/s

Prefill latency: 0.8802073281258345 sec
Decode latency: 8.442166700959206 sec
Time for inference 6: 9.32 sec total, 439.31 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8442.15 GB/s
FLOPS achieved: 42.21 TF/s

Prefill latency: 0.879949102178216 sec
Decode latency: 8.446663055568933 sec
Time for inference 7: 9.33 sec total, 439.12 tokens/sec
Decode latency: 8.45 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8438.46 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.8796806428581476 sec
Decode latency: 8.44401889666915 sec
Time for inference 8: 9.32 sec total, 439.25 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8440.96 GB/s
FLOPS achieved: 42.20 TF/s

Prefill latency: 0.8795314729213715 sec
Decode latency: 8.447831211611629 sec
Time for inference 9: 9.33 sec total, 439.08 tokens/sec
Decode latency: 8.45 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8437.60 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.8822760228067636 sec
Decode latency: 8.444390963762999 sec
Time for inference 10: 9.33 sec total, 439.11 tokens/sec
Decode latency: 8.44 sec
Prefill latency: 0.88 sec
Bandwidth achieved: 8438.27 GB/s
FLOPS achieved: 42.19 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.4445 sec
Average prefill latency: 0.8797 sec
Average tokens/sec: 439.23
Memory used: 71.17 GB
