W0920 08:07:25.411000 22829373138752 torch/distributed/run.py:779] 
W0920 08:07:25.411000 22829373138752 torch/distributed/run.py:779] *****************************************
W0920 08:07:25.411000 22829373138752 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:07:25.411000 22829373138752 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.13 seconds
[rank2]:[W920 08:08:00.018250541 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank6]:[W920 08:08:00.020480898 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.059827763587236404 sec
Decode latency: 1.8307562954723835 sec
Compilation time: 1.91 secondsCompilation time: 1.90 seconds

Compilation time: 1.88 seconds
Compilation time: 1.90 seconds
Compilation time: 1.92 seconds
Compilation time: 1.89 seconds
Compilation time: 1.87 secondsCompilation time: 1.87 seconds

Prefill latency: 0.03828071244060993 sec
Decode latency: 1.8306597657501698 sec
Prefill latency: 0.03799598291516304 sec
Decode latency: 1.8309771623462439 sec
Prefill latency: 0.038103820756077766 sec
Decode latency: 1.830691758543253 sec
Prefill latency: 0.03807183913886547 sec
Decode latency: 1.8326629977673292 sec
Prefill latency: 0.03806406445801258 sec
Decode latency: 1.8311012256890535 sec
Time for inference 1: 1.87 sec total, 547.66 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.27 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.03836689703166485 sec
Decode latency: 1.8309768568724394 sec
Time for inference 2: 1.87 sec total, 547.61 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.12 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.038125284016132355 sec
Decode latency: 1.8310268688946962 sec
Time for inference 3: 1.87 sec total, 547.69 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.35 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.03830242529511452 sec
Decode latency: 1.8312639277428389 sec
Time for inference 4: 1.87 sec total, 547.56 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1530.99 GB/s
FLOPS achieved: 7.65 TF/s

Prefill latency: 0.03808273747563362 sec
Decode latency: 1.8310410603880882 sec
Time for inference 5: 1.87 sec total, 547.66 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.27 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.038011232390999794 sec
Decode latency: 1.831161366775632 sec
Time for inference 6: 1.87 sec total, 547.65 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.25 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.03823692537844181 sec
Decode latency: 1.830973882228136 sec
Time for inference 7: 1.87 sec total, 547.61 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.15 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.03812369145452976 sec
Decode latency: 1.832484807819128 sec
Time for inference 8: 1.87 sec total, 547.25 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1530.14 GB/s
FLOPS achieved: 7.65 TF/s

Prefill latency: 0.03814493492245674 sec
Decode latency: 1.8312952164560556 sec
Time for inference 9: 1.87 sec total, 547.58 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.05 GB/s
FLOPS achieved: 7.66 TF/s

Prefill latency: 0.03800360672175884 sec
Decode latency: 1.8311249911785126 sec
Time for inference 10: 1.87 sec total, 547.67 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1531.30 GB/s
FLOPS achieved: 7.66 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8312 sec
Average prefill latency: 0.0381 sec
Average tokens/sec: 547.59
Memory used: 7.46 GB
