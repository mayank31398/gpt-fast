flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.47 seconds
Prefill latency: 0.03841958940029144 sec
Decode latency: 2.901892574504018 sec
Compilation time: 2.94 seconds
Prefill latency: 0.03804109990596771 sec
Decode latency: 2.9047121983021498 sec
Prefill latency: 0.037988852709531784 sec
Decode latency: 2.9040841348469257 sec
Prefill latency: 0.038028644397854805 sec
Decode latency: 2.9048154931515455 sec
Prefill latency: 0.03802117519080639 sec
Decode latency: 2.9040462262928486 sec
Prefill latency: 0.038040727376937866 sec
Decode latency: 2.9040304850786924 sec
Time for inference 1: 2.94 sec total, 87.00 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1305.78 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03807324543595314 sec
Decode latency: 2.9038173854351044 sec
Time for inference 2: 2.94 sec total, 87.00 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1305.86 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.038119373843073845 sec
Decode latency: 2.9026564359664917 sec
Time for inference 3: 2.94 sec total, 87.03 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.30 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.038030168041586876 sec
Decode latency: 2.9030520655214787 sec
Time for inference 4: 2.94 sec total, 87.02 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.15 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03802965581417084 sec
Decode latency: 2.9030553363263607 sec
Time for inference 5: 2.94 sec total, 87.02 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.17 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.038097526878118515 sec
Decode latency: 2.90230774320662 sec
Time for inference 6: 2.94 sec total, 87.04 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.49 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.038042280822992325 sec
Decode latency: 2.902181837707758 sec
Time for inference 7: 2.94 sec total, 87.05 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.56 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03809148445725441 sec
Decode latency: 2.9003907814621925 sec
Time for inference 8: 2.94 sec total, 87.10 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1307.37 GB/s
FLOPS achieved: 6.54 TF/s

Prefill latency: 0.03810209222137928 sec
Decode latency: 2.9025228023529053 sec
Time for inference 9: 2.94 sec total, 87.04 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.42 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03810705989599228 sec
Decode latency: 2.902363009750843 sec
Time for inference 10: 2.94 sec total, 87.04 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.49 GB/s
FLOPS achieved: 6.53 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9026 sec
Average prefill latency: 0.0381 sec
Average tokens/sec: 87.03
Memory used: 17.46 GB
