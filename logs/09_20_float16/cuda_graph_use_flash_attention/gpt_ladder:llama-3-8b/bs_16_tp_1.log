flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.44 seconds
Prefill latency: 0.594756918027997 sec
Decode latency: 6.585603348910809 sec
Compilation time: 7.18 seconds
Prefill latency: 0.5992428865283728 sec
Decode latency: 6.6541972532868385 sec
Prefill latency: 0.5979167558252811 sec
Decode latency: 6.579780211672187 sec
Prefill latency: 0.6003227047622204 sec
Decode latency: 6.566586442291737 sec
Prefill latency: 0.5994777232408524 sec
Decode latency: 6.661150671541691 sec
Prefill latency: 0.5990978721529245 sec
Decode latency: 6.659531220793724 sec
Time for inference 1: 7.26 sec total, 564.23 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8469.05 GB/s
FLOPS achieved: 42.35 TF/s

Prefill latency: 0.600312128663063 sec
Decode latency: 6.588424064218998 sec
Time for inference 2: 7.19 sec total, 569.72 tokens/sec
Decode latency: 6.59 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8551.45 GB/s
FLOPS achieved: 42.76 TF/s

Prefill latency: 0.5987078789621592 sec
Decode latency: 6.661589175462723 sec
Time for inference 3: 7.26 sec total, 564.10 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8467.12 GB/s
FLOPS achieved: 42.34 TF/s

Prefill latency: 0.6019242182374 sec
Decode latency: 6.570054246112704 sec
Time for inference 4: 7.17 sec total, 571.06 tokens/sec
Decode latency: 6.57 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8571.46 GB/s
FLOPS achieved: 42.86 TF/s

Prefill latency: 0.6001071911305189 sec
Decode latency: 6.659951847046614 sec
Time for inference 5: 7.26 sec total, 564.13 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8467.48 GB/s
FLOPS achieved: 42.34 TF/s

Prefill latency: 0.5984002221375704 sec
Decode latency: 6.6594597809016705 sec
Time for inference 6: 7.26 sec total, 564.30 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8470.07 GB/s
FLOPS achieved: 42.35 TF/s

Prefill latency: 0.6022624280303717 sec
Decode latency: 6.595818590372801 sec
Time for inference 7: 7.20 sec total, 568.99 tokens/sec
Decode latency: 6.60 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8540.45 GB/s
FLOPS achieved: 42.70 TF/s

Prefill latency: 0.6011634599417448 sec
Decode latency: 6.6603510566055775 sec
Time for inference 8: 7.26 sec total, 564.01 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.74 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.6008320711553097 sec
Decode latency: 6.642214084044099 sec
Time for inference 9: 7.24 sec total, 565.45 tokens/sec
Decode latency: 6.64 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8487.35 GB/s
FLOPS achieved: 42.44 TF/s

Prefill latency: 0.6012389846146107 sec
Decode latency: 6.593135783448815 sec
Time for inference 10: 7.20 sec total, 569.28 tokens/sec
Decode latency: 6.59 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8544.76 GB/s
FLOPS achieved: 42.72 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6291 sec
Average prefill latency: 0.6004 sec
Average tokens/sec: 566.53
Memory used: 36.19 GB
