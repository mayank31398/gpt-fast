W0920 08:10:37.662000 23302562125632 torch/distributed/run.py:779] 
W0920 08:10:37.662000 23302562125632 torch/distributed/run.py:779] *****************************************
W0920 08:10:37.662000 23302562125632 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:10:37.662000 23302562125632 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.06 seconds
Prefill latency: 0.16855767369270325 sec
Decode latency: 3.0492904763668776 sec
Compilation time: 3.22 seconds
Compilation time: 3.22 seconds
Prefill latency: 0.16853316500782967 sec
Decode latency: 3.0459590945392847 sec
Prefill latency: 0.16893354430794716 sec
Decode latency: 3.0488786548376083 sec
Prefill latency: 0.16861745156347752 sec
Decode latency: 3.0474449750036 sec
Prefill latency: 0.17043095640838146 sec
Decode latency: 3.0475961435586214 sec
Prefill latency: 0.16971056535840034 sec
Decode latency: 3.0474226027727127 sec
Time for inference 1: 3.22 sec total, 636.43 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5110.88 GB/s
FLOPS achieved: 25.55 TF/s

Prefill latency: 0.17075351253151894 sec
Decode latency: 3.047608794644475 sec
Time for inference 2: 3.22 sec total, 636.19 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5108.92 GB/s
FLOPS achieved: 25.54 TF/s

Prefill latency: 0.16826554387807846 sec
Decode latency: 3.0477944370359182 sec
Time for inference 3: 3.22 sec total, 636.66 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5112.71 GB/s
FLOPS achieved: 25.56 TF/s

Prefill latency: 0.17073553055524826 sec
Decode latency: 3.0484178625047207 sec
Time for inference 4: 3.22 sec total, 636.05 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5107.80 GB/s
FLOPS achieved: 25.54 TF/s

Prefill latency: 0.1692513097077608 sec
Decode latency: 3.049142964184284 sec
Time for inference 5: 3.22 sec total, 636.19 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5108.96 GB/s
FLOPS achieved: 25.54 TF/s

Prefill latency: 0.16987638361752033 sec
Decode latency: 3.047636551782489 sec
Time for inference 6: 3.22 sec total, 636.38 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5110.47 GB/s
FLOPS achieved: 25.55 TF/s

Prefill latency: 0.1685181725770235 sec
Decode latency: 3.0473220348358154 sec
Time for inference 7: 3.22 sec total, 636.69 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5112.97 GB/s
FLOPS achieved: 25.56 TF/s

Prefill latency: 0.17128172516822815 sec
Decode latency: 3.048512388020754 sec
Time for inference 8: 3.22 sec total, 635.91 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5106.68 GB/s
FLOPS achieved: 25.53 TF/s

Prefill latency: 0.16962661407887936 sec
Decode latency: 3.0480736289173365 sec
Time for inference 9: 3.22 sec total, 636.33 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5110.05 GB/s
FLOPS achieved: 25.55 TF/s

Prefill latency: 0.17063011229038239 sec
Decode latency: 3.048838736489415 sec
Time for inference 10: 3.22 sec total, 635.97 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 5107.17 GB/s
FLOPS achieved: 25.54 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0481 sec
Average prefill latency: 0.1699 sec
Average tokens/sec: 636.28
Memory used: 20.15 GB
