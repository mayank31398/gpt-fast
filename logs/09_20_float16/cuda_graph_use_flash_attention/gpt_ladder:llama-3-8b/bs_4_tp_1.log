flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.83 seconds
Prefill latency: 0.14857119135558605 sec
Decode latency: 3.5854931715875864 sec
Compilation time: 3.74 seconds
Prefill latency: 0.1487723719328642 sec
Decode latency: 3.6093947514891624 sec
Prefill latency: 0.14906974136829376 sec
Decode latency: 3.576904259622097 sec
Prefill latency: 0.14932680875062943 sec
Decode latency: 3.609563944861293 sec
Prefill latency: 0.1492365226149559 sec
Decode latency: 3.5289388317614794 sec
Prefill latency: 0.1495555266737938 sec
Decode latency: 3.585271680727601 sec
Time for inference 1: 3.74 sec total, 274.13 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4114.65 GB/s
FLOPS achieved: 20.57 TF/s

Prefill latency: 0.14884604886174202 sec
Decode latency: 3.6082037538290024 sec
Time for inference 2: 3.76 sec total, 272.51 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4090.33 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.1496071293950081 sec
Decode latency: 3.608072478324175 sec
Time for inference 3: 3.76 sec total, 272.46 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4089.56 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.14879685081541538 sec
Decode latency: 3.5469175092875957 sec
Time for inference 4: 3.70 sec total, 277.02 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4158.00 GB/s
FLOPS achieved: 20.79 TF/s

Prefill latency: 0.14908424764871597 sec
Decode latency: 3.6070956233888865 sec
Time for inference 5: 3.76 sec total, 272.57 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4091.21 GB/s
FLOPS achieved: 20.46 TF/s

Prefill latency: 0.1506040021777153 sec
Decode latency: 3.607519393786788 sec
Time for inference 6: 3.76 sec total, 272.43 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4089.13 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.1503034047782421 sec
Decode latency: 3.607666291296482 sec
Time for inference 7: 3.76 sec total, 272.44 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4089.29 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.1498917955905199 sec
Decode latency: 3.607944019138813 sec
Time for inference 8: 3.76 sec total, 272.45 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4089.50 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.14995080046355724 sec
Decode latency: 3.6081256587058306 sec
Time for inference 9: 3.76 sec total, 272.44 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4089.24 GB/s
FLOPS achieved: 20.45 TF/s

Prefill latency: 0.149608938023448 sec
Decode latency: 3.6076888740062714 sec
Time for inference 10: 3.76 sec total, 272.49 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4090.09 GB/s
FLOPS achieved: 20.45 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5995 sec
Average prefill latency: 0.1496 sec
Average tokens/sec: 273.09
Memory used: 21.21 GB
