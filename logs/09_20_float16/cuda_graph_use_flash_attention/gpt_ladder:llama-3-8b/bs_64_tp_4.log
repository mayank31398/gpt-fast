W0920 08:27:54.689000 23430268147520 torch/distributed/run.py:779] 
W0920 08:27:54.689000 23430268147520 torch/distributed/run.py:779] *****************************************
W0920 08:27:54.689000 23430268147520 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 08:27:54.689000 23430268147520 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.09 seconds
Prefill latency: 0.8322116676717997 sec
Decode latency: 5.90595281496644 sec
Compilation time: 6.72 seconds
Compilation time: 6.72 seconds
Compilation time: 6.72 secondsCompilation time: 6.74 seconds

Prefill latency: 0.8248332515358925 sec
Decode latency: 5.906643407419324 sec
Prefill latency: 0.8264220152050257 sec
Decode latency: 5.907380197197199 sec
Prefill latency: 0.8242517877370119 sec
Decode latency: 5.91051765717566 sec
Prefill latency: 0.8300801627337933 sec
Decode latency: 5.904083527624607 sec
Prefill latency: 0.8276470620185137 sec
Decode latency: 5.907074086368084 sec
Time for inference 1: 6.74 sec total, 2432.53 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11045.79 GB/s
FLOPS achieved: 55.23 TF/s

Prefill latency: 0.8312253411859274 sec
Decode latency: 5.9054017551243305 sec
Time for inference 2: 6.74 sec total, 2431.77 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11042.33 GB/s
FLOPS achieved: 55.21 TF/s

Prefill latency: 0.8286516219377518 sec
Decode latency: 5.905101485550404 sec
Time for inference 3: 6.73 sec total, 2432.83 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11047.13 GB/s
FLOPS achieved: 55.24 TF/s

Prefill latency: 0.8281774502247572 sec
Decode latency: 5.905983740463853 sec
Time for inference 4: 6.73 sec total, 2432.70 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11046.55 GB/s
FLOPS achieved: 55.23 TF/s

Prefill latency: 0.8262400478124619 sec
Decode latency: 5.907017460092902 sec
Time for inference 5: 6.73 sec total, 2433.03 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11048.05 GB/s
FLOPS achieved: 55.24 TF/s

Prefill latency: 0.8294333554804325 sec
Decode latency: 5.906538285315037 sec
Time for inference 6: 6.74 sec total, 2432.03 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11043.51 GB/s
FLOPS achieved: 55.22 TF/s

Prefill latency: 0.8285870142281055 sec
Decode latency: 5.9074185360223055 sec
Time for inference 7: 6.74 sec total, 2431.99 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11043.36 GB/s
FLOPS achieved: 55.22 TF/s

Prefill latency: 0.8279345147311687 sec
Decode latency: 5.904830735176802 sec
Time for inference 8: 6.73 sec total, 2433.18 tokens/sec
Decode latency: 5.90 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11048.73 GB/s
FLOPS achieved: 55.24 TF/s

Prefill latency: 0.8249759878963232 sec
Decode latency: 5.904424795880914 sec
Time for inference 9: 6.73 sec total, 2434.41 tokens/sec
Decode latency: 5.90 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 11054.35 GB/s
FLOPS achieved: 55.27 TF/s

Prefill latency: 0.8295464795082808 sec
Decode latency: 5.905269669368863 sec
Time for inference 10: 6.74 sec total, 2432.46 tokens/sec
Decode latency: 5.91 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 11045.49 GB/s
FLOPS achieved: 55.23 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.9059 sec
Average prefill latency: 0.8282 sec
Average tokens/sec: 2432.69
Memory used: 76.82 GB
