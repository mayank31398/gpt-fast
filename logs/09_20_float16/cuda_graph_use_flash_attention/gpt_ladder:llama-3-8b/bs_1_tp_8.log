W0920 07:59:02.182000 22479755581248 torch/distributed/run.py:779] 
W0920 07:59:02.182000 22479755581248 torch/distributed/run.py:779] *****************************************
W0920 07:59:02.182000 22479755581248 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0920 07:59:02.182000 22479755581248 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.09 seconds
[rank0]:[W920 07:59:35.392639599 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank6]:[W920 07:59:35.404159944 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.018107570707798004 sec
Decode latency: 1.5734206847846508 sec
Compilation time: 1.59 seconds
Compilation time: 1.62 seconds
Compilation time: 1.63 seconds
Compilation time: 1.59 seconds
Compilation time: 1.60 seconds
Compilation time: 1.59 seconds
Compilation time: 1.60 seconds
Compilation time: 1.59 seconds
Prefill latency: 0.014978768303990364 sec
Decode latency: 1.5727764926850796 sec
Prefill latency: 0.015123043209314346 sec
Decode latency: 1.5729248225688934 sec
Prefill latency: 0.015241486951708794 sec
Decode latency: 1.5733659528195858 sec
Prefill latency: 0.0152966920286417 sec
Decode latency: 1.5744200590997934 sec
Prefill latency: 0.015114055946469307 sec
Decode latency: 1.5740686934441328 sec
Time for inference 1: 1.59 sec total, 161.03 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.23 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.015148479491472244 sec
Decode latency: 1.5736416596919298 sec
Time for inference 2: 1.59 sec total, 161.05 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.29 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.015012603253126144 sec
Decode latency: 1.5738840512931347 sec
Time for inference 3: 1.59 sec total, 161.04 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.28 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.01516135036945343 sec
Decode latency: 1.5739652570337057 sec
Time for inference 4: 1.59 sec total, 161.02 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.23 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.0150822214782238 sec
Decode latency: 1.5739541556686163 sec
Time for inference 5: 1.59 sec total, 161.03 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.24 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.015093415975570679 sec
Decode latency: 1.5737867522984743 sec
Time for inference 6: 1.59 sec total, 161.05 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.29 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.015138544142246246 sec
Decode latency: 1.5733547452837229 sec
Time for inference 7: 1.59 sec total, 161.10 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.43 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.014954900369048119 sec
Decode latency: 1.573159309104085 sec
Time for inference 8: 1.59 sec total, 161.13 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 450.52 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.015210045501589775 sec
Decode latency: 1.5731843449175358 sec
Time for inference 9: 1.59 sec total, 161.10 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.45 GB/s
FLOPS achieved: 2.25 TF/s

Prefill latency: 0.01511450856924057 sec
Decode latency: 1.5734477527439594 sec
Time for inference 10: 1.59 sec total, 161.09 tokens/sec
Decode latency: 1.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 450.41 GB/s
FLOPS achieved: 2.25 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.5736 sec
Average prefill latency: 0.0151 sec
Average tokens/sec: 161.06
Memory used: 5.00 GB
