flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.24 seconds
Prefill latency: 0.29409942403435707 sec
Decode latency: 4.535902760922909 sec
Compilation time: 4.83 seconds
Prefill latency: 0.2959028519690037 sec
Decode latency: 4.535134524106979 sec
Prefill latency: 0.2962721735239029 sec
Decode latency: 4.535141052678227 sec
Prefill latency: 0.2949125003069639 sec
Decode latency: 4.535833697766066 sec
Prefill latency: 0.29806518740952015 sec
Decode latency: 4.490244211629033 sec
Prefill latency: 0.29839265532791615 sec
Decode latency: 4.535815514624119 sec
Time for inference 1: 4.83 sec total, 423.58 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6357.93 GB/s
FLOPS achieved: 31.79 TF/s

Prefill latency: 0.2957776878029108 sec
Decode latency: 4.450430527329445 sec
Time for inference 2: 4.75 sec total, 431.45 tokens/sec
Decode latency: 4.45 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6475.93 GB/s
FLOPS achieved: 32.38 TF/s

Prefill latency: 0.2970942724496126 sec
Decode latency: 4.537283688783646 sec
Time for inference 3: 4.83 sec total, 423.58 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6357.87 GB/s
FLOPS achieved: 31.79 TF/s

Prefill latency: 0.2985012922435999 sec
Decode latency: 4.536746783182025 sec
Time for inference 4: 4.84 sec total, 423.49 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6356.48 GB/s
FLOPS achieved: 31.78 TF/s

Prefill latency: 0.2955044563859701 sec
Decode latency: 4.539665926247835 sec
Time for inference 5: 4.84 sec total, 423.50 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6356.72 GB/s
FLOPS achieved: 31.78 TF/s

Prefill latency: 0.2975025847554207 sec
Decode latency: 4.539980864152312 sec
Time for inference 6: 4.84 sec total, 423.30 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6353.60 GB/s
FLOPS achieved: 31.77 TF/s

Prefill latency: 0.2979842834174633 sec
Decode latency: 4.537423944100738 sec
Time for inference 7: 4.84 sec total, 423.49 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6356.47 GB/s
FLOPS achieved: 31.78 TF/s

Prefill latency: 0.2968439534306526 sec
Decode latency: 4.537377009168267 sec
Time for inference 8: 4.83 sec total, 423.59 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6358.02 GB/s
FLOPS achieved: 31.79 TF/s

Prefill latency: 0.29627877101302147 sec
Decode latency: 4.5377899799495935 sec
Time for inference 9: 4.83 sec total, 423.61 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6358.28 GB/s
FLOPS achieved: 31.79 TF/s

Prefill latency: 0.2975211888551712 sec
Decode latency: 4.538518620654941 sec
Time for inference 10: 4.84 sec total, 423.42 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6355.54 GB/s
FLOPS achieved: 31.78 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5291 sec
Average prefill latency: 0.2971 sec
Average tokens/sec: 424.30
Memory used: 26.20 GB
