flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.01 seconds
Prefill latency: 0.032608695910312235 sec
Decode latency: 2.57485526392702 sec
Compilation time: 2.61 seconds
Prefill latency: 0.03221533400937915 sec
Decode latency: 2.574720385018736 sec
Prefill latency: 0.03219319798517972 sec
Decode latency: 2.466174022993073 sec
Prefill latency: 0.03228484699502587 sec
Decode latency: 2.4745964870089665 sec
Prefill latency: 0.032246933900751173 sec
Decode latency: 2.5727807979565114 sec
Prefill latency: 0.03222917299717665 sec
Decode latency: 2.5742642839904875 sec
Time for inference 1: 2.61 sec total, 98.19 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.44 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.03226288908626884 sec
Decode latency: 2.569605426979251 sec
Time for inference 2: 2.60 sec total, 98.36 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 690.68 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.0322627080604434 sec
Decode latency: 2.57209663791582 sec
Time for inference 3: 2.61 sec total, 98.26 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.97 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.032289774040691555 sec
Decode latency: 2.571909418911673 sec
Time for inference 4: 2.61 sec total, 98.27 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 690.03 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.032238518935628235 sec
Decode latency: 2.573237507021986 sec
Time for inference 5: 2.61 sec total, 98.23 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.72 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.03225650801323354 sec
Decode latency: 2.572490215068683 sec
Time for inference 6: 2.61 sec total, 98.26 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.93 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.03224033897276968 sec
Decode latency: 2.5728628089418635 sec
Time for inference 7: 2.61 sec total, 98.24 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.83 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.03224884101655334 sec
Decode latency: 2.574001305969432 sec
Time for inference 8: 2.61 sec total, 98.20 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.52 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.032298647915013134 sec
Decode latency: 2.574057486024685 sec
Time for inference 9: 2.61 sec total, 98.19 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 689.48 GB/s
FLOPS achieved: 3.45 TF/s

Prefill latency: 0.032291973009705544 sec
Decode latency: 2.4611780380364507 sec
Time for inference 10: 2.49 sec total, 102.64 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 720.69 GB/s
FLOPS achieved: 3.60 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5616 sec
Average prefill latency: 0.0323 sec
Average tokens/sec: 98.68
Memory used: 8.58 GB
Done. we are killing the process
