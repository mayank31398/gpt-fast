W1001 04:15:22.312000 23400040593216 torch/distributed/run.py:779] 
W1001 04:15:22.312000 23400040593216 torch/distributed/run.py:779] *****************************************
W1001 04:15:22.312000 23400040593216 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:15:22.312000 23400040593216 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.03 seconds
Prefill latency: 0.2530758719658479 sec
Decode latency: 2.9996323350351304 sec
Compilation time: 3.22 seconds
Compilation time: 3.25 seconds
Prefill latency: 0.21322964096907526 sec
Decode latency: 3.000513771898113 sec
Prefill latency: 0.21482443099375814 sec
Decode latency: 3.0012984049972147 sec
Prefill latency: 0.2137081710388884 sec
Decode latency: 3.001105672097765 sec
Prefill latency: 0.2139832250541076 sec
Decode latency: 2.994104615994729 sec
Prefill latency: 0.21345180098433048 sec
Decode latency: 2.9949086910346523 sec
Time for inference 1: 3.21 sec total, 638.17 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.89 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21413022303022444 sec
Decode latency: 2.996587692061439 sec
Time for inference 2: 3.21 sec total, 637.69 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2311.16 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.2143731649266556 sec
Decode latency: 2.9944240489276126 sec
Time for inference 3: 3.21 sec total, 638.03 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.39 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21387474797666073 sec
Decode latency: 2.994935070979409 sec
Time for inference 4: 3.21 sec total, 638.04 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.41 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21412540809251368 sec
Decode latency: 2.9952348029473796 sec
Time for inference 5: 3.21 sec total, 637.95 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.08 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21402261697221547 sec
Decode latency: 2.9959000820526853 sec
Time for inference 6: 3.21 sec total, 637.86 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2311.76 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21481639903504401 sec
Decode latency: 2.994958049035631 sec
Time for inference 7: 3.21 sec total, 637.90 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2311.89 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21427005995064974 sec
Decode latency: 2.995005083968863 sec
Time for inference 8: 3.21 sec total, 637.99 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.23 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.21363303298130631 sec
Decode latency: 2.9948630640283227 sec
Time for inference 9: 3.21 sec total, 638.14 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2312.78 GB/s
FLOPS achieved: 11.56 TF/s

Prefill latency: 0.2144622029736638 sec
Decode latency: 2.9953893529018387 sec
Time for inference 10: 3.21 sec total, 637.88 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2311.85 GB/s
FLOPS achieved: 11.56 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9952 sec
Average prefill latency: 0.2141 sec
Average tokens/sec: 637.96
Memory used: 9.07 GB
Done. we are killing the process
