flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 1.6154041750123724 sec
Decode latency: 12.792921724030748 sec
Compilation time: 14.41 seconds
Prefill latency: 1.6200681530172005 sec
Decode latency: 12.792722960934043 sec
Prefill latency: 1.6259128680685535 sec
Decode latency: 12.7897482420085 sec
Prefill latency: 1.6293469759402797 sec
Decode latency: 12.79191134904977 sec
Prefill latency: 1.6271388359600678 sec
Decode latency: 12.791715970961377 sec
Prefill latency: 1.627300722990185 sec
Decode latency: 12.79261188104283 sec
Time for inference 1: 14.42 sec total, 1136.12 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.45 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6264240050222725 sec
Decode latency: 12.79310305393301 sec
Time for inference 2: 14.42 sec total, 1136.16 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.71 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6256739749806002 sec
Decode latency: 12.790832358994521 sec
Time for inference 3: 14.42 sec total, 1136.38 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7979.27 GB/s
FLOPS achieved: 39.90 TF/s

Prefill latency: 1.6277889570919797 sec
Decode latency: 12.792805216042325 sec
Time for inference 4: 14.42 sec total, 1136.07 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.09 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6260639820247889 sec
Decode latency: 12.792616688995622 sec
Time for inference 5: 14.42 sec total, 1136.21 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7978.08 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.626046292949468 sec
Decode latency: 12.793568050954491 sec
Time for inference 6: 14.42 sec total, 1136.15 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.66 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6255568349733949 sec
Decode latency: 12.79243170202244 sec
Time for inference 7: 14.42 sec total, 1136.27 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7978.46 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6259012100053951 sec
Decode latency: 12.790365591994487 sec
Time for inference 8: 14.42 sec total, 1136.40 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7979.38 GB/s
FLOPS achieved: 39.90 TF/s

Prefill latency: 1.6287191109731793 sec
Decode latency: 12.79305439000018 sec
Time for inference 9: 14.42 sec total, 1135.97 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7976.39 GB/s
FLOPS achieved: 39.88 TF/s

Prefill latency: 1.6261598609853536 sec
Decode latency: 12.792233143001795 sec
Time for inference 10: 14.42 sec total, 1136.23 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7978.20 GB/s
FLOPS achieved: 39.89 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.7924 sec
Average prefill latency: 1.6266 sec
Average tokens/sec: 1136.20
Memory used: 62.86 GB
Done. we are killing the process
