flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.2031829219777137 sec
Decode latency: 3.620469521963969 sec
Compilation time: 3.82 seconds
Prefill latency: 0.20359295594971627 sec
Decode latency: 3.6206368090352044 sec
Prefill latency: 0.20330656901933253 sec
Decode latency: 3.6201228089630604 sec
Prefill latency: 0.20415039802901447 sec
Decode latency: 3.6208812460536137 sec
Prefill latency: 0.20350120798684657 sec
Decode latency: 3.620588591089472 sec
Prefill latency: 0.20396331802476197 sec
Decode latency: 3.6203377009369433 sec
Time for inference 1: 3.82 sec total, 535.43 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.60 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.2043823921121657 sec
Decode latency: 3.620434068958275 sec
Time for inference 2: 3.83 sec total, 535.36 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.10 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.20385961199644953 sec
Decode latency: 3.621333451010287 sec
Time for inference 3: 3.83 sec total, 535.29 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3758.61 GB/s
FLOPS achieved: 18.79 TF/s

Prefill latency: 0.20318239892367274 sec
Decode latency: 3.62068418902345 sec
Time for inference 4: 3.82 sec total, 535.45 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.75 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.20328392810188234 sec
Decode latency: 3.6204796909587458 sec
Time for inference 5: 3.82 sec total, 535.47 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.91 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.20348695199936628 sec
Decode latency: 3.6209787919651717 sec
Time for inference 6: 3.83 sec total, 535.39 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.32 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.20349308697041124 sec
Decode latency: 3.621451203012839 sec
Time for inference 7: 3.83 sec total, 535.34 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3758.96 GB/s
FLOPS achieved: 18.79 TF/s

Prefill latency: 0.2032477610046044 sec
Decode latency: 3.6208827230148017 sec
Time for inference 8: 3.82 sec total, 535.45 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.71 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.20353595004417002 sec
Decode latency: 3.620718846912496 sec
Time for inference 9: 3.82 sec total, 535.43 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3759.62 GB/s
FLOPS achieved: 18.80 TF/s

Prefill latency: 0.2031430029310286 sec
Decode latency: 3.6201706510037184 sec
Time for inference 10: 3.82 sec total, 535.57 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3760.54 GB/s
FLOPS achieved: 18.80 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6207 sec
Average prefill latency: 0.2036 sec
Average tokens/sec: 535.42
Memory used: 14.62 GB
Done. we are killing the process
