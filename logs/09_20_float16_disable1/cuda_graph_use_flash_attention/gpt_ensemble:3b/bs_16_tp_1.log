flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.4002181950490922 sec
Decode latency: 5.240751289064065 sec
Compilation time: 5.64 seconds
Prefill latency: 0.3984128589509055 sec
Decode latency: 5.241220997064374 sec
Prefill latency: 0.39863441709894687 sec
Decode latency: 5.240858795936219 sec
Prefill latency: 0.39841677201911807 sec
Decode latency: 5.24139383691363 sec
Prefill latency: 0.3987435520393774 sec
Decode latency: 5.241294046049006 sec
Prefill latency: 0.39788228704128414 sec
Decode latency: 5.2408416089601815 sec
Time for inference 1: 5.64 sec total, 726.30 tokens/sec
Decode latency: 5.24 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5099.82 GB/s
FLOPS achieved: 25.50 TF/s

Prefill latency: 0.3983864920446649 sec
Decode latency: 5.2407259120373055 sec
Time for inference 2: 5.64 sec total, 726.24 tokens/sec
Decode latency: 5.24 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5099.42 GB/s
FLOPS achieved: 25.50 TF/s

Prefill latency: 0.39768910699058324 sec
Decode latency: 5.251264013000764 sec
Time for inference 3: 5.65 sec total, 725.00 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5090.66 GB/s
FLOPS achieved: 25.45 TF/s

Prefill latency: 0.39776960806921124 sec
Decode latency: 5.241059135994874 sec
Time for inference 4: 5.64 sec total, 726.29 tokens/sec
Decode latency: 5.24 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5099.76 GB/s
FLOPS achieved: 25.50 TF/s

Prefill latency: 0.39817778195720166 sec
Decode latency: 5.253807922941633 sec
Time for inference 5: 5.65 sec total, 724.59 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5087.78 GB/s
FLOPS achieved: 25.44 TF/s

Prefill latency: 0.4035599649650976 sec
Decode latency: 5.254242999013513 sec
Time for inference 6: 5.66 sec total, 723.85 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5082.60 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3985402720281854 sec
Decode latency: 5.252118875039741 sec
Time for inference 7: 5.65 sec total, 724.76 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5089.02 GB/s
FLOPS achieved: 25.45 TF/s

Prefill latency: 0.4029205939732492 sec
Decode latency: 5.25257892801892 sec
Time for inference 8: 5.66 sec total, 724.16 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5084.76 GB/s
FLOPS achieved: 25.42 TF/s

Prefill latency: 0.39829498599283397 sec
Decode latency: 5.251519088051282 sec
Time for inference 9: 5.65 sec total, 724.87 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5089.77 GB/s
FLOPS achieved: 25.45 TF/s

Prefill latency: 0.3980276129441336 sec
Decode latency: 5.252137777977623 sec
Time for inference 10: 5.65 sec total, 724.81 tokens/sec
Decode latency: 5.25 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5089.37 GB/s
FLOPS achieved: 25.45 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.2490 sec
Average prefill latency: 0.3991 sec
Average tokens/sec: 725.09
Memory used: 21.44 GB
Done. we are killing the process
