W1001 04:18:59.398000 22831016761152 torch/distributed/run.py:779] 
W1001 04:18:59.398000 22831016761152 torch/distributed/run.py:779] *****************************************
W1001 04:18:59.398000 22831016761152 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:18:59.398000 22831016761152 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.4387304229894653 sec
Decode latency: 3.5731818629428744 sec
Compilation time: 4.01 seconds
Compilation time: 4.01 seconds
Prefill latency: 0.41379139095079154 sec
Decode latency: 3.572840425069444 sec
Prefill latency: 0.415976794087328 sec
Decode latency: 3.5726802659919485 sec
Prefill latency: 0.4152820650488138 sec
Decode latency: 3.5721223140135407 sec
Prefill latency: 0.4161586939590052 sec
Decode latency: 3.566465912037529 sec
Prefill latency: 0.41498096100986004 sec
Decode latency: 3.5657513339538127 sec
Time for inference 1: 3.98 sec total, 1028.71 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.41 sec
Bandwidth achieved: 3728.29 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.4146721209399402 sec
Decode latency: 3.5661443260032684 sec
Time for inference 2: 3.98 sec total, 1028.70 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.41 sec
Bandwidth achieved: 3728.28 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.4158718070248142 sec
Decode latency: 3.5642528330208734 sec
Time for inference 3: 3.98 sec total, 1028.91 tokens/sec
Decode latency: 3.56 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 3729.04 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.4149201479740441 sec
Decode latency: 3.565766478073783 sec
Time for inference 4: 3.98 sec total, 1028.77 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.41 sec
Bandwidth achieved: 3728.51 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.4157310660229996 sec
Decode latency: 3.5642968789907172 sec
Time for inference 5: 3.98 sec total, 1028.93 tokens/sec
Decode latency: 3.56 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 3729.12 GB/s
FLOPS achieved: 18.65 TF/s

Prefill latency: 0.41452666907571256 sec
Decode latency: 3.5677914230618626 sec
Time for inference 6: 3.98 sec total, 1028.31 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.41 sec
Bandwidth achieved: 3726.87 GB/s
FLOPS achieved: 18.63 TF/s

Prefill latency: 0.41670977498870343 sec
Decode latency: 3.5657308530062437 sec
Time for inference 7: 3.98 sec total, 1028.23 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 3726.58 GB/s
FLOPS achieved: 18.63 TF/s

Prefill latency: 0.414977727108635 sec
Decode latency: 3.5657032100716606 sec
Time for inference 8: 3.98 sec total, 1028.72 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.41 sec
Bandwidth achieved: 3728.33 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.415849027922377 sec
Decode latency: 3.5658802249236032 sec
Time for inference 9: 3.98 sec total, 1028.47 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 3727.44 GB/s
FLOPS achieved: 18.64 TF/s

Prefill latency: 0.41572023706976324 sec
Decode latency: 3.5660573499044403 sec
Time for inference 10: 3.98 sec total, 1028.48 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 3727.48 GB/s
FLOPS achieved: 18.64 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5657 sec
Average prefill latency: 0.4154 sec
Average tokens/sec: 1028.62
Memory used: 13.76 GB
Done. we are killing the process
