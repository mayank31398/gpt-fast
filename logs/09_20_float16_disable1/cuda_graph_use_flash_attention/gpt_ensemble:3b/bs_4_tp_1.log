flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.10377883608452976 sec
Decode latency: 3.1303567049326375 sec
Compilation time: 3.24 seconds
Prefill latency: 0.10342711792327464 sec
Decode latency: 3.129647938068956 sec
Prefill latency: 0.10341071209404618 sec
Decode latency: 3.13035110803321 sec
Prefill latency: 0.10362029599491507 sec
Decode latency: 3.1301786459516734 sec
Prefill latency: 0.10368161404039711 sec
Decode latency: 3.1321529579581693 sec
Prefill latency: 0.10385974706150591 sec
Decode latency: 3.1318880890030414 sec
Time for inference 1: 3.24 sec total, 316.39 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.55 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10359225305728614 sec
Decode latency: 3.1322012370219454 sec
Time for inference 2: 3.24 sec total, 316.37 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.41 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10352919099386781 sec
Decode latency: 3.129151249071583 sec
Time for inference 3: 3.23 sec total, 316.67 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2223.53 GB/s
FLOPS achieved: 11.12 TF/s

Prefill latency: 0.10344706394243985 sec
Decode latency: 3.130106108961627 sec
Time for inference 4: 3.23 sec total, 316.60 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2223.05 GB/s
FLOPS achieved: 11.12 TF/s

Prefill latency: 0.10391869000159204 sec
Decode latency: 3.1311634299345315 sec
Time for inference 5: 3.24 sec total, 316.46 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2222.04 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10377755702938884 sec
Decode latency: 3.131025917013176 sec
Time for inference 6: 3.24 sec total, 316.49 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2222.25 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10341218195389956 sec
Decode latency: 3.1306258339900523 sec
Time for inference 7: 3.23 sec total, 316.56 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2222.75 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10346729098819196 sec
Decode latency: 3.130259654019028 sec
Time for inference 8: 3.23 sec total, 316.59 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2222.99 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.1038686620304361 sec
Decode latency: 3.130688105011359 sec
Time for inference 9: 3.24 sec total, 316.50 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2222.33 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10350026900414377 sec
Decode latency: 3.1317030750215054 sec
Time for inference 10: 3.24 sec total, 316.44 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.94 GB/s
FLOPS achieved: 11.11 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1309 sec
Average prefill latency: 0.1036 sec
Average tokens/sec: 316.51
Memory used: 11.19 GB
Done. we are killing the process
