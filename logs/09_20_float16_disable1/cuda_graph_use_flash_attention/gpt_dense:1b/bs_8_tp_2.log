W1001 03:10:12.885000 23226820220736 torch/distributed/run.py:779] 
W1001 03:10:12.885000 23226820220736 torch/distributed/run.py:779] *****************************************
W1001 03:10:12.885000 23226820220736 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:10:12.885000 23226820220736 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.21901100501418114 sec
Decode latency: 2.7481143539771438 sec
Compilation time: 2.99 seconds
Compilation time: 2.97 seconds
Prefill latency: 0.20216542994603515 sec
Decode latency: 2.744713630992919 sec
Prefill latency: 0.20154208806343377 sec
Decode latency: 2.743710248032585 sec
Prefill latency: 0.20325296907685697 sec
Decode latency: 2.7468719800235704 sec
Prefill latency: 0.20118001103401184 sec
Decode latency: 2.7428708949591964 sec
Prefill latency: 0.20243675797246397 sec
Decode latency: 2.7461375230923295 sec
Time for inference 1: 2.95 sec total, 694.41 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 891.42 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.2000174499116838 sec
Decode latency: 2.7447142039891332 sec
Time for inference 2: 2.95 sec total, 695.29 tokens/sec
Decode latency: 2.74 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 892.55 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.20310146105475724 sec
Decode latency: 2.746128277038224 sec
Time for inference 3: 2.95 sec total, 694.24 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 891.20 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.201600884902291 sec
Decode latency: 2.744533209945075 sec
Time for inference 4: 2.95 sec total, 694.98 tokens/sec
Decode latency: 2.74 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 892.16 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.2034852779470384 sec
Decode latency: 2.7466059901053086 sec
Time for inference 5: 2.95 sec total, 693.97 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 890.86 GB/s
FLOPS achieved: 4.45 TF/s

Prefill latency: 0.20068823301699013 sec
Decode latency: 2.745195141993463 sec
Time for inference 6: 2.95 sec total, 694.99 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 892.16 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.20233692007604986 sec
Decode latency: 2.745666117989458 sec
Time for inference 7: 2.95 sec total, 694.51 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 891.54 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.20048728899564594 sec
Decode latency: 2.744074497022666 sec
Time for inference 8: 2.95 sec total, 695.32 tokens/sec
Decode latency: 2.74 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 892.59 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.2028906539781019 sec
Decode latency: 2.7469236999750137 sec
Time for inference 9: 2.95 sec total, 694.10 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 891.02 GB/s
FLOPS achieved: 4.46 TF/s

Prefill latency: 0.20187709596939385 sec
Decode latency: 2.745673922006972 sec
Time for inference 10: 2.95 sec total, 694.60 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 891.66 GB/s
FLOPS achieved: 4.46 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7456 sec
Average prefill latency: 0.2019 sec
Average tokens/sec: 694.64
Memory used: 6.68 GB
Done. we are killing the process
