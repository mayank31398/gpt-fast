W0930 20:18:55.161000 23382742705984 torch/distributed/run.py:779] 
W0930 20:18:55.161000 23382742705984 torch/distributed/run.py:779] *****************************************
W0930 20:18:55.161000 23382742705984 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:18:55.161000 23382742705984 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=320, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.26 seconds
Prefill latency: 0.06062818900682032 sec
Decode latency: 2.5970073549542576 sec
Compilation time: 2.62 seconds
Compilation time: 2.64 seconds
Compilation time: 2.64 seconds
Compilation time: 2.65 seconds
Compilation time: 2.64 seconds
Compilation time: 2.62 seconds
Compilation time: 2.65 seconds
Compilation time: 2.66 seconds
Prefill latency: 0.018765663029626012 sec
Decode latency: 2.5952411210164428 sec
Prefill latency: 0.019344066036865115 sec
Decode latency: 2.582864964962937 sec
Prefill latency: 0.025201605050824583 sec
Decode latency: 2.5822551819728687 sec
Prefill latency: 0.01861186104360968 sec
Decode latency: 2.57384897605516 sec
Prefill latency: 0.01877988688647747 sec
Decode latency: 2.5842078069690615 sec
Time for inference 1: 2.60 sec total, 98.32 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.61 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.02116093202494085 sec
Decode latency: 2.6022898480296135 sec
Time for inference 2: 2.62 sec total, 97.54 tokens/sec
Decode latency: 2.60 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.30 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.02492957399226725 sec
Decode latency: 2.5997426050016657 sec
Time for inference 3: 2.63 sec total, 97.47 tokens/sec
Decode latency: 2.60 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.27 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.018717356957495213 sec
Decode latency: 2.5845204549841583 sec
Time for inference 4: 2.60 sec total, 98.29 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.60 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.021646343055181205 sec
Decode latency: 2.5846996780019253 sec
Time for inference 5: 2.61 sec total, 98.19 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.56 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.018386917072348297 sec
Decode latency: 2.582641136017628 sec
Time for inference 6: 2.60 sec total, 98.39 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.64 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.018355966079980135 sec
Decode latency: 2.5730142389656976 sec
Time for inference 7: 2.59 sec total, 98.75 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.79 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.018862072029151022 sec
Decode latency: 2.589798448025249 sec
Time for inference 8: 2.61 sec total, 98.10 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.52 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.0190315650543198 sec
Decode latency: 2.570940679986961 sec
Time for inference 9: 2.59 sec total, 98.81 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.81 GB/s
FLOPS achieved: 0.20 TF/s

Prefill latency: 0.018635791959241033 sec
Decode latency: 2.569886293960735 sec
Time for inference 10: 2.59 sec total, 98.85 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 39.83 GB/s
FLOPS achieved: 0.20 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5842 sec
Average prefill latency: 0.0199 sec
Average tokens/sec: 98.27
Memory used: 1.10 GB
Done. we are killing the process
