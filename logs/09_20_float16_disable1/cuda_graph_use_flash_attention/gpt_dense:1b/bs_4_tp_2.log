W1001 03:06:40.282000 23127471818560 torch/distributed/run.py:779] 
W1001 03:06:40.282000 23127471818560 torch/distributed/run.py:779] *****************************************
W1001 03:06:40.282000 23127471818560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:06:40.282000 23127471818560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.13229640200734138 sec
Decode latency: 2.524915787973441 sec
Compilation time: 2.64 seconds
Compilation time: 2.66 seconds
Prefill latency: 0.10368556901812553 sec
Decode latency: 2.5260302589740604 sec
Prefill latency: 0.10353381000459194 sec
Decode latency: 2.5260771239409223 sec
Prefill latency: 0.10405934602022171 sec
Decode latency: 2.5275810080347583 sec
Prefill latency: 0.10361766000278294 sec
Decode latency: 2.522177260951139 sec
Prefill latency: 0.10379766090773046 sec
Decode latency: 2.523455586982891 sec
Time for inference 1: 2.63 sec total, 389.65 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.19 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10367823799606413 sec
Decode latency: 2.521943203988485 sec
Time for inference 2: 2.63 sec total, 389.88 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.50 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10391071496997029 sec
Decode latency: 2.5231215400854126 sec
Time for inference 3: 2.63 sec total, 389.68 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.24 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10397418099455535 sec
Decode latency: 2.5223734319442883 sec
Time for inference 4: 2.63 sec total, 389.76 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.34 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10395821009296924 sec
Decode latency: 2.5228799929609522 sec
Time for inference 5: 2.63 sec total, 389.71 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.27 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10383162007201463 sec
Decode latency: 2.5219463739776984 sec
Time for inference 6: 2.63 sec total, 389.88 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.49 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10381380503531545 sec
Decode latency: 2.5230019609443843 sec
Time for inference 7: 2.63 sec total, 389.69 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.25 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10354299400933087 sec
Decode latency: 2.5212407609215006 sec
Time for inference 8: 2.63 sec total, 390.00 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.65 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10396004107315093 sec
Decode latency: 2.5231255230028182 sec
Time for inference 9: 2.63 sec total, 389.64 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.19 GB/s
FLOPS achieved: 2.50 TF/s

Prefill latency: 0.10351996903773397 sec
Decode latency: 2.5218682560371235 sec
Time for inference 10: 2.63 sec total, 389.91 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 500.52 GB/s
FLOPS achieved: 2.50 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5225 sec
Average prefill latency: 0.1038 sec
Average tokens/sec: 389.78
Memory used: 4.29 GB
Done. we are killing the process
