flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.048482529004104435 sec
Decode latency: 2.5570954309077933 sec
Compilation time: 2.61 seconds
Prefill latency: 0.04821440402884036 sec
Decode latency: 2.5555756899993867 sec
Prefill latency: 0.04821045999415219 sec
Decode latency: 2.555587399052456 sec
Prefill latency: 0.048295213957317173 sec
Decode latency: 2.555862299981527 sec
Prefill latency: 0.04831602599006146 sec
Decode latency: 2.5556498480727896 sec
Prefill latency: 0.04828362597618252 sec
Decode latency: 2.5555309019982815 sec
Time for inference 1: 2.60 sec total, 393.17 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.03 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04817452002316713 sec
Decode latency: 2.5554030319908634 sec
Time for inference 2: 2.60 sec total, 393.19 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.06 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048191094072535634 sec
Decode latency: 2.5557893329532817 sec
Time for inference 3: 2.60 sec total, 393.13 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 850.93 GB/s
FLOPS achieved: 4.25 TF/s

Prefill latency: 0.04831513296812773 sec
Decode latency: 2.5551967839710414 sec
Time for inference 4: 2.60 sec total, 393.21 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.10 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048236057977192104 sec
Decode latency: 2.5555293359793723 sec
Time for inference 5: 2.60 sec total, 393.18 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.04 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048231744091026485 sec
Decode latency: 2.5557774980552495 sec
Time for inference 6: 2.60 sec total, 393.13 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 850.94 GB/s
FLOPS achieved: 4.25 TF/s

Prefill latency: 0.04826443002093583 sec
Decode latency: 2.550958501989953 sec
Time for inference 7: 2.60 sec total, 393.85 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 852.50 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04806101694703102 sec
Decode latency: 2.5507811750285327 sec
Time for inference 8: 2.60 sec total, 393.93 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 852.66 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04806231998372823 sec
Decode latency: 2.5508883660659194 sec
Time for inference 9: 2.60 sec total, 393.91 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 852.62 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048039659042842686 sec
Decode latency: 2.550223631085828 sec
Time for inference 10: 2.60 sec total, 394.02 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 852.86 GB/s
FLOPS achieved: 4.26 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5536 sec
Average prefill latency: 0.0482 sec
Average tokens/sec: 393.47
Memory used: 4.90 GB
Done. we are killing the process
