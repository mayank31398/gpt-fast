flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
[rank0]:[W930 20:23:26.222218519 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.09298567392397672 sec
Decode latency: 2.9999479479156435 sec
Compilation time: 3.09 seconds
Prefill latency: 0.09246022591833025 sec
Decode latency: 2.9977626060135663 sec
Prefill latency: 0.092319848947227 sec
Decode latency: 2.980970318079926 sec
Prefill latency: 0.09236384101677686 sec
Decode latency: 2.9976938919862732 sec
Prefill latency: 0.09240965498611331 sec
Decode latency: 2.99791810894385 sec
Prefill latency: 0.09233784698881209 sec
Decode latency: 2.998257225030102 sec
Time for inference 1: 3.09 sec total, 662.50 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1433.99 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09233701694756746 sec
Decode latency: 2.9949594730278477 sec
Time for inference 2: 3.09 sec total, 663.15 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1435.39 GB/s
FLOPS achieved: 7.18 TF/s

Prefill latency: 0.09241768391802907 sec
Decode latency: 2.997934167040512 sec
Time for inference 3: 3.09 sec total, 662.51 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.00 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.0925115030258894 sec
Decode latency: 2.997813455061987 sec
Time for inference 4: 3.09 sec total, 662.52 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.03 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09243845904711634 sec
Decode latency: 2.9963530669920146 sec
Time for inference 5: 3.09 sec total, 662.86 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.77 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09242962102871388 sec
Decode latency: 2.884097567992285 sec
Time for inference 6: 2.98 sec total, 687.88 tokens/sec
Decode latency: 2.88 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1488.92 GB/s
FLOPS achieved: 7.44 TF/s

Prefill latency: 0.0923982720123604 sec
Decode latency: 2.997556868940592 sec
Time for inference 7: 3.09 sec total, 662.64 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.28 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09239410702139139 sec
Decode latency: 2.9984400370158255 sec
Time for inference 8: 3.09 sec total, 662.45 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1433.89 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.0924437310313806 sec
Decode latency: 2.9978865439770743 sec
Time for inference 9: 3.09 sec total, 662.57 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.13 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.0924438190413639 sec
Decode latency: 2.9966602289350703 sec
Time for inference 10: 3.09 sec total, 662.82 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.68 GB/s
FLOPS achieved: 7.17 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9860 sec
Average prefill latency: 0.0924 sec
Average tokens/sec: 665.19
Memory used: 7.29 GB
Done. we are killing the process
