flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.10746927699074149 sec
Decode latency: 2.7725077848881483 sec
Compilation time: 2.88 seconds
Prefill latency: 0.10707972105592489 sec
Decode latency: 2.769258438027464 sec
Prefill latency: 0.1070475080050528 sec
Decode latency: 2.769876837031916 sec
Prefill latency: 0.10709602001588792 sec
Decode latency: 2.770006003906019 sec
Prefill latency: 0.10711048601660877 sec
Decode latency: 2.7703325951006263 sec
Prefill latency: 0.10710718901827931 sec
Decode latency: 2.769143673009239 sec
Time for inference 1: 2.88 sec total, 711.87 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1720.00 GB/s
FLOPS achieved: 8.60 TF/s

Prefill latency: 0.10710334498435259 sec
Decode latency: 2.7687271020840853 sec
Time for inference 2: 2.88 sec total, 711.98 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1720.25 GB/s
FLOPS achieved: 8.60 TF/s

Prefill latency: 0.10717059904709458 sec
Decode latency: 2.7623532010475174 sec
Time for inference 3: 2.87 sec total, 713.50 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1723.94 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10685689898673445 sec
Decode latency: 2.762480483041145 sec
Time for inference 4: 2.87 sec total, 713.57 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.11 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10691249696537852 sec
Decode latency: 2.762471839087084 sec
Time for inference 5: 2.87 sec total, 713.57 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.10 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10696307104080915 sec
Decode latency: 2.762261845986359 sec
Time for inference 6: 2.87 sec total, 713.61 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.19 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10684558493085206 sec
Decode latency: 2.762366948998533 sec
Time for inference 7: 2.87 sec total, 713.61 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.20 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10685413493774831 sec
Decode latency: 2.7623249059543014 sec
Time for inference 8: 2.87 sec total, 713.62 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.23 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10690514999441803 sec
Decode latency: 2.7623526280513033 sec
Time for inference 9: 2.87 sec total, 713.61 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.20 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.1068289470858872 sec
Decode latency: 2.762262735981494 sec
Time for inference 10: 2.87 sec total, 713.65 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.30 GB/s
FLOPS achieved: 8.62 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7637 sec
Average prefill latency: 0.1070 sec
Average tokens/sec: 713.26
Memory used: 9.32 GB
Done. we are killing the process
