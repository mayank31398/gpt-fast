flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.03 seconds
[rank0]:[W930 20:16:54.670499817 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.016487980028614402 sec
Decode latency: 2.0662262990372255 sec
Compilation time: 2.08 seconds
Prefill latency: 0.016046551056206226 sec
Decode latency: 2.064377113012597 sec
Prefill latency: 0.016035498003475368 sec
Decode latency: 2.0647729670163244 sec
Prefill latency: 0.016079111956059933 sec
Decode latency: 2.0642787200631574 sec
Prefill latency: 0.01603907998651266 sec
Decode latency: 2.064730104058981 sec
Prefill latency: 0.01606968999840319 sec
Decode latency: 2.065149158006534 sec
Time for inference 1: 2.08 sec total, 122.97 tokens/sec
Decode latency: 2.07 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.16 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01606538100168109 sec
Decode latency: 2.0646388370078057 sec
Time for inference 2: 2.08 sec total, 123.00 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.23 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016054118052124977 sec
Decode latency: 2.0030024939915165 sec
Time for inference 3: 2.02 sec total, 126.75 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 274.36 GB/s
FLOPS achieved: 1.37 TF/s

Prefill latency: 0.01608122105244547 sec
Decode latency: 1.9523399319732562 sec
Time for inference 4: 1.97 sec total, 130.01 tokens/sec
Decode latency: 1.95 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 281.41 GB/s
FLOPS achieved: 1.41 TF/s

Prefill latency: 0.01605680794455111 sec
Decode latency: 2.06503465003334 sec
Time for inference 5: 2.08 sec total, 122.98 tokens/sec
Decode latency: 2.07 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.18 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016108146053738892 sec
Decode latency: 2.0648275580024347 sec
Time for inference 6: 2.08 sec total, 122.99 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.20 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016034148051403463 sec
Decode latency: 2.064383066026494 sec
Time for inference 7: 2.08 sec total, 123.01 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.27 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01609887194354087 sec
Decode latency: 2.064290191978216 sec
Time for inference 8: 2.08 sec total, 123.02 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.27 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01604829099960625 sec
Decode latency: 2.0648737230803818 sec
Time for inference 9: 2.08 sec total, 122.99 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.20 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016041346010752022 sec
Decode latency: 2.064879874000326 sec
Time for inference 10: 2.08 sec total, 122.99 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.20 GB/s
FLOPS achieved: 1.33 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0473 sec
Average prefill latency: 0.0161 sec
Average tokens/sec: 124.07
Memory used: 3.05 GB
Done. we are killing the process
