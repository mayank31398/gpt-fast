W0930 20:34:53.891000 23107735394112 torch/distributed/run.py:779] 
W0930 20:34:53.891000 23107735394112 torch/distributed/run.py:779] *****************************************
W0930 20:34:53.891000 23107735394112 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:34:53.891000 23107735394112 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1280, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 1.6281281349947676 sec
Decode latency: 7.250221894937567 sec
Compilation time: 8.88 seconds
Compilation time: 8.88 seconds
Prefill latency: 1.5070582950720564 sec
Decode latency: 7.246134116081521 sec
Prefill latency: 1.5018697419436648 sec
Decode latency: 7.245164292049594 sec
Prefill latency: 1.513419326976873 sec
Decode latency: 7.249495049007237 sec
Prefill latency: 1.4975486641051248 sec
Decode latency: 7.246405486948788 sec
Prefill latency: 1.5111972120357677 sec
Decode latency: 7.249580709962174 sec
Time for inference 1: 8.76 sec total, 1869.93 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.51 sec
Bandwidth achieved: 2165.15 GB/s
FLOPS achieved: 10.83 TF/s

Prefill latency: 1.4954045299673453 sec
Decode latency: 7.247638700995594 sec
Time for inference 2: 8.74 sec total, 1873.76 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.50 sec
Bandwidth achieved: 2169.59 GB/s
FLOPS achieved: 10.85 TF/s

Prefill latency: 1.5128402980044484 sec
Decode latency: 7.24826166103594 sec
Time for inference 3: 8.76 sec total, 1869.89 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.51 sec
Bandwidth achieved: 2165.10 GB/s
FLOPS achieved: 10.83 TF/s

Prefill latency: 1.4992350240936503 sec
Decode latency: 7.247276504989713 sec
Time for inference 4: 8.75 sec total, 1873.01 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.50 sec
Bandwidth achieved: 2168.72 GB/s
FLOPS achieved: 10.84 TF/s

Prefill latency: 1.5145061509683728 sec
Decode latency: 7.24860027898103 sec
Time for inference 5: 8.76 sec total, 1869.43 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.51 sec
Bandwidth achieved: 2164.57 GB/s
FLOPS achieved: 10.82 TF/s

Prefill latency: 1.4988898870069534 sec
Decode latency: 7.247127586975694 sec
Time for inference 6: 8.75 sec total, 1873.11 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.50 sec
Bandwidth achieved: 2168.83 GB/s
FLOPS achieved: 10.84 TF/s

Prefill latency: 1.5048278940375894 sec
Decode latency: 7.249144549015909 sec
Time for inference 7: 8.75 sec total, 1871.39 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.50 sec
Bandwidth achieved: 2166.84 GB/s
FLOPS achieved: 10.83 TF/s

Prefill latency: 1.4948576199822128 sec
Decode latency: 7.247186294058338 sec
Time for inference 8: 8.74 sec total, 1873.96 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.49 sec
Bandwidth achieved: 2169.82 GB/s
FLOPS achieved: 10.85 TF/s

Prefill latency: 1.5068066830281168 sec
Decode latency: 7.247360983979888 sec
Time for inference 9: 8.76 sec total, 1871.37 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.51 sec
Bandwidth achieved: 2166.81 GB/s
FLOPS achieved: 10.83 TF/s

Prefill latency: 1.5000964140053838 sec
Decode latency: 7.245892302016728 sec
Time for inference 10: 8.75 sec total, 1873.14 tokens/sec
Decode latency: 7.25 sec
Prefill latency: 1.50 sec
Bandwidth achieved: 2168.87 GB/s
FLOPS achieved: 10.84 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.2478 sec
Average prefill latency: 1.5039 sec
Average tokens/sec: 1871.90
Memory used: 34.98 GB
Done. we are killing the process
