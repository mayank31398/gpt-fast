W1001 03:20:10.075000 22490340820800 torch/distributed/run.py:779] 
W1001 03:20:10.075000 22490340820800 torch/distributed/run.py:779] *****************************************
W1001 03:20:10.075000 22490340820800 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:20:10.075000 22490340820800 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
[rank1]:[W1001 03:20:21.676330327 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank0]:[W1001 03:20:21.680516379 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 1.7150269959820434 sec
Decode latency: 6.259828021982685 sec
Compilation time: 7.98 seconds
Compilation time: 7.98 seconds
Prefill latency: 1.5925087159266695 sec
Decode latency: 6.256587092997506 sec
Prefill latency: 1.5697144119767472 sec
Decode latency: 6.255714481929317 sec
Prefill latency: 1.5973911460023373 sec
Decode latency: 6.259098544018343 sec
Prefill latency: 1.5727581239771098 sec
Decode latency: 6.257783142966218 sec
Prefill latency: 1.5984712080098689 sec
Decode latency: 6.258301809895784 sec
Time for inference 1: 7.86 sec total, 2085.10 tokens/sec
Decode latency: 6.26 sec
Prefill latency: 1.60 sec
Bandwidth achieved: 2676.66 GB/s
FLOPS achieved: 13.38 TF/s

Prefill latency: 1.5717366259777918 sec
Decode latency: 6.249945548013784 sec
Time for inference 2: 7.82 sec total, 2094.44 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.57 sec
Bandwidth achieved: 2688.65 GB/s
FLOPS achieved: 13.44 TF/s

Prefill latency: 1.599972163909115 sec
Decode latency: 6.253284344100393 sec
Time for inference 3: 7.85 sec total, 2086.01 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.60 sec
Bandwidth achieved: 2677.82 GB/s
FLOPS achieved: 13.39 TF/s

Prefill latency: 1.576703395927325 sec
Decode latency: 6.251185346976854 sec
Time for inference 4: 7.83 sec total, 2092.76 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.58 sec
Bandwidth achieved: 2686.49 GB/s
FLOPS achieved: 13.43 TF/s

Prefill latency: 1.5930395900504664 sec
Decode latency: 6.254598672967404 sec
Time for inference 5: 7.85 sec total, 2087.51 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.59 sec
Bandwidth achieved: 2679.75 GB/s
FLOPS achieved: 13.40 TF/s

Prefill latency: 1.5673086809692904 sec
Decode latency: 6.253877763985656 sec
Time for inference 6: 7.82 sec total, 2094.52 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.57 sec
Bandwidth achieved: 2688.75 GB/s
FLOPS achieved: 13.44 TF/s

Prefill latency: 1.5887655150145292 sec
Decode latency: 6.253799700993113 sec
Time for inference 7: 7.84 sec total, 2088.82 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.59 sec
Bandwidth achieved: 2681.43 GB/s
FLOPS achieved: 13.41 TF/s

Prefill latency: 1.5614615710219368 sec
Decode latency: 6.252089758985676 sec
Time for inference 8: 7.81 sec total, 2096.62 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.56 sec
Bandwidth achieved: 2691.44 GB/s
FLOPS achieved: 13.46 TF/s

Prefill latency: 1.5863770151045173 sec
Decode latency: 6.253182612010278 sec
Time for inference 9: 7.84 sec total, 2089.68 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.59 sec
Bandwidth achieved: 2682.53 GB/s
FLOPS achieved: 13.41 TF/s

Prefill latency: 1.5650065270019695 sec
Decode latency: 6.253455408033915 sec
Time for inference 10: 7.82 sec total, 2095.25 tokens/sec
Decode latency: 6.25 sec
Prefill latency: 1.57 sec
Bandwidth achieved: 2689.69 GB/s
FLOPS achieved: 13.45 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.2534 sec
Average prefill latency: 1.5809 sec
Average tokens/sec: 2091.07
Memory used: 41.58 GB
Done. we are killing the process
