flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.17926299304235727 sec
Decode latency: 3.869442625087686 sec
Compilation time: 4.05 seconds
Prefill latency: 0.17864779103547335 sec
Decode latency: 3.8659614159259945 sec
Prefill latency: 0.17864296596962959 sec
Decode latency: 3.8654124869499356 sec
Prefill latency: 0.1785765839740634 sec
Decode latency: 3.75827761401888 sec
Prefill latency: 0.17865976702887565 sec
Decode latency: 3.867942371056415 sec
Prefill latency: 0.17858247202821076 sec
Decode latency: 3.865907837054692 sec
Time for inference 1: 4.05 sec total, 1012.54 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.66 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17857248603831977 sec
Decode latency: 3.744334078975953 sec
Time for inference 2: 3.92 sec total, 1043.86 tokens/sec
Decode latency: 3.74 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2259.45 GB/s
FLOPS achieved: 11.30 TF/s

Prefill latency: 0.17853391298558563 sec
Decode latency: 3.8663795290049165 sec
Time for inference 3: 4.05 sec total, 1012.39 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.33 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17863432702142745 sec
Decode latency: 3.8686185479164124 sec
Time for inference 4: 4.05 sec total, 1011.83 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2190.11 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17869120510295033 sec
Decode latency: 3.8661907690111548 sec
Time for inference 5: 4.05 sec total, 1012.45 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.45 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17863060103263706 sec
Decode latency: 3.8665439400356263 sec
Time for inference 6: 4.05 sec total, 1012.37 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.28 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17869534611236304 sec
Decode latency: 3.823684489936568 sec
Time for inference 7: 4.00 sec total, 1023.19 tokens/sec
Decode latency: 3.82 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2214.71 GB/s
FLOPS achieved: 11.07 TF/s

Prefill latency: 0.17866048798896372 sec
Decode latency: 3.866581239970401 sec
Time for inference 8: 4.05 sec total, 1012.34 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.22 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.1785859779920429 sec
Decode latency: 3.865937893046066 sec
Time for inference 9: 4.05 sec total, 1012.53 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.64 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17864703701343387 sec
Decode latency: 3.8671367650385946 sec
Time for inference 10: 4.05 sec total, 1012.17 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2190.85 GB/s
FLOPS achieved: 10.95 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8501 sec
Average prefill latency: 0.1786 sec
Average tokens/sec: 1016.57
Memory used: 12.04 GB
Done. we are killing the process
