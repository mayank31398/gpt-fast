W1001 03:16:19.722000 22768645646144 torch/distributed/run.py:779] 
W1001 03:16:19.722000 22768645646144 torch/distributed/run.py:779] *****************************************
W1001 03:16:19.722000 22768645646144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:16:19.722000 22768645646144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.14134866103995591 sec
Decode latency: 3.8105108990566805 sec
Compilation time: 3.93 seconds
Compilation time: 3.91 seconds
Compilation time: 3.95 seconds
Compilation time: 3.91 seconds
Compilation time: 3.95 seconds
Compilation time: 3.93 seconds
Compilation time: 3.92 seconds
Compilation time: 3.89 seconds
Prefill latency: 0.07281376200262457 sec
Decode latency: 3.8156208998989314 sec
Prefill latency: 0.0739006670191884 sec
Decode latency: 3.7890650290064514 sec
Prefill latency: 0.07306325400713831 sec
Decode latency: 3.8142816410399973 sec
Prefill latency: 0.07325463299639523 sec
Decode latency: 3.7999938289867714 sec
Prefill latency: 0.07324002706445754 sec
Decode latency: 3.7981482739560306 sec
Time for inference 1: 3.87 sec total, 1057.77 tokens/sec
Decode latency: 3.80 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 459.45 GB/s
FLOPS achieved: 2.30 TF/s

Prefill latency: 0.07329481095075607 sec
Decode latency: 3.7858705410035327 sec
Time for inference 2: 3.86 sec total, 1061.12 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 460.91 GB/s
FLOPS achieved: 2.30 TF/s

Prefill latency: 0.0732714009936899 sec
Decode latency: 3.805995394010097 sec
Time for inference 3: 3.88 sec total, 1055.61 tokens/sec
Decode latency: 3.81 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 458.52 GB/s
FLOPS achieved: 2.29 TF/s

Prefill latency: 0.07408214500173926 sec
Decode latency: 3.7972529149847105 sec
Time for inference 4: 3.87 sec total, 1057.79 tokens/sec
Decode latency: 3.80 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 459.46 GB/s
FLOPS achieved: 2.30 TF/s

Prefill latency: 0.07358146994374692 sec
Decode latency: 3.825744417961687 sec
Time for inference 5: 3.90 sec total, 1050.22 tokens/sec
Decode latency: 3.83 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 456.17 GB/s
FLOPS achieved: 2.28 TF/s

Prefill latency: 0.07536499400157481 sec
Decode latency: 3.8177881540032104 sec
Time for inference 6: 3.89 sec total, 1051.86 tokens/sec
Decode latency: 3.82 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 456.89 GB/s
FLOPS achieved: 2.28 TF/s

Prefill latency: 0.07673155306838453 sec
Decode latency: 3.7998975499067456 sec
Time for inference 7: 3.88 sec total, 1056.33 tokens/sec
Decode latency: 3.80 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 458.82 GB/s
FLOPS achieved: 2.29 TF/s

Prefill latency: 0.07327630801592022 sec
Decode latency: 3.809451216016896 sec
Time for inference 8: 3.88 sec total, 1054.65 tokens/sec
Decode latency: 3.81 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 458.10 GB/s
FLOPS achieved: 2.29 TF/s

Prefill latency: 0.07439402106683701 sec
Decode latency: 3.817092338926159 sec
Time for inference 9: 3.89 sec total, 1052.30 tokens/sec
Decode latency: 3.82 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 457.08 GB/s
FLOPS achieved: 2.29 TF/s

Prefill latency: 0.07415634696371853 sec
Decode latency: 3.8091261059744284 sec
Time for inference 10: 3.88 sec total, 1054.54 tokens/sec
Decode latency: 3.81 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 458.05 GB/s
FLOPS achieved: 2.29 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8066 sec
Average prefill latency: 0.0741 sec
Average tokens/sec: 1055.22
Memory used: 7.49 GB
Done. we are killing the process
