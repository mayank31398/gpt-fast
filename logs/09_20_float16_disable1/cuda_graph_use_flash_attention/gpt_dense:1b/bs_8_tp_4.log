W0930 20:25:10.928000 23317063690048 torch/distributed/run.py:779] 
W0930 20:25:10.928000 23317063690048 torch/distributed/run.py:779] *****************************************
W0930 20:25:10.928000 23317063690048 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:25:10.928000 23317063690048 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.049459223984740674 sec
Decode latency: 2.7684078180463985 sec
Compilation time: 2.81 seconds
Compilation time: 2.82 seconds
Compilation time: 2.82 seconds
Compilation time: 2.82 seconds
Prefill latency: 0.04415984998922795 sec
Decode latency: 2.7684707179432735 sec
Prefill latency: 0.044203419936820865 sec
Decode latency: 2.7638497770531103 sec
Prefill latency: 0.04418948700185865 sec
Decode latency: 2.765166510012932 sec
Prefill latency: 0.04422430298291147 sec
Decode latency: 2.764564144075848 sec
Prefill latency: 0.044318692991510034 sec
Decode latency: 2.7622570580570027 sec
Time for inference 1: 2.81 sec total, 729.52 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.51 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.04420347395353019 sec
Decode latency: 2.7616243780357763 sec
Time for inference 2: 2.81 sec total, 729.68 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.62 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.04429217497818172 sec
Decode latency: 2.7630066400161013 sec
Time for inference 3: 2.81 sec total, 729.30 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.37 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.044194129994139075 sec
Decode latency: 2.761947109014727 sec
Time for inference 4: 2.81 sec total, 729.58 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.55 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.04417019500397146 sec
Decode latency: 2.765693302033469 sec
Time for inference 5: 2.81 sec total, 728.61 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 476.92 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.044271282968111336 sec
Decode latency: 2.7628389979945496 sec
Time for inference 6: 2.81 sec total, 729.33 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.39 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.044198393006809056 sec
Decode latency: 2.76562299602665 sec
Time for inference 7: 2.81 sec total, 728.65 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 476.94 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.04425827297382057 sec
Decode latency: 2.7629170779837295 sec
Time for inference 8: 2.81 sec total, 729.36 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.41 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.0442716209217906 sec
Decode latency: 2.764204893959686 sec
Time for inference 9: 2.81 sec total, 728.95 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.14 GB/s
FLOPS achieved: 2.39 TF/s

Prefill latency: 0.04412131989374757 sec
Decode latency: 2.76328131405171 sec
Time for inference 10: 2.81 sec total, 729.25 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 477.34 GB/s
FLOPS achieved: 2.39 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7633 sec
Average prefill latency: 0.0442 sec
Average tokens/sec: 729.22
Memory used: 4.49 GB
Done. we are killing the process
