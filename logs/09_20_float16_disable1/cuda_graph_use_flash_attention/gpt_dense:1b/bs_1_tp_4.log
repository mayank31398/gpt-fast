W0930 20:18:10.375000 22991758083904 torch/distributed/run.py:779] 
W0930 20:18:10.375000 22991758083904 torch/distributed/run.py:779] *****************************************
W0930 20:18:10.375000 22991758083904 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:18:10.375000 22991758083904 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.03950279497075826 sec
Decode latency: 2.2017171380575746 sec
Compilation time: 2.23 seconds
Compilation time: 2.22 seconds
Compilation time: 2.24 seconds
Compilation time: 2.24 seconds
Prefill latency: 0.014187164953909814 sec
Decode latency: 2.1993068190058693 sec
Prefill latency: 0.014027524972334504 sec
Decode latency: 2.2007710280595347 sec
Prefill latency: 0.014183830004185438 sec
Decode latency: 2.200305689009838 sec
Prefill latency: 0.014058979926630855 sec
Decode latency: 2.1997011919738725 sec
Prefill latency: 0.014091110904701054 sec
Decode latency: 2.201333759003319 sec
Time for inference 1: 2.22 sec total, 115.51 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.61 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014112732955254614 sec
Decode latency: 2.204269237932749 sec
Time for inference 2: 2.22 sec total, 115.36 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.51 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014052791055291891 sec
Decode latency: 2.2039738160092384 sec
Time for inference 3: 2.22 sec total, 115.38 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.52 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014134744997136295 sec
Decode latency: 2.1981157150585204 sec
Time for inference 4: 2.21 sec total, 115.69 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.72 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014097134000621736 sec
Decode latency: 2.2004236100474373 sec
Time for inference 5: 2.22 sec total, 115.56 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.64 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014093213016167283 sec
Decode latency: 2.2001783850137144 sec
Time for inference 6: 2.22 sec total, 115.57 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.65 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.01411649794317782 sec
Decode latency: 2.200394576997496 sec
Time for inference 7: 2.22 sec total, 115.56 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.64 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014101910055615008 sec
Decode latency: 2.2028604589868337 sec
Time for inference 8: 2.22 sec total, 115.42 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.55 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014097527950070798 sec
Decode latency: 2.202847414999269 sec
Time for inference 9: 2.22 sec total, 115.43 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.55 GB/s
FLOPS achieved: 0.38 TF/s

Prefill latency: 0.014252046006731689 sec
Decode latency: 2.2007910390384495 sec
Time for inference 10: 2.22 sec total, 115.53 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 75.62 GB/s
FLOPS achieved: 0.38 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2015 sec
Average prefill latency: 0.0141 sec
Average tokens/sec: 115.50
Memory used: 1.38 GB
Done. we are killing the process
