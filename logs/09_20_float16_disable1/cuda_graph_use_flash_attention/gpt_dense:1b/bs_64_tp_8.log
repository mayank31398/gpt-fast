W0930 20:38:49.464000 23392428803904 torch/distributed/run.py:779] 
W0930 20:38:49.464000 23392428803904 torch/distributed/run.py:779] *****************************************
W0930 20:38:49.464000 23392428803904 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:38:49.464000 23392428803904 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=320, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.32 seconds
Prefill latency: 0.24568962992634624 sec
Decode latency: 4.487082714913413 sec
Compilation time: 4.74 secondsCompilation time: 4.74 seconds

Compilation time: 4.73 secondsCompilation time: 4.73 seconds

Compilation time: 4.73 seconds
Compilation time: 4.74 seconds
Compilation time: 4.73 seconds
Compilation time: 4.74 seconds
Prefill latency: 0.22476404695771635 sec
Decode latency: 4.513945835991763 sec
Prefill latency: 0.22597076697275043 sec
Decode latency: 4.472596351057291 sec
Prefill latency: 0.2254982088925317 sec
Decode latency: 4.495412278920412 sec
Prefill latency: 0.22521802294068038 sec
Decode latency: 4.487842109054327 sec
Prefill latency: 0.2268449430121109 sec
Decode latency: 4.517751908977516 sec
Time for inference 1: 4.75 sec total, 3452.39 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1390.97 GB/s
FLOPS achieved: 6.95 TF/s

Prefill latency: 0.22804659802932292 sec
Decode latency: 4.461571054998785 sec
Time for inference 2: 4.69 sec total, 3492.81 tokens/sec
Decode latency: 4.46 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1407.26 GB/s
FLOPS achieved: 7.04 TF/s

Prefill latency: 0.22450059500988573 sec
Decode latency: 4.477110257023014 sec
Time for inference 3: 4.70 sec total, 3483.82 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 1403.64 GB/s
FLOPS achieved: 7.02 TF/s

Prefill latency: 0.22478314803447574 sec
Decode latency: 4.519851724966429 sec
Time for inference 4: 4.75 sec total, 3452.39 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 1390.97 GB/s
FLOPS achieved: 6.95 TF/s

Prefill latency: 0.22499700204934925 sec
Decode latency: 4.496117759030312 sec
Time for inference 5: 4.72 sec total, 3469.70 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 1397.95 GB/s
FLOPS achieved: 6.99 TF/s

Prefill latency: 0.22605741408187896 sec
Decode latency: 4.467786433058791 sec
Time for inference 6: 4.69 sec total, 3489.80 tokens/sec
Decode latency: 4.47 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1406.05 GB/s
FLOPS achieved: 7.03 TF/s

Prefill latency: 0.22620025603100657 sec
Decode latency: 4.509594096103683 sec
Time for inference 7: 4.74 sec total, 3458.82 tokens/sec
Decode latency: 4.51 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1393.57 GB/s
FLOPS achieved: 6.97 TF/s

Prefill latency: 0.2269724999787286 sec
Decode latency: 4.5006406280444935 sec
Time for inference 8: 4.73 sec total, 3464.83 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1395.99 GB/s
FLOPS achieved: 6.98 TF/s

Prefill latency: 0.22471812600269914 sec
Decode latency: 4.484566716942936 sec
Time for inference 9: 4.71 sec total, 3478.15 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 1401.36 GB/s
FLOPS achieved: 7.01 TF/s

Prefill latency: 0.22619604610372335 sec
Decode latency: 4.499023701064289 sec
Time for inference 10: 4.73 sec total, 3466.57 tokens/sec
Decode latency: 4.50 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 1396.69 GB/s
FLOPS achieved: 6.98 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4934 sec
Average prefill latency: 0.2259 sec
Average tokens/sec: 3470.93
Memory used: 25.30 GB
Done. we are killing the process
