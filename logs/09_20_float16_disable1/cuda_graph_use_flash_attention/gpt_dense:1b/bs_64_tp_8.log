W1001 03:23:45.262000 23376976377664 torch/distributed/run.py:779] 
W1001 03:23:45.262000 23376976377664 torch/distributed/run.py:779] *****************************************
W1001 03:23:45.262000 23376976377664 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:23:45.262000 23376976377664 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.23 seconds
Prefill latency: 0.26192084001377225 sec
Decode latency: 4.274013169924729 sec
Compilation time: 4.54 secondsCompilation time: 4.60 seconds

Compilation time: 4.54 secondsCompilation time: 4.54 seconds
Compilation time: 4.54 seconds

Compilation time: 4.54 secondsCompilation time: 4.53 seconds

Compilation time: 4.54 seconds
Prefill latency: 0.24036531208548695 sec
Decode latency: 4.241732041933574 sec
Prefill latency: 0.24047855101525784 sec
Decode latency: 4.257854714989662 sec
Prefill latency: 0.2411872900556773 sec
Decode latency: 4.255384680931456 sec
Prefill latency: 0.24024412804283202 sec
Decode latency: 4.255934815038927 sec
Prefill latency: 0.24036165501456708 sec
Decode latency: 4.268014438915998 sec
Time for inference 1: 4.51 sec total, 3633.31 tokens/sec
Decode latency: 4.27 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1578.16 GB/s
FLOPS achieved: 7.89 TF/s

Prefill latency: 0.24055743298958987 sec
Decode latency: 4.257344928919338 sec
Time for inference 2: 4.50 sec total, 3641.74 tokens/sec
Decode latency: 4.26 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1581.83 GB/s
FLOPS achieved: 7.91 TF/s

Prefill latency: 0.24087664508260787 sec
Decode latency: 4.272730467026122 sec
Time for inference 3: 4.51 sec total, 3629.09 tokens/sec
Decode latency: 4.27 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1576.33 GB/s
FLOPS achieved: 7.88 TF/s

Prefill latency: 0.24059289798606187 sec
Decode latency: 4.247294686967507 sec
Time for inference 4: 4.49 sec total, 3649.84 tokens/sec
Decode latency: 4.25 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1585.34 GB/s
FLOPS achieved: 7.93 TF/s

Prefill latency: 0.24040829797741026 sec
Decode latency: 4.283823377918452 sec
Time for inference 5: 4.53 sec total, 3620.47 tokens/sec
Decode latency: 4.28 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1572.59 GB/s
FLOPS achieved: 7.86 TF/s

Prefill latency: 0.24099815997760743 sec
Decode latency: 4.248890936025418 sec
Time for inference 6: 4.49 sec total, 3648.26 tokens/sec
Decode latency: 4.25 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1584.66 GB/s
FLOPS achieved: 7.92 TF/s

Prefill latency: 0.24145582201890647 sec
Decode latency: 4.274410342099145 sec
Time for inference 7: 4.52 sec total, 3627.25 tokens/sec
Decode latency: 4.27 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1575.53 GB/s
FLOPS achieved: 7.88 TF/s

Prefill latency: 0.24058530502952635 sec
Decode latency: 4.257909897947684 sec
Time for inference 8: 4.50 sec total, 3641.05 tokens/sec
Decode latency: 4.26 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1581.53 GB/s
FLOPS achieved: 7.91 TF/s

Prefill latency: 0.24061346997041255 sec
Decode latency: 4.248795973020606 sec
Time for inference 9: 4.49 sec total, 3648.57 tokens/sec
Decode latency: 4.25 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1584.79 GB/s
FLOPS achieved: 7.92 TF/s

Prefill latency: 0.24028377595823258 sec
Decode latency: 4.247888532932848 sec
Time for inference 10: 4.49 sec total, 3649.61 tokens/sec
Decode latency: 4.25 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 1585.24 GB/s
FLOPS achieved: 7.93 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.2607 sec
Average prefill latency: 0.2407 sec
Average tokens/sec: 3638.92
Memory used: 27.03 GB
Done. we are killing the process
