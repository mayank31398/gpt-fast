flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.8062899799551815 sec
Decode latency: 8.611294639063999 sec
Compilation time: 9.42 seconds
Prefill latency: 0.8098922700155526 sec
Decode latency: 8.660317608038895 sec
Prefill latency: 0.8057878419058397 sec
Decode latency: 8.658084577997215 sec
Prefill latency: 0.8125466760247946 sec
Decode latency: 8.659493832965381 sec
Prefill latency: 0.8056949730962515 sec
Decode latency: 8.663015400059521 sec
Prefill latency: 0.8097502460004762 sec
Decode latency: 8.65941116400063 sec
Time for inference 1: 9.47 sec total, 1730.06 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.11 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8052960390923545 sec
Decode latency: 8.659314226009883 sec
Time for inference 2: 9.47 sec total, 1730.84 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4182.01 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.8074613300850615 sec
Decode latency: 8.660513909999281 sec
Time for inference 3: 9.47 sec total, 1730.26 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.60 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8056420469656587 sec
Decode latency: 8.550480041070841 sec
Time for inference 4: 9.36 sec total, 1750.95 tokens/sec
Decode latency: 8.55 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4230.60 GB/s
FLOPS achieved: 21.15 TF/s

Prefill latency: 0.808201540959999 sec
Decode latency: 8.65967595600523 sec
Time for inference 5: 9.47 sec total, 1730.27 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.63 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8052330689970404 sec
Decode latency: 8.608616939047351 sec
Time for inference 6: 9.41 sec total, 1740.22 tokens/sec
Decode latency: 8.61 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4204.66 GB/s
FLOPS achieved: 21.02 TF/s

Prefill latency: 0.8065637240651995 sec
Decode latency: 8.54182233591564 sec
Time for inference 7: 9.35 sec total, 1752.41 tokens/sec
Decode latency: 8.54 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4234.11 GB/s
FLOPS achieved: 21.17 TF/s

Prefill latency: 0.8072328040143475 sec
Decode latency: 8.659677715040743 sec
Time for inference 8: 9.47 sec total, 1730.43 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4181.01 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.806993501028046 sec
Decode latency: 8.658930107951164 sec
Time for inference 9: 9.47 sec total, 1730.63 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4181.50 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.8054341359529644 sec
Decode latency: 8.662385224015452 sec
Time for inference 10: 9.47 sec total, 1730.30 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.69 GB/s
FLOPS achieved: 20.90 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.6321 sec
Average prefill latency: 0.8068 sec
Average tokens/sec: 1735.64
Memory used: 54.46 GB
Done. we are killing the process
