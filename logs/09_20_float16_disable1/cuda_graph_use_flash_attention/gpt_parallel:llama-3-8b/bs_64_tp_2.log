W0928 19:21:53.014000 22359606343488 torch/distributed/run.py:779] 
W0928 19:21:53.014000 22359606343488 torch/distributed/run.py:779] *****************************************
W0928 19:21:53.014000 22359606343488 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:21:53.014000 22359606343488 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=17408, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.91 seconds
Prefill latency: 2.5623546028509736 sec
Decode latency: 10.805095823481679 sec
Compilation time: 13.37 seconds
Compilation time: 13.37 seconds
Prefill latency: 2.4320216039195657 sec
Decode latency: 10.801565646193922 sec
Prefill latency: 2.438706047832966 sec
Decode latency: 10.802214744500816 sec
Prefill latency: 2.438117125071585 sec
Decode latency: 10.790088601410389 sec
Prefill latency: 2.436784103512764 sec
Decode latency: 10.791608016937971 sec
Prefill latency: 2.4325884208083153 sec
Decode latency: 10.790547464974225 sec
Time for inference 1: 13.22 sec total, 1238.96 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.43 sec
Bandwidth achieved: 9949.14 GB/s
FLOPS achieved: 49.75 TF/s

Prefill latency: 2.435768309980631 sec
Decode latency: 10.79060438927263 sec
Time for inference 2: 13.23 sec total, 1238.64 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9946.64 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.436657159589231 sec
Decode latency: 10.789857083931565 sec
Time for inference 3: 13.23 sec total, 1238.64 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9946.59 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.4399760151281953 sec
Decode latency: 10.791191491298378 sec
Time for inference 4: 13.23 sec total, 1238.21 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9943.12 GB/s
FLOPS achieved: 49.72 TF/s

Prefill latency: 2.437351295724511 sec
Decode latency: 10.789683867245913 sec
Time for inference 5: 13.23 sec total, 1238.59 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9946.24 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.436305151320994 sec
Decode latency: 10.790719140321016 sec
Time for inference 6: 13.23 sec total, 1238.59 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9946.20 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.4355495097115636 sec
Decode latency: 10.791691914200783 sec
Time for inference 7: 13.23 sec total, 1238.57 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9946.08 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.439308806322515 sec
Decode latency: 10.791031071916223 sec
Time for inference 8: 13.23 sec total, 1238.29 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9943.77 GB/s
FLOPS achieved: 49.72 TF/s

Prefill latency: 2.4357128478586674 sec
Decode latency: 10.792138061486185 sec
Time for inference 9: 13.23 sec total, 1238.51 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.44 sec
Bandwidth achieved: 9945.57 GB/s
FLOPS achieved: 49.73 TF/s

Prefill latency: 2.43399288225919 sec
Decode latency: 10.791468775831163 sec
Time for inference 10: 13.23 sec total, 1238.74 tokens/sec
Decode latency: 10.79 sec
Prefill latency: 2.43 sec
Bandwidth achieved: 9947.45 GB/s
FLOPS achieved: 49.74 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.7909 sec
Average prefill latency: 2.4363 sec
Average tokens/sec: 1238.57
Memory used: 68.23 GB
Done. we are killing the process
