W0928 19:15:01.095000 22674734831424 torch/distributed/run.py:779] 
W0928 19:15:01.095000 22674734831424 torch/distributed/run.py:779] *****************************************
W0928 19:15:01.095000 22674734831424 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:15:01.095000 22674734831424 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=4352, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.31059756502509117 sec
Decode latency: 2.945553279481828 sec
Compilation time: 3.26 seconds
Compilation time: 3.19 seconds
Compilation time: 3.19 seconds
Compilation time: 3.26 secondsCompilation time: 3.19 secondsCompilation time: 3.21 seconds


Compilation time: 3.26 seconds
Compilation time: 3.19 seconds
Prefill latency: 0.23876825161278248 sec
Decode latency: 2.911984706297517 sec
Prefill latency: 0.23902316484600306 sec
Decode latency: 2.926480178721249 sec
Prefill latency: 0.2401399640366435 sec
Decode latency: 2.9270574571564794 sec
Prefill latency: 0.2383950799703598 sec
Decode latency: 2.925970741547644 sec
Prefill latency: 0.24384131096303463 sec
Decode latency: 2.916645398363471 sec
Time for inference 1: 3.16 sec total, 1295.69 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3622.45 GB/s
FLOPS achieved: 18.11 TF/s

Prefill latency: 0.23930667340755463 sec
Decode latency: 2.9461961947381496 sec
Time for inference 2: 3.19 sec total, 1285.50 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3593.97 GB/s
FLOPS achieved: 17.97 TF/s

Prefill latency: 0.24000329244881868 sec
Decode latency: 2.9234725991263986 sec
Time for inference 3: 3.16 sec total, 1294.41 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3618.88 GB/s
FLOPS achieved: 18.09 TF/s

Prefill latency: 0.23921412881463766 sec
Decode latency: 2.9214922254905105 sec
Time for inference 4: 3.16 sec total, 1295.56 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3622.09 GB/s
FLOPS achieved: 18.11 TF/s

Prefill latency: 0.23917038924992085 sec
Decode latency: 2.928183247335255 sec
Time for inference 5: 3.17 sec total, 1292.77 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3614.29 GB/s
FLOPS achieved: 18.07 TF/s

Prefill latency: 0.23941150959581137 sec
Decode latency: 2.932176689617336 sec
Time for inference 6: 3.17 sec total, 1291.05 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3609.49 GB/s
FLOPS achieved: 18.05 TF/s

Prefill latency: 0.23934619035571814 sec
Decode latency: 2.9398986445739865 sec
Time for inference 7: 3.18 sec total, 1287.95 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3600.81 GB/s
FLOPS achieved: 18.00 TF/s

Prefill latency: 0.23958268947899342 sec
Decode latency: 2.9363181898370385 sec
Time for inference 8: 3.18 sec total, 1289.32 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3604.64 GB/s
FLOPS achieved: 18.02 TF/s

Prefill latency: 0.24113413877785206 sec
Decode latency: 2.9367485577240586 sec
Time for inference 9: 3.18 sec total, 1288.57 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3602.56 GB/s
FLOPS achieved: 18.01 TF/s

Prefill latency: 0.24009360279887915 sec
Decode latency: 2.9196403846144676 sec
Time for inference 10: 3.16 sec total, 1295.94 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3623.15 GB/s
FLOPS achieved: 18.12 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9301 sec
Average prefill latency: 0.2401 sec
Average tokens/sec: 1291.68
Memory used: 16.60 GB
Done. we are killing the process
