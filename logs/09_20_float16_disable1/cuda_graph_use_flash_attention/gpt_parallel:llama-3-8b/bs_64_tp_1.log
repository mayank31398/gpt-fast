flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.91 seconds
[rank0]:[W928 19:16:25.789545152 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 2.4990789890289307 sec
Decode latency: 19.170891410671175 sec
Compilation time: 21.67 seconds
Prefill latency: 2.503239309415221 sec
Decode latency: 19.215601020492613 sec
Prefill latency: 2.5087885353714228 sec
Decode latency: 19.21219915524125 sec
Prefill latency: 2.49672347959131 sec
Decode latency: 19.211771295405924 sec
Prefill latency: 2.504308653064072 sec
Decode latency: 19.216676176525652 sec
Prefill latency: 2.5035032015293837 sec
Decode latency: 19.21804474014789 sec
Time for inference 1: 21.72 sec total, 754.24 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11320.83 GB/s
FLOPS achieved: 56.60 TF/s

Prefill latency: 2.508766856044531 sec
Decode latency: 19.216508811339736 sec
Time for inference 2: 21.73 sec total, 754.11 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.51 sec
Bandwidth achieved: 11318.90 GB/s
FLOPS achieved: 56.59 TF/s

Prefill latency: 2.4940188452601433 sec
Decode latency: 19.216327726840973 sec
Time for inference 3: 21.71 sec total, 754.63 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.49 sec
Bandwidth achieved: 11326.72 GB/s
FLOPS achieved: 56.63 TF/s

Prefill latency: 2.4920621486380696 sec
Decode latency: 19.138485536910594 sec
Time for inference 4: 21.63 sec total, 757.41 tokens/sec
Decode latency: 19.14 sec
Prefill latency: 2.49 sec
Bandwidth achieved: 11368.43 GB/s
FLOPS achieved: 56.84 TF/s

Prefill latency: 2.493000210262835 sec
Decode latency: 19.21745976153761 sec
Time for inference 5: 21.71 sec total, 754.63 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.49 sec
Bandwidth achieved: 11326.64 GB/s
FLOPS achieved: 56.63 TF/s

Prefill latency: 2.4983255676925182 sec
Decode latency: 19.21945832017809 sec
Time for inference 6: 21.72 sec total, 754.37 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11322.84 GB/s
FLOPS achieved: 56.61 TF/s

Prefill latency: 2.508933909237385 sec
Decode latency: 19.217018911615014 sec
Time for inference 7: 21.73 sec total, 754.09 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.51 sec
Bandwidth achieved: 11318.56 GB/s
FLOPS achieved: 56.59 TF/s

Prefill latency: 2.503959626890719 sec
Decode latency: 19.169409559108317 sec
Time for inference 8: 21.67 sec total, 755.92 tokens/sec
Decode latency: 19.17 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11346.03 GB/s
FLOPS achieved: 56.73 TF/s

Prefill latency: 2.50123131275177 sec
Decode latency: 19.167182250879705 sec
Time for inference 9: 21.67 sec total, 756.09 tokens/sec
Decode latency: 19.17 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11348.59 GB/s
FLOPS achieved: 56.74 TF/s

Prefill latency: 2.4933902313932776 sec
Decode latency: 19.211879783309996 sec
Time for inference 10: 21.71 sec total, 754.80 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.49 sec
Bandwidth achieved: 11329.31 GB/s
FLOPS achieved: 56.65 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.1992 sec
Average prefill latency: 2.4997 sec
Average tokens/sec: 755.03
Memory used: 77.63 GB
Done. we are killing the process
