flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.82 seconds
[rank0]:[W928 19:01:39.893239288 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.03784110862761736 sec
Decode latency: 2.9379606172442436 sec
Compilation time: 2.98 seconds
Prefill latency: 0.037641437724232674 sec
Decode latency: 2.9345288034528494 sec
Prefill latency: 0.03754585515707731 sec
Decode latency: 2.9353156555444 sec
Prefill latency: 0.03767673671245575 sec
Decode latency: 2.9343621358275414 sec
Prefill latency: 0.037621838971972466 sec
Decode latency: 2.9349052775651217 sec
Prefill latency: 0.037508527748286724 sec
Decode latency: 2.934326060116291 sec
Time for inference 1: 2.97 sec total, 86.13 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.72 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.037609864957630634 sec
Decode latency: 2.934842777438462 sec
Time for inference 2: 2.97 sec total, 86.11 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.42 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.0375690683722496 sec
Decode latency: 2.935875376686454 sec
Time for inference 3: 2.97 sec total, 86.08 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.00 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03756524622440338 sec
Decode latency: 2.936052086763084 sec
Time for inference 4: 2.97 sec total, 86.07 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1291.92 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03763546608388424 sec
Decode latency: 2.9355869637802243 sec
Time for inference 5: 2.97 sec total, 86.08 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.03 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03758935537189245 sec
Decode latency: 2.9356268057599664 sec
Time for inference 6: 2.97 sec total, 86.08 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.03 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03753995522856712 sec
Decode latency: 2.9356737975031137 sec
Time for inference 7: 2.97 sec total, 86.08 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.07 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03753729350864887 sec
Decode latency: 2.9343452267348766 sec
Time for inference 8: 2.97 sec total, 86.12 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.68 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03759679477661848 sec
Decode latency: 2.9354388201609254 sec
Time for inference 9: 2.97 sec total, 86.09 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.14 GB/s
FLOPS achieved: 6.46 TF/s

Prefill latency: 0.03751976788043976 sec
Decode latency: 2.9356761472299695 sec
Time for inference 10: 2.97 sec total, 86.09 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1292.11 GB/s
FLOPS achieved: 6.46 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9353 sec
Average prefill latency: 0.0376 sec
Average tokens/sec: 86.09
Memory used: 17.16 GB
Done. we are killing the process
