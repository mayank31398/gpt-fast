W0928 19:06:32.838000 22674815645504 torch/distributed/run.py:779] 
W0928 19:06:32.838000 22674815645504 torch/distributed/run.py:779] *****************************************
W0928 19:06:32.838000 22674815645504 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:06:32.838000 22674815645504 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=8704, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.83 seconds
[rank0]:[W928 19:06:41.011830476 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.06054506078362465 sec
Decode latency: 2.2204376813024282 sec
Compilation time: 2.28 seconds
Compilation time: 2.28 seconds
Compilation time: 2.28 seconds
Compilation time: 2.27 seconds
Prefill latency: 0.052088113501667976 sec
Decode latency: 2.220980556681752 sec
Prefill latency: 0.05207657814025879 sec
Decode latency: 2.221462090499699 sec
Prefill latency: 0.052076118998229504 sec
Decode latency: 2.220154150389135 sec
Prefill latency: 0.05212673731148243 sec
Decode latency: 2.2195766055956483 sec
Prefill latency: 0.052205655723810196 sec
Decode latency: 2.220276838168502 sec
Time for inference 1: 2.27 sec total, 450.45 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2045.31 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.05208977870643139 sec
Decode latency: 2.2181601328775287 sec
Time for inference 2: 2.27 sec total, 450.91 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2047.41 GB/s
FLOPS achieved: 10.24 TF/s

Prefill latency: 0.05190402362495661 sec
Decode latency: 2.2179803801700473 sec
Time for inference 3: 2.27 sec total, 450.97 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2047.68 GB/s
FLOPS achieved: 10.24 TF/s

Prefill latency: 0.05204884801059961 sec
Decode latency: 2.2188859218731523 sec
Time for inference 4: 2.27 sec total, 450.75 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2046.68 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.0520469956099987 sec
Decode latency: 2.2194337816908956 sec
Time for inference 5: 2.27 sec total, 450.63 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2046.15 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.05202985368669033 sec
Decode latency: 2.22021119017154 sec
Time for inference 6: 2.27 sec total, 450.52 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2045.61 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.05206181947141886 sec
Decode latency: 2.2169586522504687 sec
Time for inference 7: 2.27 sec total, 451.16 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2048.53 GB/s
FLOPS achieved: 10.24 TF/s

Prefill latency: 0.05229894630610943 sec
Decode latency: 2.2200353974476457 sec
Time for inference 8: 2.27 sec total, 450.47 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2045.43 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.0520384032279253 sec
Decode latency: 2.218974720686674 sec
Time for inference 9: 2.27 sec total, 450.77 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2046.78 GB/s
FLOPS achieved: 10.23 TF/s

Prefill latency: 0.05203710123896599 sec
Decode latency: 2.2193115949630737 sec
Time for inference 10: 2.27 sec total, 450.70 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2046.46 GB/s
FLOPS achieved: 10.23 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2190 sec
Average prefill latency: 0.0521 sec
Average tokens/sec: 450.73
Memory used: 8.41 GB
Done. we are killing the process
