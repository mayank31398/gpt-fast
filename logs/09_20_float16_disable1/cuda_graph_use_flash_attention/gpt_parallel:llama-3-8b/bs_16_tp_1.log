flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.81 seconds
Prefill latency: 0.5979035245254636 sec
Decode latency: 6.684083013795316 sec
Compilation time: 7.28 seconds
Prefill latency: 0.5974098099395633 sec
Decode latency: 6.683451686985791 sec
Prefill latency: 0.5995710734277964 sec
Decode latency: 6.6848903968930244 sec
Prefill latency: 0.6021511433646083 sec
Decode latency: 6.685187084600329 sec
Prefill latency: 0.6021698508411646 sec
Decode latency: 6.6868462562561035 sec
Prefill latency: 0.6023928197100759 sec
Decode latency: 6.68453355692327 sec
Time for inference 1: 7.29 sec total, 562.04 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8435.94 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.6011624084785581 sec
Decode latency: 6.685405346564949 sec
Time for inference 2: 7.29 sec total, 562.06 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8436.36 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.602443159557879 sec
Decode latency: 6.688066178932786 sec
Time for inference 3: 7.29 sec total, 561.77 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8431.90 GB/s
FLOPS achieved: 42.16 TF/s

Prefill latency: 0.6004395512863994 sec
Decode latency: 6.686321062035859 sec
Time for inference 4: 7.29 sec total, 562.05 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8436.11 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.6004450153559446 sec
Decode latency: 6.684861148707569 sec
Time for inference 5: 7.29 sec total, 562.17 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8437.98 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.6035713087767363 sec
Decode latency: 6.684557746164501 sec
Time for inference 6: 7.29 sec total, 561.96 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8434.77 GB/s
FLOPS achieved: 42.17 TF/s

Prefill latency: 0.6018060930073261 sec
Decode latency: 6.686065417714417 sec
Time for inference 7: 7.29 sec total, 561.98 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8435.08 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.5992922149598598 sec
Decode latency: 6.686354431323707 sec
Time for inference 8: 7.29 sec total, 562.13 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8437.39 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.6024264032021165 sec
Decode latency: 6.683008441701531 sec
Time for inference 9: 7.29 sec total, 562.15 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8437.70 GB/s
FLOPS achieved: 42.19 TF/s

Prefill latency: 0.600819774903357 sec
Decode latency: 6.683848447166383 sec
Time for inference 10: 7.29 sec total, 562.22 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8438.69 GB/s
FLOPS achieved: 42.19 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6853 sec
Average prefill latency: 0.6015 sec
Average tokens/sec: 562.05
Memory used: 31.58 GB
Done. we are killing the process
