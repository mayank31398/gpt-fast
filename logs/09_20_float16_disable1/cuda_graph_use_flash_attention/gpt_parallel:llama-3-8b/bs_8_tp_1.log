flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.72 seconds
Prefill latency: 0.2974594170227647 sec
Decode latency: 4.560267744585872 sec
Compilation time: 4.86 seconds
Prefill latency: 0.2988023655489087 sec
Decode latency: 4.560439646244049 sec
Prefill latency: 0.29869529884308577 sec
Decode latency: 4.560768896713853 sec
Prefill latency: 0.29854832123965025 sec
Decode latency: 4.560847240500152 sec
Prefill latency: 0.29824691824615 sec
Decode latency: 4.559132087044418 sec
Prefill latency: 0.2976359175518155 sec
Decode latency: 4.559352453798056 sec
Time for inference 1: 4.86 sec total, 421.59 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6327.91 GB/s
FLOPS achieved: 31.64 TF/s

Prefill latency: 0.2975374972447753 sec
Decode latency: 4.560151097364724 sec
Time for inference 2: 4.86 sec total, 421.52 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6326.89 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.2992184357717633 sec
Decode latency: 4.559903832152486 sec
Time for inference 3: 4.86 sec total, 421.41 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6325.19 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.29731679428368807 sec
Decode latency: 4.560761397704482 sec
Time for inference 4: 4.86 sec total, 421.49 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6326.40 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.2990189176052809 sec
Decode latency: 4.559918183833361 sec
Time for inference 5: 4.86 sec total, 421.42 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6325.33 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.29811700992286205 sec
Decode latency: 4.561555685475469 sec
Time for inference 6: 4.86 sec total, 421.35 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6324.28 GB/s
FLOPS achieved: 31.62 TF/s

Prefill latency: 0.29827188327908516 sec
Decode latency: 4.560173952020705 sec
Time for inference 7: 4.86 sec total, 421.46 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6326.00 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.2990328762680292 sec
Decode latency: 4.5601841770112514 sec
Time for inference 8: 4.86 sec total, 421.40 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6325.02 GB/s
FLOPS achieved: 31.63 TF/s

Prefill latency: 0.2983814235776663 sec
Decode latency: 4.560973908752203 sec
Time for inference 9: 4.86 sec total, 421.39 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6324.83 GB/s
FLOPS achieved: 31.62 TF/s

Prefill latency: 0.29913727939128876 sec
Decode latency: 4.559800175018609 sec
Time for inference 10: 4.86 sec total, 421.42 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6325.27 GB/s
FLOPS achieved: 31.63 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5603 sec
Average prefill latency: 0.2984 sec
Average tokens/sec: 421.44
Memory used: 23.88 GB
Done. we are killing the process
