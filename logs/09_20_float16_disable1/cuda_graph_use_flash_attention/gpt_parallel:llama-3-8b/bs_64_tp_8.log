W0928 19:27:29.216000 23303357794112 torch/distributed/run.py:779] 
W0928 19:27:29.216000 23303357794112 torch/distributed/run.py:779] *****************************************
W0928 19:27:29.216000 23303357794112 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:27:29.216000 23303357794112 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=4352, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 1.2090423004701734 sec
Decode latency: 4.433759990148246 sec
Compilation time: 5.60 seconds
Compilation time: 5.60 seconds
Compilation time: 5.41 seconds
Compilation time: 5.40 seconds
Compilation time: 5.39 seconds
Compilation time: 5.64 seconds
Compilation time: 5.60 secondsCompilation time: 5.41 seconds

Prefill latency: 0.9424834325909615 sec
Decode latency: 4.4269231809303164 sec
Prefill latency: 0.949194885790348 sec
Decode latency: 4.427300376817584 sec
Prefill latency: 0.9519027443602681 sec
Decode latency: 4.427092730998993 sec
Prefill latency: 0.9508817186579108 sec
Decode latency: 4.423253442160785 sec
Prefill latency: 0.9428861392661929 sec
Decode latency: 4.438576388172805 sec
Time for inference 1: 5.38 sec total, 3043.96 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.94 sec
Bandwidth achieved: 8510.22 GB/s
FLOPS achieved: 42.55 TF/s

Prefill latency: 0.9468490807339549 sec
Decode latency: 4.429712243378162 sec
Time for inference 2: 5.38 sec total, 3046.77 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8518.09 GB/s
FLOPS achieved: 42.59 TF/s

Prefill latency: 0.9496953077614307 sec
Decode latency: 4.4119679080322385 sec
Time for inference 3: 5.36 sec total, 3055.26 tokens/sec
Decode latency: 4.41 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8541.82 GB/s
FLOPS achieved: 42.71 TF/s

Prefill latency: 0.9510308522731066 sec
Decode latency: 4.434460557065904 sec
Time for inference 4: 5.39 sec total, 3041.66 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8503.80 GB/s
FLOPS achieved: 42.52 TF/s

Prefill latency: 0.9511862257495522 sec
Decode latency: 4.41536814160645 sec
Time for inference 5: 5.37 sec total, 3052.42 tokens/sec
Decode latency: 4.42 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8533.89 GB/s
FLOPS achieved: 42.67 TF/s

Prefill latency: 0.9456402352079749 sec
Decode latency: 4.42691102810204 sec
Time for inference 6: 5.37 sec total, 3049.06 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8524.48 GB/s
FLOPS achieved: 42.62 TF/s

Prefill latency: 0.949193462729454 sec
Decode latency: 4.441438448615372 sec
Time for inference 7: 5.39 sec total, 3038.86 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8495.96 GB/s
FLOPS achieved: 42.48 TF/s

Prefill latency: 0.9496473670005798 sec
Decode latency: 4.419935944490135 sec
Time for inference 8: 5.37 sec total, 3050.78 tokens/sec
Decode latency: 4.42 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8529.30 GB/s
FLOPS achieved: 42.65 TF/s

Prefill latency: 0.950017498806119 sec
Decode latency: 4.435803329572082 sec
Time for inference 9: 5.39 sec total, 3041.61 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8503.65 GB/s
FLOPS achieved: 42.52 TF/s

Prefill latency: 0.9484277283772826 sec
Decode latency: 4.462139322422445 sec
Time for inference 10: 5.41 sec total, 3027.63 tokens/sec
Decode latency: 4.46 sec
Prefill latency: 0.95 sec
Bandwidth achieved: 8464.57 GB/s
FLOPS achieved: 42.32 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4316 sec
Average prefill latency: 0.9485 sec
Average tokens/sec: 3044.80
Memory used: 43.29 GB
Done. we are killing the process
