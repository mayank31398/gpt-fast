flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 1.6149462139001116 sec
Decode latency: 12.673137094010599 sec
Compilation time: 14.29 seconds
Prefill latency: 1.6201378620462492 sec
Decode latency: 12.5900643869536 sec
Prefill latency: 1.6142592419637367 sec
Decode latency: 12.617159010958858 sec
Prefill latency: 1.616245921002701 sec
Decode latency: 12.67486588889733 sec
Prefill latency: 1.6245417919708416 sec
Decode latency: 12.537688995013013 sec
Prefill latency: 1.6210935229901224 sec
Decode latency: 12.67615900200326 sec
Time for inference 1: 14.30 sec total, 1145.88 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8045.94 GB/s
FLOPS achieved: 40.23 TF/s

Prefill latency: 1.6229218809166923 sec
Decode latency: 12.676375341950916 sec
Time for inference 2: 14.30 sec total, 1145.71 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8044.73 GB/s
FLOPS achieved: 40.22 TF/s

Prefill latency: 1.6227041080128402 sec
Decode latency: 12.677665604976937 sec
Time for inference 3: 14.30 sec total, 1145.63 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8044.20 GB/s
FLOPS achieved: 40.22 TF/s

Prefill latency: 1.6212140710558742 sec
Decode latency: 12.557268847012892 sec
Time for inference 4: 14.18 sec total, 1155.47 tokens/sec
Decode latency: 12.56 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8113.32 GB/s
FLOPS achieved: 40.57 TF/s

Prefill latency: 1.6216495629632846 sec
Decode latency: 12.674924978986382 sec
Time for inference 5: 14.30 sec total, 1145.92 tokens/sec
Decode latency: 12.67 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8046.26 GB/s
FLOPS achieved: 40.23 TF/s

Prefill latency: 1.6239451230503619 sec
Decode latency: 12.676362774916925 sec
Time for inference 6: 14.30 sec total, 1145.63 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8044.19 GB/s
FLOPS achieved: 40.22 TF/s

Prefill latency: 1.6225521130254492 sec
Decode latency: 12.675250367959961 sec
Time for inference 7: 14.30 sec total, 1145.83 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8045.63 GB/s
FLOPS achieved: 40.23 TF/s

Prefill latency: 1.6234647240489721 sec
Decode latency: 12.676425007986836 sec
Time for inference 8: 14.30 sec total, 1145.66 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8044.42 GB/s
FLOPS achieved: 40.22 TF/s

Prefill latency: 1.622583469026722 sec
Decode latency: 12.624066454940476 sec
Time for inference 9: 14.25 sec total, 1149.94 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8074.50 GB/s
FLOPS achieved: 40.37 TF/s

Prefill latency: 1.6205864519579336 sec
Decode latency: 12.675681840046309 sec
Time for inference 10: 14.30 sec total, 1145.95 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8046.46 GB/s
FLOPS achieved: 40.23 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.6590 sec
Average prefill latency: 1.6223 sec
Average tokens/sec: 1147.16
Memory used: 54.39 GB
Done. we are killing the process
