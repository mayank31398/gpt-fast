flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.91 seconds
Prefill latency: 0.20170263689942658 sec
Decode latency: 3.376538726966828 sec
Compilation time: 3.58 seconds
Prefill latency: 0.20232119609136134 sec
Decode latency: 3.516090097022243 sec
Prefill latency: 0.20081402291543782 sec
Decode latency: 3.5162049729842693 sec
Prefill latency: 0.2012561640003696 sec
Decode latency: 3.5151723060989752 sec
Prefill latency: 0.2022917289286852 sec
Decode latency: 3.515093425055966 sec
Prefill latency: 0.20159507996868342 sec
Decode latency: 3.516268427018076 sec
Time for inference 1: 3.72 sec total, 550.75 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.19 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20185222197324038 sec
Decode latency: 3.5151531860465184 sec
Time for inference 2: 3.72 sec total, 550.89 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.12 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2017708069179207 sec
Decode latency: 3.5162490300135687 sec
Time for inference 3: 3.72 sec total, 550.73 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.03 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2013556850142777 sec
Decode latency: 3.5155766040552408 sec
Time for inference 4: 3.72 sec total, 550.90 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.21 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2007184310350567 sec
Decode latency: 3.5169868209632114 sec
Time for inference 5: 3.72 sec total, 550.78 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.36 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20156418601982296 sec
Decode latency: 3.515779161010869 sec
Time for inference 6: 3.72 sec total, 550.84 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.76 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2011551420437172 sec
Decode latency: 3.5157627899898216 sec
Time for inference 7: 3.72 sec total, 550.90 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.20 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20267542102374136 sec
Decode latency: 3.515531818033196 sec
Time for inference 8: 3.72 sec total, 550.71 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3866.86 GB/s
FLOPS achieved: 19.33 TF/s

Prefill latency: 0.20087351300753653 sec
Decode latency: 3.5157063230872154 sec
Time for inference 9: 3.72 sec total, 550.95 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.57 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2021059920080006 sec
Decode latency: 3.5156087959185243 sec
Time for inference 10: 3.72 sec total, 550.77 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.33 GB/s
FLOPS achieved: 19.34 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5159 sec
Average prefill latency: 0.2016 sec
Average tokens/sec: 550.82
Memory used: 13.57 GB
Done. we are killing the process
