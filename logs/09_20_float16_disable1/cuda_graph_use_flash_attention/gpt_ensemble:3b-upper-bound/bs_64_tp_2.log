W1001 03:44:53.602000 22826841691968 torch/distributed/run.py:779] 
W1001 03:44:53.602000 22826841691968 torch/distributed/run.py:779] *****************************************
W1001 03:44:53.602000 22826841691968 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:44:53.602000 22826841691968 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.8283604410244152 sec
Decode latency: 7.142996397102252 sec
Compilation time: 7.97 seconds
Compilation time: 8.07 seconds
Prefill latency: 0.8355505829676986 sec
Decode latency: 7.221776486025192 sec
Prefill latency: 0.8213781710946932 sec
Decode latency: 7.219471529009752 sec
Prefill latency: 0.835935972048901 sec
Decode latency: 7.209875714033842 sec
Prefill latency: 0.8295864670071751 sec
Decode latency: 7.219840785954148 sec
Prefill latency: 0.8200093059567735 sec
Decode latency: 7.219948982005008 sec
Time for inference 1: 8.04 sec total, 2037.62 tokens/sec
Decode latency: 7.22 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 7384.86 GB/s
FLOPS achieved: 36.92 TF/s

Prefill latency: 0.8206130410544574 sec
Decode latency: 7.219585266080685 sec
Time for inference 2: 8.04 sec total, 2037.53 tokens/sec
Decode latency: 7.22 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 7384.54 GB/s
FLOPS achieved: 36.92 TF/s

Prefill latency: 0.8234463230473921 sec
Decode latency: 7.142119308002293 sec
Time for inference 3: 7.97 sec total, 2056.64 tokens/sec
Decode latency: 7.14 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 7453.79 GB/s
FLOPS achieved: 37.27 TF/s

Prefill latency: 0.831118099973537 sec
Decode latency: 7.090046279015951 sec
Time for inference 4: 7.92 sec total, 2068.20 tokens/sec
Decode latency: 7.09 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 7495.67 GB/s
FLOPS achieved: 37.48 TF/s

Prefill latency: 0.8295191510114819 sec
Decode latency: 7.20763195597101 sec
Time for inference 5: 8.04 sec total, 2038.33 tokens/sec
Decode latency: 7.21 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 7387.41 GB/s
FLOPS achieved: 36.94 TF/s

Prefill latency: 0.831922261044383 sec
Decode latency: 7.117025400977582 sec
Time for inference 6: 7.95 sec total, 2060.92 tokens/sec
Decode latency: 7.12 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 7469.28 GB/s
FLOPS achieved: 37.35 TF/s

Prefill latency: 0.8212194159859791 sec
Decode latency: 7.147571375942789 sec
Time for inference 7: 7.97 sec total, 2055.82 tokens/sec
Decode latency: 7.15 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 7450.82 GB/s
FLOPS achieved: 37.25 TF/s

Prefill latency: 0.8322286990005523 sec
Decode latency: 7.141588735976256 sec
Time for inference 8: 7.97 sec total, 2054.55 tokens/sec
Decode latency: 7.14 sec
Prefill latency: 0.83 sec
Bandwidth achieved: 7446.22 GB/s
FLOPS achieved: 37.23 TF/s

Prefill latency: 0.8357837209478021 sec
Decode latency: 7.219868464046158 sec
Time for inference 9: 8.06 sec total, 2033.66 tokens/sec
Decode latency: 7.22 sec
Prefill latency: 0.84 sec
Bandwidth achieved: 7370.50 GB/s
FLOPS achieved: 36.85 TF/s

Prefill latency: 0.820511942030862 sec
Decode latency: 7.216183144948445 sec
Time for inference 10: 8.04 sec total, 2038.41 tokens/sec
Decode latency: 7.22 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 7387.70 GB/s
FLOPS achieved: 36.94 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.1722 sec
Average prefill latency: 0.8266 sec
Average tokens/sec: 2048.17
Memory used: 31.14 GB
Done. we are killing the process
