W1001 03:35:43.260000 23190066280256 torch/distributed/run.py:779] 
W1001 03:35:43.260000 23190066280256 torch/distributed/run.py:779] *****************************************
W1001 03:35:43.260000 23190066280256 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:35:43.260000 23190066280256 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.10653037007432431 sec
Decode latency: 2.7068362090503797 sec
Compilation time: 2.81 seconds
Compilation time: 2.84 seconds
Prefill latency: 0.10648352792486548 sec
Decode latency: 2.707442262908444 sec
Prefill latency: 0.10658397595398128 sec
Decode latency: 2.707783150020987 sec
Prefill latency: 0.10645864298567176 sec
Decode latency: 2.7082016080385074 sec
Prefill latency: 0.10645879502408206 sec
Decode latency: 2.707471195026301 sec
Prefill latency: 0.10651013196911663 sec
Decode latency: 2.7076752319699153 sec
Time for inference 1: 2.81 sec total, 727.57 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.89 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.10659098194446415 sec
Decode latency: 2.7080554090207443 sec
Time for inference 2: 2.82 sec total, 727.45 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.46 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.1064639970427379 sec
Decode latency: 2.7063572029583156 sec
Time for inference 3: 2.81 sec total, 727.93 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2638.20 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.10666532395407557 sec
Decode latency: 2.708107308950275 sec
Time for inference 4: 2.82 sec total, 727.42 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.36 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.106670030974783 sec
Decode latency: 2.7076395680196583 sec
Time for inference 5: 2.82 sec total, 727.52 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.72 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.10671570792328566 sec
Decode latency: 2.7072296320693567 sec
Time for inference 6: 2.81 sec total, 727.63 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2637.10 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.10644191596657038 sec
Decode latency: 2.614746880950406 sec
Time for inference 7: 2.72 sec total, 752.44 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2727.04 GB/s
FLOPS achieved: 13.64 TF/s

Prefill latency: 0.10665897908620536 sec
Decode latency: 2.7076330890413374 sec
Time for inference 8: 2.82 sec total, 727.49 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.60 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.10664410900790244 sec
Decode latency: 2.708136394037865 sec
Time for inference 9: 2.82 sec total, 727.39 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2636.23 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.10637193999718875 sec
Decode latency: 2.705928258015774 sec
Time for inference 10: 2.81 sec total, 728.04 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2638.60 GB/s
FLOPS achieved: 13.19 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6982 sec
Average prefill latency: 0.1066 sec
Average tokens/sec: 730.09
Memory used: 7.71 GB
Done. we are killing the process
