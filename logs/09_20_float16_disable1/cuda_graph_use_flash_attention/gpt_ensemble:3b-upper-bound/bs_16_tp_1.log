flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.93 seconds
Prefill latency: 0.3948161309817806 sec
Decode latency: 5.146580594941042 sec
Compilation time: 5.54 seconds
Prefill latency: 0.3951345920795575 sec
Decode latency: 5.156543856021017 sec
Prefill latency: 0.3955718450015411 sec
Decode latency: 5.153984745964408 sec
Prefill latency: 0.39552581508178264 sec
Decode latency: 5.150024506030604 sec
Prefill latency: 0.3962153079919517 sec
Decode latency: 5.155299496022053 sec
Prefill latency: 0.3960239600855857 sec
Decode latency: 5.155753643950447 sec
Time for inference 1: 5.55 sec total, 737.68 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5179.70 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.3950948970159516 sec
Decode latency: 5.156967262970284 sec
Time for inference 2: 5.55 sec total, 737.64 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5179.48 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.39659695606678724 sec
Decode latency: 5.155963005963713 sec
Time for inference 3: 5.55 sec total, 737.58 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5179.00 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.3956997470231727 sec
Decode latency: 5.155729638994671 sec
Time for inference 4: 5.55 sec total, 737.71 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5179.92 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.3959057090105489 sec
Decode latency: 5.143253965070471 sec
Time for inference 5: 5.54 sec total, 739.35 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5191.44 GB/s
FLOPS achieved: 25.96 TF/s

Prefill latency: 0.3960530450567603 sec
Decode latency: 5.143910390906967 sec
Time for inference 6: 5.54 sec total, 739.25 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5190.76 GB/s
FLOPS achieved: 25.95 TF/s

Prefill latency: 0.3991129860514775 sec
Decode latency: 5.143844197038561 sec
Time for inference 7: 5.54 sec total, 738.87 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5188.05 GB/s
FLOPS achieved: 25.94 TF/s

Prefill latency: 0.3971193809993565 sec
Decode latency: 5.156897814013064 sec
Time for inference 8: 5.55 sec total, 737.38 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5177.61 GB/s
FLOPS achieved: 25.89 TF/s

Prefill latency: 0.3955051669618115 sec
Decode latency: 5.143024388002232 sec
Time for inference 9: 5.54 sec total, 739.42 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5191.95 GB/s
FLOPS achieved: 25.96 TF/s

Prefill latency: 0.39782030403148383 sec
Decode latency: 5.15592196106445 sec
Time for inference 10: 5.55 sec total, 737.39 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5177.71 GB/s
FLOPS achieved: 25.89 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1511 sec
Average prefill latency: 0.3965 sec
Average tokens/sec: 738.23
Memory used: 19.32 GB
Done. we are killing the process
