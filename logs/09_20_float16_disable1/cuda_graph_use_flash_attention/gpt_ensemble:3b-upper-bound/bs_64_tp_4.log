W1001 03:47:06.407000 22496303728448 torch/distributed/run.py:779] 
W1001 03:47:06.407000 22496303728448 torch/distributed/run.py:779] *****************************************
W1001 03:47:06.407000 22496303728448 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:47:06.407000 22496303728448 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.4443673969944939 sec
Compilation time: 5.17 seconds
Decode latency: 4.713200223981403 sec
Compilation time: 5.16 seconds
Compilation time: 5.19 seconds
Compilation time: 5.17 seconds
Prefill latency: 0.4448463449953124 sec
Decode latency: 4.71441341296304 sec
Prefill latency: 0.4455641000531614 sec
Decode latency: 4.724958679056726 sec
Prefill latency: 0.44465361908078194 sec
Decode latency: 4.72613307996653 sec
Prefill latency: 0.44560178194660693 sec
Decode latency: 4.723347001010552 sec
Prefill latency: 0.4449169759172946 sec
Decode latency: 4.723425928037614 sec
Time for inference 1: 5.17 sec total, 3169.59 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 6103.24 GB/s
FLOPS achieved: 30.52 TF/s

Prefill latency: 0.44596715504303575 sec
Decode latency: 4.723484041984193 sec
Time for inference 2: 5.17 sec total, 3168.92 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6101.95 GB/s
FLOPS achieved: 30.51 TF/s

Prefill latency: 0.44638717093039304 sec
Decode latency: 4.716992974979803 sec
Time for inference 3: 5.16 sec total, 3172.55 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6108.94 GB/s
FLOPS achieved: 30.54 TF/s

Prefill latency: 0.44515507796313614 sec
Decode latency: 4.713317261077464 sec
Time for inference 4: 5.16 sec total, 3175.62 tokens/sec
Decode latency: 4.71 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6114.83 GB/s
FLOPS achieved: 30.57 TF/s

Prefill latency: 0.445645899977535 sec
Decode latency: 4.65159932593815 sec
Time for inference 5: 5.10 sec total, 3213.61 tokens/sec
Decode latency: 4.65 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6188.00 GB/s
FLOPS achieved: 30.94 TF/s

Prefill latency: 0.4448981099994853 sec
Decode latency: 4.716315559926443 sec
Time for inference 6: 5.16 sec total, 3173.87 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 6111.48 GB/s
FLOPS achieved: 30.56 TF/s

Prefill latency: 0.4449621549574658 sec
Decode latency: 4.715310157975182 sec
Time for inference 7: 5.16 sec total, 3174.56 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 6112.81 GB/s
FLOPS achieved: 30.56 TF/s

Prefill latency: 0.4459419189952314 sec
Decode latency: 4.715103785973042 sec
Time for inference 8: 5.16 sec total, 3174.07 tokens/sec
Decode latency: 4.72 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6111.86 GB/s
FLOPS achieved: 30.56 TF/s

Prefill latency: 0.44476555509027094 sec
Decode latency: 4.714479423011653 sec
Time for inference 9: 5.16 sec total, 3175.10 tokens/sec
Decode latency: 4.71 sec
Prefill latency: 0.44 sec
Bandwidth achieved: 6113.84 GB/s
FLOPS achieved: 30.57 TF/s

Prefill latency: 0.44570197397843003 sec
Decode latency: 4.714983027079143 sec
Time for inference 10: 5.16 sec total, 3174.26 tokens/sec
Decode latency: 4.71 sec
Prefill latency: 0.45 sec
Bandwidth achieved: 6112.23 GB/s
FLOPS achieved: 30.56 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.7105 sec
Average prefill latency: 0.4454 sec
Average tokens/sec: 3177.22
Memory used: 19.75 GB
Done. we are killing the process
