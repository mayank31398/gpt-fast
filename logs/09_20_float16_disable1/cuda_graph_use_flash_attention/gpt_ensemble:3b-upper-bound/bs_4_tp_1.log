flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.10208260896615684 sec
Decode latency: 3.0353548310231417 sec
Compilation time: 3.14 seconds
Prefill latency: 0.10229427996091545 sec
Decode latency: 3.0360342729836702 sec
Prefill latency: 0.10219605395104736 sec
Decode latency: 3.035866240039468 sec
Prefill latency: 0.10230243799742311 sec
Decode latency: 3.0360069560119882 sec
Prefill latency: 0.10235907102469355 sec
Decode latency: 3.0355972880497575 sec
Prefill latency: 0.10200014500878751 sec
Decode latency: 3.035656166030094 sec
Time for inference 1: 3.14 sec total, 326.27 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.95 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.1030203610425815 sec
Decode latency: 3.0355537210125476 sec
Time for inference 2: 3.14 sec total, 326.17 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.27 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10209281998686492 sec
Decode latency: 3.036421882919967 sec
Time for inference 3: 3.14 sec total, 326.20 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.43 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10242377396207303 sec
Decode latency: 3.035891421022825 sec
Time for inference 4: 3.14 sec total, 326.21 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.55 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10223979002330452 sec
Decode latency: 3.0355851509375498 sec
Time for inference 5: 3.14 sec total, 326.27 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.96 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10241811699233949 sec
Decode latency: 3.0363136189989746 sec
Time for inference 6: 3.14 sec total, 326.18 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.29 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10214695194736123 sec
Decode latency: 3.0364353499608114 sec
Time for inference 7: 3.14 sec total, 326.19 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.41 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10225421702489257 sec
Decode latency: 3.034559844993055 sec
Time for inference 8: 3.14 sec total, 326.38 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.69 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10213784605730325 sec
Decode latency: 3.0359935460146517 sec
Time for inference 9: 3.14 sec total, 326.23 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2290.68 GB/s
FLOPS achieved: 11.45 TF/s

Prefill latency: 0.10222779400646687 sec
Decode latency: 3.0337946409126744 sec
Time for inference 10: 3.14 sec total, 326.43 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2292.10 GB/s
FLOPS achieved: 11.46 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0356 sec
Average prefill latency: 0.1023 sec
Average tokens/sec: 326.25
Memory used: 10.66 GB
Done. we are killing the process
