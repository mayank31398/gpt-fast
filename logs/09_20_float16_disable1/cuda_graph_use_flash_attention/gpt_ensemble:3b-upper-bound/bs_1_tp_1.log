flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.03141309297643602 sec
Decode latency: 2.434294431935996 sec
Compilation time: 2.47 seconds
Prefill latency: 0.031221644021570683 sec
Decode latency: 2.4506900319829583 sec
Prefill latency: 0.03129386599175632 sec
Decode latency: 2.4126554040703923 sec
Prefill latency: 0.0313792759552598 sec
Decode latency: 2.5406854040920734 sec
Prefill latency: 0.031285937991924584 sec
Decode latency: 2.4778532560449094 sec
Prefill latency: 0.03130438702646643 sec
Decode latency: 2.5416774509940296 sec
Time for inference 1: 2.57 sec total, 99.47 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 698.44 GB/s
FLOPS achieved: 3.49 TF/s

Prefill latency: 0.031252429937012494 sec
Decode latency: 2.417390816961415 sec
Time for inference 2: 2.45 sec total, 104.52 tokens/sec
Decode latency: 2.42 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 733.90 GB/s
FLOPS achieved: 3.67 TF/s

Prefill latency: 0.031305824988521636 sec
Decode latency: 2.540766775025986 sec
Time for inference 3: 2.57 sec total, 99.50 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 698.65 GB/s
FLOPS achieved: 3.49 TF/s

Prefill latency: 0.03126967104617506 sec
Decode latency: 2.539381137001328 sec
Time for inference 4: 2.57 sec total, 99.56 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.06 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.03124818007927388 sec
Decode latency: 2.5395200949860737 sec
Time for inference 5: 2.57 sec total, 99.56 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.04 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.03127884096466005 sec
Decode latency: 2.5380589329870418 sec
Time for inference 6: 2.57 sec total, 99.61 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.45 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031352168996818364 sec
Decode latency: 2.5405881199985743 sec
Time for inference 7: 2.57 sec total, 99.51 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 698.74 GB/s
FLOPS achieved: 3.49 TF/s

Prefill latency: 0.03133418795187026 sec
Decode latency: 2.5390129790175706 sec
Time for inference 8: 2.57 sec total, 99.58 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.18 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.03127757296897471 sec
Decode latency: 2.5387301580049098 sec
Time for inference 9: 2.57 sec total, 99.59 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.28 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031315964995883405 sec
Decode latency: 2.538966316031292 sec
Time for inference 10: 2.57 sec total, 99.58 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.20 GB/s
FLOPS achieved: 3.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5274 sec
Average prefill latency: 0.0313 sec
Average tokens/sec: 100.05
Memory used: 8.41 GB
Done. we are killing the process
