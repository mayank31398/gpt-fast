W1001 03:05:11.475000 23030821259072 torch/distributed/run.py:779] 
W1001 03:05:11.475000 23030821259072 torch/distributed/run.py:779] *****************************************
W1001 03:05:11.475000 23030821259072 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:05:11.475000 23030821259072 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.18 seconds
Prefill latency: 0.4952132230391726 sec
Decode latency: 4.926332919043489 sec
Compilation time: 5.42 seconds
Compilation time: 5.42 seconds
Compilation time: 5.42 seconds
Compilation time: 5.42 seconds
Prefill latency: 0.4969580990727991 sec
Decode latency: 4.9246041720034555 sec
Prefill latency: 0.4958182879490778 sec
Decode latency: 4.924332911963575 sec
Prefill latency: 0.49544795299880207 sec
Decode latency: 4.9237567509990185 sec
Prefill latency: 0.4951321800472215 sec
Decode latency: 4.923001722083427 sec
Prefill latency: 0.4960576189914718 sec
Decode latency: 4.925087401992641 sec
Time for inference 1: 5.42 sec total, 3021.73 tokens/sec
Decode latency: 4.93 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5818.51 GB/s
FLOPS achieved: 29.09 TF/s

Prefill latency: 0.496387735940516 sec
Decode latency: 4.922845041961409 sec
Time for inference 2: 5.42 sec total, 3022.80 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5820.59 GB/s
FLOPS achieved: 29.10 TF/s

Prefill latency: 0.4972185480874032 sec
Decode latency: 4.921773670939729 sec
Time for inference 3: 5.42 sec total, 3022.97 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5820.91 GB/s
FLOPS achieved: 29.10 TF/s

Prefill latency: 0.4967643499840051 sec
Decode latency: 4.922242002910934 sec
Time for inference 4: 5.42 sec total, 3022.97 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5820.91 GB/s
FLOPS achieved: 29.10 TF/s

Prefill latency: 0.49588341207709163 sec
Decode latency: 4.922234651981853 sec
Time for inference 5: 5.42 sec total, 3023.49 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5821.91 GB/s
FLOPS achieved: 29.11 TF/s

Prefill latency: 0.4959075750084594 sec
Decode latency: 4.923897418077104 sec
Time for inference 6: 5.42 sec total, 3022.35 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5819.72 GB/s
FLOPS achieved: 29.10 TF/s

Prefill latency: 0.4965703949565068 sec
Decode latency: 4.92202095198445 sec
Time for inference 7: 5.42 sec total, 3023.18 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5821.31 GB/s
FLOPS achieved: 29.11 TF/s

Prefill latency: 0.49632315896451473 sec
Decode latency: 4.923652678029612 sec
Time for inference 8: 5.42 sec total, 3022.40 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5819.81 GB/s
FLOPS achieved: 29.10 TF/s

Prefill latency: 0.4962363449158147 sec
Decode latency: 4.922498418018222 sec
Time for inference 9: 5.42 sec total, 3023.13 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5821.21 GB/s
FLOPS achieved: 29.11 TF/s

Prefill latency: 0.49617659603245556 sec
Decode latency: 4.922057558898814 sec
Time for inference 10: 5.42 sec total, 3023.41 tokens/sec
Decode latency: 4.92 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 5821.76 GB/s
FLOPS achieved: 29.11 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.9228 sec
Average prefill latency: 0.4964 sec
Average tokens/sec: 3022.84
Memory used: 43.63 GB
Done. we are killing the process
