W1001 02:48:30.793000 23248212588352 torch/distributed/run.py:779] 
W1001 02:48:30.793000 23248212588352 torch/distributed/run.py:779] *****************************************
W1001 02:48:30.793000 23248212588352 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:48:30.793000 23248212588352 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.16 seconds
[rank0]:[W1001 02:48:38.048656651 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank2]:[W1001 02:48:38.079038591 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.03875834005884826 sec
Decode latency: 2.0547440180089325 sec
Compilation time: 2.07 seconds
Compilation time: 2.07 seconds
Compilation time: 2.09 seconds
Compilation time: 2.09 seconds
Prefill latency: 0.015516964020207524 sec
Decode latency: 2.0544928779127076 sec
Prefill latency: 0.015780251007527113 sec
Decode latency: 2.054578208946623 sec
Prefill latency: 0.015746328979730606 sec
Decode latency: 2.054721125983633 sec
Prefill latency: 0.015838623978197575 sec
Decode latency: 2.0543754250975326 sec
Prefill latency: 0.01571198005694896 sec
Decode latency: 2.0546185709536076 sec
Time for inference 1: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.02 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.015716925030574203 sec
Decode latency: 2.054567225044593 sec
Time for inference 2: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.03 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.015594137948937714 sec
Decode latency: 2.0545900959987193 sec
Time for inference 3: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.03 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.015731546096503735 sec
Decode latency: 2.0544326140079647 sec
Time for inference 4: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.02 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.01569399400614202 sec
Decode latency: 2.0546654029749334 sec
Time for inference 5: 2.07 sec total, 123.60 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.01 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.01567849493585527 sec
Decode latency: 2.054662689915858 sec
Time for inference 6: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.01 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.015718101058155298 sec
Decode latency: 2.0546691400231794 sec
Time for inference 7: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.02 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.01576370105613023 sec
Decode latency: 2.054510800051503 sec
Time for inference 8: 2.07 sec total, 123.61 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.03 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.01568517496343702 sec
Decode latency: 2.0544752379646525 sec
Time for inference 9: 2.07 sec total, 123.62 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 238.05 GB/s
FLOPS achieved: 1.19 TF/s

Prefill latency: 0.015730070997960865 sec
Decode latency: 2.0548106129281223 sec
Time for inference 10: 2.07 sec total, 123.59 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 237.99 GB/s
FLOPS achieved: 1.19 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0546 sec
Average prefill latency: 0.0157 sec
Average tokens/sec: 123.61
Memory used: 3.03 GB
Done. we are killing the process
