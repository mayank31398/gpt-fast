flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
Prefill latency: 1.626588131999597 sec
Decode latency: 12.825015160953626 sec
Compilation time: 14.45 seconds
Prefill latency: 1.6194406560389325 sec
Decode latency: 12.822892764001153 sec
Prefill latency: 1.6172852029558271 sec
Decode latency: 12.825012376066297 sec
Prefill latency: 1.6271173289278522 sec
Decode latency: 12.823434947989881 sec
Prefill latency: 1.6210692159365863 sec
Decode latency: 12.823469965951517 sec
Prefill latency: 1.629910237970762 sec
Decode latency: 12.8235494249966 sec
Time for inference 1: 14.45 sec total, 1133.48 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7958.88 GB/s
FLOPS achieved: 39.79 TF/s

Prefill latency: 1.6211693750228733 sec
Decode latency: 12.824173243017867 sec
Time for inference 2: 14.45 sec total, 1134.12 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7963.36 GB/s
FLOPS achieved: 39.82 TF/s

Prefill latency: 1.6287665320560336 sec
Decode latency: 12.823383299983107 sec
Time for inference 3: 14.45 sec total, 1133.59 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7959.64 GB/s
FLOPS achieved: 39.80 TF/s

Prefill latency: 1.621237133978866 sec
Decode latency: 12.823983676033095 sec
Time for inference 4: 14.45 sec total, 1134.13 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7963.46 GB/s
FLOPS achieved: 39.82 TF/s

Prefill latency: 1.6287446049973369 sec
Decode latency: 12.82445249799639 sec
Time for inference 5: 14.45 sec total, 1133.50 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7959.04 GB/s
FLOPS achieved: 39.80 TF/s

Prefill latency: 1.6206336219329387 sec
Decode latency: 12.825383367016912 sec
Time for inference 6: 14.45 sec total, 1134.07 tokens/sec
Decode latency: 12.83 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7963.01 GB/s
FLOPS achieved: 39.82 TF/s

Prefill latency: 1.6271479160059243 sec
Decode latency: 12.823067408055067 sec
Time for inference 7: 14.45 sec total, 1133.74 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7960.71 GB/s
FLOPS achieved: 39.80 TF/s

Prefill latency: 1.6222013640217483 sec
Decode latency: 12.825544658931904 sec
Time for inference 8: 14.45 sec total, 1133.93 tokens/sec
Decode latency: 12.83 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7962.06 GB/s
FLOPS achieved: 39.81 TF/s

Prefill latency: 1.6271329110022634 sec
Decode latency: 12.82137892593164 sec
Time for inference 9: 14.45 sec total, 1133.88 tokens/sec
Decode latency: 12.82 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7961.70 GB/s
FLOPS achieved: 39.81 TF/s

Prefill latency: 1.6230269890511408 sec
Decode latency: 12.826593608944677 sec
Time for inference 10: 14.45 sec total, 1133.79 tokens/sec
Decode latency: 12.83 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7961.05 GB/s
FLOPS achieved: 39.81 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.8242 sec
Average prefill latency: 1.6250 sec
Average tokens/sec: 1133.82
Memory used: 77.07 GB
Done. we are killing the process
