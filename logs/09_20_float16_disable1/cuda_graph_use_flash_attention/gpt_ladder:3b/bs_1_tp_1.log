flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
Prefill latency: 0.03261159104295075 sec
Decode latency: 2.470214455970563 sec
Compilation time: 2.50 seconds
Prefill latency: 0.03226693102624267 sec
Decode latency: 2.5904406850459054 sec
Prefill latency: 0.03225945006124675 sec
Decode latency: 2.593190618092194 sec
Prefill latency: 0.03229421004652977 sec
Decode latency: 2.5847303410992026 sec
Prefill latency: 0.03227445692755282 sec
Decode latency: 2.5910117980092764 sec
Prefill latency: 0.032217009109444916 sec
Decode latency: 2.5935172570170835 sec
Time for inference 1: 2.63 sec total, 97.47 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.39 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.03226222493685782 sec
Decode latency: 2.591133525944315 sec
Time for inference 2: 2.62 sec total, 97.56 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.00 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03226755990181118 sec
Decode latency: 2.592951486003585 sec
Time for inference 3: 2.63 sec total, 97.49 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.52 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.032258811057545245 sec
Decode latency: 2.593495507026091 sec
Time for inference 4: 2.63 sec total, 97.47 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.39 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.032258908031508327 sec
Decode latency: 2.5930887568974867 sec
Time for inference 5: 2.63 sec total, 97.48 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.47 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.032278018072247505 sec
Decode latency: 2.59177624899894 sec
Time for inference 6: 2.63 sec total, 97.52 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.76 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.03229220898356289 sec
Decode latency: 2.5927687359508127 sec
Time for inference 7: 2.63 sec total, 97.49 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.53 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.032218602020293474 sec
Decode latency: 2.593350301962346 sec
Time for inference 8: 2.63 sec total, 97.47 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.40 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.03234217199496925 sec
Decode latency: 2.593504874035716 sec
Time for inference 9: 2.63 sec total, 97.46 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.35 GB/s
FLOPS achieved: 3.42 TF/s

Prefill latency: 0.03229777095839381 sec
Decode latency: 2.5927707250230014 sec
Time for inference 10: 2.63 sec total, 97.49 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 684.55 GB/s
FLOPS achieved: 3.42 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5928 sec
Average prefill latency: 0.0323 sec
Average tokens/sec: 97.49
Memory used: 8.80 GB
Done. we are killing the process
