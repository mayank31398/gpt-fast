flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W1001 02:55:06.728434783 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.3964443610748276 sec
Decode latency: 5.282556531950831 sec
Compilation time: 5.68 seconds
Prefill latency: 0.39678544003982097 sec
Decode latency: 5.281934357946739 sec
Prefill latency: 0.3975388068938628 sec
Decode latency: 5.281723191961646 sec
Prefill latency: 0.3974794039968401 sec
Decode latency: 5.282620850019157 sec
Prefill latency: 0.39632318110670894 sec
Decode latency: 5.283133398974314 sec
Prefill latency: 0.39672259998042136 sec
Decode latency: 5.269900266081095 sec
Time for inference 1: 5.67 sec total, 722.71 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5074.60 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.3973632720299065 sec
Decode latency: 5.270475699915551 sec
Time for inference 2: 5.67 sec total, 722.56 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.55 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.3982751070288941 sec
Decode latency: 5.2702087530633435 sec
Time for inference 3: 5.67 sec total, 722.46 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.88 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.39892813202459365 sec
Decode latency: 5.271441377000883 sec
Time for inference 4: 5.67 sec total, 722.23 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5071.27 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.39744426403194666 sec
Decode latency: 5.270489344024099 sec
Time for inference 5: 5.67 sec total, 722.55 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.47 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.3982833749614656 sec
Decode latency: 5.270627981983125 sec
Time for inference 6: 5.67 sec total, 722.43 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.64 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.3991716019809246 sec
Decode latency: 5.2831938930321485 sec
Time for inference 7: 5.68 sec total, 720.73 tokens/sec
Decode latency: 5.28 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5060.68 GB/s
FLOPS achieved: 25.30 TF/s

Prefill latency: 0.39790182607248425 sec
Decode latency: 5.282789455028251 sec
Time for inference 8: 5.68 sec total, 720.91 tokens/sec
Decode latency: 5.28 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5062.00 GB/s
FLOPS achieved: 25.31 TF/s

Prefill latency: 0.39734777400735766 sec
Decode latency: 5.270649685990065 sec
Time for inference 9: 5.67 sec total, 722.54 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.38 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.39684161206241697 sec
Decode latency: 5.269544477923773 sec
Time for inference 10: 5.67 sec total, 722.73 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5074.75 GB/s
FLOPS achieved: 25.37 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.2729 sec
Average prefill latency: 0.3978 sec
Average tokens/sec: 722.18
Memory used: 24.99 GB
Done. we are killing the process
