flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W1001 02:49:25.905482943 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.10376104107126594 sec
Decode latency: 3.1523091619601473 sec
Compilation time: 3.26 seconds
Prefill latency: 0.10350128798745573 sec
Decode latency: 3.1548810090171173 sec
Prefill latency: 0.10352303902618587 sec
Decode latency: 3.1524974278872833 sec
Prefill latency: 0.10305615293327719 sec
Decode latency: 3.1546683920314535 sec
Prefill latency: 0.10339976998511702 sec
Decode latency: 3.153012791997753 sec
Prefill latency: 0.10312298801727593 sec
Decode latency: 3.153602323960513 sec
Time for inference 1: 3.26 sec total, 314.35 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2207.29 GB/s
FLOPS achieved: 11.04 TF/s

Prefill latency: 0.10318513703532517 sec
Decode latency: 3.1543544490123168 sec
Time for inference 2: 3.26 sec total, 314.28 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.77 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10310829302761704 sec
Decode latency: 3.1543974209344015 sec
Time for inference 3: 3.26 sec total, 314.27 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.72 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10345844295807183 sec
Decode latency: 3.1539159199455753 sec
Time for inference 4: 3.26 sec total, 314.26 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.64 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10330730199348181 sec
Decode latency: 3.1521964040584862 sec
Time for inference 5: 3.26 sec total, 314.45 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2207.94 GB/s
FLOPS achieved: 11.04 TF/s

Prefill latency: 0.1031777769094333 sec
Decode latency: 3.1548805040074512 sec
Time for inference 6: 3.26 sec total, 314.21 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.29 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10355661599896848 sec
Decode latency: 3.155114478082396 sec
Time for inference 7: 3.26 sec total, 314.16 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2205.93 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10319409996736795 sec
Decode latency: 3.152378711034544 sec
Time for inference 8: 3.26 sec total, 314.47 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2208.10 GB/s
FLOPS achieved: 11.04 TF/s

Prefill latency: 0.1032337190117687 sec
Decode latency: 3.15455482294783 sec
Time for inference 9: 3.26 sec total, 314.25 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.57 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10353715601377189 sec
Decode latency: 3.1549312450224534 sec
Time for inference 10: 3.26 sec total, 314.19 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2206.13 GB/s
FLOPS achieved: 11.03 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1540 sec
Average prefill latency: 0.1033 sec
Average tokens/sec: 314.29
Memory used: 12.08 GB
Done. we are killing the process
