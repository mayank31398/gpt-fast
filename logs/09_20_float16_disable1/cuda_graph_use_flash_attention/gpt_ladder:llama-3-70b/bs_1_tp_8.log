W0928 18:37:52.688000 23380559423296 torch/distributed/run.py:779] 
W0928 18:37:52.688000 23380559423296 torch/distributed/run.py:779] *****************************************
W0928 18:37:52.688000 23380559423296 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:37:52.688000 23380559423296 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.47 seconds
Prefill latency: 0.0776528759743087 sec
Decode latency: 5.113070496008731 sec
Compilation time: 5.24 seconds
Compilation time: 5.22 seconds
Compilation time: 5.20 seconds
Compilation time: 5.23 seconds
Compilation time: 5.19 seconds
Compilation time: 5.21 seconds
Compilation time: 5.22 seconds
Compilation time: 5.24 seconds
Prefill latency: 0.0701114569674246 sec
Decode latency: 5.135499615978915 sec
Prefill latency: 0.07079130900092423 sec
Decode latency: 5.1259017860284075 sec
Prefill latency: 0.06987027998548001 sec
Decode latency: 5.131371551018674 sec
Prefill latency: 0.07088439201470464 sec
Decode latency: 5.135567053977866 sec
Prefill latency: 0.06989417795557529 sec
Decode latency: 5.133611682045739 sec
Time for inference 1: 5.20 sec total, 49.19 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 945.21 GB/s
FLOPS achieved: 4.73 TF/s

Prefill latency: 0.07065665000118315 sec
Decode latency: 5.135861155984458 sec
Time for inference 2: 5.21 sec total, 49.16 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 944.62 GB/s
FLOPS achieved: 4.72 TF/s

Prefill latency: 0.06978723901556805 sec
Decode latency: 5.128780677972827 sec
Time for inference 3: 5.20 sec total, 49.23 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 946.10 GB/s
FLOPS achieved: 4.73 TF/s

Prefill latency: 0.07020596298389137 sec
Decode latency: 5.129422430996783 sec
Time for inference 4: 5.20 sec total, 49.22 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 945.90 GB/s
FLOPS achieved: 4.73 TF/s

Prefill latency: 0.06991928099887446 sec
Decode latency: 5.133029479999095 sec
Time for inference 5: 5.20 sec total, 49.19 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 945.32 GB/s
FLOPS achieved: 4.73 TF/s

Prefill latency: 0.07056594401365146 sec
Decode latency: 5.134747545991559 sec
Time for inference 6: 5.21 sec total, 49.17 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 944.89 GB/s
FLOPS achieved: 4.72 TF/s

Prefill latency: 0.07035054499283433 sec
Decode latency: 5.137070222990587 sec
Time for inference 7: 5.21 sec total, 49.15 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 944.51 GB/s
FLOPS achieved: 4.72 TF/s

Prefill latency: 0.07028164097573608 sec
Decode latency: 5.1348977200104855 sec
Time for inference 8: 5.21 sec total, 49.17 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 944.91 GB/s
FLOPS achieved: 4.72 TF/s

Prefill latency: 0.06976417097030208 sec
Decode latency: 5.128165510017425 sec
Time for inference 9: 5.20 sec total, 49.24 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 946.21 GB/s
FLOPS achieved: 4.73 TF/s

Prefill latency: 0.07436813495587558 sec
Decode latency: 5.14315377001185 sec
Time for inference 10: 5.22 sec total, 49.05 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 942.67 GB/s
FLOPS achieved: 4.71 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1339 sec
Average prefill latency: 0.0706 sec
Average tokens/sec: 49.18
Memory used: 24.90 GB
Done. we are killing the process
