W0928 18:50:31.646000 23020979713856 torch/distributed/run.py:779] 
W0928 18:50:31.646000 23020979713856 torch/distributed/run.py:779] *****************************************
W0928 18:50:31.646000 23020979713856 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:50:31.646000 23020979713856 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.43 seconds
[rank6]:[W928 18:50:48.192638665 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.836520564975217 sec
Decode latency: 8.614136106974911 sec
Compilation time: 9.39 secondsCompilation time: 9.40 seconds

Compilation time: 9.39 seconds
Compilation time: 9.45 seconds
Compilation time: 9.39 seconds
Compilation time: 9.43 seconds
Compilation time: 9.43 seconds
Compilation time: 9.45 seconds
Prefill latency: 0.7713846859987825 sec
Decode latency: 8.596098652982619 sec
Prefill latency: 0.7724741459824145 sec
Decode latency: 8.585085638973396 sec
Prefill latency: 0.7730834780377336 sec
Decode latency: 8.569896809000056 sec
Prefill latency: 0.7690978430327959 sec
Decode latency: 8.58048644795781 sec
Prefill latency: 0.7741258250316605 sec
Decode latency: 8.5595415320131 sec
Time for inference 1: 9.34 sec total, 438.78 tokens/sec
Decode latency: 8.56 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8431.89 GB/s
FLOPS achieved: 42.16 TF/s

Prefill latency: 0.7694300870061852 sec
Decode latency: 8.570361885998864 sec
Time for inference 2: 9.34 sec total, 438.46 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8425.84 GB/s
FLOPS achieved: 42.13 TF/s

Prefill latency: 0.7740359409945086 sec
Decode latency: 8.576592748984694 sec
Time for inference 3: 9.35 sec total, 437.98 tokens/sec
Decode latency: 8.58 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8416.53 GB/s
FLOPS achieved: 42.08 TF/s

Prefill latency: 0.771159452968277 sec
Decode latency: 8.577783852990251 sec
Time for inference 4: 9.35 sec total, 438.06 tokens/sec
Decode latency: 8.58 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8418.01 GB/s
FLOPS achieved: 42.09 TF/s

Prefill latency: 0.7721719650435261 sec
Decode latency: 8.548697557009291 sec
Time for inference 5: 9.32 sec total, 439.38 tokens/sec
Decode latency: 8.55 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8443.38 GB/s
FLOPS achieved: 42.22 TF/s

Prefill latency: 0.7716633669915609 sec
Decode latency: 8.588379398046527 sec
Time for inference 6: 9.36 sec total, 437.55 tokens/sec
Decode latency: 8.59 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8408.20 GB/s
FLOPS achieved: 42.04 TF/s

Prefill latency: 0.7747587729827501 sec
Decode latency: 8.560158342006616 sec
Time for inference 7: 9.34 sec total, 438.72 tokens/sec
Decode latency: 8.56 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8430.78 GB/s
FLOPS achieved: 42.15 TF/s

Prefill latency: 0.7747446059947833 sec
Decode latency: 8.564634267997462 sec
Time for inference 8: 9.34 sec total, 438.52 tokens/sec
Decode latency: 8.56 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8426.88 GB/s
FLOPS achieved: 42.13 TF/s

Prefill latency: 0.7720643610227853 sec
Decode latency: 8.580255524022505 sec
Time for inference 9: 9.35 sec total, 437.91 tokens/sec
Decode latency: 8.58 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8415.13 GB/s
FLOPS achieved: 42.08 TF/s

Prefill latency: 0.7730948260286823 sec
Decode latency: 8.60169656202197 sec
Time for inference 10: 9.38 sec total, 436.85 tokens/sec
Decode latency: 8.60 sec
Prefill latency: 0.77 sec
Bandwidth achieved: 8394.90 GB/s
FLOPS achieved: 41.97 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.5728 sec
Average prefill latency: 0.7727 sec
Average tokens/sec: 438.22
Memory used: 71.17 GB
Done. we are killing the process
