W0928 18:42:16.837000 23004204492608 torch/distributed/run.py:779] 
W0928 18:42:16.837000 23004204492608 torch/distributed/run.py:779] *****************************************
W0928 18:42:16.837000 23004204492608 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:42:16.837000 23004204492608 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.41 seconds
Prefill latency: 0.23548695800127462 sec
Decode latency: 5.951379286008887 sec
Compilation time: 6.17 seconds
Compilation time: 6.17 seconds
Compilation time: 6.18 seconds
Compilation time: 6.20 seconds
Compilation time: 6.17 seconds
Compilation time: 6.19 seconds
Compilation time: 6.19 seconds
Compilation time: 6.17 seconds
Prefill latency: 0.20433234400115907 sec
Decode latency: 5.950634316017386 sec
Prefill latency: 0.20343163498910144 sec
Decode latency: 5.964505845971871 sec
Prefill latency: 0.20499963697511703 sec
Decode latency: 5.95480907097226 sec
Prefill latency: 0.20472874899860471 sec
Decode latency: 5.9566100560477935 sec
Prefill latency: 0.2024672669940628 sec
Decode latency: 5.9487673790426925 sec
Time for inference 1: 6.15 sec total, 166.44 tokens/sec
Decode latency: 5.95 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3198.39 GB/s
FLOPS achieved: 15.99 TF/s

Prefill latency: 0.2031636059982702 sec
Decode latency: 5.942519837000873 sec
Time for inference 2: 6.15 sec total, 166.59 tokens/sec
Decode latency: 5.94 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3201.32 GB/s
FLOPS achieved: 16.01 TF/s

Prefill latency: 0.20473226299509406 sec
Decode latency: 5.937193845049478 sec
Time for inference 3: 6.14 sec total, 166.69 tokens/sec
Decode latency: 5.94 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3203.21 GB/s
FLOPS achieved: 16.02 TF/s

Prefill latency: 0.20395970402751118 sec
Decode latency: 5.948227422952186 sec
Time for inference 4: 6.15 sec total, 166.41 tokens/sec
Decode latency: 5.95 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3197.94 GB/s
FLOPS achieved: 15.99 TF/s

Prefill latency: 0.20297474798280746 sec
Decode latency: 5.948213430005126 sec
Time for inference 5: 6.15 sec total, 166.44 tokens/sec
Decode latency: 5.95 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3198.43 GB/s
FLOPS achieved: 15.99 TF/s

Prefill latency: 0.20441885699983686 sec
Decode latency: 5.946494632982649 sec
Time for inference 6: 6.15 sec total, 166.45 tokens/sec
Decode latency: 5.95 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3198.59 GB/s
FLOPS achieved: 15.99 TF/s

Prefill latency: 0.20477464300347492 sec
Decode latency: 5.942326127027627 sec
Time for inference 7: 6.15 sec total, 166.55 tokens/sec
Decode latency: 5.94 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3200.58 GB/s
FLOPS achieved: 16.00 TF/s

Prefill latency: 0.2089085760526359 sec
Decode latency: 5.920414128981065 sec
Time for inference 8: 6.13 sec total, 167.04 tokens/sec
Decode latency: 5.92 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 3209.87 GB/s
FLOPS achieved: 16.05 TF/s

Prefill latency: 0.2046318089705892 sec
Decode latency: 5.952389360987581 sec
Time for inference 9: 6.16 sec total, 166.28 tokens/sec
Decode latency: 5.95 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3195.41 GB/s
FLOPS achieved: 15.98 TF/s

Prefill latency: 0.20445855701109394 sec
Decode latency: 5.990234230994247 sec
Time for inference 10: 6.20 sec total, 165.27 tokens/sec
Decode latency: 5.99 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3176.00 GB/s
FLOPS achieved: 15.88 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.9477 sec
Average prefill latency: 0.2044 sec
Average tokens/sec: 166.42
Memory used: 33.90 GB
Done. we are killing the process
