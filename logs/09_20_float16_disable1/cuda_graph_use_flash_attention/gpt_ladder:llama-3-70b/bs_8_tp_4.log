W0928 18:44:26.892000 23255390574400 torch/distributed/run.py:779] 
W0928 18:44:26.892000 23255390574400 torch/distributed/run.py:779] *****************************************
W0928 18:44:26.892000 23255390574400 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:44:26.892000 23255390574400 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.50 seconds
Prefill latency: 0.682234256004449 sec
Decode latency: 9.242131336010061 sec
Compilation time: 9.93 seconds
Compilation time: 9.93 secondsCompilation time: 9.92 seconds

Compilation time: 9.93 seconds
Prefill latency: 0.6823140039923601 sec
Decode latency: 9.23836413200479 sec
Prefill latency: 0.6857238549855538 sec
Decode latency: 9.244148791010957 sec
Prefill latency: 0.6865459430264309 sec
Decode latency: 9.245163475978188 sec
Prefill latency: 0.687808648974169 sec
Decode latency: 9.245969507028349 sec
Prefill latency: 0.6866092720301822 sec
Decode latency: 9.244392491993494 sec
Time for inference 1: 9.93 sec total, 206.20 tokens/sec
Decode latency: 9.24 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7491.27 GB/s
FLOPS achieved: 37.46 TF/s

Prefill latency: 0.6861286620260216 sec
Decode latency: 9.244123734999448 sec
Time for inference 2: 9.93 sec total, 206.22 tokens/sec
Decode latency: 9.24 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7491.76 GB/s
FLOPS achieved: 37.46 TF/s

Prefill latency: 0.6865462550194934 sec
Decode latency: 9.244316880009137 sec
Time for inference 3: 9.93 sec total, 206.21 tokens/sec
Decode latency: 9.24 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7491.34 GB/s
FLOPS achieved: 37.46 TF/s

Prefill latency: 0.685425272968132 sec
Decode latency: 9.243147208995651 sec
Time for inference 4: 9.93 sec total, 206.25 tokens/sec
Decode latency: 9.24 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7493.11 GB/s
FLOPS achieved: 37.47 TF/s

Prefill latency: 0.6873374860151671 sec
Decode latency: 9.242629067972302 sec
Time for inference 5: 9.93 sec total, 206.22 tokens/sec
Decode latency: 9.24 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7491.94 GB/s
FLOPS achieved: 37.46 TF/s

Prefill latency: 0.6851287150057033 sec
Decode latency: 9.245681605010759 sec
Time for inference 6: 9.93 sec total, 206.21 tokens/sec
Decode latency: 9.25 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7491.44 GB/s
FLOPS achieved: 37.46 TF/s

Prefill latency: 0.6872958969906904 sec
Decode latency: 9.245258860988542 sec
Time for inference 7: 9.93 sec total, 206.17 tokens/sec
Decode latency: 9.25 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7490.11 GB/s
FLOPS achieved: 37.45 TF/s

Prefill latency: 0.6875745370052755 sec
Decode latency: 9.245180188969243 sec
Time for inference 8: 9.93 sec total, 206.16 tokens/sec
Decode latency: 9.25 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7489.85 GB/s
FLOPS achieved: 37.45 TF/s

Prefill latency: 0.6864372900454327 sec
Decode latency: 9.245494154980406 sec
Time for inference 9: 9.93 sec total, 206.18 tokens/sec
Decode latency: 9.25 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7490.51 GB/s
FLOPS achieved: 37.45 TF/s

Prefill latency: 0.6859410330071114 sec
Decode latency: 9.24613559700083 sec
Time for inference 10: 9.93 sec total, 206.18 tokens/sec
Decode latency: 9.25 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 7490.48 GB/s
FLOPS achieved: 37.45 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 9.2446 sec
Average prefill latency: 0.6864 sec
Average tokens/sec: 206.20
Memory used: 72.14 GB
Done. we are killing the process
