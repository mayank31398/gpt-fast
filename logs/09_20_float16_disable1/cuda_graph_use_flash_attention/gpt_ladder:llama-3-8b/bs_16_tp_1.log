flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.17 seconds
Prefill latency: 0.5991295870044269 sec
Decode latency: 6.666133702965453 sec
Compilation time: 7.27 seconds
Prefill latency: 0.601625903043896 sec
Decode latency: 6.665529581019655 sec
Prefill latency: 0.6028516460210085 sec
Decode latency: 6.658583447977435 sec
Prefill latency: 0.6029669440467842 sec
Decode latency: 6.658927119977307 sec
Prefill latency: 0.6042429869994521 sec
Decode latency: 6.656755180039909 sec
Prefill latency: 0.6052806639927439 sec
Decode latency: 6.6573649939964525 sec
Time for inference 1: 7.26 sec total, 563.90 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8464.11 GB/s
FLOPS achieved: 42.32 TF/s

Prefill latency: 0.6067104270332493 sec
Decode latency: 6.6589837510255165 sec
Time for inference 2: 7.27 sec total, 563.66 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8460.40 GB/s
FLOPS achieved: 42.30 TF/s

Prefill latency: 0.6031850689905696 sec
Decode latency: 6.658052408020012 sec
Time for inference 3: 7.26 sec total, 564.01 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.72 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.6026235249591991 sec
Decode latency: 6.659035976976156 sec
Time for inference 4: 7.26 sec total, 563.98 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.29 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.6036933040013537 sec
Decode latency: 6.658180185011588 sec
Time for inference 5: 7.26 sec total, 563.97 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.15 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.6048430370283313 sec
Decode latency: 6.658529932959937 sec
Time for inference 6: 7.26 sec total, 563.85 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8463.30 GB/s
FLOPS achieved: 42.32 TF/s

Prefill latency: 0.604939564014785 sec
Decode latency: 6.658448560978286 sec
Time for inference 7: 7.26 sec total, 563.85 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8463.27 GB/s
FLOPS achieved: 42.32 TF/s

Prefill latency: 0.6035470990464091 sec
Decode latency: 6.657974645961076 sec
Time for inference 8: 7.26 sec total, 564.00 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8465.50 GB/s
FLOPS achieved: 42.33 TF/s

Prefill latency: 0.6038841030094773 sec
Decode latency: 6.660773932002485 sec
Time for inference 9: 7.27 sec total, 563.76 tokens/sec
Decode latency: 6.66 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8461.92 GB/s
FLOPS achieved: 42.31 TF/s

Prefill latency: 0.6036474769935012 sec
Decode latency: 6.603332698985469 sec
Time for inference 10: 7.21 sec total, 568.25 tokens/sec
Decode latency: 6.60 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8529.36 GB/s
FLOPS achieved: 42.65 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6531 sec
Average prefill latency: 0.6042 sec
Average tokens/sec: 564.32
Memory used: 36.19 GB
