flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.16 seconds
Prefill latency: 0.14858688495587558 sec
Decode latency: 3.591968188993633 sec
Compilation time: 3.74 seconds
Prefill latency: 0.14918560697697103 sec
Decode latency: 3.5400119519908912 sec
Prefill latency: 0.15009055100381374 sec
Decode latency: 3.5894538429565728 sec
Prefill latency: 0.14847723202547058 sec
Decode latency: 3.587134886009153 sec
Prefill latency: 0.14991087600355968 sec
Decode latency: 3.5875920219696127 sec
Prefill latency: 0.1489513999549672 sec
Decode latency: 3.587451124971267 sec
Time for inference 1: 3.74 sec total, 274.01 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4112.78 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.1494884550338611 sec
Decode latency: 3.5879599560284987 sec
Time for inference 2: 3.74 sec total, 273.91 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4111.34 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.14929084799950942 sec
Decode latency: 3.589738444017712 sec
Time for inference 3: 3.74 sec total, 273.80 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4109.75 GB/s
FLOPS achieved: 20.55 TF/s

Prefill latency: 0.1491020229877904 sec
Decode latency: 3.589100368961226 sec
Time for inference 4: 3.74 sec total, 273.86 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4110.58 GB/s
FLOPS achieved: 20.55 TF/s

Prefill latency: 0.14974186097970232 sec
Decode latency: 3.589187566016335 sec
Time for inference 5: 3.74 sec total, 273.82 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4109.98 GB/s
FLOPS achieved: 20.55 TF/s

Prefill latency: 0.14936664700508118 sec
Decode latency: 3.546380272018723 sec
Time for inference 6: 3.70 sec total, 277.01 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4157.91 GB/s
FLOPS achieved: 20.79 TF/s

Prefill latency: 0.1494922050042078 sec
Decode latency: 3.588238566007931 sec
Time for inference 7: 3.74 sec total, 273.91 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4111.32 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.14985220500966534 sec
Decode latency: 3.5876404820010066 sec
Time for inference 8: 3.74 sec total, 273.93 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4111.67 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.1496657480020076 sec
Decode latency: 3.50696044403594 sec
Time for inference 9: 3.66 sec total, 279.99 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4202.58 GB/s
FLOPS achieved: 21.01 TF/s

Prefill latency: 0.14914974494604394 sec
Decode latency: 3.58667939301813 sec
Time for inference 10: 3.74 sec total, 274.05 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4113.48 GB/s
FLOPS achieved: 20.57 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5759 sec
Average prefill latency: 0.1494 sec
Average tokens/sec: 274.83
Memory used: 21.21 GB
Done. we are killing the process
