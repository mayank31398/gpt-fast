flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.15 seconds
Prefill latency: 0.14879687095526606 sec
Decode latency: 3.5905032670125365 sec
Compilation time: 3.74 seconds
Prefill latency: 0.1488167800125666 sec
Decode latency: 3.5896614200319164 sec
Prefill latency: 0.1489452850073576 sec
Decode latency: 3.589967144012917 sec
Prefill latency: 0.14917276799678802 sec
Decode latency: 3.5856985169812106 sec
Prefill latency: 0.14916221797466278 sec
Decode latency: 3.5863597589777783 sec
Prefill latency: 0.14875689602922648 sec
Decode latency: 3.588249836990144 sec
Time for inference 1: 3.74 sec total, 273.96 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4112.08 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.14861852501053363 sec
Decode latency: 3.557284237991553 sec
Time for inference 2: 3.71 sec total, 276.25 tokens/sec
Decode latency: 3.56 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4146.53 GB/s
FLOPS achieved: 20.73 TF/s

Prefill latency: 0.14919668302172795 sec
Decode latency: 3.5859360659960657 sec
Time for inference 3: 3.74 sec total, 274.08 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4113.91 GB/s
FLOPS achieved: 20.57 TF/s

Prefill latency: 0.15013418794842437 sec
Decode latency: 3.5870954199926928 sec
Time for inference 4: 3.74 sec total, 273.93 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4111.69 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.14896470896201208 sec
Decode latency: 3.5726525930222124 sec
Time for inference 5: 3.72 sec total, 275.08 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4128.95 GB/s
FLOPS achieved: 20.64 TF/s

Prefill latency: 0.1497428820002824 sec
Decode latency: 3.589508589997422 sec
Time for inference 6: 3.74 sec total, 273.79 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4109.59 GB/s
FLOPS achieved: 20.55 TF/s

Prefill latency: 0.1493784170015715 sec
Decode latency: 3.5872264000354335 sec
Time for inference 7: 3.74 sec total, 273.98 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4112.47 GB/s
FLOPS achieved: 20.56 TF/s

Prefill latency: 0.14919695298885927 sec
Decode latency: 3.4963451600051485 sec
Time for inference 8: 3.65 sec total, 280.83 tokens/sec
Decode latency: 3.50 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4215.22 GB/s
FLOPS achieved: 21.08 TF/s

Prefill latency: 0.14975083601893857 sec
Decode latency: 3.5858101139892824 sec
Time for inference 9: 3.74 sec total, 274.06 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4113.61 GB/s
FLOPS achieved: 20.57 TF/s

Prefill latency: 0.14999884797725827 sec
Decode latency: 3.587370830005966 sec
Time for inference 10: 3.74 sec total, 273.92 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4111.50 GB/s
FLOPS achieved: 20.56 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5737 sec
Average prefill latency: 0.1494 sec
Average tokens/sec: 274.99
Memory used: 21.21 GB
