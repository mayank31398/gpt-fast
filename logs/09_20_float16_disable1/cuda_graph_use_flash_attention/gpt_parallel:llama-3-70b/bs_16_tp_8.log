W0928 20:27:19.310000 22989289473856 torch/distributed/run.py:779] 
W0928 20:27:19.310000 22989289473856 torch/distributed/run.py:779] *****************************************
W0928 20:27:19.310000 22989289473856 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:27:19.310000 22989289473856 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=8448, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.34 seconds
Prefill latency: 0.8755134560051374 sec
Decode latency: 8.802972881007008 sec
Compilation time: 9.65 seconds
Compilation time: 9.65 secondsCompilation time: 9.66 seconds

Compilation time: 9.63 seconds
Compilation time: 9.68 seconds
Compilation time: 9.68 seconds
Compilation time: 9.65 seconds
Compilation time: 9.67 seconds
Prefill latency: 0.8140529739903286 sec
Decode latency: 8.83788166200975 sec
Prefill latency: 0.8124856280046515 sec
Decode latency: 8.811062765016686 sec
Prefill latency: 0.8119080939795822 sec
Decode latency: 8.823691508965567 sec
Prefill latency: 0.8134822740103118 sec
Decode latency: 8.810897663992364 sec
Prefill latency: 0.8084898520028219 sec
Decode latency: 8.802509898028802 sec
Time for inference 1: 9.61 sec total, 426.13 tokens/sec
Decode latency: 8.80 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8188.30 GB/s
FLOPS achieved: 40.94 TF/s

Prefill latency: 0.8110222509712912 sec
Decode latency: 8.803937299991958 sec
Time for inference 2: 9.62 sec total, 425.95 tokens/sec
Decode latency: 8.80 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8184.87 GB/s
FLOPS achieved: 40.92 TF/s

Prefill latency: 0.8119229690055363 sec
Decode latency: 8.802147003007121 sec
Time for inference 3: 9.62 sec total, 425.99 tokens/sec
Decode latency: 8.80 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8185.61 GB/s
FLOPS achieved: 40.93 TF/s

Prefill latency: 0.8114041340304539 sec
Decode latency: 8.820375861017965 sec
Time for inference 4: 9.63 sec total, 425.21 tokens/sec
Decode latency: 8.82 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8170.59 GB/s
FLOPS achieved: 40.85 TF/s

Prefill latency: 0.8138329810462892 sec
Decode latency: 8.798723895044532 sec
Time for inference 5: 9.61 sec total, 426.06 tokens/sec
Decode latency: 8.80 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8186.94 GB/s
FLOPS achieved: 40.93 TF/s

Prefill latency: 0.8114735130220652 sec
Decode latency: 8.826539080007933 sec
Time for inference 6: 9.64 sec total, 424.94 tokens/sec
Decode latency: 8.83 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8165.35 GB/s
FLOPS achieved: 40.83 TF/s

Prefill latency: 0.8156524570076726 sec
Decode latency: 8.790627459005918 sec
Time for inference 7: 9.61 sec total, 426.33 tokens/sec
Decode latency: 8.79 sec
Prefill latency: 0.82 sec
Bandwidth achieved: 8192.16 GB/s
FLOPS achieved: 40.96 TF/s

Prefill latency: 0.8118344949907623 sec
Decode latency: 8.846791414020117 sec
Time for inference 8: 9.66 sec total, 424.03 tokens/sec
Decode latency: 8.85 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8147.94 GB/s
FLOPS achieved: 40.74 TF/s

Prefill latency: 0.8132677259854972 sec
Decode latency: 8.780333101050928 sec
Time for inference 9: 9.59 sec total, 426.91 tokens/sec
Decode latency: 8.78 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8203.20 GB/s
FLOPS achieved: 41.02 TF/s

Prefill latency: 0.8146125550265424 sec
Decode latency: 8.839812098012771 sec
Time for inference 10: 9.66 sec total, 424.22 tokens/sec
Decode latency: 8.84 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 8151.53 GB/s
FLOPS achieved: 40.76 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.8112 sec
Average prefill latency: 0.8124 sec
Average tokens/sec: 425.58
Memory used: 49.94 GB
Done. we are killing the process
