W0928 20:15:17.900000 23051823073088 torch/distributed/run.py:779] 
W0928 20:15:17.900000 23051823073088 torch/distributed/run.py:779] *****************************************
W0928 20:15:17.900000 23051823073088 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:15:17.900000 23051823073088 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=8448, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.36 seconds
Prefill latency: 0.24220274103572592 sec
Decode latency: 6.868721776001621 sec
Compilation time: 7.09 seconds
Compilation time: 7.10 seconds
Compilation time: 7.10 seconds
Compilation time: 7.09 seconds
Compilation time: 7.13 seconds
Compilation time: 7.11 seconds
Compilation time: 7.10 seconds
Compilation time: 7.10 seconds
Prefill latency: 0.2114594749873504 sec
Decode latency: 6.8735347769688815 sec
Prefill latency: 0.2105369579512626 sec
Decode latency: 6.882189330004621 sec
Prefill latency: 0.2108522880007513 sec
Decode latency: 6.887244884972461 sec
Prefill latency: 0.2099492289707996 sec
Decode latency: 6.864645076973829 sec
Prefill latency: 0.21195199998328462 sec
Decode latency: 6.8963724200148135 sec
Time for inference 1: 7.11 sec total, 144.03 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2767.69 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.2104245109949261 sec
Decode latency: 6.903241881984286 sec
Time for inference 2: 7.11 sec total, 143.93 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2765.60 GB/s
FLOPS achieved: 13.83 TF/s

Prefill latency: 0.21122540795477107 sec
Decode latency: 6.873533189995214 sec
Time for inference 3: 7.09 sec total, 144.51 tokens/sec
Decode latency: 6.87 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2776.89 GB/s
FLOPS achieved: 13.88 TF/s

Prefill latency: 0.2098646050435491 sec
Decode latency: 6.872080266999546 sec
Time for inference 4: 7.08 sec total, 144.57 tokens/sec
Decode latency: 6.87 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2777.94 GB/s
FLOPS achieved: 13.89 TF/s

Prefill latency: 0.21033417899161577 sec
Decode latency: 6.866510520980228 sec
Time for inference 5: 7.08 sec total, 144.67 tokens/sec
Decode latency: 6.87 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2779.96 GB/s
FLOPS achieved: 13.90 TF/s

Prefill latency: 0.20856971899047494 sec
Decode latency: 6.886803978995886 sec
Time for inference 6: 7.10 sec total, 144.29 tokens/sec
Decode latency: 6.89 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2772.67 GB/s
FLOPS achieved: 13.86 TF/s

Prefill latency: 0.2103687620256096 sec
Decode latency: 6.874794916016981 sec
Time for inference 7: 7.09 sec total, 144.50 tokens/sec
Decode latency: 6.87 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2776.67 GB/s
FLOPS achieved: 13.88 TF/s

Prefill latency: 0.21020673698512837 sec
Decode latency: 6.911137942981441 sec
Time for inference 8: 7.12 sec total, 143.77 tokens/sec
Decode latency: 6.91 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2762.61 GB/s
FLOPS achieved: 13.81 TF/s

Prefill latency: 0.21058361697942019 sec
Decode latency: 6.879674200958107 sec
Time for inference 9: 7.09 sec total, 144.40 tokens/sec
Decode latency: 6.88 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2774.77 GB/s
FLOPS achieved: 13.87 TF/s

Prefill latency: 0.2092085590120405 sec
Decode latency: 6.889066997973714 sec
Time for inference 10: 7.10 sec total, 144.23 tokens/sec
Decode latency: 6.89 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2771.52 GB/s
FLOPS achieved: 13.86 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.8853 sec
Average prefill latency: 0.2103 sec
Average tokens/sec: 144.29
Memory used: 28.58 GB
Done. we are killing the process
