W0928 20:07:50.909000 22659866113856 torch/distributed/run.py:779] 
W0928 20:07:50.909000 22659866113856 torch/distributed/run.py:779] *****************************************
W0928 20:07:50.909000 22659866113856 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:07:50.909000 22659866113856 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=16896, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 10.97 seconds
Prefill latency: 0.09837532794335857 sec
Decode latency: 7.22863230900839 sec
Compilation time: 7.33 seconds
Compilation time: 7.39 secondsCompilation time: 7.33 seconds

Compilation time: 7.33 seconds
Prefill latency: 0.09732534200884402 sec
Decode latency: 7.229711366002448 sec
Prefill latency: 0.09734246402513236 sec
Decode latency: 7.2290327260270715 sec
Prefill latency: 0.09724390500923619 sec
Decode latency: 7.229377484996803 sec
Prefill latency: 0.09751396800857037 sec
Decode latency: 7.230636310996488 sec
Prefill latency: 0.09742452495265752 sec
Decode latency: 7.2307186929974705 sec
Time for inference 1: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.90 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09743873198749498 sec
Decode latency: 7.230397681007162 sec
Time for inference 2: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.97 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09729016799246892 sec
Decode latency: 7.231103907979559 sec
Time for inference 3: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.89 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09752066398505121 sec
Decode latency: 7.231098101008683 sec
Time for inference 4: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.87 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09761763300048187 sec
Decode latency: 7.230530704022385 sec
Time for inference 5: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.90 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09725226403679699 sec
Decode latency: 7.229026201996021 sec
Time for inference 6: 7.33 sec total, 34.94 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1269.25 GB/s
FLOPS achieved: 6.35 TF/s

Prefill latency: 0.09744097199290991 sec
Decode latency: 7.231038121972233 sec
Time for inference 7: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.88 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09754568204516545 sec
Decode latency: 7.230037341010757 sec
Time for inference 8: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1269.03 GB/s
FLOPS achieved: 6.35 TF/s

Prefill latency: 0.09729380498174578 sec
Decode latency: 7.230310710030608 sec
Time for inference 9: 7.33 sec total, 34.93 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1268.99 GB/s
FLOPS achieved: 6.34 TF/s

Prefill latency: 0.09757123299641535 sec
Decode latency: 7.229371196997818 sec
Time for inference 10: 7.33 sec total, 34.94 tokens/sec
Decode latency: 7.23 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1269.13 GB/s
FLOPS achieved: 6.35 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.2304 sec
Average prefill latency: 0.0974 sec
Average tokens/sec: 34.93
Memory used: 40.45 GB
Done. we are killing the process
