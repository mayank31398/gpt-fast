W0928 20:04:48.631000 22696381015872 torch/distributed/run.py:779] 
W0928 20:04:48.631000 22696381015872 torch/distributed/run.py:779] *****************************************
W0928 20:04:48.631000 22696381015872 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:04:48.631000 22696381015872 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=33792, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.54 seconds
Prefill latency: 0.25855500798206776 sec
Decode latency: 10.207035903993528 sec
Compilation time: 10.48 seconds
Compilation time: 10.47 seconds
Prefill latency: 0.24561298498883843 sec
Decode latency: 10.206221733998973 sec
Prefill latency: 0.24583358701784164 sec
Decode latency: 10.204998116008937 sec
Prefill latency: 0.24584390100790188 sec
Decode latency: 10.204728044976946 sec
Prefill latency: 0.24616312904981896 sec
Decode latency: 10.206907102023251 sec
Prefill latency: 0.24565197905758396 sec
Decode latency: 10.207318685017526 sec
Time for inference 1: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.76 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24586398602696136 sec
Decode latency: 10.207788462983444 sec
Time for inference 2: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.65 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24543612997513264 sec
Decode latency: 10.20629329100484 sec
Time for inference 3: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.94 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24569110601441935 sec
Decode latency: 10.206658862996846 sec
Time for inference 4: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.86 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24534526601200923 sec
Decode latency: 10.206759691005573 sec
Time for inference 5: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.90 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24557839101180434 sec
Decode latency: 10.206825168977957 sec
Time for inference 6: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.83 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.2454256329801865 sec
Decode latency: 10.206320794997737 sec
Time for inference 7: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.95 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24569458101177588 sec
Decode latency: 10.206900691962801 sec
Time for inference 8: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.82 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24542021396337077 sec
Decode latency: 10.206787099014036 sec
Time for inference 9: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.87 GB/s
FLOPS achieved: 8.64 TF/s

Prefill latency: 0.24573611101368442 sec
Decode latency: 10.206793194054626 sec
Time for inference 10: 10.45 sec total, 24.49 tokens/sec
Decode latency: 10.21 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 1727.83 GB/s
FLOPS achieved: 8.64 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.2068 sec
Average prefill latency: 0.2456 sec
Average tokens/sec: 24.49
Memory used: 75.79 GB
Done. we are killing the process
