W0928 19:51:21.894000 22378748745536 torch/distributed/run.py:779] 
W0928 19:51:21.894000 22378748745536 torch/distributed/run.py:779] *****************************************
W0928 19:51:21.894000 22378748745536 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:51:21.894000 22378748745536 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 5.165989999019075 sec
Compilation time: 31.19 seconds
Compilation time: 31.34 seconds
Decode latency: 26.036674515984487 sec
Compilation time: 31.20 seconds
Compilation time: 31.37 seconds
Prefill latency: 5.184420426026918 sec
Decode latency: 26.036015762016177 sec
Prefill latency: 5.186109043017495 sec
Decode latency: 25.795714028994553 sec
Prefill latency: 5.164339436974842 sec
Decode latency: 25.746010411006864 sec
Prefill latency: 5.196890433959197 sec
Decode latency: 26.035600217001047 sec
Prefill latency: 5.180283904017415 sec
Decode latency: 26.03693749802187 sec
Time for inference 1: 31.22 sec total, 524.82 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.18 sec
Bandwidth achieved: 19066.49 GB/s
FLOPS achieved: 95.33 TF/s

Prefill latency: 5.18093144800514 sec
Decode latency: 26.03445348900277 sec
Time for inference 2: 31.22 sec total, 524.85 tokens/sec
Decode latency: 26.03 sec
Prefill latency: 5.18 sec
Bandwidth achieved: 19067.63 GB/s
FLOPS achieved: 95.34 TF/s

Prefill latency: 5.150553909013979 sec
Decode latency: 26.03304216702236 sec
Time for inference 3: 31.18 sec total, 525.39 tokens/sec
Decode latency: 26.03 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19087.06 GB/s
FLOPS achieved: 95.44 TF/s

Prefill latency: 5.157487919961568 sec
Decode latency: 26.038405710016377 sec
Time for inference 4: 31.20 sec total, 525.18 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19079.56 GB/s
FLOPS achieved: 95.40 TF/s

Prefill latency: 5.157885932945646 sec
Decode latency: 26.027985783002805 sec
Time for inference 5: 31.19 sec total, 525.35 tokens/sec
Decode latency: 26.03 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19085.70 GB/s
FLOPS achieved: 95.43 TF/s

Prefill latency: 5.158845027035568 sec
Decode latency: 25.807533628016245 sec
Time for inference 6: 30.97 sec total, 529.07 tokens/sec
Decode latency: 25.81 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19220.96 GB/s
FLOPS achieved: 96.10 TF/s

Prefill latency: 5.153165330004413 sec
Decode latency: 26.029541613999754 sec
Time for inference 7: 31.18 sec total, 525.40 tokens/sec
Decode latency: 26.03 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19087.63 GB/s
FLOPS achieved: 95.44 TF/s

Prefill latency: 5.154318390996195 sec
Decode latency: 26.034329907037318 sec
Time for inference 8: 31.19 sec total, 525.30 tokens/sec
Decode latency: 26.03 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19084.00 GB/s
FLOPS achieved: 95.42 TF/s

Prefill latency: 5.156481515034102 sec
Decode latency: 26.016756770026404 sec
Time for inference 9: 31.17 sec total, 525.56 tokens/sec
Decode latency: 26.02 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19093.44 GB/s
FLOPS achieved: 95.47 TF/s

Prefill latency: 5.152356147009414 sec
Decode latency: 26.03643152397126 sec
Time for inference 10: 31.19 sec total, 525.30 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19083.91 GB/s
FLOPS achieved: 95.42 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 26.0095 sec
Average prefill latency: 5.1602 sec
Average tokens/sec: 525.62
Memory used: 73.32 GB
Done. we are killing the process
