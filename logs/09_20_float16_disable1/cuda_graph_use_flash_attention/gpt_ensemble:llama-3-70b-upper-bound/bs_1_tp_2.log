W0928 19:23:06.904000 22970266748736 torch/distributed/run.py:779] 
W0928 19:23:06.904000 22970266748736 torch/distributed/run.py:779] *****************************************
W0928 19:23:06.904000 22970266748736 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:23:06.904000 22970266748736 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.18 seconds
Prefill latency: 0.15715765801724046 sec
Compilation time: 9.97 seconds
Decode latency: 9.70128629897954 sec
Compilation time: 9.86 seconds
Prefill latency: 0.1600488469703123 sec
Decode latency: 9.759294741030317 sec
Prefill latency: 0.15910630201688036 sec
Decode latency: 9.75934240402421 sec
Prefill latency: 0.16011278703808784 sec
Decode latency: 9.580048883042764 sec
Prefill latency: 0.160298281989526 sec
Decode latency: 9.758043584006373 sec
Prefill latency: 0.15983988100197166 sec
Decode latency: 9.717450177005958 sec
Time for inference 1: 9.88 sec total, 25.92 tokens/sec
Decode latency: 9.72 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1828.49 GB/s
FLOPS achieved: 9.14 TF/s

Prefill latency: 0.15930795000167564 sec
Decode latency: 9.758300890040118 sec
Time for inference 2: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1821.04 GB/s
FLOPS achieved: 9.11 TF/s

Prefill latency: 0.15951327100628987 sec
Decode latency: 9.760111702024005 sec
Time for inference 3: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.68 GB/s
FLOPS achieved: 9.10 TF/s

Prefill latency: 0.15893135301303118 sec
Decode latency: 9.75779571197927 sec
Time for inference 4: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1821.22 GB/s
FLOPS achieved: 9.11 TF/s

Prefill latency: 0.15937459998531267 sec
Decode latency: 9.54834487696644 sec
Time for inference 5: 9.71 sec total, 26.37 tokens/sec
Decode latency: 9.55 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1860.42 GB/s
FLOPS achieved: 9.30 TF/s

Prefill latency: 0.16026416304521263 sec
Decode latency: 9.759822534979321 sec
Time for inference 6: 9.92 sec total, 25.80 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.59 GB/s
FLOPS achieved: 9.10 TF/s

Prefill latency: 0.15932569198776037 sec
Decode latency: 9.759171891957521 sec
Time for inference 7: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.89 GB/s
FLOPS achieved: 9.10 TF/s

Prefill latency: 0.15868794597918168 sec
Decode latency: 9.75961783900857 sec
Time for inference 8: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.91 GB/s
FLOPS achieved: 9.10 TF/s

Prefill latency: 0.15746051201131195 sec
Decode latency: 9.760769855987746 sec
Time for inference 9: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.93 GB/s
FLOPS achieved: 9.10 TF/s

Prefill latency: 0.1586363730020821 sec
Decode latency: 9.760361697990447 sec
Time for inference 10: 9.92 sec total, 25.81 tokens/sec
Decode latency: 9.76 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1820.80 GB/s
FLOPS achieved: 9.10 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 9.7342 sec
Average prefill latency: 0.1591 sec
Average tokens/sec: 25.87
Memory used: 73.53 GB
Done. we are killing the process
