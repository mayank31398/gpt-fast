W0928 19:25:46.532000 22424945334080 torch/distributed/run.py:779] 
W0928 19:25:46.532000 22424945334080 torch/distributed/run.py:779] *****************************************
W0928 19:25:46.532000 22424945334080 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:25:46.532000 22424945334080 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.20 seconds
Prefill latency: 0.0871250790078193 sec
Compilation time: 6.58 seconds
Compilation time: 6.64 seconds
Compilation time: 6.68 seconds
Decode latency: 6.4921958220074885 sec
Compilation time: 6.58 seconds
Prefill latency: 0.08712315099546686 sec
Decode latency: 6.498125545040239 sec
Prefill latency: 0.08667335100471973 sec
Decode latency: 6.4980480580125 sec
Prefill latency: 0.08679193898569793 sec
Decode latency: 6.496706245990936 sec
Prefill latency: 0.08660496800439432 sec
Decode latency: 6.49637981801061 sec
Prefill latency: 0.08669757196912542 sec
Decode latency: 6.497817204974126 sec
Time for inference 1: 6.59 sec total, 38.87 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.29 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08716498594731092 sec
Decode latency: 6.4975239129853435 sec
Time for inference 2: 6.59 sec total, 38.87 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.27 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08713385602459311 sec
Decode latency: 6.4207415109849535 sec
Time for inference 3: 6.51 sec total, 39.33 tokens/sec
Decode latency: 6.42 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1428.94 GB/s
FLOPS achieved: 7.14 TF/s

Prefill latency: 0.0871132529573515 sec
Decode latency: 6.4968296949518844 sec
Time for inference 4: 6.58 sec total, 38.88 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.42 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08692934404825792 sec
Decode latency: 6.308164723974187 sec
Time for inference 5: 6.40 sec total, 40.03 tokens/sec
Decode latency: 6.31 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1454.13 GB/s
FLOPS achieved: 7.27 TF/s

Prefill latency: 0.08612499199807644 sec
Decode latency: 6.497623119037598 sec
Time for inference 6: 6.58 sec total, 38.88 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.47 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08672132896026596 sec
Decode latency: 6.49865405401215 sec
Time for inference 7: 6.59 sec total, 38.87 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.12 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08597900200402364 sec
Decode latency: 6.375664427003358 sec
Time for inference 8: 6.46 sec total, 39.61 tokens/sec
Decode latency: 6.38 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1439.12 GB/s
FLOPS achieved: 7.20 TF/s

Prefill latency: 0.08712078601820394 sec
Decode latency: 6.498335426033009 sec
Time for inference 9: 6.59 sec total, 38.87 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.08 GB/s
FLOPS achieved: 7.06 TF/s

Prefill latency: 0.08700296899769455 sec
Decode latency: 6.497821977012791 sec
Time for inference 10: 6.59 sec total, 38.87 tokens/sec
Decode latency: 6.50 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1412.23 GB/s
FLOPS achieved: 7.06 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.4589 sec
Average prefill latency: 0.0868 sec
Average tokens/sec: 39.11
Memory used: 39.10 GB
Done. we are killing the process
