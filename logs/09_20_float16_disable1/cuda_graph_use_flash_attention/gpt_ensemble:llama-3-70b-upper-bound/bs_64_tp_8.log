W0928 19:59:39.984000 22968766166848 torch/distributed/run.py:779] 
W0928 19:59:39.984000 22968766166848 torch/distributed/run.py:779] *****************************************
W0928 19:59:39.984000 22968766166848 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:59:39.984000 22968766166848 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.49 seconds
Prefill latency: 2.810572354006581 sec
Compilation time: 17.19 seconds
Compilation time: 17.25 seconds
Compilation time: 17.30 seconds
Compilation time: 17.40 seconds
Compilation time: 17.31 seconds
Compilation time: 17.27 seconds
Compilation time: 17.37 seconds
Decode latency: 14.506549099984113 sec
Compilation time: 17.32 seconds
Prefill latency: 2.8023119540303014 sec
Decode latency: 14.49553603498498 sec
Prefill latency: 2.8098610829911195 sec
Decode latency: 14.497742701030802 sec
Prefill latency: 2.804923567979131 sec
Decode latency: 14.501015076995827 sec
Prefill latency: 2.7979168209712952 sec
Decode latency: 14.498405975988135 sec
Prefill latency: 2.8002112659742124 sec
Decode latency: 14.384611013985705 sec
Time for inference 1: 17.19 sec total, 953.34 tokens/sec
Decode latency: 14.38 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18320.18 GB/s
FLOPS achieved: 91.60 TF/s

Prefill latency: 2.7995694520068355 sec
Decode latency: 14.508243809978012 sec
Time for inference 2: 17.31 sec total, 946.57 tokens/sec
Decode latency: 14.51 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18190.00 GB/s
FLOPS achieved: 90.95 TF/s

Prefill latency: 2.794527432997711 sec
Decode latency: 14.502934041025583 sec
Time for inference 3: 17.30 sec total, 947.14 tokens/sec
Decode latency: 14.50 sec
Prefill latency: 2.79 sec
Bandwidth achieved: 18200.92 GB/s
FLOPS achieved: 91.00 TF/s

Prefill latency: 2.8013453430030495 sec
Decode latency: 14.511742479051463 sec
Time for inference 4: 17.31 sec total, 946.28 tokens/sec
Decode latency: 14.51 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18184.33 GB/s
FLOPS achieved: 90.92 TF/s

Prefill latency: 2.7997803700272925 sec
Decode latency: 14.507074880995788 sec
Time for inference 5: 17.31 sec total, 946.63 tokens/sec
Decode latency: 14.51 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18191.07 GB/s
FLOPS achieved: 90.96 TF/s

Prefill latency: 2.802380101988092 sec
Decode latency: 14.508249600010458 sec
Time for inference 6: 17.31 sec total, 946.42 tokens/sec
Decode latency: 14.51 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18187.04 GB/s
FLOPS achieved: 90.94 TF/s

Prefill latency: 2.8065459350473247 sec
Decode latency: 14.50091873697238 sec
Time for inference 7: 17.31 sec total, 946.59 tokens/sec
Decode latency: 14.50 sec
Prefill latency: 2.81 sec
Bandwidth achieved: 18190.36 GB/s
FLOPS achieved: 90.95 TF/s

Prefill latency: 2.8045313309994526 sec
Decode latency: 14.512018685985822 sec
Time for inference 8: 17.32 sec total, 946.09 tokens/sec
Decode latency: 14.51 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18180.86 GB/s
FLOPS achieved: 90.90 TF/s

Prefill latency: 2.801371563982684 sec
Decode latency: 14.50430051801959 sec
Time for inference 9: 17.31 sec total, 946.69 tokens/sec
Decode latency: 14.50 sec
Prefill latency: 2.80 sec
Bandwidth achieved: 18192.27 GB/s
FLOPS achieved: 90.96 TF/s

Prefill latency: 2.806133765960112 sec
Decode latency: 14.515633819042705 sec
Time for inference 10: 17.32 sec total, 945.81 tokens/sec
Decode latency: 14.52 sec
Prefill latency: 2.81 sec
Bandwidth achieved: 18175.32 GB/s
FLOPS achieved: 90.88 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 14.4956 sec
Average prefill latency: 2.8016 sec
Average tokens/sec: 947.15
Memory used: 49.39 GB
Done. we are killing the process
