flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.03773242904571816 sec
Decode latency: 2.8641638380358927 sec
Compilation time: 2.90 seconds
Prefill latency: 0.03743815200868994 sec
Decode latency: 2.864856481028255 sec
Prefill latency: 0.0375102479592897 sec
Decode latency: 2.867341845005285 sec
Prefill latency: 0.03757916297763586 sec
Decode latency: 2.866725914995186 sec
Prefill latency: 0.03749467397574335 sec
Decode latency: 2.8681242219754495 sec
Prefill latency: 0.03750523499911651 sec
Decode latency: 2.8680082670180127 sec
Time for inference 1: 2.91 sec total, 88.08 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.11 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03764030401362106 sec
Decode latency: 2.867669122002553 sec
Time for inference 2: 2.91 sec total, 88.09 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.20 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03752187400823459 sec
Decode latency: 2.8682604859932326 sec
Time for inference 3: 2.91 sec total, 88.08 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.03 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03752700798213482 sec
Decode latency: 2.867510244017467 sec
Time for inference 4: 2.91 sec total, 88.10 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.40 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.037664419040083885 sec
Decode latency: 2.867260385013651 sec
Time for inference 5: 2.91 sec total, 88.11 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.46 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03752838401123881 sec
Decode latency: 2.866004122013692 sec
Time for inference 6: 2.90 sec total, 88.15 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1323.11 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.037483273015823215 sec
Decode latency: 2.8678070649621077 sec
Time for inference 7: 2.91 sec total, 88.10 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.30 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.03751789696980268 sec
Decode latency: 2.866988339985255 sec
Time for inference 8: 2.91 sec total, 88.12 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.66 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.037574379006400704 sec
Decode latency: 2.8676738920039497 sec
Time for inference 9: 2.91 sec total, 88.10 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1322.33 GB/s
FLOPS achieved: 6.61 TF/s

Prefill latency: 0.0375650689820759 sec
Decode latency: 2.8658433749806136 sec
Time for inference 10: 2.90 sec total, 88.15 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1323.16 GB/s
FLOPS achieved: 6.62 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8673 sec
Average prefill latency: 0.0376 sec
Average tokens/sec: 88.11
Memory used: 16.87 GB
