flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 2.6052915890468284 sec
Decode latency: 19.22463491698727 sec
Compilation time: 21.83 seconds
Prefill latency: 2.6122678000247106 sec
Decode latency: 19.148587750969455 sec
Prefill latency: 2.617429901030846 sec
Decode latency: 19.213117913983297 sec
Prefill latency: 2.6049122160184197 sec
Decode latency: 19.228026398981456 sec
Prefill latency: 2.603169159963727 sec
Decode latency: 19.222836305969395 sec
Prefill latency: 2.617426095006522 sec
Decode latency: 19.222932799020782 sec
Time for inference 1: 21.84 sec total, 750.13 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11259.38 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.6163671070244163 sec
Decode latency: 19.223859557998367 sec
Time for inference 2: 21.84 sec total, 750.14 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11259.42 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.6149320080294274 sec
Decode latency: 19.22190188796958 sec
Time for inference 3: 21.84 sec total, 750.25 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11261.18 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.6155505049973726 sec
Decode latency: 19.22699370299233 sec
Time for inference 4: 21.84 sec total, 750.06 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11258.31 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.608399641001597 sec
Decode latency: 19.12057944998378 sec
Time for inference 5: 21.73 sec total, 753.98 tokens/sec
Decode latency: 19.12 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11317.08 GB/s
FLOPS achieved: 56.59 TF/s

Prefill latency: 2.6099693900323473 sec
Decode latency: 19.22934510698542 sec
Time for inference 6: 21.84 sec total, 750.17 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11259.89 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.610335057019256 sec
Decode latency: 19.224469765962567 sec
Time for inference 7: 21.84 sec total, 750.33 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11262.27 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.6053688779938966 sec
Decode latency: 19.224555852997582 sec
Time for inference 8: 21.83 sec total, 750.49 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11264.79 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 2.6154261539923027 sec
Decode latency: 19.221158002968878 sec
Time for inference 9: 21.84 sec total, 750.26 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11261.31 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.6134017430013046 sec
Decode latency: 19.22317147097783 sec
Time for inference 10: 21.84 sec total, 750.27 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11261.38 GB/s
FLOPS achieved: 56.31 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2139 sec
Average prefill latency: 2.6127 sec
Average tokens/sec: 750.61
Memory used: 58.80 GB
