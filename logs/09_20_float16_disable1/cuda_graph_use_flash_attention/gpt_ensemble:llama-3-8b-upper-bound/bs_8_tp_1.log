flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.01 seconds
Prefill latency: 0.29821738798636943 sec
Decode latency: 4.48492472502403 sec
Compilation time: 4.78 seconds
Prefill latency: 0.2978930580429733 sec
Decode latency: 4.484971453959588 sec
Prefill latency: 0.2999773659976199 sec
Decode latency: 4.482723946974147 sec
Prefill latency: 0.2984514629933983 sec
Decode latency: 4.402373026998248 sec
Prefill latency: 0.29858532396610826 sec
Decode latency: 4.483490535989404 sec
Prefill latency: 0.29939209402073175 sec
Decode latency: 4.46567269298248 sec
Time for inference 1: 4.77 sec total, 429.72 tokens/sec
Decode latency: 4.47 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6450.06 GB/s
FLOPS achieved: 32.25 TF/s

Prefill latency: 0.2986990310018882 sec
Decode latency: 4.448833533038851 sec
Time for inference 2: 4.75 sec total, 431.28 tokens/sec
Decode latency: 4.45 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6473.50 GB/s
FLOPS achieved: 32.37 TF/s

Prefill latency: 0.2990378700196743 sec
Decode latency: 4.483931111986749 sec
Time for inference 3: 4.78 sec total, 428.10 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6425.75 GB/s
FLOPS achieved: 32.13 TF/s

Prefill latency: 0.30007640802068636 sec
Decode latency: 4.423093008983415 sec
Time for inference 4: 4.72 sec total, 433.54 tokens/sec
Decode latency: 4.42 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6507.31 GB/s
FLOPS achieved: 32.54 TF/s

Prefill latency: 0.2988588429871015 sec
Decode latency: 4.48503309499938 sec
Time for inference 5: 4.78 sec total, 428.03 tokens/sec
Decode latency: 4.49 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6424.68 GB/s
FLOPS achieved: 32.12 TF/s

Prefill latency: 0.29871063999598846 sec
Decode latency: 4.419368161994498 sec
Time for inference 6: 4.72 sec total, 433.99 tokens/sec
Decode latency: 4.42 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6514.19 GB/s
FLOPS achieved: 32.57 TF/s

Prefill latency: 0.2991188640007749 sec
Decode latency: 4.4840865939622745 sec
Time for inference 7: 4.78 sec total, 428.08 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6425.46 GB/s
FLOPS achieved: 32.13 TF/s

Prefill latency: 0.29961227800231427 sec
Decode latency: 4.483189721009694 sec
Time for inference 8: 4.78 sec total, 428.11 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6425.90 GB/s
FLOPS achieved: 32.13 TF/s

Prefill latency: 0.2997170979506336 sec
Decode latency: 4.44552259799093 sec
Time for inference 9: 4.75 sec total, 431.50 tokens/sec
Decode latency: 4.45 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6476.73 GB/s
FLOPS achieved: 32.38 TF/s

Prefill latency: 0.29937198001425713 sec
Decode latency: 4.483011466974858 sec
Time for inference 10: 4.78 sec total, 428.16 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6426.62 GB/s
FLOPS achieved: 32.13 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4622 sec
Average prefill latency: 0.2993 sec
Average tokens/sec: 430.05
Memory used: 21.53 GB
