W1001 04:02:18.909000 23329281898304 torch/distributed/run.py:779] 
W1001 04:02:18.909000 23329281898304 torch/distributed/run.py:779] *****************************************
W1001 04:02:18.909000 23329281898304 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:02:18.909000 23329281898304 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=6400, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
[rank0]:[W1001 04:02:28.838729421 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank1]:[W1001 04:02:28.851312238 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 1.046758477925323 sec
Decode latency: 5.648142938036472 sec
Compilation time: 6.70 seconds
Compilation time: 6.69 seconds
Prefill latency: 0.9864162199664861 sec
Decode latency: 5.640343275037594 sec
Prefill latency: 0.9874540210003033 sec
Decode latency: 5.64307728910353 sec
Prefill latency: 0.9871181549970061 sec
Decode latency: 5.641865251003765 sec
Prefill latency: 0.981249139062129 sec
Decode latency: 5.636545064975508 sec
Prefill latency: 0.9812195610720664 sec
Decode latency: 5.636622502002865 sec
Time for inference 1: 6.62 sec total, 2475.45 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3177.45 GB/s
FLOPS achieved: 15.89 TF/s

Prefill latency: 0.9891540569951758 sec
Decode latency: 5.637821171083488 sec
Time for inference 2: 6.63 sec total, 2472.04 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.99 sec
Bandwidth achieved: 3173.06 GB/s
FLOPS achieved: 15.87 TF/s

Prefill latency: 0.9836266699712723 sec
Decode latency: 5.636869853944518 sec
Time for inference 3: 6.62 sec total, 2474.42 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3176.12 GB/s
FLOPS achieved: 15.88 TF/s

Prefill latency: 0.9809040169930086 sec
Decode latency: 5.637154223048128 sec
Time for inference 4: 6.62 sec total, 2475.31 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3177.27 GB/s
FLOPS achieved: 15.89 TF/s

Prefill latency: 0.9799863650696352 sec
Decode latency: 5.637538083945401 sec
Time for inference 5: 6.62 sec total, 2475.53 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3177.54 GB/s
FLOPS achieved: 15.89 TF/s

Prefill latency: 0.9875448170350865 sec
Decode latency: 5.637816542061046 sec
Time for inference 6: 6.63 sec total, 2472.63 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.99 sec
Bandwidth achieved: 3173.83 GB/s
FLOPS achieved: 15.87 TF/s

Prefill latency: 0.9875657500233501 sec
Decode latency: 5.637807157938369 sec
Time for inference 7: 6.63 sec total, 2472.57 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.99 sec
Bandwidth achieved: 3173.74 GB/s
FLOPS achieved: 15.87 TF/s

Prefill latency: 0.9797444489086047 sec
Decode latency: 5.635894014965743 sec
Time for inference 8: 6.62 sec total, 2476.22 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3178.43 GB/s
FLOPS achieved: 15.89 TF/s

Prefill latency: 0.982214363059029 sec
Decode latency: 5.637407991918735 sec
Time for inference 9: 6.62 sec total, 2474.75 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.98 sec
Bandwidth achieved: 3176.55 GB/s
FLOPS achieved: 15.88 TF/s

Prefill latency: 0.9857047350378707 sec
Decode latency: 5.6403840680141 sec
Time for inference 10: 6.63 sec total, 2472.36 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.99 sec
Bandwidth achieved: 3173.48 GB/s
FLOPS achieved: 15.87 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.6375 sec
Average prefill latency: 0.9838 sec
Average tokens/sec: 2474.13
Memory used: 31.67 GB
Done. we are killing the process
