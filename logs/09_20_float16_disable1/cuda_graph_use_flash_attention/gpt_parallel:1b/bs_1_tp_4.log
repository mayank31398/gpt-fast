W1001 03:47:56.902000 23346744153920 torch/distributed/run.py:779] 
W1001 03:47:56.902000 23346744153920 torch/distributed/run.py:779] *****************************************
W1001 03:47:56.902000 23346744153920 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:47:56.902000 23346744153920 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=3200, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.05 seconds
[rank1]:[W1001 03:48:06.044946775 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.016446474939584732 sec
Decode latency: 1.8871995949884877 sec
Compilation time: 1.95 seconds
Compilation time: 1.91 seconds
Compilation time: 1.90 seconds
Compilation time: 1.90 seconds
Prefill latency: 0.011623905040323734 sec
Decode latency: 1.8858809299999848 sec
Prefill latency: 0.011700188973918557 sec
Decode latency: 1.8893864731071517 sec
Prefill latency: 0.011814316967502236 sec
Decode latency: 1.8899741159984842 sec
Prefill latency: 0.011597363976761699 sec
Decode latency: 1.8865999529371038 sec
Prefill latency: 0.01165256998501718 sec
Decode latency: 1.8886189500335604 sec
Time for inference 1: 1.90 sec total, 134.65 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.59 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011697483016178012 sec
Decode latency: 1.8890730059938505 sec
Time for inference 2: 1.90 sec total, 134.62 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.57 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011735002975910902 sec
Decode latency: 1.888907307991758 sec
Time for inference 3: 1.90 sec total, 134.63 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.58 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011654230067506433 sec
Decode latency: 1.8873864809283987 sec
Time for inference 4: 1.90 sec total, 134.75 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.66 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.01166374294552952 sec
Decode latency: 1.889801800949499 sec
Time for inference 5: 1.90 sec total, 134.58 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.54 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011716757901012897 sec
Decode latency: 1.88849671499338 sec
Time for inference 6: 1.90 sec total, 134.67 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.61 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011659759911708534 sec
Decode latency: 1.8887488880427554 sec
Time for inference 7: 1.90 sec total, 134.65 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.59 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011643468984402716 sec
Decode latency: 1.8893825591076165 sec
Time for inference 8: 1.90 sec total, 134.61 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.56 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.01172214699909091 sec
Decode latency: 1.8857418750412762 sec
Time for inference 9: 1.90 sec total, 134.87 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.75 GB/s
FLOPS achieved: 0.48 TF/s

Prefill latency: 0.011778639978729188 sec
Decode latency: 1.8895962900714949 sec
Time for inference 10: 1.90 sec total, 134.59 tokens/sec
Decode latency: 1.89 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 96.55 GB/s
FLOPS achieved: 0.48 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8886 sec
Average prefill latency: 0.0117 sec
Average tokens/sec: 134.66
Memory used: 1.38 GB
Done. we are killing the process
