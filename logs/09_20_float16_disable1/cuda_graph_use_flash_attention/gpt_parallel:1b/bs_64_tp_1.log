flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=10752, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.6953466950217262 sec
Decode latency: 10.53647975390777 sec
Compilation time: 11.23 seconds
Prefill latency: 0.6979050328955054 sec
Decode latency: 10.533768193912692 sec
Prefill latency: 0.6976737410295755 sec
Decode latency: 10.534298731014132 sec
Prefill latency: 0.6963398120133206 sec
Decode latency: 10.538062601001002 sec
Prefill latency: 0.6962377120507881 sec
Decode latency: 10.529839240014553 sec
Prefill latency: 0.6963921709684655 sec
Decode latency: 10.540317303035408 sec
Time for inference 1: 11.24 sec total, 1457.94 tokens/sec
Decode latency: 10.54 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3155.54 GB/s
FLOPS achieved: 15.78 TF/s

Prefill latency: 0.6974712670780718 sec
Decode latency: 10.537987365969457 sec
Time for inference 2: 11.24 sec total, 1458.12 tokens/sec
Decode latency: 10.54 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3155.93 GB/s
FLOPS achieved: 15.78 TF/s

Prefill latency: 0.6947466270066798 sec
Decode latency: 10.509774241014384 sec
Time for inference 3: 11.21 sec total, 1462.13 tokens/sec
Decode latency: 10.51 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 3164.61 GB/s
FLOPS achieved: 15.82 TF/s

Prefill latency: 0.6961997060570866 sec
Decode latency: 10.538646811037324 sec
Time for inference 4: 11.24 sec total, 1458.19 tokens/sec
Decode latency: 10.54 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3156.08 GB/s
FLOPS achieved: 15.78 TF/s

Prefill latency: 0.695508363074623 sec
Decode latency: 10.529099224018864 sec
Time for inference 5: 11.23 sec total, 1459.53 tokens/sec
Decode latency: 10.53 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3158.99 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.6958956649759784 sec
Decode latency: 10.540259271976538 sec
Time for inference 6: 11.24 sec total, 1458.01 tokens/sec
Decode latency: 10.54 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3155.70 GB/s
FLOPS achieved: 15.78 TF/s

Prefill latency: 0.6959123299457133 sec
Decode latency: 10.532002713996917 sec
Time for inference 7: 11.23 sec total, 1459.10 tokens/sec
Decode latency: 10.53 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3158.06 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.6966060129925609 sec
Decode latency: 10.53003164101392 sec
Time for inference 8: 11.23 sec total, 1459.24 tokens/sec
Decode latency: 10.53 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3158.36 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.6959692500531673 sec
Decode latency: 10.533906430006027 sec
Time for inference 9: 11.23 sec total, 1458.82 tokens/sec
Decode latency: 10.53 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3157.46 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.6964809939963743 sec
Decode latency: 10.535509245935827 sec
Time for inference 10: 11.23 sec total, 1458.57 tokens/sec
Decode latency: 10.54 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3156.91 GB/s
FLOPS achieved: 15.78 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.5328 sec
Average prefill latency: 0.6961 sec
Average tokens/sec: 1458.96
Memory used: 29.39 GB
Done. we are killing the process
