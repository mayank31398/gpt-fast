W1001 03:51:40.526000 23076050573120 torch/distributed/run.py:779] 
W1001 03:51:40.526000 23076050573120 torch/distributed/run.py:779] *****************************************
W1001 03:51:40.526000 23076050573120 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:51:40.526000 23076050573120 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=1600, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.12 seconds
Prefill latency: 0.023538418929092586 sec
Decode latency: 2.2058258299948648 sec
Compilation time: 2.25 seconds
Compilation time: 2.28 seconds
Compilation time: 2.26 seconds
Compilation time: 2.23 seconds
Compilation time: 2.24 seconds
Compilation time: 2.24 seconds
Compilation time: 2.30 seconds
Compilation time: 2.23 seconds
Prefill latency: 0.02258608501870185 sec
Decode latency: 2.2073842249810696 sec
Prefill latency: 0.020996098988689482 sec
Decode latency: 2.2104310039430857 sec
Prefill latency: 0.02116062305867672 sec
Decode latency: 2.2108341079438105 sec
Prefill latency: 0.02091488998848945 sec
Decode latency: 2.215756871039048 sec
Prefill latency: 0.020929250051267445 sec
Decode latency: 2.203497432055883 sec
Time for inference 1: 2.23 sec total, 460.20 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 199.84 GB/s
FLOPS achieved: 1.00 TF/s

Prefill latency: 0.02106860396452248 sec
Decode latency: 2.2173818349838257 sec
Time for inference 2: 2.24 sec total, 457.30 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.58 GB/s
FLOPS achieved: 0.99 TF/s

Prefill latency: 0.020917957997880876 sec
Decode latency: 2.218933554016985 sec
Time for inference 3: 2.24 sec total, 457.01 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.45 GB/s
FLOPS achieved: 0.99 TF/s

Prefill latency: 0.020907055004499853 sec
Decode latency: 2.2081990260630846 sec
Time for inference 4: 2.23 sec total, 459.22 tokens/sec
Decode latency: 2.21 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 199.41 GB/s
FLOPS achieved: 1.00 TF/s

Prefill latency: 0.020893136970698833 sec
Decode latency: 2.2203843720490113 sec
Time for inference 5: 2.24 sec total, 456.72 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.32 GB/s
FLOPS achieved: 0.99 TF/s

Prefill latency: 0.021156305097974837 sec
Decode latency: 2.2221032379893586 sec
Time for inference 6: 2.24 sec total, 456.29 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.14 GB/s
FLOPS achieved: 0.99 TF/s

Prefill latency: 0.021160954027436674 sec
Decode latency: 2.2222034400328994 sec
Time for inference 7: 2.24 sec total, 456.27 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.13 GB/s
FLOPS achieved: 0.99 TF/s

Prefill latency: 0.021104087005369365 sec
Decode latency: 2.2081483949441463 sec
Time for inference 8: 2.23 sec total, 459.17 tokens/sec
Decode latency: 2.21 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 199.39 GB/s
FLOPS achieved: 1.00 TF/s

Prefill latency: 0.0211178429890424 sec
Decode latency: 2.1993168080225587 sec
Time for inference 9: 2.22 sec total, 461.00 tokens/sec
Decode latency: 2.20 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 200.18 GB/s
FLOPS achieved: 1.00 TF/s

Prefill latency: 0.020895325927995145 sec
Decode latency: 2.2187733609462157 sec
Time for inference 10: 2.24 sec total, 457.03 tokens/sec
Decode latency: 2.22 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 198.46 GB/s
FLOPS achieved: 0.99 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2139 sec
Average prefill latency: 0.0210 sec
Average tokens/sec: 458.02
Memory used: 1.92 GB
Done. we are killing the process
