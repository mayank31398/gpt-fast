flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=10752, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.88 seconds
[rank0]:[W930 20:51:45.662511687 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.1778340069577098 sec
Decode latency: 3.7881733069662005 sec
Compilation time: 3.97 seconds
Prefill latency: 0.1773312670411542 sec
Decode latency: 3.7868787209736183 sec
Prefill latency: 0.17727047496009618 sec
Decode latency: 3.7897605079924688 sec
Prefill latency: 0.17728115897625685 sec
Decode latency: 3.7874223369872198 sec
Prefill latency: 0.17729432391934097 sec
Decode latency: 3.7870842430274934 sec
Prefill latency: 0.17737079900689423 sec
Decode latency: 3.789145580958575 sec
Time for inference 1: 3.97 sec total, 1032.46 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2234.65 GB/s
FLOPS achieved: 11.17 TF/s

Prefill latency: 0.17733757896348834 sec
Decode latency: 3.7881903200177476 sec
Time for inference 2: 3.97 sec total, 1032.72 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.21 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.1772577209630981 sec
Decode latency: 3.7878024270758033 sec
Time for inference 3: 3.97 sec total, 1032.85 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.49 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.1774057219736278 sec
Decode latency: 3.787998007959686 sec
Time for inference 4: 3.97 sec total, 1032.71 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.19 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.17737325699999928 sec
Decode latency: 3.7878861849894747 sec
Time for inference 5: 3.97 sec total, 1032.76 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.30 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.1772773410193622 sec
Decode latency: 3.7884437929606065 sec
Time for inference 6: 3.97 sec total, 1032.67 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.10 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.177279741037637 sec
Decode latency: 3.787378385895863 sec
Time for inference 7: 3.97 sec total, 1032.94 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.69 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.17737682594452053 sec
Decode latency: 3.7897122349822894 sec
Time for inference 8: 3.97 sec total, 1032.31 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2234.33 GB/s
FLOPS achieved: 11.17 TF/s

Prefill latency: 0.1773387580178678 sec
Decode latency: 3.788023776956834 sec
Time for inference 9: 3.97 sec total, 1032.77 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.32 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.1773057250538841 sec
Decode latency: 3.7884590959874913 sec
Time for inference 10: 3.97 sec total, 1032.67 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.10 GB/s
FLOPS achieved: 11.18 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.7883 sec
Average prefill latency: 0.1773 sec
Average tokens/sec: 1032.69
Memory used: 9.30 GB
Done. we are killing the process
