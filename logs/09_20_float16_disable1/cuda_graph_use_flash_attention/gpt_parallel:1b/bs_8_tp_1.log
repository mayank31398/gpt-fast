flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=10752, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.91 seconds
[rank0]:[W930 20:48:18.215281824 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.09116185992024839 sec
Decode latency: 2.927751212962903 sec
Compilation time: 3.02 seconds
Prefill latency: 0.09065366501454264 sec
Decode latency: 2.9250856690341607 sec
Prefill latency: 0.09058011008892208 sec
Decode latency: 2.9243090440286323 sec
Prefill latency: 0.09057982708327472 sec
Decode latency: 2.924770418088883 sec
Prefill latency: 0.09057380305603147 sec
Decode latency: 2.9239888680167496 sec
Prefill latency: 0.09062015998642892 sec
Decode latency: 2.923802010016516 sec
Time for inference 1: 3.02 sec total, 679.25 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1470.16 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.09058105002623051 sec
Decode latency: 2.924394796951674 sec
Time for inference 2: 3.02 sec total, 679.13 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.91 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.0906624780036509 sec
Decode latency: 2.924695322988555 sec
Time for inference 3: 3.02 sec total, 679.04 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.71 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.09071760694496334 sec
Decode latency: 2.9245782849611714 sec
Time for inference 4: 3.02 sec total, 679.05 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.73 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.09071102202869952 sec
Decode latency: 2.9242802389198914 sec
Time for inference 5: 3.02 sec total, 679.07 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.78 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.09056018094997853 sec
Decode latency: 2.92513568198774 sec
Time for inference 6: 3.02 sec total, 678.93 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.47 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.0906466799788177 sec
Decode latency: 2.876513332943432 sec
Time for inference 7: 2.97 sec total, 690.06 tokens/sec
Decode latency: 2.88 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1493.55 GB/s
FLOPS achieved: 7.47 TF/s

Prefill latency: 0.0907544590299949 sec
Decode latency: 2.9249338089721277 sec
Time for inference 8: 3.02 sec total, 678.96 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.54 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.0906311710132286 sec
Decode latency: 2.9245864619733766 sec
Time for inference 9: 3.02 sec total, 679.07 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.77 GB/s
FLOPS achieved: 7.35 TF/s

Prefill latency: 0.0906824569683522 sec
Decode latency: 2.9249070700025186 sec
Time for inference 10: 3.02 sec total, 678.99 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1469.59 GB/s
FLOPS achieved: 7.35 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9198 sec
Average prefill latency: 0.0907 sec
Average tokens/sec: 680.16
Memory used: 5.96 GB
Done. we are killing the process
