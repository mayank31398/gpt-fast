W1001 04:04:11.118000 22918640957248 torch/distributed/run.py:779] 
W1001 04:04:11.118000 22918640957248 torch/distributed/run.py:779] *****************************************
W1001 04:04:11.118000 22918640957248 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:04:11.118000 22918640957248 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=3200, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.12 seconds
Prefill latency: 0.2692199230659753 sec
Decode latency: 3.5336004310520366 sec
Compilation time: 3.81 seconds
Compilation time: 3.80 secondsCompilation time: 3.80 seconds

Compilation time: 3.80 seconds
Prefill latency: 0.26870970299933106 sec
Decode latency: 3.528745020972565 sec
Prefill latency: 0.26843744597863406 sec
Decode latency: 3.529670024989173 sec
Prefill latency: 0.2686384549597278 sec
Decode latency: 3.529577382025309 sec
Prefill latency: 0.2686172879766673 sec
Decode latency: 3.529104635003023 sec
Prefill latency: 0.2686209090752527 sec
Decode latency: 3.529777877032757 sec
Time for inference 1: 3.80 sec total, 4312.56 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.62 GB/s
FLOPS achieved: 15.47 TF/s

Prefill latency: 0.2685218109982088 sec
Decode latency: 3.529441879945807 sec
Time for inference 2: 3.80 sec total, 4312.91 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.88 GB/s
FLOPS achieved: 15.47 TF/s

Prefill latency: 0.2685442370129749 sec
Decode latency: 3.5328016449930146 sec
Time for inference 3: 3.80 sec total, 4309.11 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3091.15 GB/s
FLOPS achieved: 15.46 TF/s

Prefill latency: 0.2686165279010311 sec
Decode latency: 3.530054955976084 sec
Time for inference 4: 3.80 sec total, 4312.13 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.31 GB/s
FLOPS achieved: 15.47 TF/s

Prefill latency: 0.26877040695399046 sec
Decode latency: 3.5301032490096986 sec
Time for inference 5: 3.80 sec total, 4311.86 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.12 GB/s
FLOPS achieved: 15.47 TF/s

Prefill latency: 0.26869322499260306 sec
Decode latency: 3.5296195129631087 sec
Time for inference 6: 3.80 sec total, 4312.61 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.66 GB/s
FLOPS achieved: 15.47 TF/s

Prefill latency: 0.26878661406226456 sec
Decode latency: 3.5312225479865447 sec
Time for inference 7: 3.80 sec total, 4310.71 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3092.30 GB/s
FLOPS achieved: 15.46 TF/s

Prefill latency: 0.268780110985972 sec
Decode latency: 3.5307033540448174 sec
Time for inference 8: 3.80 sec total, 4311.38 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3092.77 GB/s
FLOPS achieved: 15.46 TF/s

Prefill latency: 0.268725543981418 sec
Decode latency: 3.530398649047129 sec
Time for inference 9: 3.80 sec total, 4311.69 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3093.00 GB/s
FLOPS achieved: 15.46 TF/s

Prefill latency: 0.2687174140010029 sec
Decode latency: 3.5304783030878752 sec
Time for inference 10: 3.80 sec total, 4311.49 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3092.86 GB/s
FLOPS achieved: 15.46 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5305 sec
Average prefill latency: 0.2687 sec
Average tokens/sec: 4311.64
Memory used: 22.68 GB
Done. we are killing the process
