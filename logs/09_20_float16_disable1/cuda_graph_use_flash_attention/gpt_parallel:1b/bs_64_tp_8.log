W0930 21:02:11.586000 23340603406144 torch/distributed/run.py:779] 
W0930 21:02:11.586000 23340603406144 torch/distributed/run.py:779] *****************************************
W0930 21:02:11.586000 23340603406144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 21:02:11.586000 23340603406144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=1344, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.1806940759997815 sec
Decode latency: 3.700496440054849 sec
Compilation time: 4.08 seconds
Compilation time: 4.09 secondsCompilation time: 4.04 seconds
Compilation time: 3.88 seconds

Compilation time: 3.88 seconds
Compilation time: 3.88 seconds
Compilation time: 3.88 seconds
Compilation time: 4.04 seconds
Prefill latency: 0.17326362896710634 sec
Decode latency: 3.653289271052927 sec
Prefill latency: 0.17347718006931245 sec
Decode latency: 3.659546802053228 sec
Prefill latency: 0.17335137899499387 sec
Decode latency: 3.684380038990639 sec
Prefill latency: 0.172579345991835 sec
Decode latency: 3.6362192010274157 sec
Prefill latency: 0.1733867129078135 sec
Decode latency: 3.658609210047871 sec
Time for inference 1: 3.83 sec total, 4274.38 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1721.63 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.17305712902452797 sec
Decode latency: 3.655997162917629 sec
Time for inference 2: 3.83 sec total, 4277.81 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1723.01 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.17286732594948262 sec
Decode latency: 3.6499506148975343 sec
Time for inference 3: 3.82 sec total, 4284.79 tokens/sec
Decode latency: 3.65 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1725.82 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.17273165693040937 sec
Decode latency: 3.6227362969657406 sec
Time for inference 4: 3.80 sec total, 4315.72 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1738.28 GB/s
FLOPS achieved: 8.69 TF/s

Prefill latency: 0.17267466394696385 sec
Decode latency: 3.6386878880439326 sec
Time for inference 5: 3.81 sec total, 4297.67 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1731.01 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.1725257949437946 sec
Decode latency: 3.6627180429641157 sec
Time for inference 6: 3.84 sec total, 4270.90 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1720.23 GB/s
FLOPS achieved: 8.60 TF/s

Prefill latency: 0.17292019806336612 sec
Decode latency: 3.6606186049757525 sec
Time for inference 7: 3.83 sec total, 4272.85 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1721.02 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.17280834796838462 sec
Decode latency: 3.6522225179942325 sec
Time for inference 8: 3.83 sec total, 4282.25 tokens/sec
Decode latency: 3.65 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1724.80 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.17342005693353713 sec
Decode latency: 3.665215643006377 sec
Time for inference 9: 3.84 sec total, 4266.93 tokens/sec
Decode latency: 3.67 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1718.63 GB/s
FLOPS achieved: 8.59 TF/s

Prefill latency: 0.17257877893280238 sec
Decode latency: 3.641168224043213 sec
Time for inference 10: 3.81 sec total, 4294.74 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1729.83 GB/s
FLOPS achieved: 8.65 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6508 sec
Average prefill latency: 0.1729 sec
Average tokens/sec: 4283.80
Memory used: 20.72 GB
Done. we are killing the process
