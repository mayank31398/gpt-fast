flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=10752, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.04771367192734033 sec
Decode latency: 2.4938955549150705 sec
Compilation time: 2.54 seconds
Prefill latency: 0.0475180969806388 sec
Decode latency: 2.4914618680486456 sec
Prefill latency: 0.04743395291734487 sec
Decode latency: 2.491765053011477 sec
Prefill latency: 0.047508861985988915 sec
Decode latency: 2.4918058479670435 sec
Prefill latency: 0.04749539808835834 sec
Decode latency: 2.491186241968535 sec
Prefill latency: 0.047432083054445684 sec
Decode latency: 2.491757327108644 sec
Time for inference 1: 2.54 sec total, 403.16 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.60 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.04743498796597123 sec
Decode latency: 2.491137685952708 sec
Time for inference 2: 2.54 sec total, 403.26 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.81 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.04751913505606353 sec
Decode latency: 2.49183237797115 sec
Time for inference 3: 2.54 sec total, 403.15 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.57 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.047521808999590576 sec
Decode latency: 2.491894238977693 sec
Time for inference 4: 2.54 sec total, 403.13 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.52 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.04749841906595975 sec
Decode latency: 2.492799154948443 sec
Time for inference 5: 2.54 sec total, 402.99 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.23 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.047485292074270546 sec
Decode latency: 2.492099345079623 sec
Time for inference 6: 2.54 sec total, 403.10 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.47 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.04746283509302884 sec
Decode latency: 2.4923084159381688 sec
Time for inference 7: 2.54 sec total, 403.08 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.41 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.047514804056845605 sec
Decode latency: 2.4313634710852057 sec
Time for inference 8: 2.48 sec total, 412.98 tokens/sec
Decode latency: 2.43 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 893.86 GB/s
FLOPS achieved: 4.47 TF/s

Prefill latency: 0.04755075101274997 sec
Decode latency: 2.490820824052207 sec
Time for inference 9: 2.54 sec total, 403.26 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.81 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.04745115106925368 sec
Decode latency: 2.4925071480683982 sec
Time for inference 10: 2.54 sec total, 403.00 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 872.26 GB/s
FLOPS achieved: 4.36 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4859 sec
Average prefill latency: 0.0475 sec
Average tokens/sec: 404.11
Memory used: 4.34 GB
Done. we are killing the process
