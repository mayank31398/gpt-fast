flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.3947367650689557 sec
Decode latency: 5.138447360950522 sec
Compilation time: 5.53 seconds
Prefill latency: 0.39799327100627124 sec
Decode latency: 5.1375531039666384 sec
Prefill latency: 0.39844743499998003 sec
Decode latency: 5.136798273073509 sec
Prefill latency: 0.39636615198105574 sec
Decode latency: 5.1228646900272 sec
Prefill latency: 0.3963236149866134 sec
Decode latency: 5.028669163002633 sec
Prefill latency: 0.3983618119964376 sec
Decode latency: 5.12396032793913 sec
Time for inference 1: 5.52 sec total, 741.60 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5207.14 GB/s
FLOPS achieved: 26.04 TF/s

Prefill latency: 0.39723627804778516 sec
Decode latency: 5.103969931951724 sec
Time for inference 2: 5.50 sec total, 744.43 tokens/sec
Decode latency: 5.10 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5227.00 GB/s
FLOPS achieved: 26.13 TF/s

Prefill latency: 0.39636972395237535 sec
Decode latency: 5.12316759605892 sec
Time for inference 3: 5.52 sec total, 741.95 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.58 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.3975315790157765 sec
Decode latency: 5.122173896059394 sec
Time for inference 4: 5.52 sec total, 741.93 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.44 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.3996093310415745 sec
Decode latency: 5.123020439059474 sec
Time for inference 5: 5.52 sec total, 741.54 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5206.68 GB/s
FLOPS achieved: 26.03 TF/s

Prefill latency: 0.39875916903838515 sec
Decode latency: 5.12354092404712 sec
Time for inference 6: 5.52 sec total, 741.58 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5206.95 GB/s
FLOPS achieved: 26.03 TF/s

Prefill latency: 0.3965521330246702 sec
Decode latency: 5.122871494037099 sec
Time for inference 7: 5.52 sec total, 741.99 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.88 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39599455101415515 sec
Decode latency: 5.1229853190016 sec
Time for inference 8: 5.52 sec total, 742.06 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5210.36 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39586563396733254 sec
Decode latency: 5.123293863958679 sec
Time for inference 9: 5.52 sec total, 742.03 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5210.14 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.3965026580262929 sec
Decode latency: 5.123123458004557 sec
Time for inference 10: 5.52 sec total, 741.95 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.54 GB/s
FLOPS achieved: 26.05 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1212 sec
Average prefill latency: 0.3973 sec
Average tokens/sec: 742.11
Memory used: 21.96 GB
Done. we are killing the process
