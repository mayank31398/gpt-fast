W1001 03:55:53.452000 23354017789760 torch/distributed/run.py:779] 
W1001 03:55:53.452000 23354017789760 torch/distributed/run.py:779] *****************************************
W1001 03:55:53.452000 23354017789760 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:55:53.452000 23354017789760 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=6336, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.06956746696960181 sec
Decode latency: 2.5512707480229437 sec
Compilation time: 2.62 seconds
Compilation time: 2.62 seconds
Compilation time: 2.62 seconds
Compilation time: 2.62 seconds
Prefill latency: 0.06805307196918875 sec
Decode latency: 2.547153549036011 sec
Prefill latency: 0.0678919629426673 sec
Decode latency: 2.5488953669555485 sec
Prefill latency: 0.0678270700154826 sec
Decode latency: 2.5485477090114728 sec
Prefill latency: 0.0677960281027481 sec
Decode latency: 2.5481510770041496 sec
Prefill latency: 0.06776761705987155 sec
Decode latency: 2.54764659202192 sec
Time for inference 1: 2.62 sec total, 782.78 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1507.15 GB/s
FLOPS achieved: 7.54 TF/s

Prefill latency: 0.06780075910501182 sec
Decode latency: 2.5473342129262164 sec
Time for inference 2: 2.62 sec total, 782.91 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1507.39 GB/s
FLOPS achieved: 7.54 TF/s

Prefill latency: 0.06797148194164038 sec
Decode latency: 2.5478472609538585 sec
Time for inference 3: 2.62 sec total, 782.69 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1506.98 GB/s
FLOPS achieved: 7.53 TF/s

Prefill latency: 0.06778235593810678 sec
Decode latency: 2.548136890050955 sec
Time for inference 4: 2.62 sec total, 782.59 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1506.78 GB/s
FLOPS achieved: 7.53 TF/s

Prefill latency: 0.06801015802193433 sec
Decode latency: 2.5488758890423924 sec
Time for inference 5: 2.62 sec total, 782.32 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1506.25 GB/s
FLOPS achieved: 7.53 TF/s

Prefill latency: 0.06776039698161185 sec
Decode latency: 2.5496314730262384 sec
Time for inference 6: 2.62 sec total, 782.19 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1506.02 GB/s
FLOPS achieved: 7.53 TF/s

Prefill latency: 0.06779160595033318 sec
Decode latency: 2.5477798141073436 sec
Time for inference 7: 2.62 sec total, 782.79 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1507.16 GB/s
FLOPS achieved: 7.54 TF/s

Prefill latency: 0.06785272900015116 sec
Decode latency: 2.547445732052438 sec
Time for inference 8: 2.62 sec total, 782.87 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1507.32 GB/s
FLOPS achieved: 7.54 TF/s

Prefill latency: 0.06786874798126519 sec
Decode latency: 2.548569413018413 sec
Time for inference 9: 2.62 sec total, 782.49 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1506.59 GB/s
FLOPS achieved: 7.53 TF/s

Prefill latency: 0.06779849692247808 sec
Decode latency: 2.5476308970246464 sec
Time for inference 10: 2.62 sec total, 782.80 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1507.19 GB/s
FLOPS achieved: 7.54 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5481 sec
Average prefill latency: 0.0678 sec
Average tokens/sec: 782.64
Memory used: 6.14 GB
Done. we are killing the process
