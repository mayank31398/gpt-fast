W1001 04:04:33.368000 22617963689792 torch/distributed/run.py:779] 
W1001 04:04:33.368000 22617963689792 torch/distributed/run.py:779] *****************************************
W1001 04:04:33.368000 22617963689792 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:04:33.368000 22617963689792 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=12672, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.99 seconds
Prefill latency: 1.7132784370332956 sec
Decode latency: 7.815432279021479 sec
Compilation time: 9.54 seconds
Compilation time: 9.53 seconds
Prefill latency: 1.6235734700458124 sec
Decode latency: 7.804015727946535 sec
Prefill latency: 1.6238619310315698 sec
Decode latency: 7.8025938489008695 sec
Prefill latency: 1.6257388569647446 sec
Decode latency: 7.803245843038894 sec
Prefill latency: 1.6225033019436523 sec
Decode latency: 7.802652216982096 sec
Prefill latency: 1.6259571239352226 sec
Decode latency: 7.806969982921146 sec
Time for inference 1: 9.43 sec total, 1736.71 tokens/sec
Decode latency: 7.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 6293.96 GB/s
FLOPS achieved: 31.47 TF/s

Prefill latency: 1.6240654450375587 sec
Decode latency: 7.805127453058958 sec
Time for inference 2: 9.43 sec total, 1737.41 tokens/sec
Decode latency: 7.81 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6296.49 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6269586079288274 sec
Decode latency: 7.803318743011914 sec
Time for inference 3: 9.43 sec total, 1737.20 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 6295.74 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6238984690280631 sec
Decode latency: 7.804423242923804 sec
Time for inference 4: 9.43 sec total, 1737.58 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6297.11 GB/s
FLOPS achieved: 31.49 TF/s

Prefill latency: 1.6259345940779895 sec
Decode latency: 7.802066170028411 sec
Time for inference 5: 9.43 sec total, 1737.65 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 6297.36 GB/s
FLOPS achieved: 31.49 TF/s

Prefill latency: 1.624875211971812 sec
Decode latency: 7.804887801990844 sec
Time for inference 6: 9.43 sec total, 1737.29 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6296.04 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6272271450143307 sec
Decode latency: 7.801528027979657 sec
Time for inference 7: 9.43 sec total, 1737.49 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 6296.77 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6243621610337868 sec
Decode latency: 7.804233864997514 sec
Time for inference 8: 9.43 sec total, 1737.52 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6296.90 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6249511189525947 sec
Decode latency: 7.8044363900553435 sec
Time for inference 9: 9.43 sec total, 1737.35 tokens/sec
Decode latency: 7.80 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6296.27 GB/s
FLOPS achieved: 31.48 TF/s

Prefill latency: 1.6248994499910623 sec
Decode latency: 7.805734071996994 sec
Time for inference 10: 9.43 sec total, 1737.14 tokens/sec
Decode latency: 7.81 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 6295.50 GB/s
FLOPS achieved: 31.48 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.8043 sec
Average prefill latency: 1.6253 sec
Average tokens/sec: 1737.33
Memory used: 43.17 GB
Done. we are killing the process
