W1001 03:52:54.779000 22396799534912 torch/distributed/run.py:779] 
W1001 03:52:54.779000 22396799534912 torch/distributed/run.py:779] *****************************************
W1001 03:52:54.779000 22396799534912 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:52:54.779000 22396799534912 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=6336, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.05918344599194825 sec
Decode latency: 2.3444091479759663 sec
Compilation time: 2.40 seconds
Compilation time: 2.39 seconds
Compilation time: 2.38 seconds
Compilation time: 2.40 seconds
Prefill latency: 0.038176098954863846 sec
Decode latency: 2.343311610049568 sec
Prefill latency: 0.03825095505453646 sec
Decode latency: 2.3436141960555688 sec
Prefill latency: 0.038304933928884566 sec
Decode latency: 2.343336535966955 sec
Prefill latency: 0.03827309003099799 sec
Decode latency: 2.3436064650304615 sec
Prefill latency: 0.03828074689954519 sec
Decode latency: 2.3424918520031497 sec
Time for inference 1: 2.38 sec total, 429.99 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 827.90 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.038222867995500565 sec
Decode latency: 2.3441657919902354 sec
Time for inference 2: 2.38 sec total, 429.68 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 827.29 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.03823325899429619 sec
Decode latency: 2.341703778016381 sec
Time for inference 3: 2.38 sec total, 430.13 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.17 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.03824899799656123 sec
Decode latency: 2.340735352016054 sec
Time for inference 4: 2.38 sec total, 430.25 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.39 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.03814397600945085 sec
Decode latency: 2.3407923739869148 sec
Time for inference 5: 2.38 sec total, 430.29 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.46 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.038370202062651515 sec
Decode latency: 2.3415063079446554 sec
Time for inference 6: 2.38 sec total, 430.13 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.15 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.03815842396579683 sec
Decode latency: 2.3420622480334714 sec
Time for inference 7: 2.38 sec total, 430.08 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.07 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.03822127101011574 sec
Decode latency: 2.339712387067266 sec
Time for inference 8: 2.38 sec total, 430.50 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 828.87 GB/s
FLOPS achieved: 4.14 TF/s

Prefill latency: 0.038296270999126136 sec
Decode latency: 2.338839936070144 sec
Time for inference 9: 2.38 sec total, 430.64 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 829.15 GB/s
FLOPS achieved: 4.15 TF/s

Prefill latency: 0.03826197003945708 sec
Decode latency: 2.339307566988282 sec
Time for inference 10: 2.38 sec total, 430.57 tokens/sec
Decode latency: 2.34 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 829.00 GB/s
FLOPS achieved: 4.14 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3411 sec
Average prefill latency: 0.0382 sec
Average tokens/sec: 430.23
Memory used: 4.26 GB
Done. we are killing the process
