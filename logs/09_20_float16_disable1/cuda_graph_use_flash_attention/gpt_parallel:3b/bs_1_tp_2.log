W1001 03:49:32.458000 23279076927296 torch/distributed/run.py:779] 
W1001 03:49:32.458000 23279076927296 torch/distributed/run.py:779] *****************************************
W1001 03:49:32.458000 23279076927296 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:49:32.458000 23279076927296 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=12672, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.89 seconds
[rank0]:[W1001 03:49:38.049780162 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank1]:[W1001 03:49:38.057487712 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.04090096103027463 sec
Decode latency: 2.2861187160015106 sec
Compilation time: 2.33 seconds
Compilation time: 2.32 seconds
Prefill latency: 0.03257451602257788 sec
Decode latency: 2.2816470930119976 sec
Prefill latency: 0.03271983400918543 sec
Decode latency: 2.2828490760875866 sec
Prefill latency: 0.03256443305872381 sec
Decode latency: 2.2822439919691533 sec
Prefill latency: 0.03271102602593601 sec
Decode latency: 2.2825857950374484 sec
Prefill latency: 0.032591153983958066 sec
Decode latency: 2.2828865949995816 sec
Time for inference 1: 2.32 sec total, 110.52 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.52 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03266984596848488 sec
Decode latency: 2.2823576589580625 sec
Time for inference 2: 2.32 sec total, 110.52 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.55 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03269889403600246 sec
Decode latency: 2.2880612440640107 sec
Time for inference 3: 2.32 sec total, 110.26 tokens/sec
Decode latency: 2.29 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 399.60 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03263202600646764 sec
Decode latency: 2.2880046810023487 sec
Time for inference 4: 2.32 sec total, 110.28 tokens/sec
Decode latency: 2.29 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 399.65 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03262890502810478 sec
Decode latency: 2.284934982075356 sec
Time for inference 5: 2.32 sec total, 110.43 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.19 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03280591999646276 sec
Decode latency: 2.2825173758901656 sec
Time for inference 6: 2.32 sec total, 110.53 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.58 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03259811596944928 sec
Decode latency: 2.2826706160558388 sec
Time for inference 7: 2.32 sec total, 110.54 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.59 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03261363098863512 sec
Decode latency: 2.281648144009523 sec
Time for inference 8: 2.31 sec total, 110.58 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.77 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.0325236190110445 sec
Decode latency: 2.282756147091277 sec
Time for inference 9: 2.32 sec total, 110.54 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.59 GB/s
FLOPS achieved: 2.00 TF/s

Prefill latency: 0.03264585800934583 sec
Decode latency: 2.2831215809565037 sec
Time for inference 10: 2.32 sec total, 110.51 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 400.51 GB/s
FLOPS achieved: 2.00 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2839 sec
Average prefill latency: 0.0326 sec
Average tokens/sec: 110.47
Memory used: 4.74 GB
Done. we are killing the process
