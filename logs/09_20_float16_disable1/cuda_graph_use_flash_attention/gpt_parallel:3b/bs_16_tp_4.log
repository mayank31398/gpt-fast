W1001 03:59:37.531000 22807830128448 torch/distributed/run.py:779] 
W1001 03:59:37.531000 22807830128448 torch/distributed/run.py:779] *****************************************
W1001 03:59:37.531000 22807830128448 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:59:37.531000 22807830128448 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=6336, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.13419967493973672 sec
Decode latency: 2.8614956960082054 sec
Compilation time: 3.00 seconds
Compilation time: 2.99 seconds
Compilation time: 2.99 seconds
Compilation time: 3.00 seconds
Prefill latency: 0.1280846120789647 sec
Decode latency: 2.8626152359647676 sec
Prefill latency: 0.12808190600480884 sec
Decode latency: 2.859465960995294 sec
Prefill latency: 0.12813622504472733 sec
Decode latency: 2.860966403968632 sec
Prefill latency: 0.12805844494141638 sec
Decode latency: 2.858430531923659 sec
Prefill latency: 0.12809659505728632 sec
Decode latency: 2.859828835935332 sec
Time for inference 1: 2.99 sec total, 1370.51 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2638.74 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.12798613694030792 sec
Decode latency: 2.8595904990797862 sec
Time for inference 2: 2.99 sec total, 1370.69 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2639.08 GB/s
FLOPS achieved: 13.20 TF/s

Prefill latency: 0.12804193096235394 sec
Decode latency: 2.8597509200917557 sec
Time for inference 3: 2.99 sec total, 1370.55 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2638.82 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.12805101391859353 sec
Decode latency: 2.8605569310020655 sec
Time for inference 4: 2.99 sec total, 1370.21 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2638.17 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.12811106501612812 sec
Decode latency: 2.8593621030449867 sec
Time for inference 5: 2.99 sec total, 1370.72 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2639.14 GB/s
FLOPS achieved: 13.20 TF/s

Prefill latency: 0.1280463100410998 sec
Decode latency: 2.8615672829328105 sec
Time for inference 6: 2.99 sec total, 1369.66 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2637.11 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.1280623460188508 sec
Decode latency: 2.8591735450318083 sec
Time for inference 7: 2.99 sec total, 1370.80 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2639.30 GB/s
FLOPS achieved: 13.20 TF/s

Prefill latency: 0.12806045205798 sec
Decode latency: 2.860202720039524 sec
Time for inference 8: 2.99 sec total, 1370.29 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2638.32 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.1280693489825353 sec
Decode latency: 2.8581912519875914 sec
Time for inference 9: 2.99 sec total, 1371.27 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2640.21 GB/s
FLOPS achieved: 13.20 TF/s

Prefill latency: 0.1280854910146445 sec
Decode latency: 2.85931823507417 sec
Time for inference 10: 2.99 sec total, 1370.74 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2639.18 GB/s
FLOPS achieved: 13.20 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8598 sec
Average prefill latency: 0.1281 sec
Average tokens/sec: 1370.54
Memory used: 9.76 GB
Done. we are killing the process
