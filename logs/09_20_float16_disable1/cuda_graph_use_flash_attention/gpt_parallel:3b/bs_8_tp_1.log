flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.84 seconds
Prefill latency: 0.2023238829569891 sec
Decode latency: 3.489224201068282 sec
Compilation time: 3.69 seconds
Prefill latency: 0.20163803198374808 sec
Decode latency: 3.4872911130078137 sec
Prefill latency: 0.20210998703259975 sec
Decode latency: 3.41802177997306 sec
Prefill latency: 0.2010858019348234 sec
Decode latency: 3.3590706629911438 sec
Prefill latency: 0.20187975000590086 sec
Decode latency: 3.487265305011533 sec
Prefill latency: 0.20172213297337294 sec
Decode latency: 3.483903792919591 sec
Time for inference 1: 3.69 sec total, 555.56 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3900.84 GB/s
FLOPS achieved: 19.50 TF/s

Prefill latency: 0.20221096894238144 sec
Decode latency: 3.363231973024085 sec
Time for inference 2: 3.57 sec total, 574.26 tokens/sec
Decode latency: 3.36 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 4032.11 GB/s
FLOPS achieved: 20.16 TF/s

Prefill latency: 0.20198809599969536 sec
Decode latency: 3.4867101409472525 sec
Time for inference 3: 3.69 sec total, 555.08 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3897.44 GB/s
FLOPS achieved: 19.49 TF/s

Prefill latency: 0.2017915400210768 sec
Decode latency: 3.487741503980942 sec
Time for inference 4: 3.69 sec total, 554.95 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3896.55 GB/s
FLOPS achieved: 19.48 TF/s

Prefill latency: 0.2021219020243734 sec
Decode latency: 3.487613375997171 sec
Time for inference 5: 3.69 sec total, 554.94 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3896.47 GB/s
FLOPS achieved: 19.48 TF/s

Prefill latency: 0.2006148750660941 sec
Decode latency: 3.4854034839663655 sec
Time for inference 6: 3.69 sec total, 555.50 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3900.43 GB/s
FLOPS achieved: 19.50 TF/s

Prefill latency: 0.20084985403809696 sec
Decode latency: 3.4856740899849683 sec
Time for inference 7: 3.69 sec total, 555.44 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3899.97 GB/s
FLOPS achieved: 19.50 TF/s

Prefill latency: 0.2020810570102185 sec
Decode latency: 3.443114159977995 sec
Time for inference 8: 3.65 sec total, 561.73 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3944.13 GB/s
FLOPS achieved: 19.72 TF/s

Prefill latency: 0.20191543898545206 sec
Decode latency: 3.4854347690707073 sec
Time for inference 9: 3.69 sec total, 555.30 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3899.02 GB/s
FLOPS achieved: 19.50 TF/s

Prefill latency: 0.20093364699278027 sec
Decode latency: 3.48734360805247 sec
Time for inference 10: 3.69 sec total, 555.15 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3897.94 GB/s
FLOPS achieved: 19.49 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.4696 sec
Average prefill latency: 0.2016 sec
Average tokens/sec: 557.79
Memory used: 14.84 GB
Done. we are killing the process
