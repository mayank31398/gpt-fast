flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.03828205104218796 sec
Decode latency: 2.861553688009735 sec
Compilation time: 2.90 seconds
Prefill latency: 0.038082607032265514 sec
Decode latency: 2.909995852969587 sec
Prefill latency: 0.03799002896994352 sec
Decode latency: 2.9104209970100783 sec
Prefill latency: 0.038182264019269496 sec
Decode latency: 2.9113236279808916 sec
Prefill latency: 0.037996486003976315 sec
Decode latency: 2.9107766849920154 sec
Prefill latency: 0.038114256982225925 sec
Decode latency: 2.9104346859967336 sec
Time for inference 1: 2.95 sec total, 86.80 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1302.89 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.03797697299160063 sec
Decode latency: 2.909018450009171 sec
Time for inference 2: 2.95 sec total, 86.85 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1303.59 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.0380399749847129 sec
Decode latency: 2.9112145969993435 sec
Time for inference 3: 2.95 sec total, 86.78 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1302.59 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.038172489032149315 sec
Decode latency: 2.912759232975077 sec
Time for inference 4: 2.95 sec total, 86.73 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1301.83 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.03817496600095183 sec
Decode latency: 2.8504011719487607 sec
Time for inference 5: 2.89 sec total, 88.60 tokens/sec
Decode latency: 2.85 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1329.94 GB/s
FLOPS achieved: 6.65 TF/s

Prefill latency: 0.038079022022429854 sec
Decode latency: 2.870670192001853 sec
Time for inference 6: 2.91 sec total, 87.99 tokens/sec
Decode latency: 2.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1320.65 GB/s
FLOPS achieved: 6.60 TF/s

Prefill latency: 0.038086530985310674 sec
Decode latency: 2.9118658719817176 sec
Time for inference 7: 2.95 sec total, 86.76 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1302.22 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.03815011295955628 sec
Decode latency: 2.9116286389762536 sec
Time for inference 8: 2.95 sec total, 86.76 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1302.33 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.03823547199135646 sec
Decode latency: 2.911859664018266 sec
Time for inference 9: 2.95 sec total, 86.76 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1302.18 GB/s
FLOPS achieved: 6.51 TF/s

Prefill latency: 0.03815536299953237 sec
Decode latency: 2.9099938140134327 sec
Time for inference 10: 2.95 sec total, 86.81 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1303.08 GB/s
FLOPS achieved: 6.52 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9010 sec
Average prefill latency: 0.0381 sec
Average tokens/sec: 87.08
Memory used: 17.46 GB
