flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.8105261990567669 sec
Decode latency: 8.64889556192793 sec
Compilation time: 9.46 seconds
Prefill latency: 0.8107078099856153 sec
Decode latency: 8.64799581898842 sec
Prefill latency: 0.8110556789906695 sec
Decode latency: 8.648525791009888 sec
Prefill latency: 0.8109849120955914 sec
Decode latency: 8.64780494000297 sec
Prefill latency: 0.8111838980112225 sec
Decode latency: 8.648833579965867 sec
Prefill latency: 0.8112459779949859 sec
Decode latency: 8.647806706023403 sec
Time for inference 1: 9.46 sec total, 1731.92 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.61 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8109538269927725 sec
Decode latency: 8.648290295037441 sec
Time for inference 2: 9.46 sec total, 1731.85 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.44 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8109065999742597 sec
Decode latency: 8.647121542016976 sec
Time for inference 3: 9.46 sec total, 1732.09 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4185.03 GB/s
FLOPS achieved: 20.93 TF/s

Prefill latency: 0.8109274739399552 sec
Decode latency: 8.585598591016605 sec
Time for inference 4: 9.40 sec total, 1743.45 tokens/sec
Decode latency: 8.59 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4212.46 GB/s
FLOPS achieved: 21.06 TF/s

Prefill latency: 0.8109296099282801 sec
Decode latency: 8.58503872109577 sec
Time for inference 5: 9.40 sec total, 1743.54 tokens/sec
Decode latency: 8.59 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4212.68 GB/s
FLOPS achieved: 21.06 TF/s

Prefill latency: 0.8108164300210774 sec
Decode latency: 8.546954316901974 sec
Time for inference 6: 9.36 sec total, 1750.66 tokens/sec
Decode latency: 8.55 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4229.90 GB/s
FLOPS achieved: 21.15 TF/s

Prefill latency: 0.8110021189786494 sec
Decode latency: 8.64559656206984 sec
Time for inference 7: 9.46 sec total, 1732.37 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4185.71 GB/s
FLOPS achieved: 20.93 TF/s

Prefill latency: 0.8109289009589702 sec
Decode latency: 8.647437255014665 sec
Time for inference 8: 9.46 sec total, 1732.02 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.84 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8108176330570132 sec
Decode latency: 8.643305413075723 sec
Time for inference 9: 9.46 sec total, 1732.80 tokens/sec
Decode latency: 8.64 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4186.73 GB/s
FLOPS achieved: 20.93 TF/s

Prefill latency: 0.8136816449696198 sec
Decode latency: 8.646263023023494 sec
Time for inference 10: 9.46 sec total, 1731.75 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.19 GB/s
FLOPS achieved: 20.92 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.6243 sec
Average prefill latency: 0.8112 sec
Average tokens/sec: 1736.24
Memory used: 42.10 GB
Done. we are killing the process
