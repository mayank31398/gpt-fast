flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.20870623597875237 sec
Decode latency: 3.3681473470060155 sec
Compilation time: 3.58 seconds
Prefill latency: 0.20839217898901552 sec
Decode latency: 3.365955854067579 sec
Prefill latency: 0.2082568759797141 sec
Decode latency: 3.3655743330018595 sec
Prefill latency: 0.20829006005078554 sec
Decode latency: 3.36402365390677 sec
Prefill latency: 0.2082659830339253 sec
Decode latency: 3.365676646004431 sec
Prefill latency: 0.20820373203605413 sec
Decode latency: 3.365549825015478 sec
Time for inference 1: 3.57 sec total, 1145.91 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.72 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20828326896298677 sec
Decode latency: 3.3063740090001374 sec
Time for inference 2: 3.52 sec total, 1165.18 tokens/sec
Decode latency: 3.31 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2815.27 GB/s
FLOPS achieved: 14.08 TF/s

Prefill latency: 0.20827491104137152 sec
Decode latency: 3.3657743459334597 sec
Time for inference 3: 3.57 sec total, 1145.81 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.48 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20823990204371512 sec
Decode latency: 3.365547330933623 sec
Time for inference 4: 3.57 sec total, 1145.79 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.43 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20824651198927313 sec
Decode latency: 3.3659416370792314 sec
Time for inference 5: 3.58 sec total, 1145.69 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.17 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20840478304307908 sec
Decode latency: 3.3674578120699152 sec
Time for inference 6: 3.58 sec total, 1145.19 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2766.96 GB/s
FLOPS achieved: 13.83 TF/s

Prefill latency: 0.20836616295855492 sec
Decode latency: 3.3658026879420504 sec
Time for inference 7: 3.57 sec total, 1145.77 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.37 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20841542806010693 sec
Decode latency: 3.36562531394884 sec
Time for inference 8: 3.57 sec total, 1145.82 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.49 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.208327317959629 sec
Decode latency: 3.3659105770057067 sec
Time for inference 9: 3.57 sec total, 1145.75 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2768.33 GB/s
FLOPS achieved: 13.84 TF/s

Prefill latency: 0.20842953701503575 sec
Decode latency: 3.3668827599612996 sec
Time for inference 10: 3.58 sec total, 1145.41 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2767.51 GB/s
FLOPS achieved: 13.84 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3601 sec
Average prefill latency: 0.2083 sec
Average tokens/sec: 1147.63
Memory used: 12.67 GB
Done. we are killing the process
