W1001 03:38:35.694000 23220959045440 torch/distributed/run.py:779] 
W1001 03:38:35.694000 23220959045440 torch/distributed/run.py:779] *****************************************
W1001 03:38:35.694000 23220959045440 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:38:35.694000 23220959045440 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.09839949896559119 sec
Decode latency: 2.923095416976139 sec
Compilation time: 2.98 seconds
Compilation time: 3.00 seconds
Compilation time: 2.99 seconds
Compilation time: 3.02 seconds
Compilation time: 3.02 seconds
Compilation time: 3.00 seconds
Compilation time: 3.00 seconds
Compilation time: 3.02 seconds
Prefill latency: 0.059164461912587285 sec
Decode latency: 2.9109405459603295 sec
Prefill latency: 0.0587523200083524 sec
Decode latency: 2.912599970935844 sec
Prefill latency: 0.05896657600533217 sec
Decode latency: 2.911595084005967 sec
Prefill latency: 0.05854954302776605 sec
Decode latency: 2.9089883220149204 sec
Prefill latency: 0.05931566096842289 sec
Decode latency: 2.908701747073792 sec
Time for inference 1: 2.97 sec total, 1379.66 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 599.27 GB/s
FLOPS achieved: 3.00 TF/s

Prefill latency: 0.0591291890013963 sec
Decode latency: 2.914102509035729 sec
Time for inference 2: 2.97 sec total, 1377.20 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 598.20 GB/s
FLOPS achieved: 2.99 TF/s

Prefill latency: 0.05885711801238358 sec
Decode latency: 2.921518152928911 sec
Time for inference 3: 2.98 sec total, 1373.92 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 596.77 GB/s
FLOPS achieved: 2.98 TF/s

Prefill latency: 0.05872127099428326 sec
Decode latency: 2.9048641009721905 sec
Time for inference 4: 2.96 sec total, 1381.62 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 600.12 GB/s
FLOPS achieved: 3.00 TF/s

Prefill latency: 0.05882871197536588 sec
Decode latency: 2.925331645994447 sec
Time for inference 5: 2.99 sec total, 1372.13 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 596.00 GB/s
FLOPS achieved: 2.98 TF/s

Prefill latency: 0.058487865957431495 sec
Decode latency: 2.9109917010646313 sec
Time for inference 6: 2.97 sec total, 1378.90 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 598.94 GB/s
FLOPS achieved: 2.99 TF/s

Prefill latency: 0.0587482659611851 sec
Decode latency: 2.91387620405294 sec
Time for inference 7: 2.97 sec total, 1377.45 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 598.31 GB/s
FLOPS achieved: 2.99 TF/s

Prefill latency: 0.061495731002651155 sec
Decode latency: 2.911417046911083 sec
Time for inference 8: 2.97 sec total, 1377.33 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 598.26 GB/s
FLOPS achieved: 2.99 TF/s

Prefill latency: 0.058651263010688126 sec
Decode latency: 2.9179954959545285 sec
Time for inference 9: 2.98 sec total, 1375.64 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 597.52 GB/s
FLOPS achieved: 2.99 TF/s

Prefill latency: 0.05880146601703018 sec
Decode latency: 2.911273972946219 sec
Time for inference 10: 2.97 sec total, 1378.57 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 598.80 GB/s
FLOPS achieved: 2.99 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9140 sec
Average prefill latency: 0.0591 sec
Average tokens/sec: 1377.24
Memory used: 5.48 GB
Done. we are killing the process
