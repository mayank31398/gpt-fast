flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.10797155601903796 sec
Decode latency: 2.751942993956618 sec
Compilation time: 2.86 seconds
Prefill latency: 0.1074107700260356 sec
Decode latency: 2.7502907239831984 sec
Prefill latency: 0.10748395207338035 sec
Decode latency: 2.750302708009258 sec
Prefill latency: 0.10747769102454185 sec
Decode latency: 2.749705789028667 sec
Prefill latency: 0.1074401589576155 sec
Decode latency: 2.7501645520096645 sec
Prefill latency: 0.10745108698029071 sec
Decode latency: 2.7494566180976108 sec
Time for inference 1: 2.86 sec total, 716.68 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.62 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10742274904623628 sec
Decode latency: 2.7499977009138092 sec
Time for inference 2: 2.86 sec total, 716.55 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.30 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10742136801127344 sec
Decode latency: 2.7494678701041266 sec
Time for inference 3: 2.86 sec total, 716.68 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.63 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10747070098295808 sec
Decode latency: 2.749419184983708 sec
Time for inference 4: 2.86 sec total, 716.68 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.61 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10756233392748982 sec
Decode latency: 2.7490486099850386 sec
Time for inference 5: 2.86 sec total, 716.72 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.71 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10741306305862963 sec
Decode latency: 2.749441401916556 sec
Time for inference 6: 2.86 sec total, 716.66 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.57 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.1075360260438174 sec
Decode latency: 2.749499158002436 sec
Time for inference 7: 2.86 sec total, 716.61 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.46 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.1075431079370901 sec
Decode latency: 2.749835961032659 sec
Time for inference 8: 2.86 sec total, 716.53 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.26 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10743554693181068 sec
Decode latency: 2.749947434058413 sec
Time for inference 9: 2.86 sec total, 716.53 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.24 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10755042906384915 sec
Decode latency: 2.7499925140291452 sec
Time for inference 10: 2.86 sec total, 716.51 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.21 GB/s
FLOPS achieved: 8.66 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7496 sec
Average prefill latency: 0.1075 sec
Average tokens/sec: 716.61
Memory used: 7.72 GB
Done. we are killing the process
