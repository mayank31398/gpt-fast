W1001 03:34:42.335000 22768093443904 torch/distributed/run.py:779] 
W1001 03:34:42.335000 22768093443904 torch/distributed/run.py:779] *****************************************
W1001 03:34:42.335000 22768093443904 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:34:42.335000 22768093443904 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.17 seconds
Prefill latency: 0.06097763299476355 sec
Decode latency: 2.599981727078557 sec
Compilation time: 2.64 seconds
Compilation time: 2.65 seconds
Compilation time: 2.68 seconds
Compilation time: 2.64 seconds
Compilation time: 2.66 seconds
Compilation time: 2.66 seconds
Compilation time: 2.68 seconds
Compilation time: 2.64 seconds
Prefill latency: 0.03368660400155932 sec
Decode latency: 2.6027843749616295 sec
Prefill latency: 0.0330160460434854 sec
Decode latency: 2.6126500628888607 sec
Prefill latency: 0.03271606599446386 sec
Decode latency: 2.608475070912391 sec
Prefill latency: 0.03472035308368504 sec
Decode latency: 2.601436460041441 sec
Prefill latency: 0.03301277395803481 sec
Decode latency: 2.6157396209891886 sec
Time for inference 1: 2.65 sec total, 772.95 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 335.74 GB/s
FLOPS achieved: 1.68 TF/s

Prefill latency: 0.032873062998987734 sec
Decode latency: 2.6139167349319905 sec
Time for inference 2: 2.65 sec total, 773.46 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 335.96 GB/s
FLOPS achieved: 1.68 TF/s

Prefill latency: 0.032790130004286766 sec
Decode latency: 2.6011406170437112 sec
Time for inference 3: 2.63 sec total, 777.25 tokens/sec
Decode latency: 2.60 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 337.61 GB/s
FLOPS achieved: 1.69 TF/s

Prefill latency: 0.0328132490394637 sec
Decode latency: 2.60610639792867 sec
Time for inference 4: 2.64 sec total, 775.81 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 336.98 GB/s
FLOPS achieved: 1.68 TF/s

Prefill latency: 0.033481220016255975 sec
Decode latency: 2.5971604239894077 sec
Time for inference 5: 2.63 sec total, 778.23 tokens/sec
Decode latency: 2.60 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 338.03 GB/s
FLOPS achieved: 1.69 TF/s

Prefill latency: 0.03292110294569284 sec
Decode latency: 2.6050476159434766 sec
Time for inference 6: 2.64 sec total, 776.09 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 337.10 GB/s
FLOPS achieved: 1.69 TF/s

Prefill latency: 0.03270679397974163 sec
Decode latency: 2.6078834059881046 sec
Time for inference 7: 2.64 sec total, 775.33 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 336.77 GB/s
FLOPS achieved: 1.68 TF/s

Prefill latency: 0.03641569695901126 sec
Decode latency: 2.6016443360131234 sec
Time for inference 8: 2.64 sec total, 776.07 tokens/sec
Decode latency: 2.60 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 337.09 GB/s
FLOPS achieved: 1.69 TF/s

Prefill latency: 0.03272412100341171 sec
Decode latency: 2.5891878639813513 sec
Time for inference 9: 2.62 sec total, 780.83 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 339.16 GB/s
FLOPS achieved: 1.70 TF/s

Prefill latency: 0.03265761293005198 sec
Decode latency: 2.606170789920725 sec
Time for inference 10: 2.64 sec total, 775.83 tokens/sec
Decode latency: 2.61 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 336.99 GB/s
FLOPS achieved: 1.68 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6044 sec
Average prefill latency: 0.0332 sec
Average tokens/sec: 776.19
Memory used: 3.02 GB
Done. we are killing the process
