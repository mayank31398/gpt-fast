flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 2.6115826410241425 sec
Decode latency: 19.225284689106047 sec
Compilation time: 21.84 seconds
Prefill latency: 2.6138890059664845 sec
Decode latency: 19.225357618997805 sec
Prefill latency: 2.6151802950771526 sec
Decode latency: 19.22499066707678 sec
Prefill latency: 2.6146560669876635 sec
Decode latency: 19.224684828077443 sec
Prefill latency: 2.614134236006066 sec
Decode latency: 19.22521015093662 sec
Prefill latency: 2.610019152984023 sec
Decode latency: 19.226560079026967 sec
Time for inference 1: 21.84 sec total, 750.26 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11261.29 GB/s
FLOPS achieved: 56.31 TF/s

Prefill latency: 2.6142117540584877 sec
Decode latency: 19.224725970067084 sec
Time for inference 2: 21.84 sec total, 750.17 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11259.98 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.6162500069476664 sec
Decode latency: 19.225081602926366 sec
Time for inference 3: 21.84 sec total, 750.10 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11258.84 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.6164961570175365 sec
Decode latency: 19.225425956072286 sec
Time for inference 4: 21.84 sec total, 750.08 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11258.52 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.6318301430437714 sec
Decode latency: 19.226142068044282 sec
Time for inference 5: 21.86 sec total, 749.53 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.63 sec
Bandwidth achieved: 11250.29 GB/s
FLOPS achieved: 56.25 TF/s

Prefill latency: 2.6125270220218226 sec
Decode latency: 19.224628665018827 sec
Time for inference 6: 21.84 sec total, 750.24 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11260.94 GB/s
FLOPS achieved: 56.30 TF/s

Prefill latency: 2.6177248070016503 sec
Decode latency: 19.226180894998834 sec
Time for inference 7: 21.85 sec total, 750.01 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11257.53 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.60709201102145 sec
Decode latency: 19.225173416896723 sec
Time for inference 8: 21.83 sec total, 750.41 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11263.53 GB/s
FLOPS achieved: 56.32 TF/s

Prefill latency: 2.617343988036737 sec
Decode latency: 19.225122801959515 sec
Time for inference 9: 21.84 sec total, 750.06 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11258.28 GB/s
FLOPS achieved: 56.29 TF/s

Prefill latency: 2.6136462660506368 sec
Decode latency: 19.22624442097731 sec
Time for inference 10: 21.84 sec total, 750.15 tokens/sec
Decode latency: 19.23 sec
Prefill latency: 2.61 sec
Bandwidth achieved: 11259.65 GB/s
FLOPS achieved: 56.30 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2255 sec
Average prefill latency: 2.6157 sec
Average tokens/sec: 750.10
Memory used: 58.80 GB
Done. we are killing the process
