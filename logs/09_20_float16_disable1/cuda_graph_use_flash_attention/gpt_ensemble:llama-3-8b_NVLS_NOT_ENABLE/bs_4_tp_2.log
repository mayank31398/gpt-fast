W0929 04:33:55.911000 22793465882432 torch/distributed/run.py:779] 
W0929 04:33:55.911000 22793465882432 torch/distributed/run.py:779] *****************************************
W0929 04:33:55.911000 22793465882432 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0929 04:33:55.911000 22793465882432 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.93 seconds
Prefill latency: 0.0816755419364199 sec
Decode latency: 2.5827135959407315 sec
Compilation time: 2.67 seconds
Compilation time: 2.67 seconds
Prefill latency: 0.08186883898451924 sec
Decode latency: 2.5806650450685993 sec
Prefill latency: 0.08212779194582254 sec
Decode latency: 2.580713193048723 sec
Prefill latency: 0.08179949899204075 sec
Decode latency: 2.581370580010116 sec
Prefill latency: 0.08137617202010006 sec
Decode latency: 2.5802278380142525 sec
Prefill latency: 0.08209713303949684 sec
Decode latency: 2.5812215100741014 sec
Time for inference 1: 2.66 sec total, 384.36 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3086.59 GB/s
FLOPS achieved: 15.43 TF/s

Prefill latency: 0.08201603009365499 sec
Decode latency: 2.5803112679859623 sec
Time for inference 2: 2.66 sec total, 384.50 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3087.78 GB/s
FLOPS achieved: 15.44 TF/s

Prefill latency: 0.08199906302616 sec
Decode latency: 2.58071678399574 sec
Time for inference 3: 2.66 sec total, 384.46 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3087.42 GB/s
FLOPS achieved: 15.44 TF/s

Prefill latency: 0.08169746992643923 sec
Decode latency: 2.580878247972578 sec
Time for inference 4: 2.66 sec total, 384.48 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3087.55 GB/s
FLOPS achieved: 15.44 TF/s

Prefill latency: 0.08180093695409596 sec
Decode latency: 2.578175055095926 sec
Time for inference 5: 2.66 sec total, 384.86 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3090.62 GB/s
FLOPS achieved: 15.45 TF/s

Prefill latency: 0.08164380106609315 sec
Decode latency: 2.579006018000655 sec
Time for inference 6: 2.66 sec total, 384.78 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3089.97 GB/s
FLOPS achieved: 15.45 TF/s

Prefill latency: 0.0815245199482888 sec
Decode latency: 2.5786965129664168 sec
Time for inference 7: 2.66 sec total, 384.81 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3090.26 GB/s
FLOPS achieved: 15.45 TF/s

Prefill latency: 0.08167689701076597 sec
Decode latency: 2.57810140599031 sec
Time for inference 8: 2.66 sec total, 384.88 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3090.78 GB/s
FLOPS achieved: 15.45 TF/s

Prefill latency: 0.08175638201646507 sec
Decode latency: 2.578583065071143 sec
Time for inference 9: 2.66 sec total, 384.81 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3090.25 GB/s
FLOPS achieved: 15.45 TF/s

Prefill latency: 0.08183634805027395 sec
Decode latency: 2.5792015249608085 sec
Time for inference 10: 2.66 sec total, 384.72 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3089.47 GB/s
FLOPS achieved: 15.45 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5795 sec
Average prefill latency: 0.0818 sec
Average tokens/sec: 384.67
Memory used: 11.11 GB
Done. we are killing the process
