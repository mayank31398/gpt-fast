W0929 04:43:17.805000 22385304192832 torch/distributed/run.py:779] 
W0929 04:43:17.805000 22385304192832 torch/distributed/run.py:779] *****************************************
W0929 04:43:17.805000 22385304192832 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0929 04:43:17.805000 22385304192832 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.14 seconds
Prefill latency: 0.19644917896948755 sec
Decode latency: 2.6832371269119903 sec
Compilation time: 2.87 seconds
Compilation time: 2.87 seconds
Compilation time: 2.88 seconds
Compilation time: 2.87 seconds
Prefill latency: 0.18977243604604155 sec
Decode latency: 2.6820748689351603 sec
Prefill latency: 0.19017118494957685 sec
Decode latency: 2.6826602820074186 sec
Prefill latency: 0.19025619502644986 sec
Decode latency: 2.683242014958523 sec
Prefill latency: 0.18954121402930468 sec
Decode latency: 2.681425586924888 sec
Prefill latency: 0.19024817598983645 sec
Decode latency: 2.6834491740446538 sec
Time for inference 1: 2.87 sec total, 1424.97 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6470.61 GB/s
FLOPS achieved: 32.35 TF/s

Prefill latency: 0.18896461999975145 sec
Decode latency: 2.681021459051408 sec
Time for inference 2: 2.87 sec total, 1426.85 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6479.12 GB/s
FLOPS achieved: 32.40 TF/s

Prefill latency: 0.19022302492521703 sec
Decode latency: 2.680916244047694 sec
Time for inference 3: 2.87 sec total, 1426.22 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6476.29 GB/s
FLOPS achieved: 32.38 TF/s

Prefill latency: 0.19031291594728827 sec
Decode latency: 2.6805476050358266 sec
Time for inference 4: 2.87 sec total, 1426.34 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6476.81 GB/s
FLOPS achieved: 32.38 TF/s

Prefill latency: 0.19038580602500588 sec
Decode latency: 2.6833633929491043 sec
Time for inference 5: 2.87 sec total, 1424.91 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6470.31 GB/s
FLOPS achieved: 32.35 TF/s

Prefill latency: 0.1897600539959967 sec
Decode latency: 2.681315248948522 sec
Time for inference 6: 2.87 sec total, 1426.23 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6476.31 GB/s
FLOPS achieved: 32.38 TF/s

Prefill latency: 0.19101405597757548 sec
Decode latency: 2.680846235016361 sec
Time for inference 7: 2.87 sec total, 1425.88 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6474.72 GB/s
FLOPS achieved: 32.37 TF/s

Prefill latency: 0.19043135293759406 sec
Decode latency: 2.6818100550444797 sec
Time for inference 8: 2.87 sec total, 1425.66 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6473.71 GB/s
FLOPS achieved: 32.37 TF/s

Prefill latency: 0.18934411893133074 sec
Decode latency: 2.681226541986689 sec
Time for inference 9: 2.87 sec total, 1426.56 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6477.83 GB/s
FLOPS achieved: 32.39 TF/s

Prefill latency: 0.19019293005112559 sec
Decode latency: 2.68167408707086 sec
Time for inference 10: 2.87 sec total, 1425.91 tokens/sec
Decode latency: 2.68 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6474.88 GB/s
FLOPS achieved: 32.37 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6816 sec
Average prefill latency: 0.1901 sec
Average tokens/sec: 1425.95
Memory used: 12.03 GB
Done. we are killing the process
