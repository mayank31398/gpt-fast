W0929 04:53:59.818000 22732627343168 torch/distributed/run.py:779] 
W0929 04:53:59.818000 22732627343168 torch/distributed/run.py:779] *****************************************
W0929 04:53:59.818000 22732627343168 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0929 04:53:59.818000 22732627343168 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.730422958964482 sec
Decode latency: 5.792449290980585 sec
Compilation time: 6.52 seconds
Compilation time: 6.52 seconds
Compilation time: 6.52 seconds
Compilation time: 6.52 seconds
Prefill latency: 0.7336113658966497 sec
Decode latency: 5.793184009962715 sec
Prefill latency: 0.7341849589720368 sec
Decode latency: 5.789615086046979 sec
Prefill latency: 0.7300635150168091 sec
Decode latency: 5.788345435052179 sec
Prefill latency: 0.7368701760424301 sec
Decode latency: 5.782816029037349 sec
Prefill latency: 0.7399589349515736 sec
Decode latency: 5.787104749004357 sec
Time for inference 1: 6.53 sec total, 2509.83 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11396.82 GB/s
FLOPS achieved: 56.98 TF/s

Prefill latency: 0.738702006987296 sec
Decode latency: 5.791173117002472 sec
Time for inference 2: 6.53 sec total, 2508.76 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11391.94 GB/s
FLOPS achieved: 56.96 TF/s

Prefill latency: 0.7372587500140071 sec
Decode latency: 5.784751738072373 sec
Time for inference 3: 6.52 sec total, 2511.78 tokens/sec
Decode latency: 5.78 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11405.64 GB/s
FLOPS achieved: 57.03 TF/s

Prefill latency: 0.7383227180689573 sec
Decode latency: 5.785984263988212 sec
Time for inference 4: 6.53 sec total, 2510.93 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11401.81 GB/s
FLOPS achieved: 57.01 TF/s

Prefill latency: 0.738763835048303 sec
Decode latency: 5.78493587509729 sec
Time for inference 5: 6.52 sec total, 2511.12 tokens/sec
Decode latency: 5.78 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11402.65 GB/s
FLOPS achieved: 57.01 TF/s

Prefill latency: 0.738755276077427 sec
Decode latency: 5.785537678049877 sec
Time for inference 6: 6.53 sec total, 2510.88 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11401.58 GB/s
FLOPS achieved: 57.01 TF/s

Prefill latency: 0.7372086750110611 sec
Decode latency: 5.786348470021039 sec
Time for inference 7: 6.52 sec total, 2511.18 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11402.94 GB/s
FLOPS achieved: 57.01 TF/s

Prefill latency: 0.7404075639788061 sec
Decode latency: 5.784738492104225 sec
Time for inference 8: 6.53 sec total, 2510.63 tokens/sec
Decode latency: 5.78 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11400.42 GB/s
FLOPS achieved: 57.00 TF/s

Prefill latency: 0.7366785890189931 sec
Decode latency: 5.7870152950054035 sec
Time for inference 9: 6.52 sec total, 2511.18 tokens/sec
Decode latency: 5.79 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11402.95 GB/s
FLOPS achieved: 57.01 TF/s

Prefill latency: 0.736622123979032 sec
Decode latency: 5.784443047945388 sec
Time for inference 10: 6.52 sec total, 2512.12 tokens/sec
Decode latency: 5.78 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 11407.22 GB/s
FLOPS achieved: 57.04 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.7862 sec
Average prefill latency: 0.7383 sec
Average tokens/sec: 2510.84
Memory used: 30.87 GB
Done. we are killing the process
