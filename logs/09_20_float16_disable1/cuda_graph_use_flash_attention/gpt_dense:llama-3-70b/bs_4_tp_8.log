W0928 19:05:08.938000 22565616240448 torch/distributed/run.py:779] 
W0928 19:05:08.938000 22565616240448 torch/distributed/run.py:779] *****************************************
W0928 19:05:08.938000 22565616240448 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:05:08.938000 22565616240448 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.45 seconds
Prefill latency: 0.27551124402089044 sec
Decode latency: 8.376865661004558 sec
Compilation time: 8.65 secondsCompilation time: 8.65 secondsCompilation time: 8.64 seconds


Compilation time: 8.71 seconds
Compilation time: 8.72 seconds
Compilation time: 8.73 seconds
Compilation time: 8.67 secondsCompilation time: 8.65 seconds

Prefill latency: 0.252904593013227 sec
Decode latency: 8.389278134040069 sec
Prefill latency: 0.25100230297539383 sec
Decode latency: 8.406380694999825 sec
Prefill latency: 0.251699845015537 sec
Decode latency: 8.377526155964006 sec
Prefill latency: 0.2516975390026346 sec
Decode latency: 8.40222868003184 sec
Prefill latency: 0.25281031703343615 sec
Decode latency: 8.39477104198886 sec
Time for inference 1: 8.65 sec total, 118.40 tokens/sec
Decode latency: 8.39 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2275.22 GB/s
FLOPS achieved: 11.38 TF/s

Prefill latency: 0.252702625002712 sec
Decode latency: 8.397557615011465 sec
Time for inference 2: 8.65 sec total, 118.36 tokens/sec
Decode latency: 8.40 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2274.48 GB/s
FLOPS achieved: 11.37 TF/s

Prefill latency: 0.25336716300807893 sec
Decode latency: 8.39096490002703 sec
Time for inference 3: 8.65 sec total, 118.44 tokens/sec
Decode latency: 8.39 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2276.10 GB/s
FLOPS achieved: 11.38 TF/s

Prefill latency: 0.2519625499844551 sec
Decode latency: 8.365723997994792 sec
Time for inference 4: 8.62 sec total, 118.81 tokens/sec
Decode latency: 8.37 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2283.16 GB/s
FLOPS achieved: 11.42 TF/s

Prefill latency: 0.25429751502815634 sec
Decode latency: 8.364098550984636 sec
Time for inference 5: 8.62 sec total, 118.80 tokens/sec
Decode latency: 8.36 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2282.93 GB/s
FLOPS achieved: 11.41 TF/s

Prefill latency: 0.252018530969508 sec
Decode latency: 8.387530279986095 sec
Time for inference 6: 8.64 sec total, 118.51 tokens/sec
Decode latency: 8.39 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2277.37 GB/s
FLOPS achieved: 11.39 TF/s

Prefill latency: 0.2518199449987151 sec
Decode latency: 8.39624204399297 sec
Time for inference 7: 8.65 sec total, 118.39 tokens/sec
Decode latency: 8.40 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2275.10 GB/s
FLOPS achieved: 11.38 TF/s

Prefill latency: 0.2533438199898228 sec
Decode latency: 8.411062847997528 sec
Time for inference 8: 8.67 sec total, 118.17 tokens/sec
Decode latency: 8.41 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2270.80 GB/s
FLOPS achieved: 11.35 TF/s

Prefill latency: 0.25175083498470485 sec
Decode latency: 8.37489875103347 sec
Time for inference 9: 8.63 sec total, 118.69 tokens/sec
Decode latency: 8.37 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2280.75 GB/s
FLOPS achieved: 11.40 TF/s

Prefill latency: 0.2531335219973698 sec
Decode latency: 8.400728298001923 sec
Time for inference 10: 8.66 sec total, 118.31 tokens/sec
Decode latency: 8.40 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 2273.59 GB/s
FLOPS achieved: 11.37 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.3884 sec
Average prefill latency: 0.2527 sec
Average tokens/sec: 118.49
Memory used: 33.90 GB
Done. we are killing the process
