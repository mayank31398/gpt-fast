W0928 18:59:56.166000 22797810399040 torch/distributed/run.py:779] 
W0928 18:59:56.166000 22797810399040 torch/distributed/run.py:779] *****************************************
W0928 18:59:56.166000 22797810399040 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:59:56.166000 22797810399040 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.44 seconds
Prefill latency: 0.1730467249872163 sec
Decode latency: 6.959667834045831 sec
Compilation time: 7.09 seconds
Compilation time: 7.12 seconds
Compilation time: 7.06 seconds
Compilation time: 7.10 seconds
Compilation time: 7.08 seconds
Compilation time: 7.08 seconds
Compilation time: 7.12 seconds
Compilation time: 7.13 seconds
Prefill latency: 0.0816770059755072 sec
Decode latency: 6.941856576944701 sec
Prefill latency: 0.08379448502091691 sec
Decode latency: 6.93399638205301 sec
Prefill latency: 0.08487219095695764 sec
Decode latency: 6.952160120010376 sec
Prefill latency: 0.08587246795650572 sec
Decode latency: 6.9449776820256375 sec
Prefill latency: 0.08263772702775896 sec
Decode latency: 6.932942431012634 sec
Time for inference 1: 7.02 sec total, 36.48 tokens/sec
Decode latency: 6.93 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 701.11 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.08338657399872318 sec
Decode latency: 6.942883652984165 sec
Time for inference 2: 7.03 sec total, 36.43 tokens/sec
Decode latency: 6.94 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 700.05 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.08333296299679205 sec
Decode latency: 6.91986858000746 sec
Time for inference 3: 7.00 sec total, 36.55 tokens/sec
Decode latency: 6.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 702.37 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.0857653230195865 sec
Decode latency: 6.936300669971388 sec
Time for inference 4: 7.02 sec total, 36.45 tokens/sec
Decode latency: 6.94 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 700.45 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.0815963780041784 sec
Decode latency: 6.938291841943283 sec
Time for inference 5: 7.02 sec total, 36.46 tokens/sec
Decode latency: 6.94 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 700.68 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.08359149500029162 sec
Decode latency: 6.944683407025877 sec
Time for inference 6: 7.03 sec total, 36.42 tokens/sec
Decode latency: 6.94 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 699.84 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.08394395798677579 sec
Decode latency: 6.930715891008731 sec
Time for inference 7: 7.02 sec total, 36.49 tokens/sec
Decode latency: 6.93 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 701.21 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.08233223803108558 sec
Decode latency: 6.92617951601278 sec
Time for inference 8: 7.01 sec total, 36.52 tokens/sec
Decode latency: 6.93 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 701.83 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.08690801303600892 sec
Decode latency: 6.940368340990972 sec
Time for inference 9: 7.03 sec total, 36.42 tokens/sec
Decode latency: 6.94 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 699.93 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.08214270998723805 sec
Decode latency: 6.948400947032496 sec
Time for inference 10: 7.03 sec total, 36.41 tokens/sec
Decode latency: 6.95 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 699.62 GB/s
FLOPS achieved: 3.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.9361 sec
Average prefill latency: 0.0836 sec
Average tokens/sec: 36.46
Memory used: 24.90 GB
Done. we are killing the process
