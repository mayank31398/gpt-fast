W0926 21:54:41.837000 23403909244736 torch/distributed/run.py:779] 
W0926 21:54:41.837000 23403909244736 torch/distributed/run.py:779] *****************************************
W0926 21:54:41.837000 23403909244736 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0926 21:54:41.837000 23403909244736 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 0.12968920730054379 sec
Decode latency: 7.719777727499604 sec
Compilation time: 7.85 seconds
Compilation time: 7.85 seconds
Compilation time: 7.87 seconds
Compilation time: 7.83 seconds
Prefill latency: 0.10866310726851225 sec
Decode latency: 7.716172721236944 sec
Prefill latency: 0.10823622718453407 sec
Decode latency: 7.719387398101389 sec
Prefill latency: 0.1083361292257905 sec
Decode latency: 7.715668291784823 sec
Prefill latency: 0.1086805397644639 sec
Decode latency: 7.71420680731535 sec
Prefill latency: 0.10868498869240284 sec
Decode latency: 7.7137297289446 sec
Time for inference 1: 7.82 sec total, 32.72 tokens/sec
Decode latency: 7.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.80 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10839785821735859 sec
Decode latency: 7.720342709682882 sec
Time for inference 2: 7.83 sec total, 32.70 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1187.84 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.1082260524854064 sec
Decode latency: 7.71651419904083 sec
Time for inference 3: 7.83 sec total, 32.71 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.45 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10831868182867765 sec
Decode latency: 7.715496260672808 sec
Time for inference 4: 7.82 sec total, 32.72 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.61 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10839535016566515 sec
Decode latency: 7.716689683496952 sec
Time for inference 5: 7.83 sec total, 32.71 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.40 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10845876019448042 sec
Decode latency: 7.713907077908516 sec
Time for inference 6: 7.82 sec total, 32.72 tokens/sec
Decode latency: 7.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.81 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10833156481385231 sec
Decode latency: 7.716417622752488 sec
Time for inference 7: 7.83 sec total, 32.71 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.44 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10827093850821257 sec
Decode latency: 7.719201267696917 sec
Time for inference 8: 7.83 sec total, 32.70 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.04 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10838296730071306 sec
Decode latency: 7.718022023327649 sec
Time for inference 9: 7.83 sec total, 32.71 tokens/sec
Decode latency: 7.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.20 GB/s
FLOPS achieved: 5.94 TF/s

Prefill latency: 0.10834185965359211 sec
Decode latency: 7.712910253554583 sec
Time for inference 10: 7.82 sec total, 32.73 tokens/sec
Decode latency: 7.71 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1188.98 GB/s
FLOPS achieved: 5.94 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.7163 sec
Average prefill latency: 0.1084 sec
Average tokens/sec: 32.71
Memory used: 42.77 GB
[rank1]:[E926 21:57:49.969734692 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
[rank2]:[E926 21:57:49.969734394 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 2] Future for ProcessGroup abort timed out after 60000 ms
[rank3]:[E926 21:57:49.969734528 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 3] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E926 21:57:49.969779577 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
[rank3]:[E926 22:14:45.946313075 ProcessGroupNCCL.cpp:1375] [PG 0 (default_pg) Rank 3] First PG on this rank that detected no heartbeat of its watchdog.
[rank3]:[E926 22:14:45.946374947 ProcessGroupNCCL.cpp:1413] [PG 0 (default_pg) Rank 3] Heartbeat monitor timed out! Process will be terminated after dumping debug info. workMetaList_.size()=0
[rank2]:[E926 22:14:45.948789318 ProcessGroupNCCL.cpp:1375] [PG 0 (default_pg) Rank 2] First PG on this rank that detected no heartbeat of its watchdog.
[rank2]:[E926 22:14:45.948831534 ProcessGroupNCCL.cpp:1413] [PG 0 (default_pg) Rank 2] Heartbeat monitor timed out! Process will be terminated after dumping debug info. workMetaList_.size()=0
[rank1]:[E926 22:14:45.949052407 ProcessGroupNCCL.cpp:1375] [PG 0 (default_pg) Rank 1] First PG on this rank that detected no heartbeat of its watchdog.
[rank1]:[E926 22:14:45.949112413 ProcessGroupNCCL.cpp:1413] [PG 0 (default_pg) Rank 1] Heartbeat monitor timed out! Process will be terminated after dumping debug info. workMetaList_.size()=0
[rank0]:[E926 22:14:45.951251268 ProcessGroupNCCL.cpp:1375] [PG 0 (default_pg) Rank 0] First PG on this rank that detected no heartbeat of its watchdog.
[rank0]:[E926 22:14:45.951296509 ProcessGroupNCCL.cpp:1413] [PG 0 (default_pg) Rank 0] Heartbeat monitor timed out! Process will be terminated after dumping debug info. workMetaList_.size()=0
