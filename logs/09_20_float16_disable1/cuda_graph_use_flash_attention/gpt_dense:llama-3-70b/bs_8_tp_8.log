W0928 19:11:14.287000 22385707280192 torch/distributed/run.py:779] 
W0928 19:11:14.287000 22385707280192 torch/distributed/run.py:779] *****************************************
W0928 19:11:14.287000 22385707280192 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:11:14.287000 22385707280192 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.64 seconds
Prefill latency: 0.5672800750471652 sec
Decode latency: 9.538060032005887 sec
Compilation time: 10.07 seconds
Compilation time: 10.07 secondsCompilation time: 10.07 seconds

Compilation time: 10.03 seconds
Compilation time: 10.05 seconds
Compilation time: 10.05 seconds
Compilation time: 10.03 seconds
Compilation time: 10.11 seconds
Prefill latency: 0.475983823009301 sec
Decode latency: 9.526654582004994 sec
Prefill latency: 0.47669815097469836 sec
Decode latency: 9.505608636012767 sec
Prefill latency: 0.4752549860277213 sec
Decode latency: 9.510447292996105 sec
Prefill latency: 0.475826173031237 sec
Decode latency: 9.524223680025898 sec
Prefill latency: 0.4746652339817956 sec
Decode latency: 9.521847249998245 sec
Time for inference 1: 10.00 sec total, 204.85 tokens/sec
Decode latency: 9.52 sec
Prefill latency: 0.47 sec
Bandwidth achieved: 3936.45 GB/s
FLOPS achieved: 19.68 TF/s

Prefill latency: 0.47425403201486915 sec
Decode latency: 9.527060523978435 sec
Time for inference 2: 10.00 sec total, 204.75 tokens/sec
Decode latency: 9.53 sec
Prefill latency: 0.47 sec
Bandwidth achieved: 3934.59 GB/s
FLOPS achieved: 19.67 TF/s

Prefill latency: 0.4747960490058176 sec
Decode latency: 9.55052293499466 sec
Time for inference 3: 10.03 sec total, 204.26 tokens/sec
Decode latency: 9.55 sec
Prefill latency: 0.47 sec
Bandwidth achieved: 3925.20 GB/s
FLOPS achieved: 19.63 TF/s

Prefill latency: 0.47654778097057715 sec
Decode latency: 9.509761978988536 sec
Time for inference 4: 9.99 sec total, 205.06 tokens/sec
Decode latency: 9.51 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3940.53 GB/s
FLOPS achieved: 19.70 TF/s

Prefill latency: 0.47607223101658747 sec
Decode latency: 9.497227216954343 sec
Time for inference 5: 9.97 sec total, 205.32 tokens/sec
Decode latency: 9.50 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3945.65 GB/s
FLOPS achieved: 19.73 TF/s

Prefill latency: 0.47818091104272753 sec
Decode latency: 9.51609195501078 sec
Time for inference 6: 10.00 sec total, 204.89 tokens/sec
Decode latency: 9.52 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3937.40 GB/s
FLOPS achieved: 19.69 TF/s

Prefill latency: 0.47521600598702207 sec
Decode latency: 9.504447577986866 sec
Time for inference 7: 9.98 sec total, 205.19 tokens/sec
Decode latency: 9.50 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3943.14 GB/s
FLOPS achieved: 19.72 TF/s

Prefill latency: 0.4750492870225571 sec
Decode latency: 9.504065093991812 sec
Time for inference 8: 9.98 sec total, 205.20 tokens/sec
Decode latency: 9.50 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3943.36 GB/s
FLOPS achieved: 19.72 TF/s

Prefill latency: 0.47571416897699237 sec
Decode latency: 9.530944752972573 sec
Time for inference 9: 10.01 sec total, 204.64 tokens/sec
Decode latency: 9.53 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3932.53 GB/s
FLOPS achieved: 19.66 TF/s

Prefill latency: 0.48026396898785606 sec
Decode latency: 9.528766840987373 sec
Time for inference 10: 10.01 sec total, 204.59 tokens/sec
Decode latency: 9.53 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 3931.56 GB/s
FLOPS achieved: 19.66 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 9.5191 sec
Average prefill latency: 0.4761 sec
Average tokens/sec: 204.88
Memory used: 46.30 GB
Done. we are killing the process
