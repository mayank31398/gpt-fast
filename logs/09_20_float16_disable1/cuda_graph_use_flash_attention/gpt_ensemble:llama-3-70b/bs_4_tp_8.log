W0928 20:41:13.522000 22537153242944 torch/distributed/run.py:779] 
W0928 20:41:13.522000 22537153242944 torch/distributed/run.py:779] *****************************************
W0928 20:41:13.522000 22537153242944 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:41:13.522000 22537153242944 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.44 seconds
Prefill latency: 0.2576439579715952 sec
Decode latency: 6.989747700048611 sec
Compilation time: 7.26 seconds
Compilation time: 7.23 seconds
Compilation time: 7.25 seconds
Compilation time: 7.21 secondsCompilation time: 7.26 seconds

Compilation time: 7.25 seconds
Compilation time: 7.32 seconds
Compilation time: 7.31 seconds
Prefill latency: 0.22268062696093693 sec
Decode latency: 6.992700026021339 sec
Prefill latency: 0.22074202296789736 sec
Decode latency: 7.012967700022273 sec
Prefill latency: 0.2195829710108228 sec
Decode latency: 7.000014221004676 sec
Prefill latency: 0.2198869590065442 sec
Decode latency: 6.999885007040575 sec
Prefill latency: 0.21868066099705175 sec
Decode latency: 6.997587129997555 sec
Time for inference 1: 7.22 sec total, 141.88 tokens/sec
Decode latency: 7.00 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2726.46 GB/s
FLOPS achieved: 13.63 TF/s

Prefill latency: 0.21808786899782717 sec
Decode latency: 6.9903343340265565 sec
Time for inference 2: 7.21 sec total, 142.03 tokens/sec
Decode latency: 6.99 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2729.44 GB/s
FLOPS achieved: 13.65 TF/s

Prefill latency: 0.21938119101105258 sec
Decode latency: 7.001400039996952 sec
Time for inference 3: 7.22 sec total, 141.79 tokens/sec
Decode latency: 7.00 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2724.75 GB/s
FLOPS achieved: 13.62 TF/s

Prefill latency: 0.21967892698012292 sec
Decode latency: 6.999531526002102 sec
Time for inference 4: 7.22 sec total, 141.82 tokens/sec
Decode latency: 7.00 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2725.35 GB/s
FLOPS achieved: 13.63 TF/s

Prefill latency: 0.21842166199348867 sec
Decode latency: 7.003125065006316 sec
Time for inference 5: 7.22 sec total, 141.78 tokens/sec
Decode latency: 7.00 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2724.52 GB/s
FLOPS achieved: 13.62 TF/s

Prefill latency: 0.21919402398634702 sec
Decode latency: 7.007317240990233 sec
Time for inference 6: 7.23 sec total, 141.68 tokens/sec
Decode latency: 7.01 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2722.62 GB/s
FLOPS achieved: 13.61 TF/s

Prefill latency: 0.21898078004596755 sec
Decode latency: 6.992396212008316 sec
Time for inference 7: 7.21 sec total, 141.98 tokens/sec
Decode latency: 6.99 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2728.37 GB/s
FLOPS achieved: 13.64 TF/s

Prefill latency: 0.22030062298290431 sec
Decode latency: 7.009191371966153 sec
Time for inference 8: 7.23 sec total, 141.62 tokens/sec
Decode latency: 7.01 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2721.51 GB/s
FLOPS achieved: 13.61 TF/s

Prefill latency: 0.22000664798542857 sec
Decode latency: 7.01182640902698 sec
Time for inference 9: 7.23 sec total, 141.57 tokens/sec
Decode latency: 7.01 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2720.61 GB/s
FLOPS achieved: 13.60 TF/s

Prefill latency: 0.21833771700039506 sec
Decode latency: 6.994997772038914 sec
Time for inference 10: 7.21 sec total, 141.94 tokens/sec
Decode latency: 6.99 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2727.61 GB/s
FLOPS achieved: 13.64 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.0008 sec
Average prefill latency: 0.2191 sec
Average tokens/sec: 141.81
Memory used: 28.53 GB
Done. we are killing the process
