W0928 20:46:38.063000 22994565035840 torch/distributed/run.py:779] 
W0928 20:46:38.063000 22994565035840 torch/distributed/run.py:779] *****************************************
W0928 20:46:38.063000 22994565035840 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 20:46:38.063000 22994565035840 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.47 seconds
Prefill latency: 0.43038266099756584 sec
Decode latency: 7.911000570980832 sec
Compilation time: 8.42 seconds
Compilation time: 8.35 seconds
Compilation time: 8.35 secondsCompilation time: 8.36 secondsCompilation time: 8.38 seconds


Compilation time: 8.38 seconds
Compilation time: 8.34 seconds
Compilation time: 8.34 seconds
Prefill latency: 0.421162462036591 sec
Decode latency: 7.889296740991995 sec
Prefill latency: 0.4202104340074584 sec
Decode latency: 7.865979308029637 sec
Prefill latency: 0.4217290799715556 sec
Decode latency: 7.839497006032616 sec
Prefill latency: 0.42088011000305414 sec
Decode latency: 7.952085027005523 sec
Prefill latency: 0.4212191590340808 sec
Decode latency: 7.868339078966528 sec
Time for inference 1: 8.29 sec total, 247.03 tokens/sec
Decode latency: 7.87 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4747.04 GB/s
FLOPS achieved: 23.74 TF/s

Prefill latency: 0.4199976680101827 sec
Decode latency: 7.87971703504445 sec
Time for inference 2: 8.30 sec total, 246.72 tokens/sec
Decode latency: 7.88 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4741.25 GB/s
FLOPS achieved: 23.71 TF/s

Prefill latency: 0.4211417240439914 sec
Decode latency: 7.877497929031961 sec
Time for inference 3: 8.30 sec total, 246.75 tokens/sec
Decode latency: 7.88 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4741.82 GB/s
FLOPS achieved: 23.71 TF/s

Prefill latency: 0.42097543802810833 sec
Decode latency: 7.8831228950293735 sec
Time for inference 4: 8.31 sec total, 246.60 tokens/sec
Decode latency: 7.88 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4738.76 GB/s
FLOPS achieved: 23.69 TF/s

Prefill latency: 0.4197158640017733 sec
Decode latency: 7.884242061001714 sec
Time for inference 5: 8.31 sec total, 246.60 tokens/sec
Decode latency: 7.88 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4738.81 GB/s
FLOPS achieved: 23.69 TF/s

Prefill latency: 0.4194355009822175 sec
Decode latency: 7.856163704011124 sec
Time for inference 6: 8.28 sec total, 247.44 tokens/sec
Decode latency: 7.86 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4755.04 GB/s
FLOPS achieved: 23.78 TF/s

Prefill latency: 0.4189813100383617 sec
Decode latency: 7.834057469968684 sec
Time for inference 7: 8.25 sec total, 248.12 tokens/sec
Decode latency: 7.83 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4768.07 GB/s
FLOPS achieved: 23.84 TF/s

Prefill latency: 0.419573933002539 sec
Decode latency: 7.894641137041617 sec
Time for inference 8: 8.32 sec total, 246.30 tokens/sec
Decode latency: 7.89 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4733.01 GB/s
FLOPS achieved: 23.67 TF/s

Prefill latency: 0.42182822502218187 sec
Decode latency: 7.865912382025272 sec
Time for inference 9: 8.29 sec total, 247.08 tokens/sec
Decode latency: 7.87 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4748.09 GB/s
FLOPS achieved: 23.74 TF/s

Prefill latency: 0.4203663030057214 sec
Decode latency: 7.85548127500806 sec
Time for inference 10: 8.28 sec total, 247.44 tokens/sec
Decode latency: 7.86 sec
Prefill latency: 0.42 sec
Bandwidth achieved: 4754.95 GB/s
FLOPS achieved: 23.77 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.8699 sec
Average prefill latency: 0.4203 sec
Average tokens/sec: 247.01
Memory used: 35.56 GB
Done. we are killing the process
