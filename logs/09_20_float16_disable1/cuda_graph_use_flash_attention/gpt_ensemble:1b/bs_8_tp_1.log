flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.09366393997333944 sec
Decode latency: 2.998690797947347 sec
Compilation time: 3.09 seconds
Prefill latency: 0.09336186200380325 sec
Decode latency: 2.9965452919714153 sec
Prefill latency: 0.09338150301482528 sec
Decode latency: 2.988567520980723 sec
Prefill latency: 0.09312924195546657 sec
Decode latency: 2.988958848058246 sec
Prefill latency: 0.0930529999313876 sec
Decode latency: 2.988473489996977 sec
Prefill latency: 0.09312522306572646 sec
Decode latency: 2.9882998398970813 sec
Time for inference 1: 3.08 sec total, 664.45 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.22 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09315532795153558 sec
Decode latency: 2.9884160539368168 sec
Time for inference 2: 3.08 sec total, 664.43 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.16 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.0930971970083192 sec
Decode latency: 2.9883396880468354 sec
Time for inference 3: 3.08 sec total, 664.47 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.24 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09306610899511725 sec
Decode latency: 2.9886386699508876 sec
Time for inference 4: 3.08 sec total, 664.41 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.12 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09304624795913696 sec
Decode latency: 2.9877097910502926 sec
Time for inference 5: 3.08 sec total, 664.60 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.54 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09304614190477878 sec
Decode latency: 2.9888198469998315 sec
Time for inference 6: 3.08 sec total, 664.36 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.02 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.0931352989282459 sec
Decode latency: 2.9881716649979353 sec
Time for inference 7: 3.08 sec total, 664.45 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.20 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09316490194760263 sec
Decode latency: 2.987796496017836 sec
Time for inference 8: 3.08 sec total, 664.53 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.38 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09309740702155977 sec
Decode latency: 2.9880958249559626 sec
Time for inference 9: 3.08 sec total, 664.50 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.32 GB/s
FLOPS achieved: 7.19 TF/s

Prefill latency: 0.09324092208407819 sec
Decode latency: 2.9876009300351143 sec
Time for inference 10: 3.08 sec total, 664.58 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1438.49 GB/s
FLOPS achieved: 7.19 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9882 sec
Average prefill latency: 0.0931 sec
Average tokens/sec: 664.48
Memory used: 5.88 GB
Done. we are killing the process
