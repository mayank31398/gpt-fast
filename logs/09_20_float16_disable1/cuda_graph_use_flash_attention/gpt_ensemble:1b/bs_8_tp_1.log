flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.10624430200550705 sec
Decode latency: 2.7233936269767582 sec
Compilation time: 2.83 seconds
Prefill latency: 0.10620390495751053 sec
Decode latency: 2.7231626490829512 sec
Prefill latency: 0.10619710595346987 sec
Decode latency: 2.7077947159996256 sec
Prefill latency: 0.1062077849637717 sec
Decode latency: 2.723430608981289 sec
Prefill latency: 0.10613971692509949 sec
Decode latency: 2.7235205239849165 sec
Prefill latency: 0.10622109507676214 sec
Decode latency: 2.7229128860635683 sec
Time for inference 1: 2.83 sec total, 723.69 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1748.57 GB/s
FLOPS achieved: 8.74 TF/s

Prefill latency: 0.10626577702350914 sec
Decode latency: 2.7161053370218724 sec
Time for inference 2: 2.82 sec total, 725.45 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.80 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10591005301102996 sec
Decode latency: 2.715750791016035 sec
Time for inference 3: 2.82 sec total, 725.64 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.26 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10598452703561634 sec
Decode latency: 2.716205656994134 sec
Time for inference 4: 2.82 sec total, 725.49 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.91 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.1058718680869788 sec
Decode latency: 2.715861171949655 sec
Time for inference 5: 2.82 sec total, 725.62 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.22 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10598454507999122 sec
Decode latency: 2.716406910913065 sec
Time for inference 6: 2.82 sec total, 725.45 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.81 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10586315090768039 sec
Decode latency: 2.7163655000040308 sec
Time for inference 7: 2.82 sec total, 725.45 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.82 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10606351296883076 sec
Decode latency: 2.7162496900418773 sec
Time for inference 8: 2.82 sec total, 725.44 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.79 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10600172204431146 sec
Decode latency: 2.715651132981293 sec
Time for inference 9: 2.82 sec total, 725.61 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.19 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10602014104370028 sec
Decode latency: 2.716293560923077 sec
Time for inference 10: 2.82 sec total, 725.45 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.80 GB/s
FLOPS achieved: 8.76 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7168 sec
Average prefill latency: 0.1060 sec
Average tokens/sec: 725.33
Memory used: 6.83 GB
Done. we are killing the process
