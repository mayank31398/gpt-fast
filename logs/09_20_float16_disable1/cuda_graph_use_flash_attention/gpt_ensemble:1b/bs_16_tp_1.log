flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.20621840294916183 sec
Decode latency: 3.1857722599525005 sec
Compilation time: 3.39 seconds
Prefill latency: 0.2059630419826135 sec
Decode latency: 3.311513095977716 sec
Prefill latency: 0.20600517001003027 sec
Decode latency: 3.3264140819665045 sec
Prefill latency: 0.20595950598362833 sec
Decode latency: 3.332787743071094 sec
Prefill latency: 0.2060251240618527 sec
Decode latency: 3.23607634997461 sec
Prefill latency: 0.20593900501262397 sec
Decode latency: 3.1933579300530255 sec
Time for inference 1: 3.40 sec total, 1204.72 tokens/sec
Decode latency: 3.19 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2910.80 GB/s
FLOPS achieved: 14.55 TF/s

Prefill latency: 0.20590940793044865 sec
Decode latency: 3.261689258972183 sec
Time for inference 2: 3.47 sec total, 1181.02 tokens/sec
Decode latency: 3.26 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2853.53 GB/s
FLOPS achieved: 14.27 TF/s

Prefill latency: 0.20595344610046595 sec
Decode latency: 3.33405084698461 sec
Time for inference 3: 3.54 sec total, 1156.77 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2794.95 GB/s
FLOPS achieved: 13.97 TF/s

Prefill latency: 0.20603267394471914 sec
Decode latency: 3.248865796951577 sec
Time for inference 4: 3.46 sec total, 1185.25 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2863.77 GB/s
FLOPS achieved: 14.32 TF/s

Prefill latency: 0.20606648491229862 sec
Decode latency: 3.334100231062621 sec
Time for inference 5: 3.54 sec total, 1156.73 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2794.84 GB/s
FLOPS achieved: 13.97 TF/s

Prefill latency: 0.2060343660414219 sec
Decode latency: 3.2726728060515597 sec
Time for inference 6: 3.48 sec total, 1177.19 tokens/sec
Decode latency: 3.27 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2844.29 GB/s
FLOPS achieved: 14.22 TF/s

Prefill latency: 0.20595981692895293 sec
Decode latency: 3.2307716259965673 sec
Time for inference 7: 3.44 sec total, 1191.58 tokens/sec
Decode latency: 3.23 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2879.05 GB/s
FLOPS achieved: 14.40 TF/s

Prefill latency: 0.206026496947743 sec
Decode latency: 3.3348504580790177 sec
Time for inference 8: 3.54 sec total, 1156.55 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2794.41 GB/s
FLOPS achieved: 13.97 TF/s

Prefill latency: 0.206011657952331 sec
Decode latency: 3.3335612369701266 sec
Time for inference 9: 3.54 sec total, 1156.99 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2795.49 GB/s
FLOPS achieved: 13.98 TF/s

Prefill latency: 0.20593575900420547 sec
Decode latency: 3.3342283579986542 sec
Time for inference 10: 3.54 sec total, 1156.79 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2794.99 GB/s
FLOPS achieved: 13.97 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.2878 sec
Average prefill latency: 0.2060 sec
Average tokens/sec: 1172.36
Memory used: 10.79 GB
Done. we are killing the process
