W1001 04:11:25.483000 23310195083072 torch/distributed/run.py:779] 
W1001 04:11:25.483000 23310195083072 torch/distributed/run.py:779] *****************************************
W1001 04:11:25.483000 23310195083072 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:11:25.483000 23310195083072 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.17 seconds
Prefill latency: 0.014200677047483623 sec
Compilation time: 1.68 seconds
Compilation time: 1.84 seconds
Compilation time: 1.75 seconds
Compilation time: 1.81 seconds
Compilation time: 1.84 seconds
Decode latency: 1.812479565036483 sec
Compilation time: 1.83 seconds
Compilation time: 1.83 seconds
Prefill latency: 0.014060355955734849 sec
Compilation time: 1.74 seconds
Decode latency: 1.8129927839618176 sec
Prefill latency: 0.014050803030841053 sec
Decode latency: 1.812427656026557 sec
Prefill latency: 0.0140721439383924 sec
Decode latency: 1.8131436429684982 sec
Prefill latency: 0.014077901025302708 sec
Decode latency: 1.812218435923569 sec
Prefill latency: 0.014071198995225132 sec
Decode latency: 1.8118087280308828 sec
Time for inference 1: 1.83 sec total, 560.62 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.51 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.014055458013899624 sec
Decode latency: 1.8127984049497172 sec
Time for inference 2: 1.83 sec total, 560.33 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.38 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.01405105902813375 sec
Decode latency: 1.6700350880855694 sec
Time for inference 3: 1.68 sec total, 607.81 tokens/sec
Decode latency: 1.67 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 264.01 GB/s
FLOPS achieved: 1.32 TF/s

Prefill latency: 0.014056486077606678 sec
Decode latency: 1.8125718460651115 sec
Time for inference 4: 1.83 sec total, 560.37 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.40 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.014050839003175497 sec
Decode latency: 1.8127497419482097 sec
Time for inference 5: 1.83 sec total, 560.34 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.39 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.01407923805527389 sec
Decode latency: 1.810997347929515 sec
Time for inference 6: 1.83 sec total, 560.88 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.62 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.014056163956411183 sec
Decode latency: 1.6707120600622147 sec
Time for inference 7: 1.69 sec total, 607.57 tokens/sec
Decode latency: 1.67 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 263.91 GB/s
FLOPS achieved: 1.32 TF/s

Prefill latency: 0.014042648952454329 sec
Decode latency: 1.812979946960695 sec
Time for inference 8: 1.83 sec total, 560.29 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.37 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.014057548018172383 sec
Decode latency: 1.8130820990772918 sec
Time for inference 9: 1.83 sec total, 560.25 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.35 GB/s
FLOPS achieved: 1.22 TF/s

Prefill latency: 0.014061020920053124 sec
Decode latency: 1.8131102790357545 sec
Time for inference 10: 1.83 sec total, 560.23 tokens/sec
Decode latency: 1.81 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 243.34 GB/s
FLOPS achieved: 1.22 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.7841 sec
Average prefill latency: 0.0141 sec
Average tokens/sec: 569.87
Memory used: 1.40 GB
Done. we are killing the process
