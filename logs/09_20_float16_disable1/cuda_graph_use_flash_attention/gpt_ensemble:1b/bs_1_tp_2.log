W0930 21:04:13.303000 23002652243776 torch/distributed/run.py:779] 
W0930 21:04:13.303000 23002652243776 torch/distributed/run.py:779] *****************************************
W0930 21:04:13.303000 23002652243776 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 21:04:13.303000 23002652243776 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1280, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.028547210968099535 sec
Decode latency: 1.9424924690974876 sec
Compilation time: 1.97 seconds
Compilation time: 1.97 seconds
Prefill latency: 0.02201163105200976 sec
Decode latency: 1.9409985709935427 sec
Prefill latency: 0.02185704605653882 sec
Decode latency: 1.9414610660169274 sec
Prefill latency: 0.02182305697351694 sec
Decode latency: 1.9426013879710808 sec
Prefill latency: 0.021773393964394927 sec
Decode latency: 1.9412521179765463 sec
Prefill latency: 0.021872916957363486 sec
Decode latency: 1.942605415941216 sec
Time for inference 1: 1.97 sec total, 130.27 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.83 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.02196096710395068 sec
Decode latency: 1.941641186014749 sec
Time for inference 2: 1.96 sec total, 130.32 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.90 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.021811974933370948 sec
Decode latency: 1.9408896440872923 sec
Time for inference 3: 1.96 sec total, 130.38 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.96 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.021957316086627543 sec
Decode latency: 1.9425261579453945 sec
Time for inference 4: 1.97 sec total, 130.26 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.82 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.02182565303519368 sec
Decode latency: 1.942654607933946 sec
Time for inference 5: 1.97 sec total, 130.27 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.83 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.0218163839308545 sec
Decode latency: 1.9429463829146698 sec
Time for inference 6: 1.97 sec total, 130.25 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.82 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.021828808938153088 sec
Decode latency: 1.9406772770453244 sec
Time for inference 7: 1.96 sec total, 130.40 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.99 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.021851449040696025 sec
Decode latency: 1.9407184430165216 sec
Time for inference 8: 1.96 sec total, 130.40 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.99 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.02187283698003739 sec
Decode latency: 1.9426248050294816 sec
Time for inference 9: 1.97 sec total, 130.26 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.82 GB/s
FLOPS achieved: 0.75 TF/s

Prefill latency: 0.021920269005931914 sec
Decode latency: 1.9424825010355562 sec
Time for inference 10: 1.97 sec total, 130.26 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 150.82 GB/s
FLOPS achieved: 0.75 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9420 sec
Average prefill latency: 0.0219 sec
Average tokens/sec: 130.31
Memory used: 1.85 GB
Done. we are killing the process
