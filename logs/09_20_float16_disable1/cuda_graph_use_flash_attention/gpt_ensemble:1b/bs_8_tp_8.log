W1001 04:14:27.780000 22487219529536 torch/distributed/run.py:779] 
W1001 04:14:27.780000 22487219529536 torch/distributed/run.py:779] *****************************************
W1001 04:14:27.780000 22487219529536 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:14:27.780000 22487219529536 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.02180209697689861 sec
Compilation time: 1.90 seconds
Compilation time: 1.93 seconds
Compilation time: 1.90 seconds
Compilation time: 1.90 seconds
Compilation time: 1.90 seconds
Compilation time: 1.88 seconds
Compilation time: 1.90 seconds
Decode latency: 1.8809353969991207 sec
Compilation time: 1.90 seconds
Prefill latency: 0.02159393997862935 sec
Decode latency: 1.8816082269186154 sec
Prefill latency: 0.021581679000519216 sec
Decode latency: 1.8801131340442225 sec
Prefill latency: 0.02158278599381447 sec
Decode latency: 1.881619453895837 sec
Prefill latency: 0.021600887062959373 sec
Decode latency: 1.8806405060458928 sec
Prefill latency: 0.021594546968117356 sec
Decode latency: 1.8811458660056815 sec
Time for inference 1: 1.90 sec total, 1075.99 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.37 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021603281027637422 sec
Decode latency: 1.8808055419940501 sec
Time for inference 2: 1.90 sec total, 1076.13 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.43 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.02160049695521593 sec
Decode latency: 1.8808353249914944 sec
Time for inference 3: 1.90 sec total, 1076.10 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.41 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021594903897494078 sec
Decode latency: 1.8809209460159764 sec
Time for inference 4: 1.90 sec total, 1076.06 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.40 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.02158116491045803 sec
Decode latency: 1.8809037549654022 sec
Time for inference 5: 1.90 sec total, 1076.13 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.43 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021585670998319983 sec
Decode latency: 1.8809046529931948 sec
Time for inference 6: 1.90 sec total, 1076.12 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.42 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021579763968475163 sec
Decode latency: 1.8814025010215119 sec
Time for inference 7: 1.90 sec total, 1075.86 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.31 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021588845062069595 sec
Decode latency: 1.880539316101931 sec
Time for inference 8: 1.90 sec total, 1076.33 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.51 GB/s
FLOPS achieved: 2.34 TF/s

Prefill latency: 0.021598628954961896 sec
Decode latency: 1.8550527340266854 sec
Time for inference 9: 1.88 sec total, 1090.94 tokens/sec
Decode latency: 1.86 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 473.86 GB/s
FLOPS achieved: 2.37 TF/s

Prefill latency: 0.021594245918095112 sec
Decode latency: 1.8803410599939525 sec
Time for inference 10: 1.90 sec total, 1076.44 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 467.56 GB/s
FLOPS achieved: 2.34 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8783 sec
Average prefill latency: 0.0216 sec
Average tokens/sec: 1077.61
Memory used: 2.04 GB
Done. we are killing the process
