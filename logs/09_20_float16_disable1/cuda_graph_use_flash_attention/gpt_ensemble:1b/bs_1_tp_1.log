flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.016531283035874367 sec
Decode latency: 2.06683930195868 sec
Compilation time: 2.08 seconds
Prefill latency: 0.016058534034527838 sec
Decode latency: 2.0649571580579504 sec
Prefill latency: 0.016103769070468843 sec
Decode latency: 2.064883457031101 sec
Prefill latency: 0.016069299075752497 sec
Decode latency: 2.0617053129244596 sec
Prefill latency: 0.016045602969825268 sec
Decode latency: 2.062035175971687 sec
Prefill latency: 0.01600905496161431 sec
Decode latency: 2.062368766986765 sec
Time for inference 1: 2.08 sec total, 123.13 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.52 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016050825943239033 sec
Decode latency: 1.9905260020168498 sec
Time for inference 2: 2.01 sec total, 127.54 tokens/sec
Decode latency: 1.99 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 276.05 GB/s
FLOPS achieved: 1.38 TF/s

Prefill latency: 0.016054795938543975 sec
Decode latency: 2.062141528003849 sec
Time for inference 3: 2.08 sec total, 123.14 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.55 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016025569988414645 sec
Decode latency: 2.0052661680383608 sec
Time for inference 4: 2.02 sec total, 126.61 tokens/sec
Decode latency: 2.01 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 274.05 GB/s
FLOPS achieved: 1.37 TF/s

Prefill latency: 0.016022525960579515 sec
Decode latency: 2.061631369055249 sec
Time for inference 5: 2.08 sec total, 123.18 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.62 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01607187802437693 sec
Decode latency: 2.061987933004275 sec
Time for inference 6: 2.08 sec total, 123.15 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.57 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01602307299617678 sec
Decode latency: 2.062014110968448 sec
Time for inference 7: 2.08 sec total, 123.15 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.57 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016058343928307295 sec
Decode latency: 2.061552469036542 sec
Time for inference 8: 2.08 sec total, 123.18 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.62 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016081808018498123 sec
Decode latency: 2.06208806601353 sec
Time for inference 9: 2.08 sec total, 123.15 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.55 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016017955960705876 sec
Decode latency: 2.061631447984837 sec
Time for inference 10: 2.08 sec total, 123.18 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.62 GB/s
FLOPS achieved: 1.33 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0491 sec
Average prefill latency: 0.0160 sec
Average tokens/sec: 123.94
Memory used: 2.89 GB
Done. we are killing the process
