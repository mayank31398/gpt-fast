flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.017004668014124036 sec
Decode latency: 2.053212749073282 sec
Compilation time: 2.07 seconds
Prefill latency: 0.016764958971180022 sec
Decode latency: 2.0066006690030918 sec
Prefill latency: 0.01677904895041138 sec
Decode latency: 1.913604388013482 sec
Prefill latency: 0.016787331085652113 sec
Decode latency: 2.0543722140137106 sec
Prefill latency: 0.01675528089981526 sec
Decode latency: 2.0534333010436967 sec
Prefill latency: 0.016804443090222776 sec
Decode latency: 2.0550259650917724 sec
Time for inference 1: 2.07 sec total, 123.52 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 298.46 GB/s
FLOPS achieved: 1.49 TF/s

Prefill latency: 0.016793765011243522 sec
Decode latency: 2.034578691003844 sec
Time for inference 2: 2.05 sec total, 124.76 tokens/sec
Decode latency: 2.03 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 301.44 GB/s
FLOPS achieved: 1.51 TF/s

Prefill latency: 0.016760024009272456 sec
Decode latency: 2.0560743720270693 sec
Time for inference 3: 2.07 sec total, 123.47 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 298.32 GB/s
FLOPS achieved: 1.49 TF/s

Prefill latency: 0.016774183022789657 sec
Decode latency: 2.0553926130523905 sec
Time for inference 4: 2.07 sec total, 123.51 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 298.42 GB/s
FLOPS achieved: 1.49 TF/s

Prefill latency: 0.016768019064329565 sec
Decode latency: 2.0555637810612097 sec
Time for inference 5: 2.07 sec total, 123.50 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 298.39 GB/s
FLOPS achieved: 1.49 TF/s

Prefill latency: 0.016760663012973964 sec
Decode latency: 2.049345157924108 sec
Time for inference 6: 2.07 sec total, 123.87 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 299.29 GB/s
FLOPS achieved: 1.50 TF/s

Prefill latency: 0.01679269806481898 sec
Decode latency: 2.05486304895021 sec
Time for inference 7: 2.07 sec total, 123.54 tokens/sec
Decode latency: 2.05 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 298.49 GB/s
FLOPS achieved: 1.49 TF/s

Prefill latency: 0.016787158092483878 sec
Decode latency: 1.93246015207842 sec
Time for inference 8: 1.95 sec total, 131.29 tokens/sec
Decode latency: 1.93 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.22 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.016788893030025065 sec
Decode latency: 1.9108415739610791 sec
Time for inference 9: 1.93 sec total, 132.76 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 320.78 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.016768755041994154 sec
Decode latency: 2.006267854012549 sec
Time for inference 10: 2.02 sec total, 126.50 tokens/sec
Decode latency: 2.01 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 305.64 GB/s
FLOPS achieved: 1.53 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0210 sec
Average prefill latency: 0.0168 sec
Average tokens/sec: 125.67
Memory used: 3.36 GB
Done. we are killing the process
