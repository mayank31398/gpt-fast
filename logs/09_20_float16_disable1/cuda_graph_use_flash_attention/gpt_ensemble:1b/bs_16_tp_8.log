W1001 04:17:51.756000 23062570186560 torch/distributed/run.py:779] 
W1001 04:17:51.756000 23062570186560 torch/distributed/run.py:779] *****************************************
W1001 04:17:51.756000 23062570186560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:17:51.756000 23062570186560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.18 seconds
Prefill latency: 0.03993296099361032 sec
Compilation time: 2.04 seconds
Compilation time: 2.05 seconds
Compilation time: 1.91 seconds
Compilation time: 1.98 seconds
Compilation time: 2.04 seconds
Compilation time: 2.05 seconds
Compilation time: 2.03 seconds
Decode latency: 1.9978985409252346 sec
Compilation time: 2.04 seconds
Prefill latency: 0.03969037800561637 sec
Decode latency: 1.9990681289928034 sec
Prefill latency: 0.039683306007646024 sec
Decode latency: 1.99927715503145 sec
Prefill latency: 0.03969623800367117 sec
Decode latency: 1.9990307239349931 sec
Prefill latency: 0.03963051992468536 sec
Decode latency: 1.9010567710502073 sec
Prefill latency: 0.039683878887444735 sec
Decode latency: 1.9970732630463317 sec
Time for inference 1: 2.04 sec total, 2010.42 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 873.24 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.039780211984179914 sec
Decode latency: 1.99792381899897 sec
Time for inference 2: 2.04 sec total, 2009.48 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.83 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.03968810592778027 sec
Decode latency: 1.9983612659852952 sec
Time for inference 3: 2.04 sec total, 2009.08 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.66 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.0396744329482317 sec
Decode latency: 1.9981560169253498 sec
Time for inference 4: 2.04 sec total, 2009.36 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.79 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.039716975996270776 sec
Decode latency: 1.9776394080836326 sec
Time for inference 5: 2.02 sec total, 2029.71 tokens/sec
Decode latency: 1.98 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 881.62 GB/s
FLOPS achieved: 4.41 TF/s

Prefill latency: 0.039674651925452054 sec
Decode latency: 1.8830701459664851 sec
Time for inference 6: 1.92 sec total, 2129.53 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 924.98 GB/s
FLOPS achieved: 4.62 TF/s

Prefill latency: 0.039726046030409634 sec
Decode latency: 1.998351532034576 sec
Time for inference 7: 2.04 sec total, 2009.09 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.67 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.03965501091443002 sec
Decode latency: 1.999040710972622 sec
Time for inference 8: 2.04 sec total, 2008.50 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.41 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.039749791962094605 sec
Decode latency: 1.998281252104789 sec
Time for inference 9: 2.04 sec total, 2009.19 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.71 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.03963317908346653 sec
Decode latency: 1.996744479984045 sec
Time for inference 10: 2.04 sec total, 2010.81 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 873.41 GB/s
FLOPS achieved: 4.37 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9845 sec
Average prefill latency: 0.0397 sec
Average tokens/sec: 2023.52
Memory used: 3.51 GB
Done. we are killing the process
