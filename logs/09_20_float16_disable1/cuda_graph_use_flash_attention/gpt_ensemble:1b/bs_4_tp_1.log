flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.05435850296635181 sec
Decode latency: 2.3958679269999266 sec
Compilation time: 2.45 seconds
Prefill latency: 0.054139615036547184 sec
Decode latency: 2.3442231089575216 sec
Prefill latency: 0.05417147697880864 sec
Decode latency: 2.253123360918835 sec
Prefill latency: 0.054168895934708416 sec
Decode latency: 2.3553396590286866 sec
Prefill latency: 0.05409338790923357 sec
Decode latency: 2.397557424963452 sec
Prefill latency: 0.05412605602759868 sec
Decode latency: 2.3737045460147783 sec
Time for inference 1: 2.43 sec total, 421.64 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1018.76 GB/s
FLOPS achieved: 5.09 TF/s

Prefill latency: 0.05408334196545184 sec
Decode latency: 2.317357806954533 sec
Time for inference 2: 2.37 sec total, 431.68 tokens/sec
Decode latency: 2.32 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1043.02 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.054100178997032344 sec
Decode latency: 2.363288872060366 sec
Time for inference 3: 2.42 sec total, 423.48 tokens/sec
Decode latency: 2.36 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1023.21 GB/s
FLOPS achieved: 5.12 TF/s

Prefill latency: 0.05415824695955962 sec
Decode latency: 2.3963329850230366 sec
Time for inference 4: 2.45 sec total, 417.77 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.39 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05416077608242631 sec
Decode latency: 2.3968094459269196 sec
Time for inference 5: 2.45 sec total, 417.64 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.10 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05411077290773392 sec
Decode latency: 2.39759431197308 sec
Time for inference 6: 2.45 sec total, 417.52 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1008.81 GB/s
FLOPS achieved: 5.04 TF/s

Prefill latency: 0.05418769596144557 sec
Decode latency: 2.327890544082038 sec
Time for inference 7: 2.38 sec total, 429.75 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1038.34 GB/s
FLOPS achieved: 5.19 TF/s

Prefill latency: 0.054183049011044204 sec
Decode latency: 2.3882351780775934 sec
Time for inference 8: 2.44 sec total, 419.13 tokens/sec
Decode latency: 2.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1012.70 GB/s
FLOPS achieved: 5.06 TF/s

Prefill latency: 0.054109059972688556 sec
Decode latency: 2.2994083049707115 sec
Time for inference 9: 2.35 sec total, 434.97 tokens/sec
Decode latency: 2.30 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1050.95 GB/s
FLOPS achieved: 5.25 TF/s

Prefill latency: 0.05408375500701368 sec
Decode latency: 2.287064658012241 sec
Time for inference 10: 2.34 sec total, 437.26 tokens/sec
Decode latency: 2.29 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1056.48 GB/s
FLOPS achieved: 5.28 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3548 sec
Average prefill latency: 0.0541 sec
Average tokens/sec: 425.08
Memory used: 4.92 GB
Done. we are killing the process
