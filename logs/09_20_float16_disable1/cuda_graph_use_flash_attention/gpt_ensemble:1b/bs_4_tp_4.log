W1001 04:10:44.365000 22908394854208 torch/distributed/run.py:779] 
W1001 04:10:44.365000 22908394854208 torch/distributed/run.py:779] *****************************************
W1001 04:10:44.365000 22908394854208 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:10:44.365000 22908394854208 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.018568456987850368 sec
Compilation time: 1.92 seconds
Compilation time: 1.85 seconds
Compilation time: 1.93 seconds
Decode latency: 1.9109850790118799 sec
Compilation time: 1.93 seconds
Prefill latency: 0.018307849997654557 sec
Decode latency: 1.9109563429374248 sec
Prefill latency: 0.018301245057955384 sec
Decode latency: 1.9118891030084342 sec
Prefill latency: 0.018280485062859952 sec
Decode latency: 1.9115387530764565 sec
Prefill latency: 0.018313498003408313 sec
Decode latency: 1.9115997808985412 sec
Prefill latency: 0.01828175992704928 sec
Decode latency: 1.911160045885481 sec
Time for inference 1: 1.93 sec total, 530.55 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.66 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.01827163004782051 sec
Decode latency: 1.911235411069356 sec
Time for inference 2: 1.93 sec total, 530.54 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.65 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018306071986444294 sec
Decode latency: 1.9108434250811115 sec
Time for inference 3: 1.93 sec total, 530.64 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.72 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018271080101840198 sec
Decode latency: 1.8780684710945934 sec
Time for inference 4: 1.90 sec total, 539.82 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 387.31 GB/s
FLOPS achieved: 1.94 TF/s

Prefill latency: 0.01829920499585569 sec
Decode latency: 1.9110649430658668 sec
Time for inference 5: 1.93 sec total, 530.58 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.68 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.0183119080029428 sec
Decode latency: 1.9110491279279813 sec
Time for inference 6: 1.93 sec total, 530.58 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.68 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018278048024512827 sec
Decode latency: 1.9110621269792318 sec
Time for inference 7: 1.93 sec total, 530.59 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.68 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018304914003238082 sec
Decode latency: 1.911238198983483 sec
Time for inference 8: 1.93 sec total, 530.53 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.64 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018294924986548722 sec
Decode latency: 1.9111825060099363 sec
Time for inference 9: 1.93 sec total, 530.49 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.62 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018278418923728168 sec
Decode latency: 1.826138245058246 sec
Time for inference 10: 1.85 sec total, 554.96 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 398.17 GB/s
FLOPS achieved: 1.99 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8993 sec
Average prefill latency: 0.0183 sec
Average tokens/sec: 533.93
Memory used: 1.86 GB
Done. we are killing the process
