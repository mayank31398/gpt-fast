W1001 04:22:44.467000 22539716638528 torch/distributed/run.py:779] 
W1001 04:22:44.467000 22539716638528 torch/distributed/run.py:779] *****************************************
W1001 04:22:44.467000 22539716638528 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:22:44.467000 22539716638528 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.20 seconds
Prefill latency: 0.24040119198616594 sec
Compilation time: 3.45 seconds
Compilation time: 3.42 seconds
Compilation time: 3.33 seconds
Decode latency: 3.0911224429728463 sec
Compilation time: 3.33 seconds
Prefill latency: 0.24001402303110808 sec
Decode latency: 3.123560728970915 sec
Prefill latency: 0.240549148991704 sec
Decode latency: 3.1492826850153506 sec
Prefill latency: 0.24024827009998262 sec
Decode latency: 3.1850220690248534 sec
Prefill latency: 0.24059915798716247 sec
Decode latency: 3.085741661954671 sec
Prefill latency: 0.24008894595317543 sec
Decode latency: 3.1811977348988876 sec
Time for inference 1: 3.42 sec total, 4787.82 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3435.14 GB/s
FLOPS achieved: 17.18 TF/s

Prefill latency: 0.24063618504442275 sec
Decode latency: 3.183466312009841 sec
Time for inference 2: 3.42 sec total, 4783.93 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3432.35 GB/s
FLOPS achieved: 17.16 TF/s

Prefill latency: 0.2410277919843793 sec
Decode latency: 3.1198787349276245 sec
Time for inference 3: 3.36 sec total, 4873.38 tokens/sec
Decode latency: 3.12 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3496.53 GB/s
FLOPS achieved: 17.48 TF/s

Prefill latency: 0.2401033240603283 sec
Decode latency: 3.1788276960141957 sec
Time for inference 4: 3.42 sec total, 4790.91 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3437.36 GB/s
FLOPS achieved: 17.19 TF/s

Prefill latency: 0.24203292990569025 sec
Decode latency: 3.1810975020052865 sec
Time for inference 5: 3.42 sec total, 4784.95 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3433.08 GB/s
FLOPS achieved: 17.17 TF/s

Prefill latency: 0.24078643892426044 sec
Decode latency: 3.071373009006493 sec
Time for inference 6: 3.31 sec total, 4945.40 tokens/sec
Decode latency: 3.07 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3548.20 GB/s
FLOPS achieved: 17.74 TF/s

Prefill latency: 0.24082208902109414 sec
Decode latency: 3.1852971729822457 sec
Time for inference 7: 3.43 sec total, 4780.97 tokens/sec
Decode latency: 3.19 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3430.22 GB/s
FLOPS achieved: 17.15 TF/s

Prefill latency: 0.24054241797421128 sec
Decode latency: 3.1798978680744767 sec
Time for inference 8: 3.42 sec total, 4788.96 tokens/sec
Decode latency: 3.18 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3435.96 GB/s
FLOPS achieved: 17.18 TF/s

Prefill latency: 0.24073311500251293 sec
Decode latency: 3.149781376007013 sec
Time for inference 9: 3.39 sec total, 4831.17 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3466.24 GB/s
FLOPS achieved: 17.33 TF/s

Prefill latency: 0.24016460205893964 sec
Decode latency: 3.050586199038662 sec
Time for inference 10: 3.29 sec total, 4977.68 tokens/sec
Decode latency: 3.05 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 3571.36 GB/s
FLOPS achieved: 17.86 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1481 sec
Average prefill latency: 0.2407 sec
Average tokens/sec: 4834.52
Memory used: 14.49 GB
Done. we are killing the process
