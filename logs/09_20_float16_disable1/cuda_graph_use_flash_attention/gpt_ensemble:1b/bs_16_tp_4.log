W1001 04:17:05.429000 22792337749824 torch/distributed/run.py:779] 
W1001 04:17:05.429000 22792337749824 torch/distributed/run.py:779] *****************************************
W1001 04:17:05.429000 22792337749824 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 04:17:05.429000 22792337749824 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.0633741810452193 sec
Compilation time: 2.31 seconds
Decode latency: 2.2399250310845673 sec
Compilation time: 2.30 seconds
Prefill latency: 0.06311289896257222 sec
Compilation time: 2.32 seconds
Compilation time: 2.31 seconds
Decode latency: 2.2399059099843726 sec
Prefill latency: 0.06307160702999681 sec
Decode latency: 2.240039210068062 sec
Prefill latency: 0.06311896094121039 sec
Decode latency: 2.2410260379547253 sec
Prefill latency: 0.06313914898782969 sec
Decode latency: 2.239867613068782 sec
Prefill latency: 0.06305011105723679 sec
Decode latency: 2.2398316899780184 sec
Time for inference 1: 2.30 sec total, 1778.15 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.78 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06311951007228345 sec
Decode latency: 2.240062493016012 sec
Time for inference 2: 2.30 sec total, 1777.92 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.61 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06305899901781231 sec
Decode latency: 2.2398682719795033 sec
Time for inference 3: 2.30 sec total, 1778.13 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.76 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06314825499430299 sec
Decode latency: 2.2399502439657226 sec
Time for inference 4: 2.30 sec total, 1777.99 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.66 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.063061797991395 sec
Decode latency: 2.239872869919054 sec
Time for inference 5: 2.30 sec total, 1778.12 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.76 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06307066394947469 sec
Decode latency: 2.239807876991108 sec
Time for inference 6: 2.30 sec total, 1778.16 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.79 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06307506002485752 sec
Decode latency: 2.2398856540676206 sec
Time for inference 7: 2.30 sec total, 1778.09 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.74 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06309999991208315 sec
Decode latency: 2.239932873984799 sec
Time for inference 8: 2.30 sec total, 1778.02 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.68 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.0631168419495225 sec
Decode latency: 2.241061076056212 sec
Time for inference 9: 2.30 sec total, 1777.15 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.06 GB/s
FLOPS achieved: 6.38 TF/s

Prefill latency: 0.06306020705960691 sec
Decode latency: 2.2395901950076222 sec
Time for inference 10: 2.30 sec total, 1778.32 tokens/sec
Decode latency: 2.24 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1275.90 GB/s
FLOPS achieved: 6.38 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2400 sec
Average prefill latency: 0.0631 sec
Average tokens/sec: 1778.00
Memory used: 4.46 GB
Done. we are killing the process
