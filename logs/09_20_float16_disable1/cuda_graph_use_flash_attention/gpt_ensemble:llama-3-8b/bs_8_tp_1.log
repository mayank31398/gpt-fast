flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.79 seconds
Prefill latency: 0.29936495795845985 sec
Decode latency: 4.462314296513796 sec
Compilation time: 4.76 seconds
Prefill latency: 0.3009343221783638 sec
Decode latency: 4.523039414547384 sec
Prefill latency: 0.30244277976453304 sec
Decode latency: 4.5423201359808445 sec
Prefill latency: 0.3018086738884449 sec
Decode latency: 4.54142496548593 sec
Prefill latency: 0.3020648816600442 sec
Decode latency: 4.488781288266182 sec
Prefill latency: 0.3010690053924918 sec
Decode latency: 4.543819478712976 sec
Time for inference 1: 4.85 sec total, 422.64 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6343.81 GB/s
FLOPS achieved: 31.72 TF/s

Prefill latency: 0.3018015371635556 sec
Decode latency: 4.542332052253187 sec
Time for inference 2: 4.85 sec total, 422.70 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6344.66 GB/s
FLOPS achieved: 31.72 TF/s

Prefill latency: 0.3018835885450244 sec
Decode latency: 4.5418412974104285 sec
Time for inference 3: 4.84 sec total, 422.74 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6345.26 GB/s
FLOPS achieved: 31.73 TF/s

Prefill latency: 0.30185157153755426 sec
Decode latency: 4.529876668937504 sec
Time for inference 4: 4.83 sec total, 423.79 tokens/sec
Decode latency: 4.53 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6361.05 GB/s
FLOPS achieved: 31.81 TF/s

Prefill latency: 0.3019288703799248 sec
Decode latency: 4.540945757180452 sec
Time for inference 5: 4.84 sec total, 422.82 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6346.45 GB/s
FLOPS achieved: 31.73 TF/s

Prefill latency: 0.3017260320484638 sec
Decode latency: 4.480790121480823 sec
Time for inference 6: 4.78 sec total, 428.15 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6426.48 GB/s
FLOPS achieved: 32.13 TF/s

Prefill latency: 0.301189411431551 sec
Decode latency: 4.543382716365159 sec
Time for inference 7: 4.85 sec total, 422.67 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6344.23 GB/s
FLOPS achieved: 31.72 TF/s

Prefill latency: 0.30061573069542646 sec
Decode latency: 4.540990272536874 sec
Time for inference 8: 4.84 sec total, 422.92 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6348.01 GB/s
FLOPS achieved: 31.74 TF/s

Prefill latency: 0.3024517921730876 sec
Decode latency: 4.5415702713653445 sec
Time for inference 9: 4.84 sec total, 422.72 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6345.00 GB/s
FLOPS achieved: 31.73 TF/s

Prefill latency: 0.30160987935960293 sec
Decode latency: 4.541042315773666 sec
Time for inference 10: 4.84 sec total, 422.84 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6346.70 GB/s
FLOPS achieved: 31.73 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5347 sec
Average prefill latency: 0.3016 sec
Average tokens/sec: 423.40
Memory used: 23.41 GB
Done. we are killing the process
