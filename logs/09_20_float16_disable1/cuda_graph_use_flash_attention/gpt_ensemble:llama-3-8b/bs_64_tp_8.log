W1001 01:04:16.452000 23087164004160 torch/distributed/run.py:779] 
W1001 01:04:16.452000 23087164004160 torch/distributed/run.py:779] *****************************************
W1001 01:04:16.452000 23087164004160 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:04:16.452000 23087164004160 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.01 seconds
Prefill latency: 0.9785298071801662 sec
Decode latency: 4.52407961525023 sec
Compilation time: 5.50 seconds
Compilation time: 5.50 secondsCompilation time: 5.50 seconds

Compilation time: 5.50 seconds
Compilation time: 5.53 seconds
Compilation time: 5.50 seconds
Compilation time: 5.51 secondsCompilation time: 5.51 seconds

Prefill latency: 0.9668658720329404 sec
Decode latency: 4.508475098758936 sec
Prefill latency: 0.9702312890440226 sec
Decode latency: 4.502580634318292 sec
Prefill latency: 0.9731428492814302 sec
Decode latency: 4.537998158484697 sec
Prefill latency: 0.9709633216261864 sec
Decode latency: 4.5045826798304915 sec
Prefill latency: 0.973341628909111 sec
Decode latency: 4.522045072168112 sec
Time for inference 1: 5.50 sec total, 2980.91 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8334.72 GB/s
FLOPS achieved: 41.67 TF/s

Prefill latency: 0.9744469542056322 sec
Decode latency: 4.547623022459447 sec
Time for inference 2: 5.52 sec total, 2966.48 tokens/sec
Decode latency: 4.55 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8294.39 GB/s
FLOPS achieved: 41.47 TF/s

Prefill latency: 0.9708492448553443 sec
Decode latency: 4.520203717984259 sec
Time for inference 3: 5.49 sec total, 2983.26 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8341.30 GB/s
FLOPS achieved: 41.71 TF/s

Prefill latency: 0.9723890759050846 sec
Decode latency: 4.515048782341182 sec
Time for inference 4: 5.49 sec total, 2985.27 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8346.91 GB/s
FLOPS achieved: 41.73 TF/s

Prefill latency: 0.9727656682953238 sec
Decode latency: 4.517680803313851 sec
Time for inference 5: 5.49 sec total, 2983.61 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8342.28 GB/s
FLOPS achieved: 41.71 TF/s

Prefill latency: 0.9704917818307877 sec
Decode latency: 4.534240246750414 sec
Time for inference 6: 5.51 sec total, 2975.90 tokens/sec
Decode latency: 4.53 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8320.73 GB/s
FLOPS achieved: 41.60 TF/s

Prefill latency: 0.9716824125498533 sec
Decode latency: 4.505794512107968 sec
Time for inference 7: 5.48 sec total, 2990.61 tokens/sec
Decode latency: 4.51 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8361.85 GB/s
FLOPS achieved: 41.81 TF/s

Prefill latency: 0.96967988088727 sec
Decode latency: 4.540619523264468 sec
Time for inference 8: 5.51 sec total, 2972.75 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8311.90 GB/s
FLOPS achieved: 41.56 TF/s

Prefill latency: 0.971462027169764 sec
Decode latency: 4.509369551204145 sec
Time for inference 9: 5.48 sec total, 2988.82 tokens/sec
Decode latency: 4.51 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8356.84 GB/s
FLOPS achieved: 41.78 TF/s

Prefill latency: 0.9695841213688254 sec
Decode latency: 4.515796456485987 sec
Time for inference 10: 5.49 sec total, 2986.35 tokens/sec
Decode latency: 4.52 sec
Prefill latency: 0.97 sec
Bandwidth achieved: 8349.93 GB/s
FLOPS achieved: 41.75 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5228 sec
Average prefill latency: 0.9717 sec
Average tokens/sec: 2981.39
Memory used: 54.96 GB
Done. we are killing the process
