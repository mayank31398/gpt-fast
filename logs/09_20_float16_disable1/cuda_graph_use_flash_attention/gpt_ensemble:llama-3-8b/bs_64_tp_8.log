W0928 19:00:11.598000 23209804724032 torch/distributed/run.py:779] 
W0928 19:00:11.598000 23209804724032 torch/distributed/run.py:779] *****************************************
W0928 19:00:11.598000 23209804724032 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 19:00:11.598000 23209804724032 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.45796903129667044 sec
Decode latency: 3.7504736287519336 sec
Compilation time: 4.21 seconds
Compilation time: 4.21 seconds
Compilation time: 4.20 seconds
Compilation time: 4.22 seconds
Compilation time: 4.22 seconds
Compilation time: 4.22 seconds
Compilation time: 4.20 seconds
Compilation time: 4.21 seconds
Prefill latency: 0.45992590952664614 sec
Decode latency: 3.7453066324815154 sec
Prefill latency: 0.4599175052717328 sec
Decode latency: 3.747353231534362 sec
Prefill latency: 0.46064962819218636 sec
Decode latency: 3.748262193053961 sec
Prefill latency: 0.46113525331020355 sec
Decode latency: 3.7459766073152423 sec
Prefill latency: 0.4580995002761483 sec
Decode latency: 3.7511844001710415 sec
Time for inference 1: 4.21 sec total, 3891.48 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10880.71 GB/s
FLOPS achieved: 54.40 TF/s

Prefill latency: 0.45885612815618515 sec
Decode latency: 3.750207661651075 sec
Time for inference 2: 4.21 sec total, 3891.70 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10881.33 GB/s
FLOPS achieved: 54.41 TF/s

Prefill latency: 0.4606645032763481 sec
Decode latency: 3.7451732456684113 sec
Time for inference 3: 4.21 sec total, 3894.61 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10889.48 GB/s
FLOPS achieved: 54.45 TF/s

Prefill latency: 0.4593322407454252 sec
Decode latency: 3.748226714320481 sec
Time for inference 4: 4.21 sec total, 3893.12 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10885.30 GB/s
FLOPS achieved: 54.43 TF/s

Prefill latency: 0.4594242703169584 sec
Decode latency: 3.7475578607991338 sec
Time for inference 5: 4.21 sec total, 3893.44 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10886.21 GB/s
FLOPS achieved: 54.43 TF/s

Prefill latency: 0.4596496894955635 sec
Decode latency: 3.7504998985677958 sec
Time for inference 6: 4.21 sec total, 3890.64 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10878.38 GB/s
FLOPS achieved: 54.39 TF/s

Prefill latency: 0.45921734254807234 sec
Decode latency: 3.748170350678265 sec
Time for inference 7: 4.21 sec total, 3893.36 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10885.97 GB/s
FLOPS achieved: 54.43 TF/s

Prefill latency: 0.46179338451474905 sec
Decode latency: 3.7459075460210443 sec
Time for inference 8: 4.21 sec total, 3892.93 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10884.77 GB/s
FLOPS achieved: 54.42 TF/s

Prefill latency: 0.4614859512075782 sec
Decode latency: 3.7471585581079125 sec
Time for inference 9: 4.21 sec total, 3892.23 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10882.81 GB/s
FLOPS achieved: 54.41 TF/s

Prefill latency: 0.45940550323575735 sec
Decode latency: 3.748041344806552 sec
Time for inference 10: 4.21 sec total, 3893.20 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 10885.53 GB/s
FLOPS achieved: 54.43 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.7482 sec
Average prefill latency: 0.4598 sec
Average tokens/sec: 3892.67
Memory used: 26.58 GB
Done. we are killing the process
