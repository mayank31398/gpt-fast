flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.84 seconds
Prefill latency: 0.03874606732279062 sec
Decode latency: 2.907121580094099 sec
Compilation time: 2.95 seconds
Prefill latency: 0.03849348705261946 sec
Decode latency: 2.905979289673269 sec
Prefill latency: 0.03841510321944952 sec
Decode latency: 2.905719155445695 sec
Prefill latency: 0.03844064101576805 sec
Decode latency: 2.9057879634201527 sec
Prefill latency: 0.03854838199913502 sec
Decode latency: 2.905767577700317 sec
Prefill latency: 0.03853572066873312 sec
Decode latency: 2.9057151041924953 sec
Time for inference 1: 2.94 sec total, 86.93 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.83 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.03840403910726309 sec
Decode latency: 2.9056677566841245 sec
Time for inference 2: 2.94 sec total, 86.94 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.91 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.038419163785874844 sec
Decode latency: 2.9060334051027894 sec
Time for inference 3: 2.95 sec total, 86.92 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.68 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.03838357422500849 sec
Decode latency: 2.8811398884281516 sec
Time for inference 4: 2.92 sec total, 87.67 tokens/sec
Decode latency: 2.88 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1315.85 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.038561275228857994 sec
Decode latency: 2.9061282565817237 sec
Time for inference 5: 2.95 sec total, 86.92 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.62 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.03843926917761564 sec
Decode latency: 2.9060224685817957 sec
Time for inference 6: 2.95 sec total, 86.92 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.70 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.03843225818127394 sec
Decode latency: 2.906534243375063 sec
Time for inference 7: 2.95 sec total, 86.91 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.51 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.038433958776295185 sec
Decode latency: 2.9058900997042656 sec
Time for inference 8: 2.94 sec total, 86.93 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.79 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.03840224724262953 sec
Decode latency: 2.9055000487715006 sec
Time for inference 9: 2.94 sec total, 86.94 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.97 GB/s
FLOPS achieved: 6.52 TF/s

Prefill latency: 0.038523511961102486 sec
Decode latency: 2.905571904964745 sec
Time for inference 10: 2.94 sec total, 86.93 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1304.87 GB/s
FLOPS achieved: 6.52 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9034 sec
Average prefill latency: 0.0385 sec
Average tokens/sec: 87.00
Memory used: 17.10 GB
Done. we are killing the process
