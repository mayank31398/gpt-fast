flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.03776861500227824 sec
Decode latency: 2.8645495329983532 sec
Compilation time: 2.90 seconds
Prefill latency: 0.037572636967524886 sec
Decode latency: 2.865685647004284 sec
Prefill latency: 0.037543898972216994 sec
Decode latency: 2.8647658709669486 sec
Prefill latency: 0.03759437700500712 sec
Decode latency: 2.792221221025102 sec
Prefill latency: 0.037602781027089804 sec
Decode latency: 2.864821769995615 sec
Prefill latency: 0.037564381025731564 sec
Decode latency: 2.8637160360231064 sec
Time for inference 1: 2.90 sec total, 88.22 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.11 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.03757096501067281 sec
Decode latency: 2.864939705003053 sec
Time for inference 2: 2.90 sec total, 88.18 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1323.56 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.03762800700496882 sec
Decode latency: 2.861978011962492 sec
Time for inference 3: 2.90 sec total, 88.27 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.88 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.037560645025223494 sec
Decode latency: 2.862075624987483 sec
Time for inference 4: 2.90 sec total, 88.27 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.88 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.0375713329995051 sec
Decode latency: 2.8631543600349687 sec
Time for inference 5: 2.90 sec total, 88.23 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.39 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.037511471018660814 sec
Decode latency: 2.863920272968244 sec
Time for inference 6: 2.90 sec total, 88.21 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1323.98 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.03750426898477599 sec
Decode latency: 2.863762781023979 sec
Time for inference 7: 2.90 sec total, 88.22 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.10 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.037520890997257084 sec
Decode latency: 2.8634233720367774 sec
Time for inference 8: 2.90 sec total, 88.23 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.24 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.03759140404872596 sec
Decode latency: 2.8630223050131463 sec
Time for inference 9: 2.90 sec total, 88.24 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1324.42 GB/s
FLOPS achieved: 6.62 TF/s

Prefill latency: 0.03756858600536361 sec
Decode latency: 2.7986293570138514 sec
Time for inference 10: 2.84 sec total, 90.24 tokens/sec
Decode latency: 2.80 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1354.51 GB/s
FLOPS achieved: 6.77 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8569 sec
Average prefill latency: 0.0376 sec
Average tokens/sec: 88.43
Memory used: 16.87 GB
Done. we are killing the process
