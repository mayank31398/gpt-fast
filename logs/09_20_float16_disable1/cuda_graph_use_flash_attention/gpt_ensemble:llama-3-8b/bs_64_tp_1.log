flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.82 seconds
Prefill latency: 2.6157550243660808 sec
Decode latency: 19.249970979988575 sec
Compilation time: 21.87 seconds
Prefill latency: 2.6331272646784782 sec
Decode latency: 19.253229988738894 sec
Prefill latency: 2.624955573119223 sec
Decode latency: 19.252495993860066 sec
Prefill latency: 2.623958316631615 sec
Decode latency: 19.249371570535004 sec
Prefill latency: 2.6242193011566997 sec
Decode latency: 19.252504440024495 sec
Prefill latency: 2.6340348664671183 sec
Decode latency: 19.25387050770223 sec
Time for inference 1: 21.89 sec total, 748.51 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.63 sec
Bandwidth achieved: 11235.00 GB/s
FLOPS achieved: 56.18 TF/s

Prefill latency: 2.62091529648751 sec
Decode latency: 19.25186379533261 sec
Time for inference 2: 21.87 sec total, 749.03 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11242.78 GB/s
FLOPS achieved: 56.21 TF/s

Prefill latency: 2.6259938701987267 sec
Decode latency: 19.24949188437313 sec
Time for inference 3: 21.88 sec total, 748.94 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.63 sec
Bandwidth achieved: 11241.41 GB/s
FLOPS achieved: 56.21 TF/s

Prefill latency: 2.6219055680558085 sec
Decode latency: 19.248217714950442 sec
Time for inference 4: 21.87 sec total, 749.11 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11244.07 GB/s
FLOPS achieved: 56.22 TF/s

Prefill latency: 2.6214614789932966 sec
Decode latency: 19.251624298281968 sec
Time for inference 5: 21.87 sec total, 749.01 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11242.57 GB/s
FLOPS achieved: 56.21 TF/s

Prefill latency: 2.6190719977021217 sec
Decode latency: 19.24735620804131 sec
Time for inference 6: 21.87 sec total, 749.24 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11245.99 GB/s
FLOPS achieved: 56.23 TF/s

Prefill latency: 2.61645074095577 sec
Decode latency: 19.25360574014485 sec
Time for inference 7: 21.87 sec total, 749.12 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11244.18 GB/s
FLOPS achieved: 56.22 TF/s

Prefill latency: 2.619887496344745 sec
Decode latency: 19.249504159204662 sec
Time for inference 8: 21.87 sec total, 749.15 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11244.56 GB/s
FLOPS achieved: 56.22 TF/s

Prefill latency: 2.616809987463057 sec
Decode latency: 19.247922173701227 sec
Time for inference 9: 21.87 sec total, 749.30 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11246.93 GB/s
FLOPS achieved: 56.23 TF/s

Prefill latency: 2.619469117373228 sec
Decode latency: 19.252543409354985 sec
Time for inference 10: 21.87 sec total, 749.05 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.62 sec
Bandwidth achieved: 11243.11 GB/s
FLOPS achieved: 56.22 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2506 sec
Average prefill latency: 2.6216 sec
Average tokens/sec: 749.05
Memory used: 58.80 GB
Done. we are killing the process
