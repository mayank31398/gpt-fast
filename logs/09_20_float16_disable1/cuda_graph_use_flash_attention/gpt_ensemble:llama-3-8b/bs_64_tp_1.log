flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.85 seconds
Prefill latency: 2.642412177287042 sec
Decode latency: 19.250526471063495 sec
Compilation time: 21.89 seconds
Prefill latency: 2.6413808818906546 sec
Decode latency: 19.247800212353468 sec
Prefill latency: 2.6282456116750836 sec
Decode latency: 19.252113996073604 sec
Prefill latency: 2.646265733987093 sec
Decode latency: 19.250192480161786 sec
Prefill latency: 2.640805379487574 sec
Decode latency: 19.250003676861525 sec
Prefill latency: 2.6350982189178467 sec
Decode latency: 19.249576026573777 sec
Time for inference 1: 21.89 sec total, 748.61 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11236.55 GB/s
FLOPS achieved: 56.18 TF/s

Prefill latency: 2.648895487189293 sec
Decode latency: 19.251004739664495 sec
Time for inference 2: 21.90 sec total, 748.09 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11228.70 GB/s
FLOPS achieved: 56.14 TF/s

Prefill latency: 2.6505950447171926 sec
Decode latency: 19.268711272627115 sec
Time for inference 3: 21.92 sec total, 747.43 tokens/sec
Decode latency: 19.27 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11218.84 GB/s
FLOPS achieved: 56.09 TF/s

Prefill latency: 2.649979921989143 sec
Decode latency: 19.278990001417696 sec
Time for inference 4: 21.93 sec total, 747.10 tokens/sec
Decode latency: 19.28 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11213.93 GB/s
FLOPS achieved: 56.07 TF/s

Prefill latency: 2.639379834756255 sec
Decode latency: 19.278577289544046 sec
Time for inference 5: 21.92 sec total, 747.48 tokens/sec
Decode latency: 19.28 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11219.53 GB/s
FLOPS achieved: 56.10 TF/s

Prefill latency: 2.635770964436233 sec
Decode latency: 19.24907424300909 sec
Time for inference 6: 21.89 sec total, 748.61 tokens/sec
Decode latency: 19.25 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11236.50 GB/s
FLOPS achieved: 56.18 TF/s

Prefill latency: 2.6440138649195433 sec
Decode latency: 19.24074072111398 sec
Time for inference 7: 21.89 sec total, 748.60 tokens/sec
Decode latency: 19.24 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11236.43 GB/s
FLOPS achieved: 56.18 TF/s

Prefill latency: 2.6454091612249613 sec
Decode latency: 19.27108338661492 sec
Time for inference 8: 21.92 sec total, 747.53 tokens/sec
Decode latency: 19.27 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11220.28 GB/s
FLOPS achieved: 56.10 TF/s

Prefill latency: 2.642011998221278 sec
Decode latency: 19.282569386065006 sec
Time for inference 9: 21.93 sec total, 747.25 tokens/sec
Decode latency: 19.28 sec
Prefill latency: 2.64 sec
Bandwidth achieved: 11216.13 GB/s
FLOPS achieved: 56.08 TF/s

Prefill latency: 2.648076026700437 sec
Decode latency: 19.285016616806388 sec
Time for inference 10: 21.93 sec total, 746.96 tokens/sec
Decode latency: 19.29 sec
Prefill latency: 2.65 sec
Bandwidth achieved: 11211.79 GB/s
FLOPS achieved: 56.06 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2655 sec
Average prefill latency: 2.6439 sec
Average tokens/sec: 747.77
Memory used: 73.85 GB
Done. we are killing the process
