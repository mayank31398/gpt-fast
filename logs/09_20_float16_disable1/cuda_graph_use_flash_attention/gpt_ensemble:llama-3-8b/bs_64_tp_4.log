W1001 01:02:16.167000 23402493728576 torch/distributed/run.py:779] 
W1001 01:02:16.167000 23402493728576 torch/distributed/run.py:779] *****************************************
W1001 01:02:16.167000 23402493728576 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:02:16.167000 23402493728576 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.21 seconds
Prefill latency: 0.8113941419869661 sec
Decode latency: 6.116357936523855 sec
Compilation time: 6.92 seconds
Compilation time: 6.93 seconds
Compilation time: 6.92 seconds
Compilation time: 6.93 seconds
Prefill latency: 0.8061392474919558 sec
Decode latency: 6.118724752217531 sec
Prefill latency: 0.8073689248412848 sec
Decode latency: 6.116049882024527 sec
Prefill latency: 0.8077250253409147 sec
Decode latency: 6.116823854856193 sec
Prefill latency: 0.8099626218900084 sec
Decode latency: 6.114474304951727 sec
Prefill latency: 0.8089015567675233 sec
Decode latency: 6.117116155102849 sec
Time for inference 1: 6.93 sec total, 2365.30 tokens/sec
Decode latency: 6.12 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10740.52 GB/s
FLOPS achieved: 53.70 TF/s

Prefill latency: 0.8078723195940256 sec
Decode latency: 6.119112136773765 sec
Time for inference 2: 6.93 sec total, 2364.93 tokens/sec
Decode latency: 6.12 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10738.85 GB/s
FLOPS achieved: 53.69 TF/s

Prefill latency: 0.806612272746861 sec
Decode latency: 6.115075383335352 sec
Time for inference 3: 6.92 sec total, 2366.79 tokens/sec
Decode latency: 6.12 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10747.26 GB/s
FLOPS achieved: 53.74 TF/s

Prefill latency: 0.810504762455821 sec
Decode latency: 6.113270962610841 sec
Time for inference 4: 6.92 sec total, 2366.07 tokens/sec
Decode latency: 6.11 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10744.02 GB/s
FLOPS achieved: 53.72 TF/s

Prefill latency: 0.8100113952532411 sec
Decode latency: 6.11672196444124 sec
Time for inference 5: 6.93 sec total, 2365.07 tokens/sec
Decode latency: 6.12 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10739.45 GB/s
FLOPS achieved: 53.70 TF/s

Prefill latency: 0.8090315768495202 sec
Decode latency: 6.117763116955757 sec
Time for inference 6: 6.93 sec total, 2365.00 tokens/sec
Decode latency: 6.12 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10739.16 GB/s
FLOPS achieved: 53.70 TF/s

Prefill latency: 0.8088274952024221 sec
Decode latency: 6.109390651807189 sec
Time for inference 7: 6.92 sec total, 2367.96 tokens/sec
Decode latency: 6.11 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10752.58 GB/s
FLOPS achieved: 53.76 TF/s

Prefill latency: 0.8110205447301269 sec
Decode latency: 6.109839181415737 sec
Time for inference 8: 6.92 sec total, 2367.01 tokens/sec
Decode latency: 6.11 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10748.26 GB/s
FLOPS achieved: 53.74 TF/s

Prefill latency: 0.8081874148920178 sec
Decode latency: 6.111608404666185 sec
Time for inference 9: 6.92 sec total, 2367.40 tokens/sec
Decode latency: 6.11 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10750.05 GB/s
FLOPS achieved: 53.75 TF/s

Prefill latency: 0.809765225276351 sec
Decode latency: 6.111213774420321 sec
Time for inference 10: 6.92 sec total, 2367.01 tokens/sec
Decode latency: 6.11 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 10748.27 GB/s
FLOPS achieved: 53.74 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.1141 sec
Average prefill latency: 0.8091 sec
Average tokens/sec: 2366.25
Memory used: 59.08 GB
Done. we are killing the process
