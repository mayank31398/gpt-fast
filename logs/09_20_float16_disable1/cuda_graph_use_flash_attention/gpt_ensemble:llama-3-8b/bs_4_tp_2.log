W0928 18:38:19.306000 23263833470784 torch/distributed/run.py:779] 
W0928 18:38:19.306000 23263833470784 torch/distributed/run.py:779] *****************************************
W0928 18:38:19.306000 23263833470784 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 18:38:19.306000 23263833470784 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.79 seconds
Prefill latency: 0.08223897963762283 sec
Decode latency: 2.594877758063376 sec
Compilation time: 2.68 seconds
Compilation time: 2.68 seconds
Prefill latency: 0.08142417296767235 sec
Decode latency: 2.593064612708986 sec
Prefill latency: 0.08162863552570343 sec
Decode latency: 2.5946579463779926 sec
Prefill latency: 0.08204287569969893 sec
Decode latency: 2.5905486652627587 sec
Prefill latency: 0.0823300750926137 sec
Decode latency: 2.5912018418312073 sec
Prefill latency: 0.08207043539732695 sec
Decode latency: 2.59047229308635 sec
Time for inference 1: 2.67 sec total, 383.02 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3075.84 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08127349987626076 sec
Decode latency: 2.591943387873471 sec
Time for inference 2: 2.67 sec total, 382.96 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3075.35 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08227899484336376 sec
Decode latency: 2.590091927908361 sec
Time for inference 3: 2.67 sec total, 383.08 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.37 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08192796353250742 sec
Decode latency: 2.5899110035970807 sec
Time for inference 4: 2.67 sec total, 383.16 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3077.00 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08229888789355755 sec
Decode latency: 2.591266476549208 sec
Time for inference 5: 2.67 sec total, 382.90 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3074.88 GB/s
FLOPS achieved: 15.37 TF/s

Prefill latency: 0.08159783203154802 sec
Decode latency: 2.5907241506502032 sec
Time for inference 6: 2.67 sec total, 383.09 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.44 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08194294944405556 sec
Decode latency: 2.5902411909773946 sec
Time for inference 7: 2.67 sec total, 383.10 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.53 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.08230038452893496 sec
Decode latency: 2.5920130107551813 sec
Time for inference 8: 2.68 sec total, 382.79 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3073.97 GB/s
FLOPS achieved: 15.37 TF/s

Prefill latency: 0.08235100656747818 sec
Decode latency: 2.5906431153416634 sec
Time for inference 9: 2.67 sec total, 382.99 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3075.62 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.0819136006757617 sec
Decode latency: 2.590869005769491 sec
Time for inference 10: 2.67 sec total, 383.04 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 3076.02 GB/s
FLOPS achieved: 15.38 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5908 sec
Average prefill latency: 0.0820 sec
Average tokens/sec: 383.01
Memory used: 11.11 GB
Done. we are killing the process
