W1001 00:50:40.577000 22984056899392 torch/distributed/run.py:779] 
W1001 00:50:40.577000 22984056899392 torch/distributed/run.py:779] *****************************************
W1001 00:50:40.577000 22984056899392 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:50:40.577000 22984056899392 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.23560605850070715 sec
Decode latency: 2.97054485976696 sec
Compilation time: 3.18 seconds
Compilation time: 3.21 seconds
Compilation time: 3.18 seconds
Compilation time: 3.21 seconds
Prefill latency: 0.21052995789796114 sec
Decode latency: 2.9712495310232043 sec
Prefill latency: 0.2104941662400961 sec
Decode latency: 2.970730699598789 sec
Prefill latency: 0.2105306889861822 sec
Decode latency: 2.971054445952177 sec
Prefill latency: 0.20989223197102547 sec
Decode latency: 2.972048762254417 sec
Prefill latency: 0.2105044275522232 sec
Decode latency: 2.9712128713726997 sec
Time for inference 1: 3.18 sec total, 1287.02 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5844.20 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.2104952670633793 sec
Decode latency: 2.9709691740572453 sec
Time for inference 2: 3.18 sec total, 1287.20 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5844.99 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.21083799097687006 sec
Decode latency: 2.9711387744173408 sec
Time for inference 3: 3.18 sec total, 1286.96 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5843.91 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.21101869456470013 sec
Decode latency: 2.970304357819259 sec
Time for inference 4: 3.18 sec total, 1287.22 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5845.11 GB/s
FLOPS achieved: 29.23 TF/s

Prefill latency: 0.21150722168385983 sec
Decode latency: 2.9701851466670632 sec
Time for inference 5: 3.18 sec total, 1287.11 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5844.58 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.21080733556300402 sec
Decode latency: 2.9696427769958973 sec
Time for inference 6: 3.18 sec total, 1287.57 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5846.68 GB/s
FLOPS achieved: 29.23 TF/s

Prefill latency: 0.21073439437896013 sec
Decode latency: 2.9710768153890967 sec
Time for inference 7: 3.18 sec total, 1287.00 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5844.10 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.21041775960475206 sec
Decode latency: 2.9716453654691577 sec
Time for inference 8: 3.18 sec total, 1286.93 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5843.76 GB/s
FLOPS achieved: 29.22 TF/s

Prefill latency: 0.2107628546655178 sec
Decode latency: 2.970573304221034 sec
Time for inference 9: 3.18 sec total, 1287.25 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5845.25 GB/s
FLOPS achieved: 29.23 TF/s

Prefill latency: 0.21082105860114098 sec
Decode latency: 2.9721941724419594 sec
Time for inference 10: 3.18 sec total, 1286.51 tokens/sec
Decode latency: 2.97 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 5841.88 GB/s
FLOPS achieved: 29.21 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9709 sec
Average prefill latency: 0.2108 sec
Average tokens/sec: 1287.08
Memory used: 20.77 GB
Done. we are killing the process
