W1001 00:46:11.686000 22522251233088 torch/distributed/run.py:779] 
W1001 00:46:11.686000 22522251233088 torch/distributed/run.py:779] *****************************************
W1001 00:46:11.686000 22522251233088 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:46:11.686000 22522251233088 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.93 seconds
Prefill latency: 0.3374574026092887 sec
Decode latency: 2.7537203142419457 sec
Compilation time: 3.09 seconds
Compilation time: 3.08 secondsCompilation time: 2.90 seconds
Compilation time: 2.89 seconds

Compilation time: 3.09 seconds
Compilation time: 2.90 secondsCompilation time: 2.90 seconds

Compilation time: 3.10 seconds
Prefill latency: 0.1341266566887498 sec
Decode latency: 2.7494594510644674 sec
Prefill latency: 0.13386311009526253 sec
Decode latency: 2.7389377020299435 sec
Prefill latency: 0.13331017922610044 sec
Decode latency: 2.767694833688438 sec
Prefill latency: 0.13349335175007582 sec
Decode latency: 2.743435202166438 sec
Prefill latency: 0.1333422912284732 sec
Decode latency: 2.734528724104166 sec
Time for inference 1: 2.87 sec total, 713.88 tokens/sec
Decode latency: 2.73 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1996.04 GB/s
FLOPS achieved: 9.98 TF/s

Prefill latency: 0.13362914603203535 sec
Decode latency: 2.7584210596978664 sec
Time for inference 2: 2.89 sec total, 707.96 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1979.47 GB/s
FLOPS achieved: 9.90 TF/s

Prefill latency: 0.1336983796209097 sec
Decode latency: 2.746372938156128 sec
Time for inference 3: 2.88 sec total, 710.90 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1987.70 GB/s
FLOPS achieved: 9.94 TF/s

Prefill latency: 0.13375568762421608 sec
Decode latency: 2.7259112372994423 sec
Time for inference 4: 2.86 sec total, 715.93 tokens/sec
Decode latency: 2.73 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2001.78 GB/s
FLOPS achieved: 10.01 TF/s

Prefill latency: 0.13308447692543268 sec
Decode latency: 2.73148356936872 sec
Time for inference 5: 2.87 sec total, 714.73 tokens/sec
Decode latency: 2.73 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1998.40 GB/s
FLOPS achieved: 9.99 TF/s

Prefill latency: 0.13416324276477098 sec
Decode latency: 2.73114228900522 sec
Time for inference 6: 2.87 sec total, 714.54 tokens/sec
Decode latency: 2.73 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1997.89 GB/s
FLOPS achieved: 9.99 TF/s

Prefill latency: 0.13349362183362246 sec
Decode latency: 2.750242861919105 sec
Time for inference 7: 2.88 sec total, 709.96 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1985.06 GB/s
FLOPS achieved: 9.93 TF/s

Prefill latency: 0.13321191258728504 sec
Decode latency: 2.7472365768626332 sec
Time for inference 8: 2.88 sec total, 710.72 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1987.19 GB/s
FLOPS achieved: 9.94 TF/s

Prefill latency: 0.13295802753418684 sec
Decode latency: 2.73689335398376 sec
Time for inference 9: 2.87 sec total, 713.35 tokens/sec
Decode latency: 2.74 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1994.56 GB/s
FLOPS achieved: 9.97 TF/s

Prefill latency: 0.13559873681515455 sec
Decode latency: 2.78153123985976 sec
Time for inference 10: 2.92 sec total, 701.86 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 1962.42 GB/s
FLOPS achieved: 9.81 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7444 sec
Average prefill latency: 0.1337 sec
Average tokens/sec: 711.38
Memory used: 9.90 GB
Done. we are killing the process
