W0929 01:53:23.616000 23198154680128 torch/distributed/run.py:779] 
W0929 01:53:23.616000 23198154680128 torch/distributed/run.py:779] *****************************************
W0929 01:53:23.616000 23198154680128 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0929 01:53:23.616000 23198154680128 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.22 seconds
Prefill latency: 0.05177494999952614 sec
Decode latency: 1.5125845840084367 sec
Compilation time: 1.57 seconds
Compilation time: 1.55 seconds
Compilation time: 1.55 secondsCompilation time: 1.53 secondsCompilation time: 1.55 seconds


Compilation time: 1.55 seconds
Compilation time: 1.62 seconds
Compilation time: 1.54 seconds
Prefill latency: 0.01166572398506105 sec
Decode latency: 1.509915816015564 sec
Prefill latency: 0.011582300008740276 sec
Decode latency: 1.5101423599990085 sec
Prefill latency: 0.011486450035590678 sec
Decode latency: 1.5101538359886035 sec
Prefill latency: 0.011644797981716692 sec
Decode latency: 1.5108689260086976 sec
Prefill latency: 0.011612292961217463 sec
Decode latency: 1.5100106240133755 sec
Time for inference 1: 1.52 sec total, 168.11 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.05 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011435242020525038 sec
Decode latency: 1.5109066410223022 sec
Time for inference 2: 1.52 sec total, 168.06 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 469.89 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.012041074980515987 sec
Decode latency: 1.5118371280259453 sec
Time for inference 3: 1.52 sec total, 167.90 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 469.44 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011474831029772758 sec
Decode latency: 1.51058776199352 sec
Time for inference 4: 1.52 sec total, 168.09 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 469.98 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011702710995450616 sec
Decode latency: 1.5111944089876488 sec
Time for inference 5: 1.52 sec total, 168.00 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 469.75 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011414068983867764 sec
Decode latency: 1.5099507510312833 sec
Time for inference 6: 1.52 sec total, 168.15 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.14 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011438891990110278 sec
Decode latency: 1.5101467510103248 sec
Time for inference 7: 1.52 sec total, 168.16 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.17 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011368043022230268 sec
Decode latency: 1.5102085929829627 sec
Time for inference 8: 1.52 sec total, 168.15 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.15 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011732493992894888 sec
Decode latency: 1.510020464018453 sec
Time for inference 9: 1.52 sec total, 168.14 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 470.13 GB/s
FLOPS achieved: 2.35 TF/s

Prefill latency: 0.011495137005113065 sec
Decode latency: 1.5108337629935704 sec
Time for inference 10: 1.52 sec total, 168.07 tokens/sec
Decode latency: 1.51 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 469.92 GB/s
FLOPS achieved: 2.35 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.5106 sec
Average prefill latency: 0.0116 sec
Average tokens/sec: 168.08
Memory used: 4.35 GB
Done. we are killing the process
