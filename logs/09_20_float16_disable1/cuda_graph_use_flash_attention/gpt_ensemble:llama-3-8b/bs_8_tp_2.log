W1001 00:44:15.541000 22971983275840 torch/distributed/run.py:779] 
W1001 00:44:15.541000 22971983275840 torch/distributed/run.py:779] *****************************************
W1001 00:44:15.541000 22971983275840 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:44:15.541000 22971983275840 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.77 seconds
[rank1]:[W1001 00:44:22.390238549 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.33880576211959124 sec
Decode latency: 3.2481028139591217 sec
Compilation time: 3.56 seconds
Compilation time: 3.59 seconds
Prefill latency: 0.29811166506260633 sec
Decode latency: 3.2451350074261427 sec
Prefill latency: 0.29869689233601093 sec
Decode latency: 3.2444809833541512 sec
Prefill latency: 0.29805357567965984 sec
Decode latency: 3.2446415247395635 sec
Prefill latency: 0.29808582831174135 sec
Decode latency: 3.246812312863767 sec
Prefill latency: 0.2984003257006407 sec
Decode latency: 3.2465505925938487 sec
Time for inference 1: 3.55 sec total, 577.58 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4638.30 GB/s
FLOPS achieved: 23.19 TF/s

Prefill latency: 0.29880458395928144 sec
Decode latency: 3.2446618443354964 sec
Time for inference 2: 3.54 sec total, 577.85 tokens/sec
Decode latency: 3.24 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4640.47 GB/s
FLOPS achieved: 23.20 TF/s

Prefill latency: 0.29853510577231646 sec
Decode latency: 3.2452180832624435 sec
Time for inference 3: 3.54 sec total, 577.80 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4640.05 GB/s
FLOPS achieved: 23.20 TF/s

Prefill latency: 0.2985532181337476 sec
Decode latency: 3.246840538457036 sec
Time for inference 4: 3.55 sec total, 577.55 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4638.04 GB/s
FLOPS achieved: 23.19 TF/s

Prefill latency: 0.2988845854997635 sec
Decode latency: 3.2470841063186526 sec
Time for inference 5: 3.55 sec total, 577.44 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4637.13 GB/s
FLOPS achieved: 23.19 TF/s

Prefill latency: 0.2986581176519394 sec
Decode latency: 3.245436631143093 sec
Time for inference 6: 3.54 sec total, 577.73 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4639.46 GB/s
FLOPS achieved: 23.20 TF/s

Prefill latency: 0.2986225662752986 sec
Decode latency: 3.245171424932778 sec
Time for inference 7: 3.54 sec total, 577.79 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4639.98 GB/s
FLOPS achieved: 23.20 TF/s

Prefill latency: 0.29851971101015806 sec
Decode latency: 3.2472067223861814 sec
Time for inference 8: 3.55 sec total, 577.47 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4637.39 GB/s
FLOPS achieved: 23.19 TF/s

Prefill latency: 0.29860860109329224 sec
Decode latency: 3.2456071274355054 sec
Time for inference 9: 3.55 sec total, 577.69 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4639.18 GB/s
FLOPS achieved: 23.20 TF/s

Prefill latency: 0.29883605521172285 sec
Decode latency: 3.245052305981517 sec
Time for inference 10: 3.54 sec total, 577.78 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 4639.86 GB/s
FLOPS achieved: 23.20 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.2459 sec
Average prefill latency: 0.2986 sec
Average tokens/sec: 577.67
Memory used: 16.54 GB
Done. we are killing the process
