flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.90 seconds
Prefill latency: 0.14863315969705582 sec
Decode latency: 3.5679931938648224 sec
Compilation time: 3.72 seconds
Prefill latency: 0.14939151518046856 sec
Decode latency: 3.5676851607859135 sec
Prefill latency: 0.1495736613869667 sec
Decode latency: 3.569152840413153 sec
Prefill latency: 0.1496841637417674 sec
Decode latency: 3.56787187140435 sec
Prefill latency: 0.1493086339905858 sec
Decode latency: 3.5696760891005397 sec
Prefill latency: 0.14931750856339931 sec
Decode latency: 3.5702056530863047 sec
Time for inference 1: 3.72 sec total, 275.25 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.46 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14929428044706583 sec
Decode latency: 3.5709592681378126 sec
Time for inference 2: 3.72 sec total, 275.20 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.71 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14961485471576452 sec
Decode latency: 3.5708906818181276 sec
Time for inference 3: 3.72 sec total, 275.18 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.39 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14977057371288538 sec
Decode latency: 3.5705152666196227 sec
Time for inference 4: 3.72 sec total, 275.20 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.65 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14924785681068897 sec
Decode latency: 3.5690858652815223 sec
Time for inference 5: 3.72 sec total, 275.34 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4132.84 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14981041569262743 sec
Decode latency: 3.5693819019943476 sec
Time for inference 6: 3.72 sec total, 275.28 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.93 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14943653997033834 sec
Decode latency: 3.5687888991087675 sec
Time for inference 7: 3.72 sec total, 275.35 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4133.02 GB/s
FLOPS achieved: 20.67 TF/s

Prefill latency: 0.14920129347592592 sec
Decode latency: 3.5700601805001497 sec
Time for inference 8: 3.72 sec total, 275.27 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4131.72 GB/s
FLOPS achieved: 20.66 TF/s

Prefill latency: 0.14952835626900196 sec
Decode latency: 3.570623729377985 sec
Time for inference 9: 3.72 sec total, 275.20 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4130.70 GB/s
FLOPS achieved: 20.65 TF/s

Prefill latency: 0.14923149161040783 sec
Decode latency: 3.569294212386012 sec
Time for inference 10: 3.72 sec total, 275.32 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4132.58 GB/s
FLOPS achieved: 20.66 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5700 sec
Average prefill latency: 0.1494 sec
Average tokens/sec: 275.26
Memory used: 18.88 GB
Done. we are killing the process
