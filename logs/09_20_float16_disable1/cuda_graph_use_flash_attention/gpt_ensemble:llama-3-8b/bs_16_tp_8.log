W1001 00:51:42.588000 23243249461056 torch/distributed/run.py:779] 
W1001 00:51:42.588000 23243249461056 torch/distributed/run.py:779] *****************************************
W1001 00:51:42.588000 23243249461056 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:51:42.588000 23243249461056 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.36491411086171865 sec
Decode latency: 3.012836253270507 sec
Compilation time: 3.38 seconds
Compilation time: 3.38 seconds
Compilation time: 3.27 seconds
Compilation time: 3.27 seconds
Compilation time: 3.28 seconds
Compilation time: 3.27 seconds
Compilation time: 3.38 seconds
Compilation time: 3.38 seconds
Prefill latency: 0.24938563909381628 sec
Decode latency: 2.998532841913402 sec
Prefill latency: 0.24993062671273947 sec
Decode latency: 3.0340747237205505 sec
Prefill latency: 0.2478025583550334 sec
Decode latency: 2.994110413827002 sec
Prefill latency: 0.2500113993883133 sec
Decode latency: 3.008837710134685 sec
Prefill latency: 0.2509236605837941 sec
Decode latency: 3.012832125648856 sec
Time for inference 1: 3.26 sec total, 1254.68 tokens/sec
Decode latency: 3.01 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3508.12 GB/s
FLOPS achieved: 17.54 TF/s

Prefill latency: 0.24883821234107018 sec
Decode latency: 2.99492250289768 sec
Time for inference 2: 3.24 sec total, 1262.41 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3529.74 GB/s
FLOPS achieved: 17.65 TF/s

Prefill latency: 0.25005179084837437 sec
Decode latency: 2.995549889281392 sec
Time for inference 3: 3.25 sec total, 1261.70 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3527.77 GB/s
FLOPS achieved: 17.64 TF/s

Prefill latency: 0.2493918864056468 sec
Decode latency: 3.0112268598750234 sec
Time for inference 4: 3.26 sec total, 1255.85 tokens/sec
Decode latency: 3.01 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3511.40 GB/s
FLOPS achieved: 17.56 TF/s

Prefill latency: 0.2496923329308629 sec
Decode latency: 3.0044729206711054 sec
Time for inference 5: 3.26 sec total, 1258.32 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3518.31 GB/s
FLOPS achieved: 17.59 TF/s

Prefill latency: 0.24921306129544973 sec
Decode latency: 3.0013578422367573 sec
Time for inference 6: 3.25 sec total, 1259.80 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3522.44 GB/s
FLOPS achieved: 17.61 TF/s

Prefill latency: 0.24917813763022423 sec
Decode latency: 3.0133866891264915 sec
Time for inference 7: 3.26 sec total, 1255.08 tokens/sec
Decode latency: 3.01 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3509.25 GB/s
FLOPS achieved: 17.55 TF/s

Prefill latency: 0.2488430244848132 sec
Decode latency: 2.99661148712039 sec
Time for inference 8: 3.25 sec total, 1261.73 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3527.84 GB/s
FLOPS achieved: 17.64 TF/s

Prefill latency: 0.24931118916720152 sec
Decode latency: 2.996855126693845 sec
Time for inference 9: 3.25 sec total, 1261.47 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3527.11 GB/s
FLOPS achieved: 17.64 TF/s

Prefill latency: 0.24915327038615942 sec
Decode latency: 3.0019587986171246 sec
Time for inference 10: 3.25 sec total, 1259.58 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.25 sec
Bandwidth achieved: 3521.84 GB/s
FLOPS achieved: 17.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0029 sec
Average prefill latency: 0.2495 sec
Average tokens/sec: 1259.06
Memory used: 16.53 GB
Done. we are killing the process
