flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W1001 02:48:45.967858739 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.10753945505712181 sec
Decode latency: 2.7744746890384704 sec
Compilation time: 2.88 seconds
Prefill latency: 0.10713179293088615 sec
Decode latency: 2.7664775729645044 sec
Prefill latency: 0.10693040699698031 sec
Decode latency: 2.7661609470378608 sec
Prefill latency: 0.10695944610051811 sec
Decode latency: 2.7663141989614815 sec
Prefill latency: 0.1069402180146426 sec
Decode latency: 2.766269644955173 sec
Prefill latency: 0.10695545002818108 sec
Decode latency: 2.7662185210501775 sec
Time for inference 1: 2.87 sec total, 712.61 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.77 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10702344996389002 sec
Decode latency: 2.765987624065019 sec
Time for inference 2: 2.87 sec total, 712.66 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.91 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10696288594044745 sec
Decode latency: 2.7661678809672594 sec
Time for inference 3: 2.87 sec total, 712.65 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.87 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10692810697946697 sec
Decode latency: 2.7659987860824913 sec
Time for inference 4: 2.87 sec total, 712.69 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.98 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10691362095531076 sec
Decode latency: 2.7660258029354736 sec
Time for inference 5: 2.87 sec total, 712.69 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.98 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10697070299647748 sec
Decode latency: 2.765974511974491 sec
Time for inference 6: 2.87 sec total, 712.64 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.85 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10703901096712798 sec
Decode latency: 2.766105385031551 sec
Time for inference 7: 2.87 sec total, 712.61 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.78 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10696947295218706 sec
Decode latency: 2.766225946950726 sec
Time for inference 8: 2.87 sec total, 712.61 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.79 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10702341701835394 sec
Decode latency: 2.766328054945916 sec
Time for inference 9: 2.87 sec total, 712.59 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.73 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10705238301306963 sec
Decode latency: 2.7659361239057034 sec
Time for inference 10: 2.87 sec total, 712.68 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.95 GB/s
FLOPS achieved: 8.61 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7661 sec
Average prefill latency: 0.1070 sec
Average tokens/sec: 712.64
Memory used: 9.33 GB
Done. we are killing the process
