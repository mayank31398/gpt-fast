flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.22 seconds
Prefill latency: 0.20744442497380078 sec
Decode latency: 3.3854371559573337 sec
Compilation time: 3.59 seconds
Prefill latency: 0.20692265301477164 sec
Decode latency: 3.3821462870109826 sec
Prefill latency: 0.20699166401755065 sec
Decode latency: 3.3821343949530274 sec
Prefill latency: 0.20695826597511768 sec
Decode latency: 3.382308130036108 sec
Prefill latency: 0.20695740589872003 sec
Decode latency: 3.3823593029519543 sec
Prefill latency: 0.20698478701524436 sec
Decode latency: 3.3822610420174897 sec
Time for inference 1: 3.59 sec total, 1140.85 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.48 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.207018755027093 sec
Decode latency: 3.382440199959092 sec
Time for inference 2: 3.59 sec total, 1140.81 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.39 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20706475502811372 sec
Decode latency: 3.3822489420417696 sec
Time for inference 3: 3.59 sec total, 1140.89 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.59 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20713563298340887 sec
Decode latency: 3.3822239480214193 sec
Time for inference 4: 3.59 sec total, 1140.90 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.61 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20710808201692998 sec
Decode latency: 3.382336169015616 sec
Time for inference 5: 3.59 sec total, 1140.86 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.51 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20701950101647526 sec
Decode latency: 3.382433558930643 sec
Time for inference 6: 3.59 sec total, 1140.86 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.51 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20707380096428096 sec
Decode latency: 3.3822201979346573 sec
Time for inference 7: 3.59 sec total, 1140.90 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.60 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20703731290996075 sec
Decode latency: 3.38246115995571 sec
Time for inference 8: 3.59 sec total, 1140.83 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.43 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20702074200380594 sec
Decode latency: 3.381604766007513 sec
Time for inference 9: 3.59 sec total, 1141.11 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2757.11 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.2069851440610364 sec
Decode latency: 3.3239114469615743 sec
Time for inference 10: 3.53 sec total, 1159.77 tokens/sec
Decode latency: 3.32 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2802.19 GB/s
FLOPS achieved: 14.01 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3764 sec
Average prefill latency: 0.2070 sec
Average tokens/sec: 1142.78
Memory used: 15.78 GB
Done. we are killing the process
