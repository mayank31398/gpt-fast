W1001 03:00:12.072000 23430209263424 torch/distributed/run.py:779] 
W1001 03:00:12.072000 23430209263424 torch/distributed/run.py:779] *****************************************
W1001 03:00:12.072000 23430209263424 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:00:12.072000 23430209263424 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.18 seconds
Prefill latency: 0.26745296095032245 sec
Decode latency: 3.443774151033722 sec
Compilation time: 3.71 seconds
Compilation time: 3.71 seconds
Compilation time: 3.71 seconds
Compilation time: 3.71 seconds
Prefill latency: 0.26667288108728826 sec
Decode latency: 3.4455440500751138 sec
Prefill latency: 0.2668517199344933 sec
Decode latency: 3.443772583035752 sec
Prefill latency: 0.26702944398857653 sec
Decode latency: 3.443824962945655 sec
Prefill latency: 0.26734107499942183 sec
Decode latency: 3.444493441027589 sec
Prefill latency: 0.26708469493314624 sec
Decode latency: 3.444114726036787 sec
Time for inference 1: 3.71 sec total, 4413.68 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3166.71 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.2668871709611267 sec
Decode latency: 3.4453763209749013 sec
Time for inference 2: 3.71 sec total, 4412.24 tokens/sec
Decode latency: 3.45 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3165.67 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.2669376420089975 sec
Decode latency: 3.4455618619685993 sec
Time for inference 3: 3.71 sec total, 4412.03 tokens/sec
Decode latency: 3.45 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3165.52 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.26698410301469266 sec
Decode latency: 3.446161644998938 sec
Time for inference 4: 3.71 sec total, 4411.37 tokens/sec
Decode latency: 3.45 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3165.05 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.2671799890231341 sec
Decode latency: 3.444453911972232 sec
Time for inference 5: 3.71 sec total, 4413.19 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3166.36 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.26676532498095185 sec
Decode latency: 3.4440105539979413 sec
Time for inference 6: 3.71 sec total, 4414.35 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3167.18 GB/s
FLOPS achieved: 15.84 TF/s

Prefill latency: 0.2671496879775077 sec
Decode latency: 3.4435233050026 sec
Time for inference 7: 3.71 sec total, 4414.46 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3167.26 GB/s
FLOPS achieved: 15.84 TF/s

Prefill latency: 0.2670779579784721 sec
Decode latency: 3.4450452919118106 sec
Time for inference 8: 3.71 sec total, 4412.56 tokens/sec
Decode latency: 3.45 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3165.90 GB/s
FLOPS achieved: 15.83 TF/s

Prefill latency: 0.2669829869410023 sec
Decode latency: 3.4437594099435955 sec
Time for inference 9: 3.71 sec total, 4414.27 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3167.13 GB/s
FLOPS achieved: 15.84 TF/s

Prefill latency: 0.267043496016413 sec
Decode latency: 3.4439144459320232 sec
Time for inference 10: 3.71 sec total, 4413.73 tokens/sec
Decode latency: 3.44 sec
Prefill latency: 0.27 sec
Bandwidth achieved: 3166.74 GB/s
FLOPS achieved: 15.83 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.4446 sec
Average prefill latency: 0.2670 sec
Average tokens/sec: 4413.19
Memory used: 32.96 GB
Done. we are killing the process
