flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.20 seconds
Prefill latency: 0.04873469297308475 sec
Decode latency: 2.5611630349885672 sec
Compilation time: 2.61 seconds
Prefill latency: 0.04838576202746481 sec
Decode latency: 2.55809282802511 sec
Prefill latency: 0.04848130710888654 sec
Decode latency: 2.540061169071123 sec
Prefill latency: 0.04825823497958481 sec
Decode latency: 2.4358657900011167 sec
Prefill latency: 0.048365448019467294 sec
Decode latency: 2.5532141650328413 sec
Prefill latency: 0.048383818939328194 sec
Decode latency: 2.5531878480687737 sec
Time for inference 1: 2.60 sec total, 393.49 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.72 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04839561495464295 sec
Decode latency: 2.552436967031099 sec
Time for inference 2: 2.60 sec total, 393.61 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.96 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048371182987466455 sec
Decode latency: 2.5511403240961954 sec
Time for inference 3: 2.60 sec total, 393.81 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 852.40 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048358264029957354 sec
Decode latency: 2.5524933109991252 sec
Time for inference 4: 2.60 sec total, 393.61 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.97 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04839608201291412 sec
Decode latency: 2.552694290992804 sec
Time for inference 5: 2.60 sec total, 393.57 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.90 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048377444967627525 sec
Decode latency: 2.553249796037562 sec
Time for inference 6: 2.60 sec total, 393.49 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.71 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04838996892794967 sec
Decode latency: 2.553010553936474 sec
Time for inference 7: 2.60 sec total, 393.53 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.80 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.048335841041989625 sec
Decode latency: 2.552934063016437 sec
Time for inference 8: 2.60 sec total, 393.56 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.85 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04839660692960024 sec
Decode latency: 2.552877165027894 sec
Time for inference 9: 2.60 sec total, 393.55 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.85 GB/s
FLOPS achieved: 4.26 TF/s

Prefill latency: 0.04841249110177159 sec
Decode latency: 2.5529512480134144 sec
Time for inference 10: 2.60 sec total, 393.54 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 851.82 GB/s
FLOPS achieved: 4.26 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5527 sec
Average prefill latency: 0.0484 sec
Average tokens/sec: 393.58
Memory used: 4.90 GB
Done. we are killing the process
