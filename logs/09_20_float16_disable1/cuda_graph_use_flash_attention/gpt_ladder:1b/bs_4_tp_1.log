flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W1001 02:45:46.988164337 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.055702051031403244 sec
Decode latency: 2.4507526529487222 sec
Compilation time: 2.51 seconds
Prefill latency: 0.055400119978003204 sec
Decode latency: 2.443682328099385 sec
Prefill latency: 0.055312881944701076 sec
Decode latency: 2.443709228071384 sec
Prefill latency: 0.0553349070250988 sec
Decode latency: 2.443780862959102 sec
Prefill latency: 0.05527456395793706 sec
Decode latency: 2.443597205914557 sec
Prefill latency: 0.05531849502585828 sec
Decode latency: 2.443688887055032 sec
Time for inference 1: 2.50 sec total, 409.65 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.79 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.055285413982346654 sec
Decode latency: 2.4436771360924467 sec
Time for inference 2: 2.50 sec total, 409.66 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.81 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05534243804868311 sec
Decode latency: 2.44394182797987 sec
Time for inference 3: 2.50 sec total, 409.61 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.69 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05533017800189555 sec
Decode latency: 2.4432527370518073 sec
Time for inference 4: 2.50 sec total, 409.72 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.96 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05531838000752032 sec
Decode latency: 2.4435927129816264 sec
Time for inference 5: 2.50 sec total, 409.67 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.82 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05529681302141398 sec
Decode latency: 2.443631810019724 sec
Time for inference 6: 2.50 sec total, 409.67 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.82 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05533885199110955 sec
Decode latency: 2.4434364159824327 sec
Time for inference 7: 2.50 sec total, 409.69 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.89 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.055323648964986205 sec
Decode latency: 2.4435297349700704 sec
Time for inference 8: 2.50 sec total, 409.68 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.86 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05537384399212897 sec
Decode latency: 2.443251930992119 sec
Time for inference 9: 2.50 sec total, 409.72 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.95 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05532506702002138 sec
Decode latency: 2.443585581961088 sec
Time for inference 10: 2.50 sec total, 409.67 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.84 GB/s
FLOPS achieved: 4.95 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4436 sec
Average prefill latency: 0.0553 sec
Average tokens/sec: 409.67
Memory used: 6.17 GB
Done. we are killing the process
