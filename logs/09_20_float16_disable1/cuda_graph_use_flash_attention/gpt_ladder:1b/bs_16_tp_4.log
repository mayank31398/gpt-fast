W0930 20:06:59.840000 23306550712128 torch/distributed/run.py:779] 
W0930 20:06:59.840000 23306550712128 torch/distributed/run.py:779] *****************************************
W0930 20:06:59.840000 23306550712128 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 20:06:59.840000 23306550712128 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.17 seconds
Prefill latency: 0.0656943799695 sec
Decode latency: 2.5249545630067587 sec
Compilation time: 2.59 secondsCompilation time: 2.59 seconds

Compilation time: 2.59 seconds
Compilation time: 2.59 seconds
Prefill latency: 0.06525877397507429 sec
Decode latency: 2.5270721779670566 sec
Prefill latency: 0.06528889003675431 sec
Decode latency: 2.527284611016512 sec
Prefill latency: 0.06541295803617686 sec
Decode latency: 2.52755957597401 sec
Prefill latency: 0.06534385797567666 sec
Decode latency: 2.5278998360736296 sec
Prefill latency: 0.06545550492592156 sec
Decode latency: 2.5245998130412772 sec
Time for inference 1: 2.59 sec total, 1580.86 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1034.77 GB/s
FLOPS achieved: 5.17 TF/s

Prefill latency: 0.06528696499299258 sec
Decode latency: 2.525414648000151 sec
Time for inference 2: 2.59 sec total, 1580.54 tokens/sec
Decode latency: 2.53 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1034.56 GB/s
FLOPS achieved: 5.17 TF/s

Prefill latency: 0.06524538504891098 sec
Decode latency: 2.524127873010002 sec
Time for inference 3: 2.59 sec total, 1581.29 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.05 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.06513843894936144 sec
Decode latency: 2.523551738006063 sec
Time for inference 4: 2.59 sec total, 1581.76 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.36 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.06523393501993269 sec
Decode latency: 2.5234796730801463 sec
Time for inference 5: 2.59 sec total, 1581.78 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.37 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.06520767405163497 sec
Decode latency: 2.5237142080441117 sec
Time for inference 6: 2.59 sec total, 1581.62 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.27 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.0651950070168823 sec
Decode latency: 2.523633982054889 sec
Time for inference 7: 2.59 sec total, 1581.72 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.33 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.06523925508372486 sec
Decode latency: 2.524505676003173 sec
Time for inference 8: 2.59 sec total, 1581.12 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1034.94 GB/s
FLOPS achieved: 5.17 TF/s

Prefill latency: 0.06557117204647511 sec
Decode latency: 2.5239386939210817 sec
Time for inference 9: 2.59 sec total, 1581.30 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1035.06 GB/s
FLOPS achieved: 5.18 TF/s

Prefill latency: 0.06534551503136754 sec
Decode latency: 2.524316320894286 sec
Time for inference 10: 2.59 sec total, 1581.07 tokens/sec
Decode latency: 2.52 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1034.91 GB/s
FLOPS achieved: 5.17 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5241 sec
Average prefill latency: 0.0653 sec
Average tokens/sec: 1581.31
Memory used: 8.08 GB
Done. we are killing the process
