flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
Prefill latency: 0.6987004800466821 sec
Decode latency: 10.613346365047619 sec
Compilation time: 11.31 seconds
Prefill latency: 0.6990834159078076 sec
Decode latency: 10.617890018969774 sec
Prefill latency: 0.6986068650148809 sec
Decode latency: 10.61790056200698 sec
Prefill latency: 0.6992474410217255 sec
Decode latency: 10.617204952053726 sec
Prefill latency: 0.6998534160666168 sec
Decode latency: 10.612224578042515 sec
Prefill latency: 0.6991241879295558 sec
Decode latency: 10.612681347993203 sec
Time for inference 1: 11.31 sec total, 1448.28 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.81 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.6998653670307249 sec
Decode latency: 10.617742248927243 sec
Time for inference 2: 11.32 sec total, 1447.52 tokens/sec
Decode latency: 10.62 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3133.16 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.6986930449493229 sec
Decode latency: 10.59172526805196 sec
Time for inference 3: 11.29 sec total, 1451.01 tokens/sec
Decode latency: 10.59 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3140.72 GB/s
FLOPS achieved: 15.70 TF/s

Prefill latency: 0.6993506320286542 sec
Decode latency: 10.576431736932136 sec
Time for inference 4: 11.28 sec total, 1452.90 tokens/sec
Decode latency: 10.58 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3144.82 GB/s
FLOPS achieved: 15.72 TF/s

Prefill latency: 0.6989207239821553 sec
Decode latency: 10.488406404969282 sec
Time for inference 5: 11.19 sec total, 1464.37 tokens/sec
Decode latency: 10.49 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3169.65 GB/s
FLOPS achieved: 15.85 TF/s

Prefill latency: 0.6985134439310059 sec
Decode latency: 10.48487937496975 sec
Time for inference 6: 11.18 sec total, 1464.89 tokens/sec
Decode latency: 10.48 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3170.78 GB/s
FLOPS achieved: 15.85 TF/s

Prefill latency: 0.6990572100039572 sec
Decode latency: 10.569060240057297 sec
Time for inference 7: 11.27 sec total, 1453.86 tokens/sec
Decode latency: 10.57 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3146.90 GB/s
FLOPS achieved: 15.73 TF/s

Prefill latency: 0.6992066570091993 sec
Decode latency: 10.613162375986576 sec
Time for inference 8: 11.31 sec total, 1448.18 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.59 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.698884469922632 sec
Decode latency: 10.525499534094706 sec
Time for inference 9: 11.23 sec total, 1459.55 tokens/sec
Decode latency: 10.53 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3159.22 GB/s
FLOPS achieved: 15.80 TF/s

Prefill latency: 0.6983157569775358 sec
Decode latency: 10.613800047081895 sec
Time for inference 10: 11.31 sec total, 1448.22 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.68 GB/s
FLOPS achieved: 15.67 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.5693 sec
Average prefill latency: 0.6990 sec
Average tokens/sec: 1453.88
Memory used: 40.63 GB
Done. we are killing the process
