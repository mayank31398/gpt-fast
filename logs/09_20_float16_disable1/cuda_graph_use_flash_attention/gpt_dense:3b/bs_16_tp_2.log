W1001 03:17:29.389000 22944908990272 torch/distributed/run.py:779] 
W1001 03:17:29.389000 22944908990272 torch/distributed/run.py:779] *****************************************
W1001 03:17:29.389000 22944908990272 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:17:29.389000 22944908990272 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.6751812300644815 sec
Decode latency: 3.900895745959133 sec
Compilation time: 4.57 seconds
Compilation time: 4.58 seconds
Prefill latency: 0.6287720799446106 sec
Decode latency: 3.9011044739745557 sec
Prefill latency: 0.6245590180624276 sec
Decode latency: 3.90221367997583 sec
Prefill latency: 0.6292698760516942 sec
Decode latency: 3.902096781996079 sec
Prefill latency: 0.6253175189485773 sec
Decode latency: 3.899639276904054 sec
Prefill latency: 0.6276128209428862 sec
Decode latency: 3.9027299530571327 sec
Time for inference 1: 4.53 sec total, 903.94 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3276.10 GB/s
FLOPS achieved: 16.38 TF/s

Prefill latency: 0.6256273360922933 sec
Decode latency: 3.8993553780019283 sec
Time for inference 2: 4.53 sec total, 905.03 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3280.07 GB/s
FLOPS achieved: 16.40 TF/s

Prefill latency: 0.6288044829852879 sec
Decode latency: 3.8960857740603387 sec
Time for inference 3: 4.53 sec total, 905.07 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3280.20 GB/s
FLOPS achieved: 16.40 TF/s

Prefill latency: 0.6270205299369991 sec
Decode latency: 3.895563431084156 sec
Time for inference 4: 4.52 sec total, 905.47 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3281.65 GB/s
FLOPS achieved: 16.41 TF/s

Prefill latency: 0.630659049958922 sec
Decode latency: 3.8965105700772256 sec
Time for inference 5: 4.53 sec total, 904.57 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3278.39 GB/s
FLOPS achieved: 16.39 TF/s

Prefill latency: 0.6259396870154887 sec
Decode latency: 3.8974779810523614 sec
Time for inference 6: 4.52 sec total, 905.31 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3281.06 GB/s
FLOPS achieved: 16.41 TF/s

Prefill latency: 0.6288408490363508 sec
Decode latency: 3.8980986629612744 sec
Time for inference 7: 4.53 sec total, 904.62 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3278.58 GB/s
FLOPS achieved: 16.39 TF/s

Prefill latency: 0.6258459100499749 sec
Decode latency: 3.8935511189047247 sec
Time for inference 8: 4.52 sec total, 906.14 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3284.08 GB/s
FLOPS achieved: 16.42 TF/s

Prefill latency: 0.6298976490506902 sec
Decode latency: 3.8976051011122763 sec
Time for inference 9: 4.53 sec total, 904.53 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3278.24 GB/s
FLOPS achieved: 16.39 TF/s

Prefill latency: 0.6266357230488211 sec
Decode latency: 3.8955839889822528 sec
Time for inference 10: 4.52 sec total, 905.59 tokens/sec
Decode latency: 3.90 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 3282.08 GB/s
FLOPS achieved: 16.41 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8973 sec
Average prefill latency: 0.6277 sec
Average tokens/sec: 905.03
Memory used: 16.94 GB
Done. we are killing the process
