W1001 03:14:42.491000 23437141698368 torch/distributed/run.py:779] 
W1001 03:14:42.491000 23437141698368 torch/distributed/run.py:779] *****************************************
W1001 03:14:42.491000 23437141698368 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:14:42.491000 23437141698368 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.07821519998833537 sec
Decode latency: 2.9816231899894774 sec
Compilation time: 3.06 seconds
Compilation time: 3.06 secondsCompilation time: 3.06 seconds

Compilation time: 3.06 seconds
Prefill latency: 0.07763762795366347 sec
Decode latency: 2.9809642580803484 sec
Prefill latency: 0.07790657202713192 sec
Decode latency: 2.981361743994057 sec
Prefill latency: 0.07771047204732895 sec
Decode latency: 2.9814356570132077 sec
Prefill latency: 0.07765456906054169 sec
Decode latency: 2.9811365589266643 sec
Prefill latency: 0.07766235107555985 sec
Decode latency: 2.9804098749300465 sec
Time for inference 1: 3.06 sec total, 669.52 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.21 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.0776892569847405 sec
Decode latency: 2.979207328055054 sec
Time for inference 2: 3.06 sec total, 669.79 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.72 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07767443195916712 sec
Decode latency: 2.980068036937155 sec
Time for inference 3: 3.06 sec total, 669.60 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.36 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.0775680459337309 sec
Decode latency: 2.9799113050103188 sec
Time for inference 4: 3.06 sec total, 669.64 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.43 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07777147099841386 sec
Decode latency: 2.980636200052686 sec
Time for inference 5: 3.06 sec total, 669.40 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1288.97 GB/s
FLOPS achieved: 6.44 TF/s

Prefill latency: 0.07765436300542206 sec
Decode latency: 2.980073518003337 sec
Time for inference 6: 3.06 sec total, 669.57 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.30 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07762841891963035 sec
Decode latency: 2.9799595279619098 sec
Time for inference 7: 3.06 sec total, 669.61 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.37 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07765697094146162 sec
Decode latency: 2.979725559009239 sec
Time for inference 8: 3.06 sec total, 669.69 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.52 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07778711896389723 sec
Decode latency: 2.9807919370941818 sec
Time for inference 9: 3.06 sec total, 669.44 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.05 GB/s
FLOPS achieved: 6.45 TF/s

Prefill latency: 0.07780560804530978 sec
Decode latency: 2.9797122289892286 sec
Time for inference 10: 3.06 sec total, 669.65 tokens/sec
Decode latency: 2.98 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1289.46 GB/s
FLOPS achieved: 6.45 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9800 sec
Average prefill latency: 0.0777 sec
Average tokens/sec: 669.59
Memory used: 7.67 GB
Done. we are killing the process
