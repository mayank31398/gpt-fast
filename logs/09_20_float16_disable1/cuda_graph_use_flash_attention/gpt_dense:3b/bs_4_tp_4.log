W1001 03:11:28.909000 23282515957568 torch/distributed/run.py:779] 
W1001 03:11:28.909000 23282515957568 torch/distributed/run.py:779] *****************************************
W1001 03:11:28.909000 23282515957568 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:11:28.909000 23282515957568 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.99 seconds
[rank1]:[W1001 03:11:37.701682515 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.08573949302081019 sec
Decode latency: 2.771222083014436 sec
Compilation time: 2.83 seconds
Compilation time: 2.84 secondsCompilation time: 2.82 seconds

Compilation time: 2.86 seconds
Prefill latency: 0.04422485001850873 sec
Decode latency: 2.771275634993799 sec
Prefill latency: 0.04430376004893333 sec
Decode latency: 2.7653420260176063 sec
Prefill latency: 0.04432410001754761 sec
Decode latency: 2.765750218066387 sec
Prefill latency: 0.04430012800730765 sec
Decode latency: 2.764815080910921 sec
Prefill latency: 0.044342438923195004 sec
Decode latency: 2.766767904977314 sec
Time for inference 1: 2.81 sec total, 364.13 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.16 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.044279129011556506 sec
Decode latency: 2.7650235989131033 sec
Time for inference 2: 2.81 sec total, 364.36 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.60 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04423059895634651 sec
Decode latency: 2.76733018795494 sec
Time for inference 3: 2.81 sec total, 364.09 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.07 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04409954301081598 sec
Decode latency: 2.7650570309488103 sec
Time for inference 4: 2.81 sec total, 364.41 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.70 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04425522196106613 sec
Decode latency: 2.767324252985418 sec
Time for inference 5: 2.81 sec total, 364.11 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.11 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04428493895102292 sec
Decode latency: 2.7649344289675355 sec
Time for inference 6: 2.81 sec total, 364.42 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.71 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04433100007008761 sec
Decode latency: 2.7687617399496958 sec
Time for inference 7: 2.81 sec total, 363.90 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 700.72 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.04430674505420029 sec
Decode latency: 2.7642563030822203 sec
Time for inference 8: 2.81 sec total, 364.50 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.87 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04422410693950951 sec
Decode latency: 2.7672317819669843 sec
Time for inference 9: 2.81 sec total, 364.13 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 701.16 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.04431116604246199 sec
Decode latency: 2.763493270962499 sec
Time for inference 10: 2.81 sec total, 364.60 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 702.07 GB/s
FLOPS achieved: 3.51 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7660 sec
Average prefill latency: 0.0443 sec
Average tokens/sec: 364.27
Memory used: 5.09 GB
Done. we are killing the process
