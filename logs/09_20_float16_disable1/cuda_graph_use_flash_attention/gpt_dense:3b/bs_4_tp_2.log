W1001 03:10:33.100000 22671851472704 torch/distributed/run.py:779] 
W1001 03:10:33.100000 22671851472704 torch/distributed/run.py:779] *****************************************
W1001 03:10:33.100000 22671851472704 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:10:33.100000 22671851472704 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.18130876298528165 sec
Decode latency: 2.888440117938444 sec
Compilation time: 3.13 seconds
Compilation time: 3.07 seconds
Prefill latency: 0.16526882094331086 sec
Decode latency: 2.8887447390006855 sec
Prefill latency: 0.16441674099769443 sec
Decode latency: 2.8879981860518456 sec
Prefill latency: 0.16631832905113697 sec
Decode latency: 2.8893388779833913 sec
Prefill latency: 0.16518045705743134 sec
Decode latency: 2.889156566001475 sec
Prefill latency: 0.16694380203261971 sec
Decode latency: 2.888441988034174 sec
Time for inference 1: 3.06 sec total, 335.04 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1214.28 GB/s
FLOPS achieved: 6.07 TF/s

Prefill latency: 0.16438468301203102 sec
Decode latency: 2.889534670044668 sec
Time for inference 2: 3.05 sec total, 335.22 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1214.91 GB/s
FLOPS achieved: 6.07 TF/s

Prefill latency: 0.1658942080102861 sec
Decode latency: 2.889090183074586 sec
Time for inference 3: 3.06 sec total, 335.11 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1214.51 GB/s
FLOPS achieved: 6.07 TF/s

Prefill latency: 0.16457869799342006 sec
Decode latency: 2.887613515020348 sec
Time for inference 4: 3.05 sec total, 335.41 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1215.62 GB/s
FLOPS achieved: 6.08 TF/s

Prefill latency: 0.166816117009148 sec
Decode latency: 2.887577235000208 sec
Time for inference 5: 3.06 sec total, 335.18 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1214.76 GB/s
FLOPS achieved: 6.07 TF/s

Prefill latency: 0.16518678097054362 sec
Decode latency: 2.8875841851113364 sec
Time for inference 6: 3.05 sec total, 335.35 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1215.41 GB/s
FLOPS achieved: 6.08 TF/s

Prefill latency: 0.16583847207948565 sec
Decode latency: 2.887592170969583 sec
Time for inference 7: 3.05 sec total, 335.28 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1215.14 GB/s
FLOPS achieved: 6.08 TF/s

Prefill latency: 0.16435633006040007 sec
Decode latency: 2.8891265699639916 sec
Time for inference 8: 3.05 sec total, 335.26 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1215.06 GB/s
FLOPS achieved: 6.08 TF/s

Prefill latency: 0.16578709695022553 sec
Decode latency: 2.8891161490464583 sec
Time for inference 9: 3.06 sec total, 335.11 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.17 sec
Bandwidth achieved: 1214.51 GB/s
FLOPS achieved: 6.07 TF/s

Prefill latency: 0.16496638499666005 sec
Decode latency: 2.8890732779400423 sec
Time for inference 10: 3.05 sec total, 335.19 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 1214.83 GB/s
FLOPS achieved: 6.07 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.8885 sec
Average prefill latency: 0.1655 sec
Average tokens/sec: 335.21
Memory used: 7.39 GB
Done. we are killing the process
