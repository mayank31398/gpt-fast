W1001 03:27:01.100000 22645868971840 torch/distributed/run.py:779] 
W1001 03:27:01.100000 22645868971840 torch/distributed/run.py:779] *****************************************
W1001 03:27:01.100000 22645868971840 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 03:27:01.100000 22645868971840 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.07 seconds
Prefill latency: 0.5541321228956804 sec
Decode latency: 5.519615023978986 sec
Compilation time: 6.07 seconds
Compilation time: 6.07 secondsCompilation time: 6.08 seconds

Compilation time: 6.08 seconds
Prefill latency: 0.5461671510711312 sec
Decode latency: 5.5194989640731364 sec
Prefill latency: 0.5466700020479038 sec
Decode latency: 5.518989250995219 sec
Prefill latency: 0.5469365059398115 sec
Decode latency: 5.5177146079950035 sec
Prefill latency: 0.5469347540056333 sec
Decode latency: 5.518643338000402 sec
Prefill latency: 0.5467023079982027 sec
Decode latency: 5.518463159096427 sec
Time for inference 1: 6.07 sec total, 2700.92 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5200.79 GB/s
FLOPS achieved: 26.00 TF/s

Prefill latency: 0.5468617710284889 sec
Decode latency: 5.516800301964395 sec
Time for inference 2: 6.06 sec total, 2701.56 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5202.01 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.5462890970520675 sec
Decode latency: 5.517945395084098 sec
Time for inference 3: 6.07 sec total, 2701.34 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5201.58 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.5470462489174679 sec
Decode latency: 5.516222606995143 sec
Time for inference 4: 6.06 sec total, 2701.81 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5202.49 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.5463446070207283 sec
Decode latency: 5.518884434946813 sec
Time for inference 5: 6.07 sec total, 2700.89 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5200.73 GB/s
FLOPS achieved: 26.00 TF/s

Prefill latency: 0.5464915860211477 sec
Decode latency: 5.516660053981468 sec
Time for inference 6: 6.06 sec total, 2701.79 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5202.45 GB/s
FLOPS achieved: 26.01 TF/s

Prefill latency: 0.5461594089865685 sec
Decode latency: 5.515729603008367 sec
Time for inference 7: 6.06 sec total, 2702.35 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5203.53 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.5463991810102016 sec
Decode latency: 5.518914264044724 sec
Time for inference 8: 6.07 sec total, 2700.83 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5200.61 GB/s
FLOPS achieved: 26.00 TF/s

Prefill latency: 0.5465548809152097 sec
Decode latency: 5.518954272032715 sec
Time for inference 9: 6.07 sec total, 2700.78 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5200.52 GB/s
FLOPS achieved: 26.00 TF/s

Prefill latency: 0.5464860900538042 sec
Decode latency: 5.515803822083399 sec
Time for inference 10: 6.06 sec total, 2702.20 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5203.25 GB/s
FLOPS achieved: 26.02 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.5174 sec
Average prefill latency: 0.5465 sec
Average tokens/sec: 2701.45
Memory used: 43.63 GB
Done. we are killing the process
