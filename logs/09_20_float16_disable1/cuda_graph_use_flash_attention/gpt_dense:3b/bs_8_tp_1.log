flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.93 seconds
[rank0]:[W1001 03:12:38.418789525 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.20223315199837089 sec
Decode latency: 3.6368182150181383 sec
Compilation time: 3.84 seconds
Prefill latency: 0.2029230099869892 sec
Decode latency: 3.6376087040407583 sec
Prefill latency: 0.20287709194235504 sec
Decode latency: 3.6367209849413484 sec
Prefill latency: 0.20300437801051885 sec
Decode latency: 3.6370806680060923 sec
Prefill latency: 0.2024881379911676 sec
Decode latency: 3.6356785231037065 sec
Prefill latency: 0.20288362295832485 sec
Decode latency: 3.636375450063497 sec
Time for inference 1: 3.84 sec total, 533.32 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3744.80 GB/s
FLOPS achieved: 18.72 TF/s

Prefill latency: 0.20293251308612525 sec
Decode latency: 3.636190289980732 sec
Time for inference 2: 3.84 sec total, 533.35 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3745.00 GB/s
FLOPS achieved: 18.72 TF/s

Prefill latency: 0.20310621906537563 sec
Decode latency: 3.6358801359310746 sec
Time for inference 3: 3.84 sec total, 533.37 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3745.15 GB/s
FLOPS achieved: 18.73 TF/s

Prefill latency: 0.20307095092721283 sec
Decode latency: 3.6369594410061836 sec
Time for inference 4: 3.84 sec total, 533.23 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3744.13 GB/s
FLOPS achieved: 18.72 TF/s

Prefill latency: 0.2026189329335466 sec
Decode latency: 3.6365884580882266 sec
Time for inference 5: 3.84 sec total, 533.35 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3744.96 GB/s
FLOPS achieved: 18.72 TF/s

Prefill latency: 0.2027625689515844 sec
Decode latency: 3.634815669967793 sec
Time for inference 6: 3.84 sec total, 533.56 tokens/sec
Decode latency: 3.63 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3746.49 GB/s
FLOPS achieved: 18.73 TF/s

Prefill latency: 0.2036495750071481 sec
Decode latency: 3.6360907760681584 sec
Time for inference 7: 3.84 sec total, 533.25 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3744.32 GB/s
FLOPS achieved: 18.72 TF/s

Prefill latency: 0.20318765204865485 sec
Decode latency: 3.6356790959835052 sec
Time for inference 8: 3.84 sec total, 533.37 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3745.11 GB/s
FLOPS achieved: 18.73 TF/s

Prefill latency: 0.20310772606171668 sec
Decode latency: 3.6353575099492446 sec
Time for inference 9: 3.84 sec total, 533.42 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3745.49 GB/s
FLOPS achieved: 18.73 TF/s

Prefill latency: 0.20336420799139887 sec
Decode latency: 3.635876834974624 sec
Time for inference 10: 3.84 sec total, 533.33 tokens/sec
Decode latency: 3.64 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3744.85 GB/s
FLOPS achieved: 18.72 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6360 sec
Average prefill latency: 0.2031 sec
Average tokens/sec: 533.36
Memory used: 16.44 GB
Done. we are killing the process
