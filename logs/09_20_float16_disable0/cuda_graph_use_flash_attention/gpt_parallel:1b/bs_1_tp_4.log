W0930 19:14:55.958000 22607455799104 torch/distributed/run.py:779] 
W0930 19:14:55.958000 22607455799104 torch/distributed/run.py:779] *****************************************
W0930 19:14:55.958000 22607455799104 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 19:14:55.958000 22607455799104 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=2688, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 0.012198932934552431 sec
Decode latency: 1.761603745049797 sec
Compilation time: 1.78 seconds
Compilation time: 1.80 seconds
Compilation time: 1.77 seconds
Compilation time: 1.78 seconds
Prefill latency: 0.011697727022692561 sec
Decode latency: 1.763089027022943 sec
Prefill latency: 0.011759471031837165 sec
Decode latency: 1.762556361965835 sec
Prefill latency: 0.011713917017914355 sec
Decode latency: 1.7633309239754453 sec
Prefill latency: 0.011792575009167194 sec
Decode latency: 1.765651152934879 sec
Prefill latency: 0.011740774032659829 sec
Decode latency: 1.7617277120007202 sec
Time for inference 1: 1.77 sec total, 144.28 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.43 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011711852974258363 sec
Decode latency: 1.7628776560304686 sec
Time for inference 2: 1.78 sec total, 144.18 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.35 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011730893049389124 sec
Decode latency: 1.7673638579435647 sec
Time for inference 3: 1.78 sec total, 143.80 tokens/sec
Decode latency: 1.77 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.11 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011756143998354673 sec
Decode latency: 1.7635660860687494 sec
Time for inference 4: 1.78 sec total, 144.12 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.32 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011754878098145127 sec
Decode latency: 1.7622153299162164 sec
Time for inference 5: 1.77 sec total, 144.24 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.40 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011693276930600405 sec
Decode latency: 1.762245850986801 sec
Time for inference 6: 1.77 sec total, 144.25 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.40 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011791034950874746 sec
Decode latency: 1.7636564240092412 sec
Time for inference 7: 1.78 sec total, 144.12 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.32 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011778934043832123 sec
Decode latency: 1.7616560850292444 sec
Time for inference 8: 1.77 sec total, 144.28 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.42 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011760498979128897 sec
Decode latency: 1.7618779670447111 sec
Time for inference 9: 1.77 sec total, 144.27 tokens/sec
Decode latency: 1.76 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.42 GB/s
FLOPS achieved: 0.47 TF/s

Prefill latency: 0.011941307922825217 sec
Decode latency: 1.7671737120253965 sec
Time for inference 10: 1.78 sec total, 143.82 tokens/sec
Decode latency: 1.77 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 94.12 GB/s
FLOPS achieved: 0.47 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.7634 sec
Average prefill latency: 0.0118 sec
Average tokens/sec: 144.14
Memory used: 1.24 GB
Done. we are killing the process
