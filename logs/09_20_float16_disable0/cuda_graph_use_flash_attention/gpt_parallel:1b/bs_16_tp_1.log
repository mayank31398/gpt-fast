flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=10752, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.17785880796145648 sec
Decode latency: 3.7040562389884144 sec
Compilation time: 3.88 seconds
Prefill latency: 0.1773049640469253 sec
Decode latency: 3.7874925379874185 sec
Prefill latency: 0.17715820902958512 sec
Decode latency: 3.7730986210517585 sec
Prefill latency: 0.1772892220178619 sec
Decode latency: 3.7089575519785285 sec
Prefill latency: 0.17736731306649745 sec
Decode latency: 3.6614147989312187 sec
Prefill latency: 0.17732037499081343 sec
Decode latency: 3.7876313099404797 sec
Time for inference 1: 3.97 sec total, 1032.85 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.49 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.17733473097905517 sec
Decode latency: 3.7304317880189046 sec
Time for inference 2: 3.91 sec total, 1047.99 tokens/sec
Decode latency: 3.73 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2268.25 GB/s
FLOPS achieved: 11.34 TF/s

Prefill latency: 0.1773328969720751 sec
Decode latency: 3.6585639509139583 sec
Time for inference 3: 3.84 sec total, 1067.62 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2310.74 GB/s
FLOPS achieved: 11.55 TF/s

Prefill latency: 0.17729044402949512 sec
Decode latency: 3.7890467760153115 sec
Time for inference 4: 3.97 sec total, 1032.52 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2234.77 GB/s
FLOPS achieved: 11.17 TF/s

Prefill latency: 0.1772958190413192 sec
Decode latency: 3.7330833500018343 sec
Time for inference 5: 3.91 sec total, 1047.27 tokens/sec
Decode latency: 3.73 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2266.70 GB/s
FLOPS achieved: 11.33 TF/s

Prefill latency: 0.1774057219736278 sec
Decode latency: 3.7458847340894863 sec
Time for inference 6: 3.92 sec total, 1043.82 tokens/sec
Decode latency: 3.75 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2259.22 GB/s
FLOPS achieved: 11.30 TF/s

Prefill latency: 0.1772714500548318 sec
Decode latency: 3.7881002810318023 sec
Time for inference 7: 3.97 sec total, 1032.75 tokens/sec
Decode latency: 3.79 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2235.26 GB/s
FLOPS achieved: 11.18 TF/s

Prefill latency: 0.17732463998254389 sec
Decode latency: 3.6615111889550462 sec
Time for inference 8: 3.84 sec total, 1066.80 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2308.97 GB/s
FLOPS achieved: 11.54 TF/s

Prefill latency: 0.17735999508295208 sec
Decode latency: 3.726059212931432 sec
Time for inference 9: 3.90 sec total, 1049.15 tokens/sec
Decode latency: 3.73 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2270.76 GB/s
FLOPS achieved: 11.35 TF/s

Prefill latency: 0.17728974809870124 sec
Decode latency: 3.6631100060185418 sec
Time for inference 10: 3.84 sec total, 1066.37 tokens/sec
Decode latency: 3.66 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2308.04 GB/s
FLOPS achieved: 11.54 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.7283 sec
Average prefill latency: 0.1773 sec
Average tokens/sec: 1048.71
Memory used: 9.30 GB
Done. we are killing the process
