W0930 19:32:23.834000 22596855314240 torch/distributed/run.py:779] 
W0930 19:32:23.834000 22596855314240 torch/distributed/run.py:779] *****************************************
W0930 19:32:23.834000 22596855314240 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 19:32:23.834000 22596855314240 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=1344, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.2261165640084073 sec
Decode latency: 3.0372964130947366 sec
Compilation time: 3.23 seconds
Compilation time: 3.23 seconds
Compilation time: 3.24 seconds
Compilation time: 3.27 seconds
Compilation time: 3.22 seconds
Compilation time: 3.23 seconds
Compilation time: 3.20 seconds
Compilation time: 3.20 seconds
Prefill latency: 0.1616009429562837 sec
Decode latency: 3.0359683780698106 sec
Prefill latency: 0.16033790400251746 sec
Decode latency: 3.0377742450218648 sec
Prefill latency: 0.16056319908238947 sec
Decode latency: 3.0391644010087475 sec
Prefill latency: 0.16045975196175277 sec
Decode latency: 3.0380065500503406 sec
Prefill latency: 0.16033554798923433 sec
Decode latency: 3.0382407259894535 sec
Time for inference 1: 3.20 sec total, 5120.85 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2062.57 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16037078201770782 sec
Decode latency: 3.0370369540760294 sec
Time for inference 2: 3.20 sec total, 5122.95 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2063.42 GB/s
FLOPS achieved: 10.32 TF/s

Prefill latency: 0.16036987502593547 sec
Decode latency: 3.039296973962337 sec
Time for inference 3: 3.20 sec total, 5119.18 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.90 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16040304896887392 sec
Decode latency: 3.0385168639477342 sec
Time for inference 4: 3.20 sec total, 5120.59 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2062.47 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16036388091742992 sec
Decode latency: 3.0399998030625284 sec
Time for inference 5: 3.20 sec total, 5117.95 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.40 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.1604431050363928 sec
Decode latency: 3.0395109839737415 sec
Time for inference 6: 3.20 sec total, 5118.69 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.70 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16045543504878879 sec
Decode latency: 3.0394589649513364 sec
Time for inference 7: 3.20 sec total, 5118.82 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.75 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16078059491701424 sec
Decode latency: 3.037228208966553 sec
Time for inference 8: 3.20 sec total, 5121.84 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2062.97 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16080138692632318 sec
Decode latency: 3.038977748947218 sec
Time for inference 9: 3.20 sec total, 5119.02 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.83 GB/s
FLOPS achieved: 10.31 TF/s

Prefill latency: 0.16040999605320394 sec
Decode latency: 3.0395191189600155 sec
Time for inference 10: 3.20 sec total, 5118.62 tokens/sec
Decode latency: 3.04 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 2061.67 GB/s
FLOPS achieved: 10.31 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0388 sec
Average prefill latency: 0.1605 sec
Average tokens/sec: 5119.85
Memory used: 20.12 GB
Done. we are killing the process
