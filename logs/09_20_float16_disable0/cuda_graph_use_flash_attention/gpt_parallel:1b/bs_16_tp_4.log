W1001 02:16:19.477000 22960927627072 torch/distributed/run.py:779] 
W1001 02:16:19.477000 22960927627072 torch/distributed/run.py:779] *****************************************
W1001 02:16:19.477000 22960927627072 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:16:19.477000 22960927627072 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=3200, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.09189489099662751 sec
Decode latency: 2.3790936009027064 sec
Compilation time: 2.47 seconds
Compilation time: 2.45 seconds
Compilation time: 2.47 seconds
Compilation time: 2.48 seconds
Prefill latency: 0.07162257097661495 sec
Decode latency: 2.3749847690341994 sec
Prefill latency: 0.07138911506626755 sec
Decode latency: 2.3760090769501403 sec
Prefill latency: 0.07149723696056753 sec
Decode latency: 2.374851463944651 sec
Prefill latency: 0.07142617600038648 sec
Decode latency: 2.374159440980293 sec
Prefill latency: 0.07158120791427791 sec
Decode latency: 2.374482849962078 sec
Time for inference 1: 2.45 sec total, 1673.92 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.79 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07127024990040809 sec
Decode latency: 2.374312578001991 sec
Time for inference 2: 2.45 sec total, 1674.16 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.96 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07122238399460912 sec
Decode latency: 2.3744372070068493 sec
Time for inference 3: 2.45 sec total, 1673.92 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.79 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07136238005477935 sec
Decode latency: 2.374813806032762 sec
Time for inference 4: 2.45 sec total, 1673.73 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.65 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07159282604698092 sec
Decode latency: 2.373765349970199 sec
Time for inference 5: 2.45 sec total, 1674.39 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1201.13 GB/s
FLOPS achieved: 6.01 TF/s

Prefill latency: 0.07149590190965682 sec
Decode latency: 2.3747982140630484 sec
Time for inference 6: 2.45 sec total, 1673.80 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.71 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07132136099971831 sec
Decode latency: 2.3744982989737764 sec
Time for inference 7: 2.45 sec total, 1674.09 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.91 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07132183900102973 sec
Decode latency: 2.374729678966105 sec
Time for inference 8: 2.45 sec total, 1673.78 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1200.69 GB/s
FLOPS achieved: 6.00 TF/s

Prefill latency: 0.07122313498985022 sec
Decode latency: 2.373933642054908 sec
Time for inference 9: 2.45 sec total, 1674.60 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1201.28 GB/s
FLOPS achieved: 6.01 TF/s

Prefill latency: 0.07157719298265874 sec
Decode latency: 2.3739992460468784 sec
Time for inference 10: 2.45 sec total, 1674.33 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1201.08 GB/s
FLOPS achieved: 6.01 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3744 sec
Average prefill latency: 0.0714 sec
Average tokens/sec: 1674.07
Memory used: 6.85 GB
Done. we are killing the process
