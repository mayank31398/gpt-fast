W0930 19:17:48.500000 22546316834624 torch/distributed/run.py:779] 
W0930 19:17:48.500000 22546316834624 torch/distributed/run.py:779] *****************************************
W0930 19:17:48.500000 22546316834624 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 19:17:48.500000 22546316834624 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=2688, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.021503802970983088 sec
Decode latency: 1.9963729860028252 sec
Compilation time: 2.04 seconds
Compilation time: 2.04 seconds
Compilation time: 2.02 seconds
Compilation time: 2.04 seconds
Prefill latency: 0.02109769103117287 sec
Decode latency: 1.9937908289721236 sec
Prefill latency: 0.021106036030687392 sec
Decode latency: 1.9944533869856969 sec
Prefill latency: 0.02111708198208362 sec
Decode latency: 1.994988524937071 sec
Prefill latency: 0.021128166932612658 sec
Decode latency: 1.9950151549419388 sec
Prefill latency: 0.02107446303125471 sec
Decode latency: 1.9946587219601497 sec
Time for inference 1: 2.02 sec total, 507.75 tokens/sec
Decode latency: 1.99 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.29 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021097722928971052 sec
Decode latency: 1.9950773059390485 sec
Time for inference 2: 2.02 sec total, 507.66 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.23 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021176756941713393 sec
Decode latency: 1.995713016949594 sec
Time for inference 3: 2.02 sec total, 507.48 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.11 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021132485009729862 sec
Decode latency: 1.9956707450328395 sec
Time for inference 4: 2.02 sec total, 507.55 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.16 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021140686003491282 sec
Decode latency: 1.9955694110831246 sec
Time for inference 5: 2.02 sec total, 507.49 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.12 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021112160990014672 sec
Decode latency: 1.9959435310447589 sec
Time for inference 6: 2.02 sec total, 507.47 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.11 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021147799910977483 sec
Decode latency: 1.9963129269890487 sec
Time for inference 7: 2.02 sec total, 507.37 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.04 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.02104614395648241 sec
Decode latency: 1.9954053189139813 sec
Time for inference 8: 2.02 sec total, 507.63 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.21 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021117592928931117 sec
Decode latency: 1.9951677119825035 sec
Time for inference 9: 2.02 sec total, 507.66 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.23 GB/s
FLOPS achieved: 1.66 TF/s

Prefill latency: 0.021089989924803376 sec
Decode latency: 1.9964206259464845 sec
Time for inference 10: 2.02 sec total, 507.33 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 332.01 GB/s
FLOPS achieved: 1.66 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9956 sec
Average prefill latency: 0.0211 sec
Average tokens/sec: 507.54
Memory used: 2.08 GB
Done. we are killing the process
