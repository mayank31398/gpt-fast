W0930 19:31:09.243000 23353110947648 torch/distributed/run.py:779] 
W0930 19:31:09.243000 23353110947648 torch/distributed/run.py:779] *****************************************
W0930 19:31:09.243000 23353110947648 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 19:31:09.243000 23353110947648 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=1536, out_features=2688, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.10 seconds
Prefill latency: 0.24202405102550983 sec
Decode latency: 3.8499996019527316 sec
Compilation time: 4.16 seconds
Compilation time: 4.09 seconds
Compilation time: 4.13 seconds
Compilation time: 4.10 seconds
Prefill latency: 0.24128366902004927 sec
Decode latency: 3.848210958065465 sec
Prefill latency: 0.241348801064305 sec
Decode latency: 3.8510279579786584 sec
Prefill latency: 0.2414494650438428 sec
Decode latency: 3.8502340520499274 sec
Prefill latency: 0.24151506193447858 sec
Decode latency: 3.848081891075708 sec
Prefill latency: 0.24165107402950525 sec
Decode latency: 3.8505456580314785 sec
Time for inference 1: 4.09 sec total, 4002.97 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2619.69 GB/s
FLOPS achieved: 13.10 TF/s

Prefill latency: 0.24143975297920406 sec
Decode latency: 3.8485420839861035 sec
Time for inference 2: 4.09 sec total, 4004.97 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2621.00 GB/s
FLOPS achieved: 13.11 TF/s

Prefill latency: 0.24144238396547735 sec
Decode latency: 3.8518310911022127 sec
Time for inference 3: 4.09 sec total, 4001.75 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2618.90 GB/s
FLOPS achieved: 13.09 TF/s

Prefill latency: 0.24151687801349908 sec
Decode latency: 3.8504725280217826 sec
Time for inference 4: 4.09 sec total, 4003.07 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2619.76 GB/s
FLOPS achieved: 13.10 TF/s

Prefill latency: 0.24172429798636585 sec
Decode latency: 3.8465445790207013 sec
Time for inference 5: 4.09 sec total, 4006.61 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2622.07 GB/s
FLOPS achieved: 13.11 TF/s

Prefill latency: 0.24185880098957568 sec
Decode latency: 3.8512881429633126 sec
Time for inference 6: 4.09 sec total, 4002.01 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2619.06 GB/s
FLOPS achieved: 13.10 TF/s

Prefill latency: 0.24168430105783045 sec
Decode latency: 3.848288872046396 sec
Time for inference 7: 4.09 sec total, 4005.14 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2621.11 GB/s
FLOPS achieved: 13.11 TF/s

Prefill latency: 0.24177659302949905 sec
Decode latency: 3.8498209739336744 sec
Time for inference 8: 4.09 sec total, 4003.62 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2620.12 GB/s
FLOPS achieved: 13.10 TF/s

Prefill latency: 0.24181845597922802 sec
Decode latency: 3.8500093210022897 sec
Time for inference 9: 4.09 sec total, 4003.11 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2619.79 GB/s
FLOPS achieved: 13.10 TF/s

Prefill latency: 0.24164547608233988 sec
Decode latency: 3.8465751089388505 sec
Time for inference 10: 4.09 sec total, 4006.44 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.24 sec
Bandwidth achieved: 2621.97 GB/s
FLOPS achieved: 13.11 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8494 sec
Average prefill latency: 0.2417 sec
Average tokens/sec: 4003.97
Memory used: 19.09 GB
Done. we are killing the process
