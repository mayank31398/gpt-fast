W1001 01:57:29.386000 23339556058944 torch/distributed/run.py:779] 
W1001 01:57:29.386000 23339556058944 torch/distributed/run.py:779] *****************************************
W1001 01:57:29.386000 23339556058944 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:57:29.386000 23339556058944 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.99 seconds
Prefill latency: 0.0758608829928562 sec
Decode latency: 2.4584013310959563 sec
Compilation time: 2.55 secondsCompilation time: 2.57 seconds
Compilation time: 2.56 seconds

Compilation time: 2.54 seconds
Prefill latency: 0.07570130401290953 sec
Decode latency: 2.457887655007653 sec
Prefill latency: 0.07564922899473459 sec
Decode latency: 2.4582274530548602 sec
Prefill latency: 0.07570695097092539 sec
Decode latency: 2.4582758779870346 sec
Prefill latency: 0.07570262404624373 sec
Decode latency: 2.457876274944283 sec
Prefill latency: 0.0757117469329387 sec
Decode latency: 2.457520604948513 sec
Time for inference 1: 2.53 sec total, 1616.27 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.64 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07581070810556412 sec
Decode latency: 2.458124254946597 sec
Time for inference 2: 2.53 sec total, 1615.92 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.38 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07565009209793061 sec
Decode latency: 2.4583507020724937 sec
Time for inference 3: 2.53 sec total, 1615.88 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.36 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07575849501881748 sec
Decode latency: 2.4575201970292255 sec
Time for inference 4: 2.53 sec total, 1616.32 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.67 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07578235503751785 sec
Decode latency: 2.4576566260075197 sec
Time for inference 5: 2.53 sec total, 1616.22 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.60 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07572082593105733 sec
Decode latency: 2.4584110870491713 sec
Time for inference 6: 2.53 sec total, 1615.85 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.33 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07566813903395087 sec
Decode latency: 2.458064011996612 sec
Time for inference 7: 2.53 sec total, 1615.99 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.43 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07574686408042908 sec
Decode latency: 2.4578440450131893 sec
Time for inference 8: 2.53 sec total, 1616.04 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.47 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07563690794631839 sec
Decode latency: 2.4580094849225134 sec
Time for inference 9: 2.53 sec total, 1615.90 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1159.37 GB/s
FLOPS achieved: 5.80 TF/s

Prefill latency: 0.07569258601870388 sec
Decode latency: 2.455116326920688 sec
Time for inference 10: 2.53 sec total, 1617.84 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1160.76 GB/s
FLOPS achieved: 5.80 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4577 sec
Average prefill latency: 0.0757 sec
Average tokens/sec: 1616.22
Memory used: 7.01 GB
Done. we are killing the process
