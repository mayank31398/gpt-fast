W1001 01:53:08.520000 22516761073472 torch/distributed/run.py:779] 
W1001 01:53:08.520000 22516761073472 torch/distributed/run.py:779] *****************************************
W1001 01:53:08.520000 22516761073472 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:53:08.520000 22516761073472 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.98 seconds
[rank0]:[W1001 01:53:15.520788525 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.06362843292299658 sec
Decode latency: 2.4575849489774555 sec
Compilation time: 2.55 seconds
Compilation time: 2.52 seconds
Prefill latency: 0.06328182702418417 sec
Decode latency: 2.456578910932876 sec
Prefill latency: 0.06333773396909237 sec
Decode latency: 2.455534594017081 sec
Prefill latency: 0.06329493096563965 sec
Decode latency: 2.4553670480381697 sec
Prefill latency: 0.0632518210913986 sec
Decode latency: 2.455284392926842 sec
Prefill latency: 0.06332732201553881 sec
Decode latency: 2.4532138910144567 sec
Time for inference 1: 2.52 sec total, 813.55 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.35 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06332587904762477 sec
Decode latency: 2.453095330041833 sec
Time for inference 2: 2.52 sec total, 813.60 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.43 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06328610598575324 sec
Decode latency: 2.453502807067707 sec
Time for inference 3: 2.52 sec total, 813.49 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.28 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06332113803364336 sec
Decode latency: 2.453886565985158 sec
Time for inference 4: 2.52 sec total, 813.39 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.16 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06335006305016577 sec
Decode latency: 2.4543755690101534 sec
Time for inference 5: 2.52 sec total, 813.19 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1043.90 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06326389301102608 sec
Decode latency: 2.454177759005688 sec
Time for inference 6: 2.52 sec total, 813.29 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.02 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06330507306847721 sec
Decode latency: 2.4548816569149494 sec
Time for inference 7: 2.52 sec total, 812.98 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1043.63 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.0632974379695952 sec
Decode latency: 2.455014909966849 sec
Time for inference 8: 2.52 sec total, 812.94 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1043.57 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.0632809610106051 sec
Decode latency: 2.453587246942334 sec
Time for inference 9: 2.52 sec total, 813.48 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.27 GB/s
FLOPS achieved: 5.22 TF/s

Prefill latency: 0.06333955889567733 sec
Decode latency: 2.454082979937084 sec
Time for inference 10: 2.52 sec total, 813.27 tokens/sec
Decode latency: 2.45 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1044.00 GB/s
FLOPS achieved: 5.22 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4540 sec
Average prefill latency: 0.0633 sec
Average tokens/sec: 813.32
Memory used: 5.34 GB
Done. we are killing the process
