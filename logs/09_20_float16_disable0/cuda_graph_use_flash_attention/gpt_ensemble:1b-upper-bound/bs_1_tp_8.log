W1001 01:48:21.811000 22843411810112 torch/distributed/run.py:779] 
W1001 01:48:21.811000 22843411810112 torch/distributed/run.py:779] *****************************************
W1001 01:48:21.811000 22843411810112 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:48:21.811000 22843411810112 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.25 seconds
Prefill latency: 0.033200007979758084 sec
Decode latency: 1.8353250829968601 sec
Compilation time: 1.85 secondsCompilation time: 1.88 secondsCompilation time: 1.86 seconds


Compilation time: 1.85 seconds
Compilation time: 1.87 seconds
Compilation time: 1.85 seconds
Compilation time: 1.85 secondsCompilation time: 1.87 seconds

Prefill latency: 0.01237734907772392 sec
Decode latency: 1.833687803009525 sec
Prefill latency: 0.012096805032342672 sec
Decode latency: 1.8351662330096588 sec
Prefill latency: 0.012129110051319003 sec
Decode latency: 1.8357872180640697 sec
Prefill latency: 0.012180060031823814 sec
Decode latency: 1.8356039329664782 sec
Prefill latency: 0.012069985968992114 sec
Decode latency: 1.8336636869935319 sec
Time for inference 1: 1.85 sec total, 138.61 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.21 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.012058483087457716 sec
Decode latency: 1.8350942579563707 sec
Time for inference 2: 1.85 sec total, 138.53 tokens/sec
Decode latency: 1.84 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.17 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.01198150496929884 sec
Decode latency: 1.8347234429093078 sec
Time for inference 3: 1.85 sec total, 138.57 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.19 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.011958841001614928 sec
Decode latency: 1.8354071769863367 sec
Time for inference 4: 1.85 sec total, 138.53 tokens/sec
Decode latency: 1.84 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.17 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.012063101981766522 sec
Decode latency: 1.8340328220510855 sec
Time for inference 5: 1.85 sec total, 138.62 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.21 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.011915827984921634 sec
Decode latency: 1.8319058420602232 sec
Time for inference 6: 1.84 sec total, 138.79 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.29 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.01228443591389805 sec
Decode latency: 1.8343080090126023 sec
Time for inference 7: 1.85 sec total, 138.58 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.19 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.011904128943569958 sec
Decode latency: 1.8325542689999565 sec
Time for inference 8: 1.85 sec total, 138.73 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.26 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.011984410928562284 sec
Decode latency: 1.8339216189924628 sec
Time for inference 9: 1.85 sec total, 138.63 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.21 GB/s
FLOPS achieved: 0.30 TF/s

Prefill latency: 0.011982575990259647 sec
Decode latency: 1.8346218169899657 sec
Time for inference 10: 1.85 sec total, 138.58 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 60.19 GB/s
FLOPS achieved: 0.30 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8340 sec
Average prefill latency: 0.0120 sec
Average tokens/sec: 138.62
Memory used: 1.04 GB
Done. we are killing the process
