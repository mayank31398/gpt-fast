flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
[rank0]:[W1001 01:52:23.336264828 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.10798955103382468 sec
Decode latency: 2.7308484819950536 sec
Compilation time: 2.84 seconds
Prefill latency: 0.10757431609090418 sec
Decode latency: 2.749703262001276 sec
Prefill latency: 0.10752402793150395 sec
Decode latency: 2.749866248923354 sec
Prefill latency: 0.10756564897019416 sec
Decode latency: 2.750522364047356 sec
Prefill latency: 0.10744426597375423 sec
Decode latency: 2.749317493988201 sec
Prefill latency: 0.1074329880066216 sec
Decode latency: 2.7498441439820454 sec
Time for inference 1: 2.86 sec total, 716.56 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.32 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10754156298935413 sec
Decode latency: 2.6511823559412733 sec
Time for inference 2: 2.76 sec total, 742.15 tokens/sec
Decode latency: 2.65 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1793.15 GB/s
FLOPS achieved: 8.97 TF/s

Prefill latency: 0.10749011894222349 sec
Decode latency: 2.750399858923629 sec
Time for inference 3: 2.86 sec total, 716.43 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.01 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10756896797101945 sec
Decode latency: 2.7497555629815906 sec
Time for inference 4: 2.86 sec total, 716.52 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.22 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10751673299819231 sec
Decode latency: 2.724711057031527 sec
Time for inference 5: 2.83 sec total, 722.87 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1746.56 GB/s
FLOPS achieved: 8.73 TF/s

Prefill latency: 0.1074761999770999 sec
Decode latency: 2.750157392001711 sec
Time for inference 6: 2.86 sec total, 716.47 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.10 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10744238900952041 sec
Decode latency: 2.7505491139600053 sec
Time for inference 7: 2.86 sec total, 716.40 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1730.95 GB/s
FLOPS achieved: 8.65 TF/s

Prefill latency: 0.10743611305952072 sec
Decode latency: 2.750243806047365 sec
Time for inference 8: 2.86 sec total, 716.48 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.13 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10746718698646873 sec
Decode latency: 2.750196321052499 sec
Time for inference 9: 2.86 sec total, 716.47 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1731.10 GB/s
FLOPS achieved: 8.66 TF/s

Prefill latency: 0.10750810394529253 sec
Decode latency: 2.748440069030039 sec
Time for inference 10: 2.86 sec total, 716.92 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1732.21 GB/s
FLOPS achieved: 8.66 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7375 sec
Average prefill latency: 0.1075 sec
Average tokens/sec: 719.72
Memory used: 7.72 GB
Done. we are killing the process
