flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.814529808005318 sec
Decode latency: 8.643334875931032 sec
Compilation time: 9.46 seconds
Prefill latency: 0.8143704130779952 sec
Decode latency: 8.646791919018142 sec
Prefill latency: 0.8139348939293995 sec
Decode latency: 8.552059305016883 sec
Prefill latency: 0.8128344470169395 sec
Decode latency: 8.61666790896561 sec
Prefill latency: 0.8110903369961306 sec
Decode latency: 8.621260098996572 sec
Prefill latency: 0.8111465589608997 sec
Decode latency: 8.649706399999559 sec
Time for inference 1: 9.46 sec total, 1731.57 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4183.77 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8112102230079472 sec
Decode latency: 8.647111839964055 sec
Time for inference 2: 9.46 sec total, 1732.05 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.92 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8109587070066482 sec
Decode latency: 8.649009916000068 sec
Time for inference 3: 9.46 sec total, 1731.74 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.18 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.811096329940483 sec
Decode latency: 8.612349031958729 sec
Time for inference 4: 9.42 sec total, 1738.46 tokens/sec
Decode latency: 8.61 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4200.41 GB/s
FLOPS achieved: 21.00 TF/s

Prefill latency: 0.811235710978508 sec
Decode latency: 8.646745409932919 sec
Time for inference 5: 9.46 sec total, 1732.09 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4185.03 GB/s
FLOPS achieved: 20.93 TF/s

Prefill latency: 0.8109145219204947 sec
Decode latency: 8.646403457038105 sec
Time for inference 6: 9.46 sec total, 1732.23 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4185.35 GB/s
FLOPS achieved: 20.93 TF/s

Prefill latency: 0.8110754028894007 sec
Decode latency: 8.647428653086536 sec
Time for inference 7: 9.46 sec total, 1732.02 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.84 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8110512479906902 sec
Decode latency: 8.647952276980504 sec
Time for inference 8: 9.46 sec total, 1731.93 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.63 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8110793939558789 sec
Decode latency: 8.64818492392078 sec
Time for inference 9: 9.46 sec total, 1731.86 tokens/sec
Decode latency: 8.65 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4184.48 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8109298429917544 sec
Decode latency: 8.547864240943454 sec
Time for inference 10: 9.36 sec total, 1750.48 tokens/sec
Decode latency: 8.55 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4229.46 GB/s
FLOPS achieved: 21.15 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.6343 sec
Average prefill latency: 0.8111 sec
Average tokens/sec: 1734.44
Memory used: 42.10 GB
Done. we are killing the process
