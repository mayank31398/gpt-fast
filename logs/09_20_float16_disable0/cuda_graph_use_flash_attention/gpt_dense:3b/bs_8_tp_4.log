W1001 01:34:45.970000 23331087636288 torch/distributed/run.py:779] 
W1001 01:34:45.970000 23331087636288 torch/distributed/run.py:779] *****************************************
W1001 01:34:45.970000 23331087636288 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:34:45.970000 23331087636288 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.26 seconds
Prefill latency: 0.14223441889043897 sec
Decode latency: 2.699964383034967 sec
Compilation time: 2.84 seconds
Compilation time: 2.78 seconds
Compilation time: 2.82 seconds
Compilation time: 2.80 seconds
Prefill latency: 0.07692847901489586 sec
Decode latency: 2.6966487480094656 sec
Prefill latency: 0.07684835908003151 sec
Decode latency: 2.697175740962848 sec
Prefill latency: 0.07689136790577322 sec
Decode latency: 2.6976791030028835 sec
Prefill latency: 0.07665765401907265 sec
Decode latency: 2.6959484820254147 sec
Prefill latency: 0.0768049448961392 sec
Decode latency: 2.6972520329291 sec
Time for inference 1: 2.77 sec total, 738.04 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.14 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.0768245339859277 sec
Decode latency: 2.6975042480044067 sec
Time for inference 2: 2.78 sec total, 737.97 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.00 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07687215402256697 sec
Decode latency: 2.697414599941112 sec
Time for inference 3: 2.78 sec total, 738.01 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.08 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07676947803702205 sec
Decode latency: 2.6968449300620705 sec
Time for inference 4: 2.77 sec total, 738.15 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.36 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07681585696991533 sec
Decode latency: 2.6974751569796354 sec
Time for inference 5: 2.78 sec total, 737.98 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.02 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07688381697516888 sec
Decode latency: 2.697404408012517 sec
Time for inference 6: 2.78 sec total, 737.94 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1420.95 GB/s
FLOPS achieved: 7.10 TF/s

Prefill latency: 0.07695435092318803 sec
Decode latency: 2.696696526953019 sec
Time for inference 7: 2.77 sec total, 738.14 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.32 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07677558402065188 sec
Decode latency: 2.6971106940181926 sec
Time for inference 8: 2.77 sec total, 738.10 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.25 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.0768436350626871 sec
Decode latency: 2.6974654200021178 sec
Time for inference 9: 2.78 sec total, 737.99 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.03 GB/s
FLOPS achieved: 7.11 TF/s

Prefill latency: 0.07681645208504051 sec
Decode latency: 2.6970074150012806 sec
Time for inference 10: 2.77 sec total, 738.13 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1421.31 GB/s
FLOPS achieved: 7.11 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6972 sec
Average prefill latency: 0.0768 sec
Average tokens/sec: 738.04
Memory used: 7.67 GB
Done. we are killing the process
