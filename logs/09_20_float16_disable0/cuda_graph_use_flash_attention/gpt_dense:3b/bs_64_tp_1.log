flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.90 seconds
[rank0]:[W1001 01:39:50.052087474 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 1.617543735075742 sec
Decode latency: 12.808550558052957 sec
Compilation time: 14.43 seconds
Prefill latency: 1.6161031629890203 sec
Decode latency: 12.807744391961023 sec
Prefill latency: 1.62501883902587 sec
Decode latency: 12.813630491960794 sec
Prefill latency: 1.6261916370131075 sec
Decode latency: 12.813595562940463 sec
Prefill latency: 1.6247411359800026 sec
Decode latency: 12.811646947055124 sec
Prefill latency: 1.6272088189143687 sec
Decode latency: 12.809140011901036 sec
Time for inference 1: 14.44 sec total, 1134.83 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7968.36 GB/s
FLOPS achieved: 39.84 TF/s

Prefill latency: 1.6155800459673628 sec
Decode latency: 12.81058125605341 sec
Time for inference 2: 14.43 sec total, 1135.63 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7973.97 GB/s
FLOPS achieved: 39.87 TF/s

Prefill latency: 1.6225423199357465 sec
Decode latency: 12.81344053405337 sec
Time for inference 3: 14.44 sec total, 1134.86 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7968.58 GB/s
FLOPS achieved: 39.84 TF/s

Prefill latency: 1.6251657889224589 sec
Decode latency: 12.81027987296693 sec
Time for inference 4: 14.44 sec total, 1134.90 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7968.89 GB/s
FLOPS achieved: 39.84 TF/s

Prefill latency: 1.6284780809655786 sec
Decode latency: 12.811990085989237 sec
Time for inference 5: 14.44 sec total, 1134.51 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7966.15 GB/s
FLOPS achieved: 39.83 TF/s

Prefill latency: 1.627139808028005 sec
Decode latency: 12.81333121296484 sec
Time for inference 6: 14.44 sec total, 1134.51 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7966.14 GB/s
FLOPS achieved: 39.83 TF/s

Prefill latency: 1.6258533239597455 sec
Decode latency: 12.811138867982663 sec
Time for inference 7: 14.44 sec total, 1134.78 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7968.03 GB/s
FLOPS achieved: 39.84 TF/s

Prefill latency: 1.6272260780679062 sec
Decode latency: 12.81281872105319 sec
Time for inference 8: 14.44 sec total, 1134.55 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7966.38 GB/s
FLOPS achieved: 39.83 TF/s

Prefill latency: 1.626350661041215 sec
Decode latency: 12.808614948997274 sec
Time for inference 9: 14.44 sec total, 1134.95 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7969.19 GB/s
FLOPS achieved: 39.85 TF/s

Prefill latency: 1.615529639995657 sec
Decode latency: 12.809611669974402 sec
Time for inference 10: 14.43 sec total, 1135.72 tokens/sec
Decode latency: 12.81 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7974.59 GB/s
FLOPS achieved: 39.87 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.8111 sec
Average prefill latency: 1.6241 sec
Average tokens/sec: 1134.92
Memory used: 77.37 GB
Done. we are killing the process
