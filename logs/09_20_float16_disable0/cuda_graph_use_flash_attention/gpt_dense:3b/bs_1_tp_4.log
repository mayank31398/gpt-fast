W1001 01:28:56.334000 22831923554112 torch/distributed/run.py:779] 
W1001 01:28:56.334000 22831923554112 torch/distributed/run.py:779] *****************************************
W1001 01:28:56.334000 22831923554112 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:28:56.334000 22831923554112 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.17 seconds
Prefill latency: 0.024490664014592767 sec
Decode latency: 2.3326788400299847 sec
Compilation time: 2.40 seconds
Compilation time: 2.35 seconds
Compilation time: 2.36 seconds
Compilation time: 2.36 seconds
Prefill latency: 0.01950935006607324 sec
Decode latency: 2.3321550679393113 sec
Prefill latency: 0.019455180037766695 sec
Decode latency: 2.332652210025117 sec
Prefill latency: 0.019557538093067706 sec
Decode latency: 2.3325535639887676 sec
Prefill latency: 0.01946464693173766 sec
Decode latency: 2.332702715997584 sec
Prefill latency: 0.01952441909816116 sec
Decode latency: 2.3320170290535316 sec
Time for inference 1: 2.35 sec total, 108.82 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.55 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.01955003698822111 sec
Decode latency: 2.332731279078871 sec
Time for inference 2: 2.35 sec total, 108.79 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.48 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.01943876699078828 sec
Decode latency: 2.333622512058355 sec
Time for inference 3: 2.35 sec total, 108.76 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.42 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.01952167006675154 sec
Decode latency: 2.3323888489976525 sec
Time for inference 4: 2.35 sec total, 108.81 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.52 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.019532977021299303 sec
Decode latency: 2.332119495025836 sec
Time for inference 5: 2.35 sec total, 108.82 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.55 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.01953518798109144 sec
Decode latency: 2.3331973620224744 sec
Time for inference 6: 2.35 sec total, 108.77 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.44 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.019444948062300682 sec
Decode latency: 2.3322551619494334 sec
Time for inference 7: 2.35 sec total, 108.82 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.54 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.019491133047267795 sec
Decode latency: 2.333139072987251 sec
Time for inference 8: 2.35 sec total, 108.78 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.46 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.019487251993268728 sec
Decode latency: 2.3315789999905974 sec
Time for inference 9: 2.35 sec total, 108.83 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.57 GB/s
FLOPS achieved: 1.05 TF/s

Prefill latency: 0.019435294903814793 sec
Decode latency: 2.3310118230292574 sec
Time for inference 10: 2.35 sec total, 108.88 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 209.65 GB/s
FLOPS achieved: 1.05 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3324 sec
Average prefill latency: 0.0195 sec
Average tokens/sec: 108.81
Memory used: 3.03 GB
Done. we are killing the process
