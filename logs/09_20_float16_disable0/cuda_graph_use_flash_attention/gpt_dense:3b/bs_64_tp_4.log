W1001 01:45:50.430000 23180048127808 torch/distributed/run.py:779] 
W1001 01:45:50.430000 23180048127808 torch/distributed/run.py:779] *****************************************
W1001 01:45:50.430000 23180048127808 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:45:50.430000 23180048127808 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.13 seconds
Prefill latency: 0.559889717027545 sec
Decode latency: 5.158806357067078 sec
Compilation time: 5.79 seconds
Compilation time: 5.71 seconds
Compilation time: 5.71 seconds
Compilation time: 5.72 seconds
Prefill latency: 0.5501964030554518 sec
Decode latency: 5.159995367983356 sec
Prefill latency: 0.5499544510385022 sec
Decode latency: 5.159946023020893 sec
Prefill latency: 0.5501104430295527 sec
Decode latency: 5.159850552910939 sec
Prefill latency: 0.5501921470277011 sec
Decode latency: 5.158160735969432 sec
Prefill latency: 0.5503594310721382 sec
Decode latency: 5.158669025055133 sec
Time for inference 1: 5.71 sec total, 2869.40 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5525.20 GB/s
FLOPS achieved: 27.63 TF/s

Prefill latency: 0.5502743200631812 sec
Decode latency: 5.157769102952443 sec
Time for inference 2: 5.71 sec total, 2869.89 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5526.14 GB/s
FLOPS achieved: 27.63 TF/s

Prefill latency: 0.5506760569987819 sec
Decode latency: 5.157200088026002 sec
Time for inference 3: 5.71 sec total, 2870.01 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5526.37 GB/s
FLOPS achieved: 27.63 TF/s

Prefill latency: 0.5503242349950597 sec
Decode latency: 5.156633111066185 sec
Time for inference 4: 5.71 sec total, 2870.40 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5527.12 GB/s
FLOPS achieved: 27.64 TF/s

Prefill latency: 0.5502492620144039 sec
Decode latency: 5.158098260988481 sec
Time for inference 5: 5.71 sec total, 2869.71 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5525.80 GB/s
FLOPS achieved: 27.63 TF/s

Prefill latency: 0.5506724019069225 sec
Decode latency: 5.155962647986598 sec
Time for inference 6: 5.71 sec total, 2870.60 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5527.50 GB/s
FLOPS achieved: 27.64 TF/s

Prefill latency: 0.5503934270236641 sec
Decode latency: 5.1592619670554996 sec
Time for inference 7: 5.71 sec total, 2869.12 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5524.66 GB/s
FLOPS achieved: 27.62 TF/s

Prefill latency: 0.5510985680157319 sec
Decode latency: 5.157297644065693 sec
Time for inference 8: 5.71 sec total, 2869.75 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5525.87 GB/s
FLOPS achieved: 27.63 TF/s

Prefill latency: 0.5506007320946082 sec
Decode latency: 5.1610219199210405 sec
Time for inference 9: 5.71 sec total, 2868.08 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5522.65 GB/s
FLOPS achieved: 27.61 TF/s

Prefill latency: 0.5505172939738259 sec
Decode latency: 5.156146571971476 sec
Time for inference 10: 5.71 sec total, 2870.50 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.55 sec
Bandwidth achieved: 5527.31 GB/s
FLOPS achieved: 27.64 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1578 sec
Average prefill latency: 0.5505 sec
Average tokens/sec: 2869.75
Memory used: 43.63 GB
Done. we are killing the process
