flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
[rank0]:[W1001 01:27:27.221011146 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.03255642997100949 sec
Decode latency: 2.462368278997019 sec
Compilation time: 2.50 seconds
Prefill latency: 0.032256106031127274 sec
Decode latency: 2.589020711951889 sec
Prefill latency: 0.03230499103665352 sec
Decode latency: 2.5892926478991285 sec
Prefill latency: 0.0322310320334509 sec
Decode latency: 2.5897017830284312 sec
Prefill latency: 0.032320431899279356 sec
Decode latency: 2.5896008670097217 sec
Prefill latency: 0.032254924066364765 sec
Decode latency: 2.581157271983102 sec
Time for inference 1: 2.61 sec total, 97.93 tokens/sec
Decode latency: 2.58 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 687.61 GB/s
FLOPS achieved: 3.44 TF/s

Prefill latency: 0.03223268303554505 sec
Decode latency: 2.587575246929191 sec
Time for inference 2: 2.62 sec total, 97.69 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.93 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03226342797279358 sec
Decode latency: 2.5885614200960845 sec
Time for inference 3: 2.62 sec total, 97.65 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.66 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03230238088872284 sec
Decode latency: 2.5436247230973095 sec
Time for inference 4: 2.58 sec total, 99.35 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 697.59 GB/s
FLOPS achieved: 3.49 TF/s

Prefill latency: 0.03231431997846812 sec
Decode latency: 2.5878661510068923 sec
Time for inference 5: 2.62 sec total, 97.67 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.82 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.032306942041032016 sec
Decode latency: 2.504769975086674 sec
Time for inference 6: 2.54 sec total, 100.87 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 708.25 GB/s
FLOPS achieved: 3.54 TF/s

Prefill latency: 0.032292423071339726 sec
Decode latency: 2.586956012994051 sec
Time for inference 7: 2.62 sec total, 97.71 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 686.07 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03227215295191854 sec
Decode latency: 2.5873167770914733 sec
Time for inference 8: 2.62 sec total, 97.70 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.99 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.032303047948516905 sec
Decode latency: 2.5872581580188125 sec
Time for inference 9: 2.62 sec total, 97.70 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 686.00 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03226308000739664 sec
Decode latency: 2.585625438950956 sec
Time for inference 10: 2.62 sec total, 97.76 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 686.45 GB/s
FLOPS achieved: 3.43 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5741 sec
Average prefill latency: 0.0323 sec
Average tokens/sec: 98.20
Memory used: 8.81 GB
Done. we are killing the process
