W1001 01:38:30.559000 23412125374272 torch/distributed/run.py:779] 
W1001 01:38:30.559000 23412125374272 torch/distributed/run.py:779] *****************************************
W1001 01:38:30.559000 23412125374272 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:38:30.559000 23412125374272 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.14440928702242672 sec
Decode latency: 2.986328375991434 sec
Compilation time: 3.13 seconds
Compilation time: 3.18 seconds
Compilation time: 3.18 seconds
Compilation time: 3.13 seconds
Prefill latency: 0.14407589507754892 sec
Decode latency: 2.986811859998852 sec
Prefill latency: 0.14384145510848612 sec
Decode latency: 2.985303053050302 sec
Prefill latency: 0.14393563603516668 sec
Decode latency: 2.985853280988522 sec
Prefill latency: 0.14386995800305158 sec
Decode latency: 2.986753858975135 sec
Prefill latency: 0.14376212609931827 sec
Decode latency: 2.9863864210201427 sec
Time for inference 1: 3.13 sec total, 1308.18 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2518.99 GB/s
FLOPS achieved: 12.59 TF/s

Prefill latency: 0.14378383406437933 sec
Decode latency: 2.986128840013407 sec
Time for inference 2: 3.13 sec total, 1308.31 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.22 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.14393383893184364 sec
Decode latency: 2.98525350401178 sec
Time for inference 3: 3.13 sec total, 1308.63 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.85 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.1438173180213198 sec
Decode latency: 2.9862034460529685 sec
Time for inference 4: 3.13 sec total, 1308.31 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.22 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.14385825803037733 sec
Decode latency: 2.9853977079037577 sec
Time for inference 5: 3.13 sec total, 1308.60 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.78 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.1438362319022417 sec
Decode latency: 2.9856260549277067 sec
Time for inference 6: 3.13 sec total, 1308.52 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.64 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.14395959896501154 sec
Decode latency: 2.985277245985344 sec
Time for inference 7: 3.13 sec total, 1308.63 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.85 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.14389683201443404 sec
Decode latency: 2.9858006900176406 sec
Time for inference 8: 3.13 sec total, 1308.39 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2519.39 GB/s
FLOPS achieved: 12.60 TF/s

Prefill latency: 0.14382683392614126 sec
Decode latency: 2.987290350953117 sec
Time for inference 9: 3.13 sec total, 1307.83 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2518.30 GB/s
FLOPS achieved: 12.59 TF/s

Prefill latency: 0.14394013909623027 sec
Decode latency: 2.988506682100706 sec
Time for inference 10: 3.13 sec total, 1307.25 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 2517.20 GB/s
FLOPS achieved: 12.59 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9862 sec
Average prefill latency: 0.1439 sec
Average tokens/sec: 1308.27
Memory used: 12.87 GB
Done. we are killing the process
