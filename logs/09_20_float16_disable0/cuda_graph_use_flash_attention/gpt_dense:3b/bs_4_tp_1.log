flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.1036465319339186 sec
Decode latency: 3.146282411995344 sec
Compilation time: 3.25 seconds
Prefill latency: 0.10305527504533529 sec
Decode latency: 3.1481794479768723 sec
Prefill latency: 0.10308816004544497 sec
Decode latency: 3.148193018976599 sec
Prefill latency: 0.10316234501078725 sec
Decode latency: 3.1480987418908626 sec
Prefill latency: 0.10313461697660387 sec
Decode latency: 3.147231908980757 sec
Prefill latency: 0.1032433439977467 sec
Decode latency: 3.1474874389823526 sec
Time for inference 1: 3.25 sec total, 314.94 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.40 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10306414403021336 sec
Decode latency: 3.1490971989696845 sec
Time for inference 2: 3.25 sec total, 314.79 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2210.32 GB/s
FLOPS achieved: 11.05 TF/s

Prefill latency: 0.10324573901016265 sec
Decode latency: 3.1478598680114374 sec
Time for inference 3: 3.25 sec total, 314.89 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.01 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10316182998940349 sec
Decode latency: 3.1473177160369232 sec
Time for inference 4: 3.25 sec total, 314.95 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.44 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10316159902140498 sec
Decode latency: 3.1477826189948246 sec
Time for inference 5: 3.25 sec total, 314.91 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.15 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10302997997496277 sec
Decode latency: 3.147402745904401 sec
Time for inference 6: 3.25 sec total, 314.95 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.50 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10329595697112381 sec
Decode latency: 3.148558755987324 sec
Time for inference 7: 3.25 sec total, 314.83 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2210.59 GB/s
FLOPS achieved: 11.05 TF/s

Prefill latency: 0.1032467340119183 sec
Decode latency: 3.146667168010026 sec
Time for inference 8: 3.25 sec total, 315.01 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.89 GB/s
FLOPS achieved: 11.06 TF/s

Prefill latency: 0.10339462500996888 sec
Decode latency: 3.1481554890051484 sec
Time for inference 9: 3.25 sec total, 314.85 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2210.77 GB/s
FLOPS achieved: 11.05 TF/s

Prefill latency: 0.10332788492087275 sec
Decode latency: 3.1478392489952967 sec
Time for inference 10: 3.25 sec total, 314.90 tokens/sec
Decode latency: 3.15 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2211.09 GB/s
FLOPS achieved: 11.06 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1478 sec
Average prefill latency: 0.1032 sec
Average tokens/sec: 314.90
Memory used: 12.10 GB
Done. we are killing the process
