flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
[rank0]:[W1001 01:35:56.929381849 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.3958430050406605 sec
Decode latency: 5.261382030905224 sec
Compilation time: 5.66 seconds
Prefill latency: 0.3960732149425894 sec
Decode latency: 5.260913940961473 sec
Prefill latency: 0.3982265150407329 sec
Decode latency: 5.258514830027707 sec
Prefill latency: 0.4002298900159076 sec
Decode latency: 5.260098507045768 sec
Prefill latency: 0.399206283967942 sec
Decode latency: 5.260969750001095 sec
Prefill latency: 0.3984379329485819 sec
Decode latency: 5.261424493044615 sec
Time for inference 1: 5.66 sec total, 723.56 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5080.61 GB/s
FLOPS achieved: 25.40 TF/s

Prefill latency: 0.39734592800959945 sec
Decode latency: 5.2604064049664885 sec
Time for inference 2: 5.66 sec total, 723.84 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5082.51 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3987012270372361 sec
Decode latency: 5.261735528940335 sec
Time for inference 3: 5.66 sec total, 723.51 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5080.22 GB/s
FLOPS achieved: 25.40 TF/s

Prefill latency: 0.3971379679860547 sec
Decode latency: 5.260291117010638 sec
Time for inference 4: 5.66 sec total, 723.90 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5082.95 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3987480819923803 sec
Decode latency: 5.26230196794495 sec
Time for inference 5: 5.66 sec total, 723.41 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5079.54 GB/s
FLOPS achieved: 25.40 TF/s

Prefill latency: 0.3972402709769085 sec
Decode latency: 5.261157158995047 sec
Time for inference 6: 5.66 sec total, 723.74 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5081.86 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3976127099012956 sec
Decode latency: 5.2602476929314435 sec
Time for inference 7: 5.66 sec total, 723.81 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5082.32 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3982466999441385 sec
Decode latency: 5.260568270925432 sec
Time for inference 8: 5.66 sec total, 723.71 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5081.62 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.39830064203124493 sec
Decode latency: 5.259860471007414 sec
Time for inference 9: 5.66 sec total, 723.79 tokens/sec
Decode latency: 5.26 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5082.19 GB/s
FLOPS achieved: 25.41 TF/s

Prefill latency: 0.3991327160038054 sec
Decode latency: 5.2743123199325055 sec
Time for inference 10: 5.67 sec total, 721.84 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5068.52 GB/s
FLOPS achieved: 25.34 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.2622 sec
Average prefill latency: 0.3981 sec
Average tokens/sec: 723.51
Memory used: 25.06 GB
Done. we are killing the process
