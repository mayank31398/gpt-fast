W0928 17:34:46.839000 22748383741760 torch/distributed/run.py:779] 
W0928 17:34:46.839000 22748383741760 torch/distributed/run.py:779] *****************************************
W0928 17:34:46.839000 22748383741760 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:34:46.839000 22748383741760 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=5120, bias=False)
        (wo): Linear(in_features=4096, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 0.6023334079654887 sec
Decode latency: 11.359507431974635 sec
Compilation time: 11.96 seconds
Compilation time: 11.95 seconds
Prefill latency: 0.5953902420005761 sec
Decode latency: 11.358466987032443 sec
Prefill latency: 0.5988401190261357 sec
Decode latency: 11.36100961198099 sec
Prefill latency: 0.5975625379942358 sec
Decode latency: 11.360636092023924 sec
Prefill latency: 0.5930274379788898 sec
Decode latency: 11.35664989403449 sec
Prefill latency: 0.5996177759952843 sec
Decode latency: 11.358218587003648 sec
Time for inference 1: 11.96 sec total, 85.63 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6041.47 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.5977238480118103 sec
Decode latency: 11.357936412037816 sec
Time for inference 2: 11.96 sec total, 85.64 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6042.54 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.5954856040189043 sec
Decode latency: 11.357703242043499 sec
Time for inference 3: 11.95 sec total, 85.66 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6043.81 GB/s
FLOPS achieved: 30.22 TF/s

Prefill latency: 0.5958773520542309 sec
Decode latency: 11.358428373991046 sec
Time for inference 4: 11.96 sec total, 85.65 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6043.29 GB/s
FLOPS achieved: 30.22 TF/s

Prefill latency: 0.5974391300114803 sec
Decode latency: 11.357813214010093 sec
Time for inference 5: 11.96 sec total, 85.65 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6042.76 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.6003491900046356 sec
Decode latency: 11.356383937003557 sec
Time for inference 6: 11.96 sec total, 85.64 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6042.04 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.5968677430064417 sec
Decode latency: 11.360010399017483 sec
Time for inference 7: 11.96 sec total, 85.63 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6041.92 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.597744673024863 sec
Decode latency: 11.356778663001023 sec
Time for inference 8: 11.96 sec total, 85.65 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6043.09 GB/s
FLOPS achieved: 30.22 TF/s

Prefill latency: 0.5982830299763009 sec
Decode latency: 11.356731612992007 sec
Time for inference 9: 11.96 sec total, 85.65 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6042.90 GB/s
FLOPS achieved: 30.21 TF/s

Prefill latency: 0.6016277649905533 sec
Decode latency: 11.357477955985814 sec
Time for inference 10: 11.96 sec total, 85.62 tokens/sec
Decode latency: 11.36 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 6040.80 GB/s
FLOPS achieved: 30.20 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 11.3577 sec
Average prefill latency: 0.5981 sec
Average tokens/sec: 85.64
Memory used: 75.70 GB
Done. we are killing the process
