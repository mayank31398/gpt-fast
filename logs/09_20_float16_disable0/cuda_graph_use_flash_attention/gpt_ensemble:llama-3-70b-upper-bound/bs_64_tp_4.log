W0928 17:56:42.272000 22886672066368 torch/distributed/run.py:779] 
W0928 17:56:42.272000 22886672066368 torch/distributed/run.py:779] *****************************************
W0928 17:56:42.272000 22886672066368 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:56:42.272000 22886672066368 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.24 seconds
Prefill latency: 5.14092900097603 sec
Compilation time: 31.37 seconds
Compilation time: 31.14 seconds
Decode latency: 26.0363414559979 sec
Compilation time: 31.18 seconds
Compilation time: 31.36 seconds
Prefill latency: 5.14893312996719 sec
Decode latency: 26.036469422047958 sec
Prefill latency: 5.146536290005315 sec
Decode latency: 26.036020757979713 sec
Prefill latency: 5.146584259986412 sec
Decode latency: 26.03413152100984 sec
Prefill latency: 5.149843360995874 sec
Decode latency: 26.037657879991457 sec
Prefill latency: 5.149723629991058 sec
Decode latency: 26.03667493996909 sec
Time for inference 1: 31.19 sec total, 525.34 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19085.31 GB/s
FLOPS achieved: 95.43 TF/s

Prefill latency: 5.152554770000279 sec
Decode latency: 26.03788119496312 sec
Time for inference 2: 31.19 sec total, 525.27 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19082.89 GB/s
FLOPS achieved: 95.41 TF/s

Prefill latency: 5.1544125429936685 sec
Decode latency: 26.03775279200636 sec
Time for inference 3: 31.19 sec total, 525.24 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19081.70 GB/s
FLOPS achieved: 95.41 TF/s

Prefill latency: 5.141086757008452 sec
Decode latency: 26.035413678968325 sec
Time for inference 4: 31.18 sec total, 525.50 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.14 sec
Bandwidth achieved: 19091.31 GB/s
FLOPS achieved: 95.46 TF/s

Prefill latency: 5.14937161601847 sec
Decode latency: 25.83460602199193 sec
Time for inference 5: 30.99 sec total, 528.77 tokens/sec
Decode latency: 25.83 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19209.96 GB/s
FLOPS achieved: 96.05 TF/s

Prefill latency: 5.149470710952301 sec
Decode latency: 25.74775466497522 sec
Time for inference 6: 30.90 sec total, 530.25 tokens/sec
Decode latency: 25.75 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19263.89 GB/s
FLOPS achieved: 96.32 TF/s

Prefill latency: 5.151582786988001 sec
Decode latency: 26.036618685990106 sec
Time for inference 7: 31.19 sec total, 525.31 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19084.10 GB/s
FLOPS achieved: 95.42 TF/s

Prefill latency: 5.153923214005772 sec
Decode latency: 26.038582181965467 sec
Time for inference 8: 31.19 sec total, 525.24 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.15 sec
Bandwidth achieved: 19081.54 GB/s
FLOPS achieved: 95.41 TF/s

Prefill latency: 5.1603298529516906 sec
Decode latency: 26.03689905599458 sec
Time for inference 9: 31.20 sec total, 525.16 tokens/sec
Decode latency: 26.04 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19078.63 GB/s
FLOPS achieved: 95.39 TF/s

Prefill latency: 5.156147593981586 sec
Decode latency: 26.00691476999782 sec
Time for inference 10: 31.16 sec total, 525.73 tokens/sec
Decode latency: 26.01 sec
Prefill latency: 5.16 sec
Bandwidth achieved: 19099.59 GB/s
FLOPS achieved: 95.50 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 25.9849 sec
Average prefill latency: 5.1519 sec
Average tokens/sec: 526.18
Memory used: 73.32 GB
Done. we are killing the process
