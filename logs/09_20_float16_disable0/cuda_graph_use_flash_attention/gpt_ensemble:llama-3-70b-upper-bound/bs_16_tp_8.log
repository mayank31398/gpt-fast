W0928 17:54:11.807000 22708757550912 torch/distributed/run.py:779] 
W0928 17:54:11.807000 22708757550912 torch/distributed/run.py:779] *****************************************
W0928 17:54:11.807000 22708757550912 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:54:11.807000 22708757550912 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.45 seconds
Prefill latency: 0.6845530540449545 sec
Compilation time: 7.78 seconds
Compilation time: 7.84 seconds
Compilation time: 7.78 seconds
Compilation time: 7.82 seconds
Compilation time: 7.76 seconds
Compilation time: 7.80 seconds
Compilation time: 7.86 seconds
Decode latency: 7.101408837013878 sec
Compilation time: 7.79 seconds
Prefill latency: 0.6857367299962789 sec
Decode latency: 7.101491196022835 sec
Prefill latency: 0.68786274100421 sec
Decode latency: 7.098563759995159 sec
Prefill latency: 0.6902013850049116 sec
Decode latency: 7.10173188499175 sec
Prefill latency: 0.6886976090027019 sec
Decode latency: 7.101407267036848 sec
Prefill latency: 0.6905360289965756 sec
Decode latency: 7.104099040967412 sec
Time for inference 1: 7.80 sec total, 525.43 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10097.09 GB/s
FLOPS achieved: 50.49 TF/s

Prefill latency: 0.68900447699707 sec
Decode latency: 7.099284398020245 sec
Time for inference 2: 7.79 sec total, 525.86 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10105.32 GB/s
FLOPS achieved: 50.53 TF/s

Prefill latency: 0.6864443910308182 sec
Decode latency: 7.099852661951445 sec
Time for inference 3: 7.79 sec total, 525.98 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10107.56 GB/s
FLOPS achieved: 50.54 TF/s

Prefill latency: 0.686633315985091 sec
Decode latency: 7.102003788982984 sec
Time for inference 4: 7.79 sec total, 525.84 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10104.86 GB/s
FLOPS achieved: 50.52 TF/s

Prefill latency: 0.6896934230462648 sec
Decode latency: 7.0972123079700395 sec
Time for inference 5: 7.79 sec total, 525.96 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10107.18 GB/s
FLOPS achieved: 50.54 TF/s

Prefill latency: 0.6899501429870725 sec
Decode latency: 7.099421448947396 sec
Time for inference 6: 7.79 sec total, 525.78 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10103.79 GB/s
FLOPS achieved: 50.52 TF/s

Prefill latency: 0.6901099240058102 sec
Decode latency: 7.099836217996199 sec
Time for inference 7: 7.79 sec total, 525.74 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10102.94 GB/s
FLOPS achieved: 50.51 TF/s

Prefill latency: 0.6911652839626186 sec
Decode latency: 6.96568385703722 sec
Time for inference 8: 7.66 sec total, 534.88 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10278.70 GB/s
FLOPS achieved: 51.39 TF/s

Prefill latency: 0.6885206430451944 sec
Decode latency: 7.0995565470075235 sec
Time for inference 9: 7.79 sec total, 525.87 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10105.58 GB/s
FLOPS achieved: 50.53 TF/s

Prefill latency: 0.6880077829700895 sec
Decode latency: 7.1009505889960565 sec
Time for inference 10: 7.79 sec total, 525.81 tokens/sec
Decode latency: 7.10 sec
Prefill latency: 0.69 sec
Bandwidth achieved: 10104.26 GB/s
FLOPS achieved: 50.52 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.0868 sec
Average prefill latency: 0.6890 sec
Average tokens/sec: 526.71
Memory used: 28.45 GB
Done. we are killing the process
