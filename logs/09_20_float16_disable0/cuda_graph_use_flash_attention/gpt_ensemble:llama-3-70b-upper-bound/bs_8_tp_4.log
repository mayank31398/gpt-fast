W0928 17:45:58.917000 22885254076224 torch/distributed/run.py:779] 
W0928 17:45:58.917000 22885254076224 torch/distributed/run.py:779] *****************************************
W0928 17:45:58.917000 22885254076224 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:45:58.917000 22885254076224 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.29 seconds
Prefill latency: 0.6292528350022621 sec
Compilation time: 9.20 seconds
Decode latency: 8.568359791999683 sec
Compilation time: 9.20 seconds
Compilation time: 9.29 seconds
Compilation time: 9.44 seconds
Prefill latency: 0.6307072390336543 sec
Decode latency: 8.567642029956914 sec
Prefill latency: 0.629779931041412 sec
Decode latency: 8.567927433003206 sec
Prefill latency: 0.6331045749830082 sec
Decode latency: 8.567247271013912 sec
Prefill latency: 0.6293039899901487 sec
Decode latency: 8.565861698996741 sec
Prefill latency: 0.6314633879810572 sec
Decode latency: 8.56683480401989 sec
Time for inference 1: 9.20 sec total, 222.63 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8087.97 GB/s
FLOPS achieved: 40.44 TF/s

Prefill latency: 0.6336933270213194 sec
Decode latency: 8.56732195999939 sec
Time for inference 2: 9.20 sec total, 222.56 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8085.60 GB/s
FLOPS achieved: 40.43 TF/s

Prefill latency: 0.6297099430230446 sec
Decode latency: 8.566655991016887 sec
Time for inference 3: 9.20 sec total, 222.67 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8089.61 GB/s
FLOPS achieved: 40.45 TF/s

Prefill latency: 0.6304233669652604 sec
Decode latency: 8.566682644013781 sec
Time for inference 4: 9.20 sec total, 222.66 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8089.03 GB/s
FLOPS achieved: 40.45 TF/s

Prefill latency: 0.6315223990241066 sec
Decode latency: 8.567015681997873 sec
Time for inference 5: 9.20 sec total, 222.62 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8087.83 GB/s
FLOPS achieved: 40.44 TF/s

Prefill latency: 0.6311149630346335 sec
Decode latency: 8.56692228897009 sec
Time for inference 6: 9.20 sec total, 222.63 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8088.12 GB/s
FLOPS achieved: 40.44 TF/s

Prefill latency: 0.6332944399910048 sec
Decode latency: 8.56713487196248 sec
Time for inference 7: 9.20 sec total, 222.58 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8086.06 GB/s
FLOPS achieved: 40.43 TF/s

Prefill latency: 0.6328523799893446 sec
Decode latency: 8.566376481961925 sec
Time for inference 8: 9.20 sec total, 222.61 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8087.20 GB/s
FLOPS achieved: 40.44 TF/s

Prefill latency: 0.63179586204933 sec
Decode latency: 8.566478002991062 sec
Time for inference 9: 9.20 sec total, 222.63 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8088.07 GB/s
FLOPS achieved: 40.44 TF/s

Prefill latency: 0.6302439319551922 sec
Decode latency: 8.567673000972718 sec
Time for inference 10: 9.20 sec total, 222.64 tokens/sec
Decode latency: 8.57 sec
Prefill latency: 0.63 sec
Bandwidth achieved: 8088.23 GB/s
FLOPS achieved: 40.44 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.5669 sec
Average prefill latency: 0.6316 sec
Average tokens/sec: 222.62
Memory used: 42.92 GB
Done. we are killing the process
