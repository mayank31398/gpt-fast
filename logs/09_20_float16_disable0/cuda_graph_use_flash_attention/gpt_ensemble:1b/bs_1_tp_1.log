flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.09 seconds
Prefill latency: 0.01652697194367647 sec
Decode latency: 2.063114444958046 sec
Compilation time: 2.08 seconds
Prefill latency: 0.016029953956604004 sec
Decode latency: 2.0618963319575414 sec
Prefill latency: 0.016062992974184453 sec
Decode latency: 2.0616980029735714 sec
Prefill latency: 0.016000773990526795 sec
Decode latency: 2.060750472941436 sec
Prefill latency: 0.016059287008829415 sec
Decode latency: 2.0610556280007586 sec
Prefill latency: 0.016037845984101295 sec
Decode latency: 2.0613031910033897 sec
Time for inference 1: 2.08 sec total, 123.18 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.62 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016032449901103973 sec
Decode latency: 2.0346677240449935 sec
Time for inference 2: 2.05 sec total, 124.78 tokens/sec
Decode latency: 2.03 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 270.09 GB/s
FLOPS achieved: 1.35 TF/s

Prefill latency: 0.0160603120457381 sec
Decode latency: 2.0609356749337167 sec
Time for inference 3: 2.08 sec total, 123.21 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.68 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.01603687193710357 sec
Decode latency: 1.9540152999106795 sec
Time for inference 4: 1.97 sec total, 129.90 tokens/sec
Decode latency: 1.95 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 281.16 GB/s
FLOPS achieved: 1.41 TF/s

Prefill latency: 0.016052917926572263 sec
Decode latency: 2.061236555920914 sec
Time for inference 5: 2.08 sec total, 123.20 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.66 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016006359015591443 sec
Decode latency: 1.9364191129570827 sec
Time for inference 6: 1.95 sec total, 131.07 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 283.71 GB/s
FLOPS achieved: 1.42 TF/s

Prefill latency: 0.016003304976038635 sec
Decode latency: 1.9366879930021241 sec
Time for inference 7: 1.95 sec total, 131.06 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 283.67 GB/s
FLOPS achieved: 1.42 TF/s

Prefill latency: 0.016068786033429205 sec
Decode latency: 2.0610470570391044 sec
Time for inference 8: 2.08 sec total, 123.21 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.69 GB/s
FLOPS achieved: 1.33 TF/s

Prefill latency: 0.016015075030736625 sec
Decode latency: 1.9445942369056866 sec
Time for inference 9: 1.96 sec total, 130.53 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 282.53 GB/s
FLOPS achieved: 1.41 TF/s

Prefill latency: 0.016044685035012662 sec
Decode latency: 2.060873872949742 sec
Time for inference 10: 2.08 sec total, 123.22 tokens/sec
Decode latency: 2.06 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 266.71 GB/s
FLOPS achieved: 1.33 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0112 sec
Average prefill latency: 0.0160 sec
Average tokens/sec: 126.34
Memory used: 2.89 GB
Done. we are killing the process
