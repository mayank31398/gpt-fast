flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.1803278069710359 sec
Decode latency: 3.85292988398578 sec
Compilation time: 4.03 seconds
Prefill latency: 0.18008633004501462 sec
Decode latency: 3.8540027120616287 sec
Prefill latency: 0.1801157200243324 sec
Decode latency: 3.8511395499808714 sec
Prefill latency: 0.18004686199128628 sec
Decode latency: 3.8518331699306145 sec
Prefill latency: 0.1800733710406348 sec
Decode latency: 3.853930025943555 sec
Prefill latency: 0.18006962293293327 sec
Decode latency: 3.852511561010033 sec
Time for inference 1: 4.03 sec total, 1015.55 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.17 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.17999899701680988 sec
Decode latency: 3.8527268430916592 sec
Time for inference 2: 4.03 sec total, 1015.50 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.05 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.18007944303099066 sec
Decode latency: 3.796791183995083 sec
Time for inference 3: 3.98 sec total, 1029.69 tokens/sec
Decode latency: 3.80 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2228.78 GB/s
FLOPS achieved: 11.14 TF/s

Prefill latency: 0.1801134479464963 sec
Decode latency: 3.8524222070118412 sec
Time for inference 4: 4.03 sec total, 1015.51 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.08 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.18013982207048684 sec
Decode latency: 3.8515461260685697 sec
Time for inference 5: 4.03 sec total, 1015.74 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.59 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.18010500795207918 sec
Decode latency: 3.8526043590391055 sec
Time for inference 6: 4.03 sec total, 1015.51 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.07 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.18004798202309757 sec
Decode latency: 3.852713327971287 sec
Time for inference 7: 4.03 sec total, 1015.49 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.05 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.18006036698352545 sec
Decode latency: 3.8519675319548696 sec
Time for inference 8: 4.03 sec total, 1015.68 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2198.45 GB/s
FLOPS achieved: 10.99 TF/s

Prefill latency: 0.1801420069532469 sec
Decode latency: 3.8546720379963517 sec
Time for inference 9: 4.04 sec total, 1014.98 tokens/sec
Decode latency: 3.85 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2196.93 GB/s
FLOPS achieved: 10.98 TF/s

Prefill latency: 0.18002957105636597 sec
Decode latency: 3.8550691209966317 sec
Time for inference 10: 4.04 sec total, 1014.87 tokens/sec
Decode latency: 3.86 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2196.70 GB/s
FLOPS achieved: 10.98 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8473 sec
Average prefill latency: 0.1801 sec
Average tokens/sec: 1016.85
Memory used: 9.22 GB
Done. we are killing the process
