flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.2061508580809459 sec
Decode latency: 3.330900649074465 sec
Compilation time: 3.54 seconds
Prefill latency: 0.20602297107689083 sec
Decode latency: 3.331893471069634 sec
Prefill latency: 0.20596643898170441 sec
Decode latency: 3.3321101689944044 sec
Prefill latency: 0.20600951300002635 sec
Decode latency: 3.33368920290377 sec
Prefill latency: 0.2059970849659294 sec
Decode latency: 3.2006970960646868 sec
Prefill latency: 0.2060562469996512 sec
Decode latency: 3.3311990320216864 sec
Time for inference 1: 3.54 sec total, 1157.72 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2797.24 GB/s
FLOPS achieved: 13.99 TF/s

Prefill latency: 0.20603036601096392 sec
Decode latency: 3.292545613949187 sec
Time for inference 2: 3.50 sec total, 1170.48 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2828.08 GB/s
FLOPS achieved: 14.14 TF/s

Prefill latency: 0.20594068698119372 sec
Decode latency: 3.3324192279251292 sec
Time for inference 3: 3.54 sec total, 1157.31 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2796.25 GB/s
FLOPS achieved: 13.98 TF/s

Prefill latency: 0.20599349110852927 sec
Decode latency: 3.3302056519314647 sec
Time for inference 4: 3.54 sec total, 1158.03 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2797.99 GB/s
FLOPS achieved: 13.99 TF/s

Prefill latency: 0.20607572700828314 sec
Decode latency: 3.3319934810278937 sec
Time for inference 5: 3.54 sec total, 1157.43 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2796.55 GB/s
FLOPS achieved: 13.98 TF/s

Prefill latency: 0.20603231305722147 sec
Decode latency: 3.333295207004994 sec
Time for inference 6: 3.54 sec total, 1157.04 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2795.60 GB/s
FLOPS achieved: 13.98 TF/s

Prefill latency: 0.20608517597429454 sec
Decode latency: 3.238720107008703 sec
Time for inference 7: 3.45 sec total, 1188.78 tokens/sec
Decode latency: 3.24 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2872.30 GB/s
FLOPS achieved: 14.36 TF/s

Prefill latency: 0.20615415507927537 sec
Decode latency: 3.330992388073355 sec
Time for inference 8: 3.54 sec total, 1157.77 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2797.36 GB/s
FLOPS achieved: 13.99 TF/s

Prefill latency: 0.20604122697841376 sec
Decode latency: 3.333049127017148 sec
Time for inference 9: 3.54 sec total, 1157.12 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2795.80 GB/s
FLOPS achieved: 13.98 TF/s

Prefill latency: 0.20611874700989574 sec
Decode latency: 3.3315933499252424 sec
Time for inference 10: 3.54 sec total, 1157.58 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2796.91 GB/s
FLOPS achieved: 13.98 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3186 sec
Average prefill latency: 0.2061 sec
Average tokens/sec: 1161.93
Memory used: 10.79 GB
Done. we are killing the process
