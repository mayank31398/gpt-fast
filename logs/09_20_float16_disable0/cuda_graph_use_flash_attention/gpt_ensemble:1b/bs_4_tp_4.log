W1001 02:28:17.899000 22589740943168 torch/distributed/run.py:779] 
W1001 02:28:17.899000 22589740943168 torch/distributed/run.py:779] *****************************************
W1001 02:28:17.899000 22589740943168 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:28:17.899000 22589740943168 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.98 seconds
Prefill latency: 0.018548762891441584 sec
Compilation time: 1.93 seconds
Decode latency: 1.911406866973266 sec
Compilation time: 1.93 seconds
Compilation time: 1.93 seconds
Prefill latency: 0.01831885997671634 sec
Compilation time: 1.95 seconds
Decode latency: 1.9119347459636629 sec
Prefill latency: 0.01829265500418842 sec
Decode latency: 1.7793917310191318 sec
Prefill latency: 0.018303825985640287 sec
Decode latency: 1.7885870770551264 sec
Prefill latency: 0.018310150946490467 sec
Decode latency: 1.9116922229295596 sec
Prefill latency: 0.018295121961273253 sec
Decode latency: 1.911750118015334 sec
Time for inference 1: 1.93 sec total, 530.38 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.53 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018321643001399934 sec
Decode latency: 1.9119246209738776 sec
Time for inference 2: 1.93 sec total, 530.33 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.50 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.01829333498608321 sec
Decode latency: 1.9117826360743493 sec
Time for inference 3: 1.93 sec total, 530.38 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.53 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018294465960934758 sec
Decode latency: 1.9117498949635774 sec
Time for inference 4: 1.93 sec total, 530.32 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.49 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018326138029806316 sec
Decode latency: 1.9117297200718895 sec
Time for inference 5: 1.93 sec total, 530.39 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.54 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018287468934431672 sec
Decode latency: 1.9117564860498533 sec
Time for inference 6: 1.93 sec total, 530.38 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.54 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018280623015016317 sec
Decode latency: 1.9116076650097966 sec
Time for inference 7: 1.93 sec total, 530.43 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.57 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018317652051337063 sec
Decode latency: 1.9118336089886725 sec
Time for inference 8: 1.93 sec total, 530.35 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.51 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018289090949110687 sec
Decode latency: 1.9116572339553386 sec
Time for inference 9: 1.93 sec total, 530.41 tokens/sec
Decode latency: 1.91 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 380.55 GB/s
FLOPS achieved: 1.90 TF/s

Prefill latency: 0.018291633925400674 sec
Decode latency: 1.7690108510432765 sec
Time for inference 10: 1.79 sec total, 572.72 tokens/sec
Decode latency: 1.77 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 410.91 GB/s
FLOPS achieved: 2.05 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8975 sec
Average prefill latency: 0.0183 sec
Average tokens/sec: 534.61
Memory used: 1.86 GB
Done. we are killing the process
