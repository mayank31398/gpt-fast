W0930 19:37:46.181000 22567447390016 torch/distributed/run.py:779] 
W0930 19:37:46.181000 22567447390016 torch/distributed/run.py:779] *****************************************
W0930 19:37:46.181000 22567447390016 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 19:37:46.181000 22567447390016 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.23 seconds
Prefill latency: 0.02837624796666205 sec
Decode latency: 2.0906506469473243 sec
Compilation time: 2.11 seconds
Compilation time: 2.16 seconds
Compilation time: 2.12 seconds
Compilation time: 2.12 seconds
Prefill latency: 0.021734433947131038 sec
Decode latency: 2.089811366982758 sec
Prefill latency: 0.021768521051853895 sec
Decode latency: 2.0901713570347056 sec
Prefill latency: 0.02177540003322065 sec
Decode latency: 2.0898602929664776 sec
Prefill latency: 0.021839783061295748 sec
Decode latency: 2.08923900895752 sec
Prefill latency: 0.02183815708849579 sec
Decode latency: 2.0894996740389615 sec
Time for inference 1: 2.11 sec total, 484.81 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.34 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021819128072820604 sec
Decode latency: 2.089968967018649 sec
Time for inference 2: 2.11 sec total, 484.72 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.28 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.02177278697490692 sec
Decode latency: 2.0900433809729293 sec
Time for inference 3: 2.11 sec total, 484.72 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.28 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.02181415108498186 sec
Decode latency: 2.0890614030649886 sec
Time for inference 4: 2.11 sec total, 484.94 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.42 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.02181780501268804 sec
Decode latency: 2.089688300038688 sec
Time for inference 5: 2.11 sec total, 484.79 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.33 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021854925900697708 sec
Decode latency: 2.088379396009259 sec
Time for inference 6: 2.11 sec total, 485.03 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.48 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021762799937278032 sec
Decode latency: 2.087228629970923 sec
Time for inference 7: 2.11 sec total, 485.31 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.67 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021794949076138437 sec
Decode latency: 2.0872938600368798 sec
Time for inference 8: 2.11 sec total, 485.34 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.69 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021812594030052423 sec
Decode latency: 2.0878205250483006 sec
Time for inference 9: 2.11 sec total, 485.21 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.60 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.021813949919305742 sec
Decode latency: 2.088018831098452 sec
Time for inference 10: 2.11 sec total, 485.15 tokens/sec
Decode latency: 2.09 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 317.56 GB/s
FLOPS achieved: 1.59 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0887 sec
Average prefill latency: 0.0218 sec
Average tokens/sec: 485.00
Memory used: 2.20 GB
Done. we are killing the process
