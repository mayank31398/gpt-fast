flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.05436653189826757 sec
Decode latency: 2.3935363380005583 sec
Compilation time: 2.45 seconds
Prefill latency: 0.05408127803821117 sec
Decode latency: 2.396096120006405 sec
Prefill latency: 0.054069725098088384 sec
Decode latency: 2.3947020720224828 sec
Prefill latency: 0.054064234951511025 sec
Decode latency: 2.273165980936028 sec
Prefill latency: 0.05408746097236872 sec
Decode latency: 2.395794752985239 sec
Prefill latency: 0.054074065992608666 sec
Decode latency: 2.285800725920126 sec
Time for inference 1: 2.34 sec total, 437.52 tokens/sec
Decode latency: 2.29 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1057.11 GB/s
FLOPS achieved: 5.29 TF/s

Prefill latency: 0.054117662948556244 sec
Decode latency: 2.282810139004141 sec
Time for inference 2: 2.34 sec total, 438.07 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1058.44 GB/s
FLOPS achieved: 5.29 TF/s

Prefill latency: 0.05411582894157618 sec
Decode latency: 2.39663858700078 sec
Time for inference 3: 2.45 sec total, 417.73 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.30 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05408322298899293 sec
Decode latency: 2.2782109499676153 sec
Time for inference 4: 2.33 sec total, 438.91 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1060.49 GB/s
FLOPS achieved: 5.30 TF/s

Prefill latency: 0.05407475691754371 sec
Decode latency: 2.3963002039818093 sec
Time for inference 5: 2.45 sec total, 417.77 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.39 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.054073905921541154 sec
Decode latency: 2.3958195379236713 sec
Time for inference 6: 2.45 sec total, 417.86 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.61 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05408188607543707 sec
Decode latency: 2.396212930092588 sec
Time for inference 7: 2.45 sec total, 417.80 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.48 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05407078203279525 sec
Decode latency: 2.3958692270098254 sec
Time for inference 8: 2.45 sec total, 417.86 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.62 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05414082994684577 sec
Decode latency: 2.3957612740341574 sec
Time for inference 9: 2.45 sec total, 417.86 tokens/sec
Decode latency: 2.40 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1009.62 GB/s
FLOPS achieved: 5.05 TF/s

Prefill latency: 0.05405722209252417 sec
Decode latency: 2.2696062029572204 sec
Time for inference 10: 2.32 sec total, 440.55 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1064.45 GB/s
FLOPS achieved: 5.32 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3493 sec
Average prefill latency: 0.0541 sec
Average tokens/sec: 426.19
Memory used: 4.92 GB
Done. we are killing the process
