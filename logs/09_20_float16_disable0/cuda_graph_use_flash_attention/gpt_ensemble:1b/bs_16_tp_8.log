W1001 02:35:52.247000 22379562055488 torch/distributed/run.py:779] 
W1001 02:35:52.247000 22379562055488 torch/distributed/run.py:779] *****************************************
W1001 02:35:52.247000 22379562055488 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:35:52.247000 22379562055488 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.11 seconds
Prefill latency: 0.0399535009637475 sec
Compilation time: 2.05 seconds
Compilation time: 2.03 seconds
Compilation time: 2.04 seconds
Decode latency: 1.8580870580626652 sec
Compilation time: 1.90 seconds
Prefill latency: 0.039720020024105906 sec
Compilation time: 2.02 seconds
Compilation time: 2.04 seconds
Compilation time: 2.00 seconds
Compilation time: 2.07 seconds
Decode latency: 1.9464863230241463 sec
Prefill latency: 0.03968500590417534 sec
Decode latency: 2.0007879349868745 sec
Prefill latency: 0.03965636692009866 sec
Decode latency: 1.9999353839084506 sec
Prefill latency: 0.039738158928230405 sec
Decode latency: 1.875102804042399 sec
Prefill latency: 0.03967332502361387 sec
Decode latency: 1.9993010780308396 sec
Time for inference 1: 2.04 sec total, 2008.23 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 872.29 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.03966011700686067 sec
Decode latency: 1.9423957790713757 sec
Time for inference 2: 1.98 sec total, 2065.89 tokens/sec
Decode latency: 1.94 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 897.34 GB/s
FLOPS achieved: 4.49 TF/s

Prefill latency: 0.03969711507670581 sec
Decode latency: 2.000923684099689 sec
Time for inference 3: 2.04 sec total, 2006.62 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 871.59 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.039676800020970404 sec
Decode latency: 1.8832382049877197 sec
Time for inference 4: 1.92 sec total, 2129.26 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 924.86 GB/s
FLOPS achieved: 4.62 TF/s

Prefill latency: 0.039711234043352306 sec
Decode latency: 1.8687999360263348 sec
Time for inference 5: 1.91 sec total, 2145.42 tokens/sec
Decode latency: 1.87 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 931.88 GB/s
FLOPS achieved: 4.66 TF/s

Prefill latency: 0.03970049903728068 sec
Decode latency: 1.999913785024546 sec
Time for inference 6: 2.04 sec total, 2007.52 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 871.98 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.0396646469598636 sec
Decode latency: 1.9256708750035614 sec
Time for inference 7: 1.97 sec total, 2083.40 tokens/sec
Decode latency: 1.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 904.94 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.03966001502703875 sec
Decode latency: 1.900127452914603 sec
Time for inference 8: 1.94 sec total, 2110.82 tokens/sec
Decode latency: 1.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 916.86 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.039657791960053146 sec
Decode latency: 2.00020796910394 sec
Time for inference 9: 2.04 sec total, 2007.37 tokens/sec
Decode latency: 2.00 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 871.92 GB/s
FLOPS achieved: 4.36 TF/s

Prefill latency: 0.039681750000454485 sec
Decode latency: 1.9301825920119882 sec
Time for inference 10: 1.97 sec total, 2078.63 tokens/sec
Decode latency: 1.93 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 902.87 GB/s
FLOPS achieved: 4.51 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9451 sec
Average prefill latency: 0.0397 sec
Average tokens/sec: 2064.31
Memory used: 3.51 GB
Done. we are killing the process
