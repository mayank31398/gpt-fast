flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.1062385409604758 sec
Decode latency: 2.722695749020204 sec
Compilation time: 2.83 seconds
Prefill latency: 0.10609402507543564 sec
Decode latency: 2.722521201008931 sec
Prefill latency: 0.1063446409534663 sec
Decode latency: 2.7222732310183346 sec
Prefill latency: 0.10623410693369806 sec
Decode latency: 2.7236080849543214 sec
Prefill latency: 0.10614851000718772 sec
Decode latency: 2.7240820080041885 sec
Prefill latency: 0.10628911200910807 sec
Decode latency: 2.7230687119299546 sec
Time for inference 1: 2.83 sec total, 723.67 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1748.50 GB/s
FLOPS achieved: 8.74 TF/s

Prefill latency: 0.1063453119713813 sec
Decode latency: 2.723652709973976 sec
Time for inference 2: 2.83 sec total, 723.52 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1748.14 GB/s
FLOPS achieved: 8.74 TF/s

Prefill latency: 0.10622978606261313 sec
Decode latency: 2.716369820991531 sec
Time for inference 3: 2.82 sec total, 725.41 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.71 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10598157194908708 sec
Decode latency: 2.7155966369900852 sec
Time for inference 4: 2.82 sec total, 725.67 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.33 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10592240502592176 sec
Decode latency: 2.7159412569599226 sec
Time for inference 5: 2.82 sec total, 725.58 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.12 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10598136705812067 sec
Decode latency: 2.716320692910813 sec
Time for inference 6: 2.82 sec total, 725.44 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.78 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10588599101174623 sec
Decode latency: 2.7163715600036085 sec
Time for inference 7: 2.82 sec total, 725.45 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.81 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.10598706698510796 sec
Decode latency: 2.7151173630263656 sec
Time for inference 8: 2.82 sec total, 725.76 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.55 GB/s
FLOPS achieved: 8.77 TF/s

Prefill latency: 0.10594462405424565 sec
Decode latency: 2.716509070014581 sec
Time for inference 9: 2.82 sec total, 725.43 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1752.77 GB/s
FLOPS achieved: 8.76 TF/s

Prefill latency: 0.1059231839608401 sec
Decode latency: 2.7161121529061347 sec
Time for inference 10: 2.82 sec total, 725.55 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1753.04 GB/s
FLOPS achieved: 8.77 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7175 sec
Average prefill latency: 0.1060 sec
Average tokens/sec: 725.15
Memory used: 6.83 GB
Done. we are killing the process
