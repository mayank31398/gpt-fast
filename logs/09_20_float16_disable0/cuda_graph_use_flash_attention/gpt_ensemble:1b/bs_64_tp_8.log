W1001 02:42:02.510000 22825166862144 torch/distributed/run.py:779] 
W1001 02:42:02.510000 22825166862144 torch/distributed/run.py:779] *****************************************
W1001 02:42:02.510000 22825166862144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:42:02.510000 22825166862144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.17 seconds
Prefill latency: 0.14605236996430904 sec
Compilation time: 2.70 seconds
Compilation time: 2.70 seconds
Compilation time: 2.73 seconds
Decode latency: 2.5552120730280876 sec
Compilation time: 2.70 seconds
Compilation time: 2.71 seconds
Compilation time: 2.73 seconds
Compilation time: 2.73 seconds
Compilation time: 2.71 seconds
Prefill latency: 0.145592100918293 sec
Decode latency: 2.5517488040495664 sec
Prefill latency: 0.14569752500392497 sec
Decode latency: 2.5528630019398406 sec
Prefill latency: 0.14586516399867833 sec
Decode latency: 2.5526574719697237 sec
Prefill latency: 0.14578390202950686 sec
Decode latency: 2.5530347460880876 sec
Prefill latency: 0.14568042405880988 sec
Decode latency: 2.5528750580269843 sec
Time for inference 1: 2.70 sec total, 6069.84 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2636.49 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14567996305413544 sec
Decode latency: 2.553765511023812 sec
Time for inference 2: 2.70 sec total, 6067.93 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2635.66 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14567468699533492 sec
Decode latency: 2.555916784098372 sec
Time for inference 3: 2.70 sec total, 6063.03 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2633.54 GB/s
FLOPS achieved: 13.17 TF/s

Prefill latency: 0.1458498580614105 sec
Decode latency: 2.551657062023878 sec
Time for inference 4: 2.70 sec total, 6072.24 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2637.53 GB/s
FLOPS achieved: 13.19 TF/s

Prefill latency: 0.14580577099695802 sec
Decode latency: 2.5537055380409583 sec
Time for inference 5: 2.70 sec total, 6067.78 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2635.60 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14583386399317533 sec
Decode latency: 2.5536111219553277 sec
Time for inference 6: 2.70 sec total, 6067.96 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2635.67 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14569212694186717 sec
Decode latency: 2.5532073619542643 sec
Time for inference 7: 2.70 sec total, 6069.27 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2636.24 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14573481201659888 sec
Decode latency: 2.5528574300697073 sec
Time for inference 8: 2.70 sec total, 6069.85 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2636.50 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.1458748410223052 sec
Decode latency: 2.5538476440124214 sec
Time for inference 9: 2.70 sec total, 6066.96 tokens/sec
Decode latency: 2.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2635.24 GB/s
FLOPS achieved: 13.18 TF/s

Prefill latency: 0.14585111197084188 sec
Decode latency: 2.555648608948104 sec
Time for inference 10: 2.70 sec total, 6062.94 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2633.49 GB/s
FLOPS achieved: 13.17 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5537 sec
Average prefill latency: 0.1458 sec
Average tokens/sec: 6067.78
Memory used: 11.11 GB
Done. we are killing the process
