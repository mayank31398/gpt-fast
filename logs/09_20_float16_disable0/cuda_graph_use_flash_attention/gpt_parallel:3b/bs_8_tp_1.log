flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
[rank0]:[W1001 02:12:00.461619518 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.2022701120004058 sec
Decode latency: 3.4886605909559876 sec
Compilation time: 3.69 seconds
Prefill latency: 0.20217958802822977 sec
Decode latency: 3.4866013650316745 sec
Prefill latency: 0.20161683298647404 sec
Decode latency: 3.487888371106237 sec
Prefill latency: 0.2024066000012681 sec
Decode latency: 3.486848045955412 sec
Prefill latency: 0.2020039790077135 sec
Decode latency: 3.4868527019862086 sec
Prefill latency: 0.20238160400185734 sec
Decode latency: 3.4862567769596353 sec
Time for inference 1: 3.69 sec total, 555.11 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3897.65 GB/s
FLOPS achieved: 19.49 TF/s

Prefill latency: 0.20145081297960132 sec
Decode latency: 3.4258589500095695 sec
Time for inference 2: 3.63 sec total, 564.46 tokens/sec
Decode latency: 3.43 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3963.32 GB/s
FLOPS achieved: 19.82 TF/s

Prefill latency: 0.202143163071014 sec
Decode latency: 3.4868614609586075 sec
Time for inference 3: 3.69 sec total, 555.02 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3897.05 GB/s
FLOPS achieved: 19.49 TF/s

Prefill latency: 0.2015988400671631 sec
Decode latency: 3.486166291986592 sec
Time for inference 4: 3.69 sec total, 555.20 tokens/sec
Decode latency: 3.49 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3898.34 GB/s
FLOPS achieved: 19.49 TF/s

Prefill latency: 0.20200608496088535 sec
Decode latency: 3.479404410929419 sec
Time for inference 5: 3.68 sec total, 556.19 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3905.27 GB/s
FLOPS achieved: 19.53 TF/s

Prefill latency: 0.2028518320294097 sec
Decode latency: 3.48110615008045 sec
Time for inference 6: 3.68 sec total, 555.82 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3902.68 GB/s
FLOPS achieved: 19.51 TF/s

Prefill latency: 0.2009949180064723 sec
Decode latency: 3.479035933036357 sec
Time for inference 7: 3.68 sec total, 556.41 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3906.83 GB/s
FLOPS achieved: 19.53 TF/s

Prefill latency: 0.20310905401129276 sec
Decode latency: 3.4791359250666574 sec
Time for inference 8: 3.68 sec total, 556.08 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3904.49 GB/s
FLOPS achieved: 19.52 TF/s

Prefill latency: 0.20248267194256186 sec
Decode latency: 3.4791957690613344 sec
Time for inference 9: 3.68 sec total, 556.14 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3904.93 GB/s
FLOPS achieved: 19.52 TF/s

Prefill latency: 0.20035367098171264 sec
Decode latency: 3.3826493771048263 sec
Time for inference 10: 3.58 sec total, 571.43 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 4012.23 GB/s
FLOPS achieved: 20.06 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.4666 sec
Average prefill latency: 0.2019 sec
Average tokens/sec: 558.19
Memory used: 14.84 GB
Done. we are killing the process
