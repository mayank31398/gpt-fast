flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 1.615376278059557 sec
Decode latency: 12.615277093020268 sec
Compilation time: 14.23 seconds
Prefill latency: 1.6229144849348813 sec
Decode latency: 12.501978965010494 sec
Prefill latency: 1.6171307720942423 sec
Decode latency: 12.616024449001998 sec
Prefill latency: 1.6233496660133824 sec
Decode latency: 12.615625353064388 sec
Prefill latency: 1.6235384680330753 sec
Decode latency: 12.613922332064249 sec
Prefill latency: 1.624612935935147 sec
Decode latency: 12.61517470900435 sec
Time for inference 1: 14.24 sec total, 1150.49 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.12 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6234493639785796 sec
Decode latency: 12.615957512985915 sec
Time for inference 2: 14.24 sec total, 1150.52 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.33 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6232103819493204 sec
Decode latency: 12.616081445012242 sec
Time for inference 3: 14.24 sec total, 1150.53 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.39 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6219565439969301 sec
Decode latency: 12.53891276801005 sec
Time for inference 4: 14.16 sec total, 1156.91 tokens/sec
Decode latency: 12.54 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8123.16 GB/s
FLOPS achieved: 40.62 TF/s

Prefill latency: 1.6203168539796025 sec
Decode latency: 12.61596682399977 sec
Time for inference 5: 14.24 sec total, 1150.77 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8080.10 GB/s
FLOPS achieved: 40.40 TF/s

Prefill latency: 1.6236297780415043 sec
Decode latency: 12.614991223090328 sec
Time for inference 6: 14.24 sec total, 1150.59 tokens/sec
Decode latency: 12.61 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.83 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6228072190424427 sec
Decode latency: 12.615764635032974 sec
Time for inference 7: 14.24 sec total, 1150.59 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.81 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6233306979993358 sec
Decode latency: 12.615142605965957 sec
Time for inference 8: 14.24 sec total, 1150.61 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8078.94 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6242269199574366 sec
Decode latency: 12.616239850060083 sec
Time for inference 9: 14.24 sec total, 1150.44 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8077.76 GB/s
FLOPS achieved: 40.39 TF/s

Prefill latency: 1.6223146320553496 sec
Decode latency: 12.614183494006284 sec
Time for inference 10: 14.24 sec total, 1150.76 tokens/sec
Decode latency: 12.61 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8080.03 GB/s
FLOPS achieved: 40.40 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.6078 sec
Average prefill latency: 1.6230 sec
Average tokens/sec: 1151.22
Memory used: 65.21 GB
Done. we are killing the process
