flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.91 seconds
Prefill latency: 0.10310527309775352 sec
Decode latency: 3.0000946890795603 sec
Compilation time: 3.10 seconds
Prefill latency: 0.10254246601834893 sec
Decode latency: 3.0018774330383167 sec
Prefill latency: 0.10263148602098227 sec
Decode latency: 3.0018051259685308 sec
Prefill latency: 0.10269792296458036 sec
Decode latency: 3.002105703926645 sec
Prefill latency: 0.10242913395632058 sec
Decode latency: 2.921674947021529 sec
Prefill latency: 0.1025630229851231 sec
Decode latency: 3.002495627035387 sec
Time for inference 1: 3.11 sec total, 329.71 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.07 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.10251480294391513 sec
Decode latency: 3.001893449923955 sec
Time for inference 2: 3.11 sec total, 329.78 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.55 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.10253491601906717 sec
Decode latency: 2.985970897017978 sec
Time for inference 3: 3.09 sec total, 331.47 tokens/sec
Decode latency: 2.99 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2327.43 GB/s
FLOPS achieved: 11.64 TF/s

Prefill latency: 0.10240163200069219 sec
Decode latency: 2.9244686670135707 sec
Time for inference 4: 3.03 sec total, 338.23 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2374.84 GB/s
FLOPS achieved: 11.87 TF/s

Prefill latency: 0.10252425400540233 sec
Decode latency: 3.0017992600332946 sec
Time for inference 5: 3.10 sec total, 329.79 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.63 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.1026970089878887 sec
Decode latency: 3.001397227984853 sec
Time for inference 6: 3.10 sec total, 329.81 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.77 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.10262171598151326 sec
Decode latency: 2.9431259059347212 sec
Time for inference 7: 3.05 sec total, 336.13 tokens/sec
Decode latency: 2.94 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2360.09 GB/s
FLOPS achieved: 11.80 TF/s

Prefill latency: 0.10268645000178367 sec
Decode latency: 3.002381189027801 sec
Time for inference 8: 3.11 sec total, 329.70 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.00 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.10253217699937522 sec
Decode latency: 3.00204934400972 sec
Time for inference 9: 3.11 sec total, 329.76 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.41 GB/s
FLOPS achieved: 11.58 TF/s

Prefill latency: 0.10244738089386374 sec
Decode latency: 3.0020796969765797 sec
Time for inference 10: 3.11 sec total, 329.77 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2315.47 GB/s
FLOPS achieved: 11.58 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9868 sec
Average prefill latency: 0.1026 sec
Average tokens/sec: 331.42
Memory used: 11.26 GB
Done. we are killing the process
