flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
[rank0]:[W1001 02:07:03.602637280 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.03138873400166631 sec
Decode latency: 2.4951475829584524 sec
Compilation time: 2.53 seconds
Prefill latency: 0.031008768011815846 sec
Decode latency: 2.431568215950392 sec
Prefill latency: 0.031020435970276594 sec
Decode latency: 2.494719928014092 sec
Prefill latency: 0.03106616495642811 sec
Decode latency: 2.4947994969552383 sec
Prefill latency: 0.03108551900368184 sec
Decode latency: 2.4682447649538517 sec
Prefill latency: 0.031009427038952708 sec
Decode latency: 2.3819809020496905 sec
Time for inference 1: 2.41 sec total, 106.06 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 744.68 GB/s
FLOPS achieved: 3.72 TF/s

Prefill latency: 0.031042538001202047 sec
Decode latency: 2.4267664569197223 sec
Time for inference 2: 2.46 sec total, 104.13 tokens/sec
Decode latency: 2.43 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 731.12 GB/s
FLOPS achieved: 3.66 TF/s

Prefill latency: 0.031036763917654753 sec
Decode latency: 2.490177022991702 sec
Time for inference 3: 2.52 sec total, 101.51 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 712.74 GB/s
FLOPS achieved: 3.56 TF/s

Prefill latency: 0.030991106061264873 sec
Decode latency: 2.4941475728992373 sec
Time for inference 4: 2.53 sec total, 101.35 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 711.63 GB/s
FLOPS achieved: 3.56 TF/s

Prefill latency: 0.031060122069902718 sec
Decode latency: 2.4937146020820364 sec
Time for inference 5: 2.53 sec total, 101.37 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 711.73 GB/s
FLOPS achieved: 3.56 TF/s

Prefill latency: 0.03101352695375681 sec
Decode latency: 2.4940222180448472 sec
Time for inference 6: 2.53 sec total, 101.35 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 711.64 GB/s
FLOPS achieved: 3.56 TF/s

Prefill latency: 0.031067922012880445 sec
Decode latency: 2.494817027938552 sec
Time for inference 7: 2.53 sec total, 101.32 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 711.42 GB/s
FLOPS achieved: 3.56 TF/s

Prefill latency: 0.031063252012245357 sec
Decode latency: 2.4748067599721253 sec
Time for inference 8: 2.51 sec total, 102.13 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 717.11 GB/s
FLOPS achieved: 3.59 TF/s

Prefill latency: 0.030992739950306714 sec
Decode latency: 2.3700464399298653 sec
Time for inference 9: 2.40 sec total, 106.59 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 748.42 GB/s
FLOPS achieved: 3.74 TF/s

Prefill latency: 0.031007507001049817 sec
Decode latency: 2.4939211409073323 sec
Time for inference 10: 2.53 sec total, 101.36 tokens/sec
Decode latency: 2.49 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 711.69 GB/s
FLOPS achieved: 3.56 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4614 sec
Average prefill latency: 0.0310 sec
Average tokens/sec: 102.72
Memory used: 8.54 GB
Done. we are killing the process
