flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=2304, out_features=25344, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.90 seconds
Prefill latency: 0.39546350098680705 sec
Decode latency: 5.124188894988038 sec
Compilation time: 5.52 seconds
Prefill latency: 0.39608092105481774 sec
Decode latency: 5.123148376005702 sec
Prefill latency: 0.3967041680589318 sec
Decode latency: 5.122395923011936 sec
Prefill latency: 0.3964624690124765 sec
Decode latency: 5.123526628012769 sec
Prefill latency: 0.39650752302259207 sec
Decode latency: 5.1235104439547285 sec
Prefill latency: 0.3986676640342921 sec
Decode latency: 5.123143394943327 sec
Time for inference 1: 5.52 sec total, 741.64 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5207.39 GB/s
FLOPS achieved: 26.04 TF/s

Prefill latency: 0.40061562007758766 sec
Decode latency: 5.124278943985701 sec
Time for inference 2: 5.53 sec total, 741.23 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5204.50 GB/s
FLOPS achieved: 26.02 TF/s

Prefill latency: 0.395884883007966 sec
Decode latency: 5.0120117829646915 sec
Time for inference 3: 5.41 sec total, 757.29 tokens/sec
Decode latency: 5.01 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5317.28 GB/s
FLOPS achieved: 26.59 TF/s

Prefill latency: 0.3965221010148525 sec
Decode latency: 5.123401907971129 sec
Time for inference 4: 5.52 sec total, 741.93 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.43 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39581116696354 sec
Decode latency: 5.123709971085191 sec
Time for inference 5: 5.52 sec total, 741.97 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.68 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39629789104219526 sec
Decode latency: 5.123363696970046 sec
Time for inference 6: 5.52 sec total, 741.94 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5209.47 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39509627397637814 sec
Decode latency: 5.123118440969847 sec
Time for inference 7: 5.52 sec total, 742.14 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5210.93 GB/s
FLOPS achieved: 26.05 TF/s

Prefill latency: 0.39588586904574186 sec
Decode latency: 5.1355057989712805 sec
Time for inference 8: 5.53 sec total, 740.40 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5198.67 GB/s
FLOPS achieved: 25.99 TF/s

Prefill latency: 0.4006437440402806 sec
Decode latency: 5.122548507992178 sec
Time for inference 9: 5.52 sec total, 741.51 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5206.47 GB/s
FLOPS achieved: 26.03 TF/s

Prefill latency: 0.39750497101340443 sec
Decode latency: 5.134542468003929 sec
Time for inference 10: 5.53 sec total, 740.32 tokens/sec
Decode latency: 5.13 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5198.11 GB/s
FLOPS achieved: 25.99 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1146 sec
Average prefill latency: 0.3973 sec
Average tokens/sec: 743.04
Memory used: 21.96 GB
Done. we are killing the process
