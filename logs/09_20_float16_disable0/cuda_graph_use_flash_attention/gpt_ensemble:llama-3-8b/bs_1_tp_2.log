W1001 00:08:45.184000 23413667489600 torch/distributed/run.py:779] 
W1001 00:08:45.184000 23413667489600 torch/distributed/run.py:779] *****************************************
W1001 00:08:45.184000 23413667489600 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:08:45.184000 23413667489600 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.034607067704200745 sec
Decode latency: 2.3276977259665728 sec
Compilation time: 2.36 seconds
Compilation time: 2.35 seconds
Prefill latency: 0.02397087123245001 sec
Decode latency: 2.327390135265887 sec
Prefill latency: 0.02390484232455492 sec
Decode latency: 2.3270856104791164 sec
Prefill latency: 0.023931080475449562 sec
Decode latency: 2.327256035991013 sec
Prefill latency: 0.023944365791976452 sec
Decode latency: 2.3282199976965785 sec
Prefill latency: 0.024010437540709972 sec
Decode latency: 2.329791883006692 sec
Time for inference 1: 2.35 sec total, 108.72 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.08 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.02393409702926874 sec
Decode latency: 2.3294782480224967 sec
Time for inference 2: 2.35 sec total, 108.74 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.25 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.02396405301988125 sec
Decode latency: 2.3287966288626194 sec
Time for inference 3: 2.35 sec total, 108.78 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.53 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.02401473931968212 sec
Decode latency: 2.329008111730218 sec
Time for inference 4: 2.35 sec total, 108.77 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.45 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.023916982114315033 sec
Decode latency: 2.32923461869359 sec
Time for inference 5: 2.35 sec total, 108.76 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.41 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.023941315710544586 sec
Decode latency: 2.3291569715365767 sec
Time for inference 6: 2.35 sec total, 108.76 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.39 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.0239989859983325 sec
Decode latency: 2.3288522697985172 sec
Time for inference 7: 2.35 sec total, 108.78 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.53 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.0239466717466712 sec
Decode latency: 2.3292714413255453 sec
Time for inference 8: 2.35 sec total, 108.76 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.43 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.023927940987050533 sec
Decode latency: 2.329142091795802 sec
Time for inference 9: 2.35 sec total, 108.76 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.43 GB/s
FLOPS achieved: 4.37 TF/s

Prefill latency: 0.023994507268071175 sec
Decode latency: 2.3292636033147573 sec
Time for inference 10: 2.35 sec total, 108.75 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 873.32 GB/s
FLOPS achieved: 4.37 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3292 sec
Average prefill latency: 0.0240 sec
Average tokens/sec: 108.76
Memory used: 10.13 GB
Done. we are killing the process
