flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.93 seconds
Prefill latency: 0.3003000346943736 sec
Decode latency: 4.438574021682143 sec
Compilation time: 4.74 seconds
Prefill latency: 0.30139357410371304 sec
Decode latency: 4.544610024429858 sec
Prefill latency: 0.30280555598437786 sec
Decode latency: 4.54169159475714 sec
Prefill latency: 0.3016305100172758 sec
Decode latency: 4.467445456422865 sec
Prefill latency: 0.30099239759147167 sec
Decode latency: 4.502429777756333 sec
Prefill latency: 0.3013200741261244 sec
Decode latency: 4.435139720328152 sec
Time for inference 1: 4.74 sec total, 432.31 tokens/sec
Decode latency: 4.44 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6488.94 GB/s
FLOPS achieved: 32.44 TF/s

Prefill latency: 0.3005960090085864 sec
Decode latency: 4.542391311377287 sec
Time for inference 2: 4.84 sec total, 422.81 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6346.33 GB/s
FLOPS achieved: 31.73 TF/s

Prefill latency: 0.30215560365468264 sec
Decode latency: 4.542693996801972 sec
Time for inference 3: 4.85 sec total, 422.62 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6343.41 GB/s
FLOPS achieved: 31.72 TF/s

Prefill latency: 0.30202991142868996 sec
Decode latency: 4.445411000400782 sec
Time for inference 4: 4.75 sec total, 431.31 tokens/sec
Decode latency: 4.45 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6473.84 GB/s
FLOPS achieved: 32.37 TF/s

Prefill latency: 0.30173113383352757 sec
Decode latency: 4.453277635388076 sec
Time for inference 5: 4.76 sec total, 430.63 tokens/sec
Decode latency: 4.45 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6463.68 GB/s
FLOPS achieved: 32.32 TF/s

Prefill latency: 0.30089342035353184 sec
Decode latency: 4.543411020189524 sec
Time for inference 6: 4.85 sec total, 422.69 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6344.54 GB/s
FLOPS achieved: 31.72 TF/s

Prefill latency: 0.30204735789448023 sec
Decode latency: 4.433896134607494 sec
Time for inference 7: 4.74 sec total, 432.35 tokens/sec
Decode latency: 4.43 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6489.52 GB/s
FLOPS achieved: 32.45 TF/s

Prefill latency: 0.3011439982801676 sec
Decode latency: 4.461845614947379 sec
Time for inference 8: 4.76 sec total, 429.90 tokens/sec
Decode latency: 4.46 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6452.77 GB/s
FLOPS achieved: 32.26 TF/s

Prefill latency: 0.30265727266669273 sec
Decode latency: 4.478457534685731 sec
Time for inference 9: 4.78 sec total, 428.26 tokens/sec
Decode latency: 4.48 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6428.09 GB/s
FLOPS achieved: 32.14 TF/s

Prefill latency: 0.30165496096014977 sec
Decode latency: 4.543657663278282 sec
Time for inference 10: 4.85 sec total, 422.59 tokens/sec
Decode latency: 4.54 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6343.05 GB/s
FLOPS achieved: 31.72 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.4880 sec
Average prefill latency: 0.3016 sec
Average tokens/sec: 427.55
Memory used: 23.41 GB
Done. we are killing the process
