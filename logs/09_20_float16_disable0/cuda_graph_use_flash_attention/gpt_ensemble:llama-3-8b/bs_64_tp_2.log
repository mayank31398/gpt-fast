W1001 00:29:27.420000 23004877317952 torch/distributed/run.py:779] 
W1001 00:29:27.420000 23004877317952 torch/distributed/run.py:779] *****************************************
W1001 00:29:27.420000 23004877317952 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:29:27.420000 23004877317952 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 1.4591581476852298 sec
Decode latency: 10.440670748241246 sec
Compilation time: 11.90 seconds
Compilation time: 11.90 seconds
Prefill latency: 1.4637336935847998 sec
Decode latency: 10.438381065614522 sec
Prefill latency: 1.4638335620984435 sec
Decode latency: 10.438845355995 sec
Prefill latency: 1.4640311663970351 sec
Decode latency: 10.438562035560608 sec
Prefill latency: 1.4650311740115285 sec
Decode latency: 10.437755212187767 sec
Prefill latency: 1.4651065552607179 sec
Decode latency: 10.434949805028737 sec
Time for inference 1: 11.90 sec total, 1376.67 tokens/sec
Decode latency: 10.43 sec
Prefill latency: 1.47 sec
Bandwidth achieved: 11055.42 GB/s
FLOPS achieved: 55.28 TF/s

Prefill latency: 1.4687201157212257 sec
Decode latency: 10.435043068602681 sec
Time for inference 2: 11.90 sec total, 1376.27 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.47 sec
Bandwidth achieved: 11052.14 GB/s
FLOPS achieved: 55.26 TF/s

Prefill latency: 1.4654202237725258 sec
Decode latency: 10.439468733035028 sec
Time for inference 3: 11.91 sec total, 1376.13 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.47 sec
Bandwidth achieved: 11051.09 GB/s
FLOPS achieved: 55.26 TF/s

Prefill latency: 1.4591711955145001 sec
Decode latency: 10.438788887113333 sec
Time for inference 4: 11.90 sec total, 1376.94 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.46 sec
Bandwidth achieved: 11057.56 GB/s
FLOPS achieved: 55.29 TF/s

Prefill latency: 1.464103295467794 sec
Decode latency: 10.437374311499298 sec
Time for inference 5: 11.90 sec total, 1376.52 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.46 sec
Bandwidth achieved: 11054.19 GB/s
FLOPS achieved: 55.27 TF/s

Prefill latency: 1.4635952739045024 sec
Decode latency: 10.44027354195714 sec
Time for inference 6: 11.90 sec total, 1376.25 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.46 sec
Bandwidth achieved: 11052.03 GB/s
FLOPS achieved: 55.26 TF/s

Prefill latency: 1.4653723742812872 sec
Decode latency: 10.436499894596636 sec
Time for inference 7: 11.90 sec total, 1376.47 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.47 sec
Bandwidth achieved: 11053.78 GB/s
FLOPS achieved: 55.27 TF/s

Prefill latency: 1.4657919695600867 sec
Decode latency: 10.43533452320844 sec
Time for inference 8: 11.90 sec total, 1376.57 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.47 sec
Bandwidth achieved: 11054.57 GB/s
FLOPS achieved: 55.27 TF/s

Prefill latency: 1.4616098692640662 sec
Decode latency: 10.438106407411397 sec
Time for inference 9: 11.90 sec total, 1376.74 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.46 sec
Bandwidth achieved: 11055.92 GB/s
FLOPS achieved: 55.28 TF/s

Prefill latency: 1.4643956944346428 sec
Decode latency: 10.435848723165691 sec
Time for inference 10: 11.90 sec total, 1376.68 tokens/sec
Decode latency: 10.44 sec
Prefill latency: 1.46 sec
Bandwidth achieved: 11055.49 GB/s
FLOPS achieved: 55.28 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.4372 sec
Average prefill latency: 1.4643 sec
Average tokens/sec: 1376.52
Memory used: 67.67 GB
Done. we are killing the process
