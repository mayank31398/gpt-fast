W0928 17:53:20.039000 23032256583488 torch/distributed/run.py:779] 
W0928 17:53:20.039000 23032256583488 torch/distributed/run.py:779] *****************************************
W0928 17:53:20.039000 23032256583488 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:53:20.039000 23032256583488 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=8448, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.99 seconds
Prefill latency: 0.7975057829171419 sec
Decode latency: 8.002366212196648 sec
Compilation time: 8.88 seconds
Compilation time: 8.78 seconds
Compilation time: 8.79 seconds
Compilation time: 8.84 seconds
Compilation time: 8.80 seconds
Compilation time: 8.80 seconds
Compilation time: 8.83 seconds
Compilation time: 8.80 seconds
Prefill latency: 0.7840013522654772 sec
Decode latency: 8.000256857834756 sec
Prefill latency: 0.7854525949805975 sec
Decode latency: 8.004932560026646 sec
Prefill latency: 0.7864456009119749 sec
Decode latency: 8.006170124746859 sec
Prefill latency: 0.7861205292865634 sec
Decode latency: 8.004072871990502 sec
Prefill latency: 0.78270682413131 sec
Decode latency: 8.004922424443066 sec
Time for inference 1: 8.79 sec total, 466.06 tokens/sec
Decode latency: 8.00 sec
Prefill latency: 0.78 sec
Bandwidth achieved: 8955.59 GB/s
FLOPS achieved: 44.78 TF/s

Prefill latency: 0.7869916278868914 sec
Decode latency: 8.003934955224395 sec
Time for inference 2: 8.79 sec total, 465.88 tokens/sec
Decode latency: 8.00 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8952.18 GB/s
FLOPS achieved: 44.76 TF/s

Prefill latency: 0.7867222102358937 sec
Decode latency: 8.004054714925587 sec
Time for inference 3: 8.79 sec total, 465.89 tokens/sec
Decode latency: 8.00 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8952.31 GB/s
FLOPS achieved: 44.76 TF/s

Prefill latency: 0.7871365202590823 sec
Decode latency: 8.001671025529504 sec
Time for inference 4: 8.79 sec total, 466.00 tokens/sec
Decode latency: 8.00 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8954.33 GB/s
FLOPS achieved: 44.77 TF/s

Prefill latency: 0.7846099166199565 sec
Decode latency: 8.006579237058759 sec
Time for inference 5: 8.79 sec total, 465.87 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.78 sec
Bandwidth achieved: 8951.93 GB/s
FLOPS achieved: 44.76 TF/s

Prefill latency: 0.7837170045822859 sec
Decode latency: 8.006333702243865 sec
Time for inference 6: 8.79 sec total, 465.93 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.78 sec
Bandwidth achieved: 8952.97 GB/s
FLOPS achieved: 44.76 TF/s

Prefill latency: 0.787325968965888 sec
Decode latency: 8.005536963231862 sec
Time for inference 7: 8.79 sec total, 465.79 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8950.31 GB/s
FLOPS achieved: 44.75 TF/s

Prefill latency: 0.7854434810578823 sec
Decode latency: 8.007591646164656 sec
Time for inference 8: 8.79 sec total, 465.78 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8950.10 GB/s
FLOPS achieved: 44.75 TF/s

Prefill latency: 0.7864205949008465 sec
Decode latency: 8.006960371509194 sec
Time for inference 9: 8.79 sec total, 465.76 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8949.78 GB/s
FLOPS achieved: 44.75 TF/s

Prefill latency: 0.7859499659389257 sec
Decode latency: 8.006317137740552 sec
Time for inference 10: 8.79 sec total, 465.82 tokens/sec
Decode latency: 8.01 sec
Prefill latency: 0.79 sec
Bandwidth achieved: 8950.92 GB/s
FLOPS achieved: 44.75 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.0054 sec
Average prefill latency: 0.7857 sec
Average tokens/sec: 465.88
Memory used: 49.94 GB
Done. we are killing the process
