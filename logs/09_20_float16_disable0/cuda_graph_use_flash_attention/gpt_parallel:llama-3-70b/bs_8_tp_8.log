W0928 17:47:20.202000 23328735434560 torch/distributed/run.py:779] 
W0928 17:47:20.202000 23328735434560 torch/distributed/run.py:779] *****************************************
W0928 17:47:20.202000 23328735434560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:47:20.202000 23328735434560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=8448, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.16 seconds
Prefill latency: 0.427706147544086 sec
Decode latency: 6.9012718154117465 sec
Compilation time: 7.33 seconds
Compilation time: 7.31 seconds
Compilation time: 7.31 seconds
Compilation time: 7.31 seconds
Compilation time: 7.29 seconds
Compilation time: 7.30 secondsCompilation time: 7.30 seconds

Compilation time: 7.29 seconds
Prefill latency: 0.3870798712596297 sec
Decode latency: 6.904109961353242 sec
Prefill latency: 0.3864380521699786 sec
Decode latency: 6.900892300531268 sec
Prefill latency: 0.38785401824861765 sec
Decode latency: 6.9030749425292015 sec
Prefill latency: 0.3874885616824031 sec
Decode latency: 6.901515920646489 sec
Prefill latency: 0.3876892849802971 sec
Decode latency: 6.9038226986303926 sec
Time for inference 1: 7.29 sec total, 280.84 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5396.46 GB/s
FLOPS achieved: 26.98 TF/s

Prefill latency: 0.3880459927022457 sec
Decode latency: 6.900997549295425 sec
Time for inference 2: 7.29 sec total, 280.93 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5398.26 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.38849295116961 sec
Decode latency: 6.902105074375868 sec
Time for inference 3: 7.29 sec total, 280.87 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5397.12 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.388127701357007 sec
Decode latency: 6.902663226239383 sec
Time for inference 4: 7.29 sec total, 280.87 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5397.06 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.38759976997971535 sec
Decode latency: 6.902273065410554 sec
Time for inference 5: 7.29 sec total, 280.90 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5397.70 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.38865262642502785 sec
Decode latency: 6.901997926644981 sec
Time for inference 6: 7.29 sec total, 280.87 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5397.10 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.38789047952741385 sec
Decode latency: 6.901700912974775 sec
Time for inference 7: 7.29 sec total, 280.92 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5397.92 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.38815884478390217 sec
Decode latency: 6.904002841562033 sec
Time for inference 8: 7.29 sec total, 280.82 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5396.04 GB/s
FLOPS achieved: 26.98 TF/s

Prefill latency: 0.3878458943217993 sec
Decode latency: 6.901532894000411 sec
Time for inference 9: 7.29 sec total, 280.92 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5398.04 GB/s
FLOPS achieved: 26.99 TF/s

Prefill latency: 0.3883085520938039 sec
Decode latency: 6.903407791629434 sec
Time for inference 10: 7.29 sec total, 280.83 tokens/sec
Decode latency: 6.90 sec
Prefill latency: 0.39 sec
Bandwidth achieved: 5396.35 GB/s
FLOPS achieved: 26.98 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.9024 sec
Average prefill latency: 0.3881 sec
Average tokens/sec: 280.88
Memory used: 35.69 GB
Done. we are killing the process
