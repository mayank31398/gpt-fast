W0928 17:38:06.716000 23103934691136 torch/distributed/run.py:779] 
W0928 17:38:06.716000 23103934691136 torch/distributed/run.py:779] *****************************************
W0928 17:38:06.716000 23103934691136 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:38:06.716000 23103934691136 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=8192, out_features=8448, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.07171263266354799 sec
Decode latency: 5.377352993004024 sec
Compilation time: 5.45 seconds
Compilation time: 5.45 seconds
Compilation time: 5.57 seconds
Compilation time: 5.54 seconds
Compilation time: 5.48 seconds
Compilation time: 5.45 seconds
Compilation time: 5.45 seconds
Compilation time: 5.51 seconds
Prefill latency: 0.06606151629239321 sec
Decode latency: 5.376212764531374 sec
Prefill latency: 0.06604002323001623 sec
Decode latency: 5.375615203753114 sec
Prefill latency: 0.06622492056339979 sec
Decode latency: 5.376748578622937 sec
Prefill latency: 0.06596985459327698 sec
Decode latency: 5.375717149116099 sec
Prefill latency: 0.065880686044693 sec
Decode latency: 5.376205852255225 sec
Time for inference 1: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.76 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06605584546923637 sec
Decode latency: 5.375915083102882 sec
Time for inference 2: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.79 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06621427275240421 sec
Decode latency: 5.375605613924563 sec
Time for inference 3: 5.44 sec total, 47.04 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.82 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06587380729615688 sec
Decode latency: 5.376564914360642 sec
Time for inference 4: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.71 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06606582179665565 sec
Decode latency: 5.3760750172659755 sec
Time for inference 5: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.76 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.0662384582683444 sec
Decode latency: 5.375975066795945 sec
Time for inference 6: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.75 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06584486644715071 sec
Decode latency: 5.376161788590252 sec
Time for inference 7: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.76 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06600785348564386 sec
Decode latency: 5.376013603061438 sec
Time for inference 8: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.77 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06597948633134365 sec
Decode latency: 5.37665178347379 sec
Time for inference 9: 5.44 sec total, 47.03 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.67 GB/s
FLOPS achieved: 4.52 TF/s

Prefill latency: 0.06621698755770922 sec
Decode latency: 5.3755786987021565 sec
Time for inference 10: 5.44 sec total, 47.04 tokens/sec
Decode latency: 5.38 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 903.82 GB/s
FLOPS achieved: 4.52 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.3761 sec
Average prefill latency: 0.0660 sec
Average tokens/sec: 47.03
Memory used: 23.24 GB
Done. we are killing the process
