W1001 02:36:17.717000 23278502602560 torch/distributed/run.py:779] 
W1001 02:36:17.717000 23278502602560 torch/distributed/run.py:779] *****************************************
W1001 02:36:17.717000 23278502602560 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:36:17.717000 23278502602560 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.22624322201590985 sec
Decode latency: 3.3740137990098447 sec
Compilation time: 3.60 seconds
Compilation time: 3.60 seconds
Prefill latency: 0.22547427006065845 sec
Decode latency: 3.3729583399835974 sec
Prefill latency: 0.22479285998269916 sec
Decode latency: 3.373243498033844 sec
Prefill latency: 0.22547884995583445 sec
Decode latency: 3.373021592036821 sec
Prefill latency: 0.22505394101608545 sec
Decode latency: 3.3734009340405464 sec
Prefill latency: 0.22466560907196254 sec
Decode latency: 3.3741127719404176 sec
Time for inference 1: 3.60 sec total, 1137.95 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4124.20 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.22548791393637657 sec
Decode latency: 3.373773077968508 sec
Time for inference 2: 3.60 sec total, 1137.77 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 4123.57 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.22492358193267137 sec
Decode latency: 3.3731892029754817 sec
Time for inference 3: 3.60 sec total, 1138.15 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4124.93 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.22495152603369206 sec
Decode latency: 3.3738366150064394 sec
Time for inference 4: 3.60 sec total, 1137.89 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4124.00 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.22533599799498916 sec
Decode latency: 3.374556349008344 sec
Time for inference 5: 3.60 sec total, 1137.57 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 4122.82 GB/s
FLOPS achieved: 20.61 TF/s

Prefill latency: 0.22499459597747773 sec
Decode latency: 3.3741363550070673 sec
Time for inference 6: 3.60 sec total, 1137.81 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4123.71 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.2252341890707612 sec
Decode latency: 3.3750347199384123 sec
Time for inference 7: 3.60 sec total, 1137.47 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 4122.47 GB/s
FLOPS achieved: 20.61 TF/s

Prefill latency: 0.22534881893079728 sec
Decode latency: 3.37397695297841 sec
Time for inference 8: 3.60 sec total, 1137.77 tokens/sec
Decode latency: 3.37 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 4123.55 GB/s
FLOPS achieved: 20.62 TF/s

Prefill latency: 0.22477447905112058 sec
Decode latency: 3.375382047961466 sec
Time for inference 9: 3.60 sec total, 1137.50 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4122.60 GB/s
FLOPS achieved: 20.61 TF/s

Prefill latency: 0.2250174810178578 sec
Decode latency: 3.3754622030537575 sec
Time for inference 10: 3.60 sec total, 1137.39 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.23 sec
Bandwidth achieved: 4122.18 GB/s
FLOPS achieved: 20.61 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3743 sec
Average prefill latency: 0.2251 sec
Average tokens/sec: 1137.73
Memory used: 13.76 GB
Done. we are killing the process
