flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.38 seconds
Prefill latency: 1.618287469027564 sec
Decode latency: 12.791435308055952 sec
Compilation time: 14.41 seconds
Prefill latency: 1.6268657030304894 sec
Decode latency: 12.789373040082864 sec
Prefill latency: 1.6297135999193415 sec
Decode latency: 12.787106210947968 sec
Prefill latency: 1.6179762749234214 sec
Decode latency: 12.79048523597885 sec
Prefill latency: 1.6221718379529193 sec
Decode latency: 12.787479975959286 sec
Prefill latency: 1.6178170340135694 sec
Decode latency: 12.78947270999197 sec
Time for inference 1: 14.41 sec total, 1137.11 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7984.38 GB/s
FLOPS achieved: 39.92 TF/s

Prefill latency: 1.622656087973155 sec
Decode latency: 12.789966352982447 sec
Time for inference 2: 14.41 sec total, 1136.69 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7981.45 GB/s
FLOPS achieved: 39.91 TF/s

Prefill latency: 1.6286236280575395 sec
Decode latency: 12.79259365494363 sec
Time for inference 3: 14.42 sec total, 1136.01 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7976.68 GB/s
FLOPS achieved: 39.88 TF/s

Prefill latency: 1.6269082120852545 sec
Decode latency: 12.788582108914852 sec
Time for inference 4: 14.42 sec total, 1136.46 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7979.84 GB/s
FLOPS achieved: 39.90 TF/s

Prefill latency: 1.6300335600972176 sec
Decode latency: 12.78952157101594 sec
Time for inference 5: 14.42 sec total, 1136.15 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.62 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6291175240185112 sec
Decode latency: 12.790091075003147 sec
Time for inference 6: 14.42 sec total, 1136.17 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.76 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.628541941056028 sec
Decode latency: 12.790234929998405 sec
Time for inference 7: 14.42 sec total, 1136.20 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7978.02 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6287058469606563 sec
Decode latency: 12.791093404055573 sec
Time for inference 8: 14.42 sec total, 1136.14 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7977.55 GB/s
FLOPS achieved: 39.89 TF/s

Prefill latency: 1.6275418709265068 sec
Decode latency: 12.788789590005763 sec
Time for inference 9: 14.42 sec total, 1136.39 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.63 sec
Bandwidth achieved: 7979.33 GB/s
FLOPS achieved: 39.90 TF/s

Prefill latency: 1.6153738140128553 sec
Decode latency: 12.788910602917895 sec
Time for inference 10: 14.41 sec total, 1137.36 tokens/sec
Decode latency: 12.79 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 7986.10 GB/s
FLOPS achieved: 39.93 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 12.7899 sec
Average prefill latency: 1.6255 sec
Average tokens/sec: 1136.47
Memory used: 62.86 GB
Done. we are killing the process
