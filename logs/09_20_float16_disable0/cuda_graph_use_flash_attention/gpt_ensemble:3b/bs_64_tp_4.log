W1001 02:45:07.932000 23100088911680 torch/distributed/run.py:779] 
W1001 02:45:07.932000 23100088911680 torch/distributed/run.py:779] *****************************************
W1001 02:45:07.932000 23100088911680 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:45:07.932000 23100088911680 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.19 seconds
Prefill latency: 0.5261068729450926 sec
Decode latency: 4.963587939972058 sec
Compilation time: 5.48 secondsCompilation time: 5.47 seconds

Compilation time: 5.49 secondsCompilation time: 5.49 seconds

Prefill latency: 0.5074053320568055 sec
Decode latency: 4.963112242054194 sec
Prefill latency: 0.5082109649665654 sec
Decode latency: 4.959686579066329 sec
Prefill latency: 0.5084700590232387 sec
Decode latency: 4.957057166961022 sec
Prefill latency: 0.5077983778901398 sec
Decode latency: 4.952911319909617 sec
Prefill latency: 0.5086993060540408 sec
Decode latency: 4.953927470953204 sec
Time for inference 1: 5.46 sec total, 2998.84 tokens/sec
Decode latency: 4.95 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5774.45 GB/s
FLOPS achieved: 28.87 TF/s

Prefill latency: 0.50886750605423 sec
Decode latency: 4.961499999044463 sec
Time for inference 2: 5.47 sec total, 2994.53 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5766.15 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5095964580541477 sec
Decode latency: 4.961639714078046 sec
Time for inference 3: 5.47 sec total, 2994.07 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5765.25 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5092431870289147 sec
Decode latency: 4.961108212010004 sec
Time for inference 4: 5.47 sec total, 2994.62 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5766.32 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5083236659411341 sec
Decode latency: 4.959826673963107 sec
Time for inference 5: 5.47 sec total, 2995.83 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5768.65 GB/s
FLOPS achieved: 28.84 TF/s

Prefill latency: 0.5090246460167691 sec
Decode latency: 4.961528443032876 sec
Time for inference 6: 5.47 sec total, 2994.54 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5766.16 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5095696059288457 sec
Decode latency: 4.960487973992713 sec
Time for inference 7: 5.47 sec total, 2994.66 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5766.40 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5097775040194392 sec
Decode latency: 4.961244500940666 sec
Time for inference 8: 5.47 sec total, 2994.15 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5765.41 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5099141100654379 sec
Decode latency: 4.961404536035843 sec
Time for inference 9: 5.47 sec total, 2994.12 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5765.36 GB/s
FLOPS achieved: 28.83 TF/s

Prefill latency: 0.5104204670060426 sec
Decode latency: 4.961003580945544 sec
Time for inference 10: 5.47 sec total, 2994.04 tokens/sec
Decode latency: 4.96 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 5765.21 GB/s
FLOPS achieved: 28.83 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.9604 sec
Average prefill latency: 0.5093 sec
Average tokens/sec: 2994.94
Memory used: 31.24 GB
Done. we are killing the process
