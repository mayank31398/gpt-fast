flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.20362034707795829 sec
Decode latency: 3.615619816002436 sec
Compilation time: 3.82 seconds
Prefill latency: 0.20364682096987963 sec
Decode latency: 3.614936201949604 sec
Prefill latency: 0.20352406904567033 sec
Decode latency: 3.615081861964427 sec
Prefill latency: 0.2027389759896323 sec
Decode latency: 3.614358384977095 sec
Prefill latency: 0.20392078894656152 sec
Decode latency: 3.615128755918704 sec
Prefill latency: 0.20389680296648294 sec
Decode latency: 3.615188258001581 sec
Time for inference 1: 3.82 sec total, 536.11 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.39 GB/s
FLOPS achieved: 18.82 TF/s

Prefill latency: 0.2032765110488981 sec
Decode latency: 3.6148266108939424 sec
Time for inference 2: 3.82 sec total, 536.27 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3765.49 GB/s
FLOPS achieved: 18.83 TF/s

Prefill latency: 0.20429511996917427 sec
Decode latency: 3.614947636029683 sec
Time for inference 3: 3.82 sec total, 536.12 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.42 GB/s
FLOPS achieved: 18.82 TF/s

Prefill latency: 0.20354820601642132 sec
Decode latency: 3.6148976819822565 sec
Time for inference 4: 3.82 sec total, 536.24 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3765.30 GB/s
FLOPS achieved: 18.83 TF/s

Prefill latency: 0.20394222193863243 sec
Decode latency: 3.6149155820021406 sec
Time for inference 5: 3.82 sec total, 536.18 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.89 GB/s
FLOPS achieved: 18.82 TF/s

Prefill latency: 0.20412646105978638 sec
Decode latency: 3.6150374630233273 sec
Time for inference 6: 3.82 sec total, 536.13 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.54 GB/s
FLOPS achieved: 18.82 TF/s

Prefill latency: 0.20450456300750375 sec
Decode latency: 3.61463812191505 sec
Time for inference 7: 3.82 sec total, 536.14 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.57 GB/s
FLOPS achieved: 18.82 TF/s

Prefill latency: 0.20311084704007953 sec
Decode latency: 3.614775966037996 sec
Time for inference 8: 3.82 sec total, 536.32 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3765.83 GB/s
FLOPS achieved: 18.83 TF/s

Prefill latency: 0.2033035239437595 sec
Decode latency: 3.613990962971002 sec
Time for inference 9: 3.82 sec total, 536.37 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3766.20 GB/s
FLOPS achieved: 18.83 TF/s

Prefill latency: 0.20386559003964067 sec
Decode latency: 3.6151421789545566 sec
Time for inference 10: 3.82 sec total, 536.14 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3764.56 GB/s
FLOPS achieved: 18.82 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6148 sec
Average prefill latency: 0.2038 sec
Average tokens/sec: 536.20
Memory used: 14.62 GB
Done. we are killing the process
