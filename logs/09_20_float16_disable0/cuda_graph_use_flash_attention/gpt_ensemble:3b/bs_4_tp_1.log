flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.87 seconds
Prefill latency: 0.10409371100831777 sec
Decode latency: 3.132646134006791 sec
Compilation time: 3.24 seconds
Prefill latency: 0.10359576204791665 sec
Decode latency: 3.131912039942108 sec
Prefill latency: 0.10394508601166308 sec
Decode latency: 3.1329221519408748 sec
Prefill latency: 0.10385957197286189 sec
Decode latency: 3.13268908590544 sec
Prefill latency: 0.10397434199694544 sec
Decode latency: 3.13266923208721 sec
Prefill latency: 0.10365384304895997 sec
Decode latency: 3.133449409971945 sec
Time for inference 1: 3.24 sec total, 316.26 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.66 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10369907005224377 sec
Decode latency: 3.1332092059310526 sec
Time for inference 2: 3.24 sec total, 316.28 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.79 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10352943104226142 sec
Decode latency: 3.1324173039756715 sec
Time for inference 3: 3.24 sec total, 316.37 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.46 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10361432400532067 sec
Decode latency: 3.131772506982088 sec
Time for inference 4: 3.24 sec total, 316.43 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.86 GB/s
FLOPS achieved: 11.11 TF/s

Prefill latency: 0.10365100996568799 sec
Decode latency: 3.13347010104917 sec
Time for inference 5: 3.24 sec total, 316.26 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.65 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10368631407618523 sec
Decode latency: 3.1331357629969716 sec
Time for inference 6: 3.24 sec total, 316.26 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.70 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10356157296337187 sec
Decode latency: 3.133127262000926 sec
Time for inference 7: 3.24 sec total, 316.28 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.80 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10351918498054147 sec
Decode latency: 3.133636561105959 sec
Time for inference 8: 3.24 sec total, 316.24 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.53 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10365216201171279 sec
Decode latency: 3.1330577629851177 sec
Time for inference 9: 3.24 sec total, 316.29 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2220.89 GB/s
FLOPS achieved: 11.10 TF/s

Prefill latency: 0.10363893292378634 sec
Decode latency: 3.1326192249543965 sec
Time for inference 10: 3.24 sec total, 316.34 tokens/sec
Decode latency: 3.13 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2221.26 GB/s
FLOPS achieved: 11.11 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1330 sec
Average prefill latency: 0.1036 sec
Average tokens/sec: 316.30
Memory used: 11.19 GB
Done. we are killing the process
