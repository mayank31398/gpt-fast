W1001 02:37:26.929000 23213528835904 torch/distributed/run.py:779] 
W1001 02:37:26.929000 23213528835904 torch/distributed/run.py:779] *****************************************
W1001 02:37:26.929000 23213528835904 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 02:37:26.929000 23213528835904 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 2.08 seconds
Prefill latency: 0.17002107994630933 sec
Decode latency: 2.7830480110133067 sec
Compilation time: 2.99 seconds
Compilation time: 2.93 seconds
Compilation time: 2.92 seconds
Compilation time: 2.95 seconds
Prefill latency: 0.13174074504058808 sec
Decode latency: 2.7812548850197345 sec
Prefill latency: 0.13147916400339454 sec
Decode latency: 2.782314174924977 sec
Prefill latency: 0.13156659994274378 sec
Decode latency: 2.781949670985341 sec
Prefill latency: 0.13161564606707543 sec
Decode latency: 2.7826125300489366 sec
Prefill latency: 0.1315937329782173 sec
Decode latency: 2.7830206429352984 sec
Time for inference 1: 2.92 sec total, 1404.92 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2705.26 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13172825810033828 sec
Decode latency: 2.782470511039719 sec
Time for inference 2: 2.91 sec total, 1405.16 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2705.72 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13154346693772823 sec
Decode latency: 2.781359096057713 sec
Time for inference 3: 2.91 sec total, 1405.80 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2706.96 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13159058394376189 sec
Decode latency: 2.781293647014536 sec
Time for inference 4: 2.91 sec total, 1405.79 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2706.92 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13160306692589074 sec
Decode latency: 2.783034046064131 sec
Time for inference 5: 2.92 sec total, 1404.96 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2705.33 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13180305692367256 sec
Decode latency: 2.781114433077164 sec
Time for inference 6: 2.91 sec total, 1405.83 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2707.00 GB/s
FLOPS achieved: 13.54 TF/s

Prefill latency: 0.13160472898744047 sec
Decode latency: 2.7827734670136124 sec
Time for inference 7: 2.92 sec total, 1405.10 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2705.60 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13164228305686265 sec
Decode latency: 2.781644109985791 sec
Time for inference 8: 2.91 sec total, 1405.49 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2706.35 GB/s
FLOPS achieved: 13.53 TF/s

Prefill latency: 0.13153067196253687 sec
Decode latency: 2.783329183002934 sec
Time for inference 9: 2.92 sec total, 1404.72 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2704.86 GB/s
FLOPS achieved: 13.52 TF/s

Prefill latency: 0.13176138198468834 sec
Decode latency: 2.781941146007739 sec
Time for inference 10: 2.91 sec total, 1405.26 tokens/sec
Decode latency: 2.78 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 2705.92 GB/s
FLOPS achieved: 13.53 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7822 sec
Average prefill latency: 0.1316 sec
Average tokens/sec: 1405.30
Memory used: 9.77 GB
Done. we are killing the process
