W1001 01:11:27.230000 22366287341376 torch/distributed/run.py:779] 
W1001 01:11:27.230000 22366287341376 torch/distributed/run.py:779] *****************************************
W1001 01:11:27.230000 22366287341376 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:11:27.230000 22366287341376 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.24 seconds
[rank1]:[W1001 01:11:32.377150665 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.08216516498941928 sec
Decode latency: 2.508568837074563 sec
Compilation time: 2.59 seconds
Compilation time: 2.57 seconds
Prefill latency: 0.06037820305209607 sec
Decode latency: 2.5088181250030175 sec
Prefill latency: 0.060295218019746244 sec
Decode latency: 2.50782077095937 sec
Prefill latency: 0.060200855950824916 sec
Decode latency: 2.5079443840077147 sec
Prefill latency: 0.06033471797127277 sec
Decode latency: 2.507350070984103 sec
Prefill latency: 0.060291605070233345 sec
Decode latency: 2.5076869919430465 sec
Time for inference 1: 2.57 sec total, 398.64 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.78 GB/s
FLOPS achieved: 7.22 TF/s

Prefill latency: 0.06021082203369588 sec
Decode latency: 2.507638245006092 sec
Time for inference 2: 2.57 sec total, 398.64 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.76 GB/s
FLOPS achieved: 7.22 TF/s

Prefill latency: 0.06026492896489799 sec
Decode latency: 2.5074041390325874 sec
Time for inference 3: 2.57 sec total, 398.67 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.87 GB/s
FLOPS achieved: 7.22 TF/s

Prefill latency: 0.060124568990431726 sec
Decode latency: 2.5073379300301895 sec
Time for inference 4: 2.57 sec total, 398.71 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1445.04 GB/s
FLOPS achieved: 7.23 TF/s

Prefill latency: 0.06031137995887548 sec
Decode latency: 2.507440624991432 sec
Time for inference 5: 2.57 sec total, 398.67 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.89 GB/s
FLOPS achieved: 7.22 TF/s

Prefill latency: 0.060172282974235713 sec
Decode latency: 2.5072097869124264 sec
Time for inference 6: 2.57 sec total, 398.72 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1445.06 GB/s
FLOPS achieved: 7.23 TF/s

Prefill latency: 0.06021089805290103 sec
Decode latency: 2.507610587985255 sec
Time for inference 7: 2.57 sec total, 398.66 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.84 GB/s
FLOPS achieved: 7.22 TF/s

Prefill latency: 0.06028714496642351 sec
Decode latency: 2.5072966479929164 sec
Time for inference 8: 2.57 sec total, 398.71 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1445.03 GB/s
FLOPS achieved: 7.23 TF/s

Prefill latency: 0.06027655198704451 sec
Decode latency: 2.5072829829296097 sec
Time for inference 9: 2.57 sec total, 398.72 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1445.05 GB/s
FLOPS achieved: 7.23 TF/s

Prefill latency: 0.06027306499890983 sec
Decode latency: 2.5073367989389226 sec
Time for inference 10: 2.57 sec total, 398.70 tokens/sec
Decode latency: 2.51 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 1444.98 GB/s
FLOPS achieved: 7.22 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5074 sec
Average prefill latency: 0.0602 sec
Average tokens/sec: 398.68
Memory used: 7.37 GB
Done. we are killing the process
