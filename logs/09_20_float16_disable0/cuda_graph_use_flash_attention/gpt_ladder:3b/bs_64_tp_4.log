W1001 01:25:40.956000 22509036758848 torch/distributed/run.py:779] 
W1001 01:25:40.956000 22509036758848 torch/distributed/run.py:779] *****************************************
W1001 01:25:40.956000 22509036758848 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:25:40.956000 22509036758848 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.18 seconds
Prefill latency: 0.49512006307486445 sec
Decode latency: 4.8365729979705065 sec
Compilation time: 5.33 seconds
Compilation time: 5.33 seconds
Compilation time: 5.33 seconds
Compilation time: 5.33 seconds
Prefill latency: 0.49371924600563943 sec
Decode latency: 4.838366676005535 sec
Prefill latency: 0.4935279251076281 sec
Decode latency: 4.836437258985825 sec
Prefill latency: 0.4942266430007294 sec
Decode latency: 4.836855180095881 sec
Prefill latency: 0.49474219302646816 sec
Decode latency: 4.8378925959113985 sec
Prefill latency: 0.49439952394459397 sec
Decode latency: 4.837557355989702 sec
Time for inference 1: 5.33 sec total, 3072.32 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5915.94 GB/s
FLOPS achieved: 29.58 TF/s

Prefill latency: 0.49374647403601557 sec
Decode latency: 4.837297147954814 sec
Time for inference 2: 5.33 sec total, 3072.79 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5916.84 GB/s
FLOPS achieved: 29.58 TF/s

Prefill latency: 0.4947349049616605 sec
Decode latency: 4.837579661980271 sec
Time for inference 3: 5.33 sec total, 3072.08 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5915.47 GB/s
FLOPS achieved: 29.58 TF/s

Prefill latency: 0.49411262292414904 sec
Decode latency: 4.844328545033932 sec
Time for inference 4: 5.34 sec total, 3068.61 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5908.79 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.4946517701027915 sec
Decode latency: 4.844670186052099 sec
Time for inference 5: 5.34 sec total, 3068.08 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5907.77 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.494413128006272 sec
Decode latency: 4.8438899220200256 sec
Time for inference 6: 5.34 sec total, 3068.45 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5908.48 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.4946999909589067 sec
Decode latency: 4.84469944704324 sec
Time for inference 7: 5.34 sec total, 3067.99 tokens/sec
Decode latency: 4.84 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5907.59 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.4945729640312493 sec
Decode latency: 4.845199903938919 sec
Time for inference 8: 5.34 sec total, 3067.76 tokens/sec
Decode latency: 4.85 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5907.15 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.4941616100259125 sec
Decode latency: 4.845188473002054 sec
Time for inference 9: 5.34 sec total, 3068.00 tokens/sec
Decode latency: 4.85 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5907.62 GB/s
FLOPS achieved: 29.54 TF/s

Prefill latency: 0.494598584016785 sec
Decode latency: 4.845430820947513 sec
Time for inference 10: 5.34 sec total, 3067.61 tokens/sec
Decode latency: 4.85 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 5906.87 GB/s
FLOPS achieved: 29.53 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.8426 sec
Average prefill latency: 0.4944 sec
Average tokens/sec: 3069.37
Memory used: 43.63 GB
Done. we are killing the process
