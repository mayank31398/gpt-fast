W1001 01:17:34.271000 23441895995200 torch/distributed/run.py:779] 
W1001 01:17:34.271000 23441895995200 torch/distributed/run.py:779] *****************************************
W1001 01:17:34.271000 23441895995200 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:17:34.271000 23441895995200 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=3456, bias=False)
        (wo): Linear(in_features=1152, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=9216, bias=False)
        (w2): Linear(in_features=4608, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank1]:[W1001 01:17:40.881053312 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.21927276602946222 sec
Decode latency: 3.2944603479700163 sec
Compilation time: 3.52 seconds
Compilation time: 3.52 seconds
Prefill latency: 0.22049748804420233 sec
Decode latency: 3.2867158320732415 sec
Prefill latency: 0.22061633900739253 sec
Decode latency: 3.287776562036015 sec
Prefill latency: 0.21996653196401894 sec
Decode latency: 3.2865486319642514 sec
Prefill latency: 0.220937788952142 sec
Decode latency: 3.286865411908366 sec
Prefill latency: 0.21957272896543145 sec
Decode latency: 3.287564724101685 sec
Time for inference 1: 3.51 sec total, 1167.59 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4231.62 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.22079180006403476 sec
Decode latency: 3.286329202936031 sec
Time for inference 2: 3.51 sec total, 1167.63 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4231.78 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.2204252389492467 sec
Decode latency: 3.289283190970309 sec
Time for inference 3: 3.51 sec total, 1166.81 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4228.83 GB/s
FLOPS achieved: 21.14 TF/s

Prefill latency: 0.22027900605462492 sec
Decode latency: 3.2875132070621476 sec
Time for inference 4: 3.51 sec total, 1167.43 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4231.04 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.22023728501517326 sec
Decode latency: 3.287968026008457 sec
Time for inference 5: 3.51 sec total, 1167.31 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4230.62 GB/s
FLOPS achieved: 21.15 TF/s

Prefill latency: 0.22051910101436079 sec
Decode latency: 3.2862469700630754 sec
Time for inference 6: 3.51 sec total, 1167.77 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4232.30 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.22084824193734676 sec
Decode latency: 3.286859157960862 sec
Time for inference 7: 3.51 sec total, 1167.44 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4231.11 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.22040317300707102 sec
Decode latency: 3.2876282889628783 sec
Time for inference 8: 3.51 sec total, 1167.32 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4230.65 GB/s
FLOPS achieved: 21.15 TF/s

Prefill latency: 0.2204720340669155 sec
Decode latency: 3.2869977199006826 sec
Time for inference 9: 3.51 sec total, 1167.47 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4231.20 GB/s
FLOPS achieved: 21.16 TF/s

Prefill latency: 0.22083948692306876 sec
Decode latency: 3.2879324089735746 sec
Time for inference 10: 3.51 sec total, 1167.06 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 4229.72 GB/s
FLOPS achieved: 21.15 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.2874 sec
Average prefill latency: 0.2204 sec
Average tokens/sec: 1167.38
Memory used: 17.01 GB
Done. we are killing the process
