flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
Prefill latency: 0.03266902803443372 sec
Decode latency: 2.593223572941497 sec
Compilation time: 2.63 seconds
Prefill latency: 0.03230535704642534 sec
Decode latency: 2.455042490037158 sec
Prefill latency: 0.03215491399168968 sec
Decode latency: 2.5873610040871426 sec
Prefill latency: 0.03213928500190377 sec
Decode latency: 2.587914200965315 sec
Prefill latency: 0.032216044957749546 sec
Decode latency: 2.588399945991114 sec
Prefill latency: 0.032242837944068015 sec
Decode latency: 2.4780120099894702 sec
Time for inference 1: 2.51 sec total, 101.95 tokens/sec
Decode latency: 2.48 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 715.87 GB/s
FLOPS achieved: 3.58 TF/s

Prefill latency: 0.03219034802168608 sec
Decode latency: 2.5868346740026027 sec
Time for inference 2: 2.62 sec total, 97.72 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 686.13 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.0320846289396286 sec
Decode latency: 2.4656658170279115 sec
Time for inference 3: 2.50 sec total, 102.46 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 719.41 GB/s
FLOPS achieved: 3.60 TF/s

Prefill latency: 0.032271325937472284 sec
Decode latency: 2.559067983063869 sec
Time for inference 4: 2.59 sec total, 98.76 tokens/sec
Decode latency: 2.56 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 693.47 GB/s
FLOPS achieved: 3.47 TF/s

Prefill latency: 0.03212037601042539 sec
Decode latency: 2.588708791998215 sec
Time for inference 5: 2.62 sec total, 97.65 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.67 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.032121372991241515 sec
Decode latency: 2.4971793830627576 sec
Time for inference 6: 2.53 sec total, 101.18 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 710.47 GB/s
FLOPS achieved: 3.55 TF/s

Prefill latency: 0.032235017977654934 sec
Decode latency: 2.5265259370207787 sec
Time for inference 7: 2.56 sec total, 100.02 tokens/sec
Decode latency: 2.53 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 702.30 GB/s
FLOPS achieved: 3.51 TF/s

Prefill latency: 0.03211504698265344 sec
Decode latency: 2.587868300965056 sec
Time for inference 8: 2.62 sec total, 97.68 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.89 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.032137050991877913 sec
Decode latency: 2.5887701149331406 sec
Time for inference 9: 2.62 sec total, 97.65 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.64 GB/s
FLOPS achieved: 3.43 TF/s

Prefill latency: 0.03217034100089222 sec
Decode latency: 2.5873846450122073 sec
Time for inference 10: 2.62 sec total, 97.69 tokens/sec
Decode latency: 2.59 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 685.95 GB/s
FLOPS achieved: 3.43 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5466 sec
Average prefill latency: 0.0322 sec
Average tokens/sec: 99.28
Memory used: 8.80 GB
Done. we are killing the process
