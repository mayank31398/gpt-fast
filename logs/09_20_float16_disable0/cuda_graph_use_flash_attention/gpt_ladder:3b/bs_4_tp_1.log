flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W1001 01:10:35.150880592 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.10368361708242446 sec
Decode latency: 3.1572743030264974 sec
Compilation time: 3.26 seconds
Prefill latency: 0.10330073500517756 sec
Decode latency: 3.1577647080412135 sec
Prefill latency: 0.10321646998636425 sec
Decode latency: 3.1560868530068547 sec
Prefill latency: 0.10301591199822724 sec
Decode latency: 3.1575856569688767 sec
Prefill latency: 0.10378961300011724 sec
Decode latency: 3.157792954938486 sec
Prefill latency: 0.1033871800173074 sec
Decode latency: 3.1574994679540396 sec
Time for inference 1: 3.26 sec total, 313.93 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2204.33 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10305010504089296 sec
Decode latency: 3.158940735971555 sec
Time for inference 2: 3.26 sec total, 313.84 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2203.67 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10353267297614366 sec
Decode latency: 3.1567782529164106 sec
Time for inference 3: 3.26 sec total, 314.01 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2204.85 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10334747296292335 sec
Decode latency: 3.158096583094448 sec
Time for inference 4: 3.26 sec total, 313.90 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2204.13 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10348696692381054 sec
Decode latency: 3.1558403320377693 sec
Time for inference 5: 3.26 sec total, 314.11 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2205.57 GB/s
FLOPS achieved: 11.03 TF/s

Prefill latency: 0.10310226492583752 sec
Decode latency: 3.157852274016477 sec
Time for inference 6: 3.26 sec total, 313.95 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2204.47 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10385146806947887 sec
Decode latency: 3.1580946010071784 sec
Time for inference 7: 3.26 sec total, 313.86 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2203.80 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10306155600119382 sec
Decode latency: 3.1578524720389396 sec
Time for inference 8: 3.26 sec total, 313.96 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2204.51 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.1030454549472779 sec
Decode latency: 3.1592657080618665 sec
Time for inference 9: 3.26 sec total, 313.81 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2203.48 GB/s
FLOPS achieved: 11.02 TF/s

Prefill latency: 0.10328442498575896 sec
Decode latency: 3.1584466580534354 sec
Time for inference 10: 3.26 sec total, 313.87 tokens/sec
Decode latency: 3.16 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2203.88 GB/s
FLOPS achieved: 11.02 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.1579 sec
Average prefill latency: 0.1033 sec
Average tokens/sec: 313.93
Memory used: 12.08 GB
Done. we are killing the process
