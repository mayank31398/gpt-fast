flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W1001 01:16:06.437844578 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.3999867259990424 sec
Decode latency: 5.285018786089495 sec
Compilation time: 5.69 seconds
Prefill latency: 0.3966683059697971 sec
Decode latency: 5.271080762962811 sec
Prefill latency: 0.396998587064445 sec
Decode latency: 5.272393555031158 sec
Prefill latency: 0.39638041995931417 sec
Decode latency: 5.271208205027506 sec
Prefill latency: 0.3971229640301317 sec
Decode latency: 5.271989298984408 sec
Prefill latency: 0.39706648304127157 sec
Decode latency: 5.270997981890105 sec
Time for inference 1: 5.67 sec total, 722.54 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.44 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.39818639890290797 sec
Decode latency: 5.272009955020621 sec
Time for inference 2: 5.67 sec total, 722.28 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5071.59 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.39792740903794765 sec
Decode latency: 5.271688275970519 sec
Time for inference 3: 5.67 sec total, 722.34 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.00 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.3968970290152356 sec
Decode latency: 5.27168507699389 sec
Time for inference 4: 5.67 sec total, 722.46 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.82 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.3966003719251603 sec
Decode latency: 5.271587432012893 sec
Time for inference 5: 5.67 sec total, 722.52 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.24 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.39794168004300445 sec
Decode latency: 5.272094666957855 sec
Time for inference 6: 5.67 sec total, 722.30 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5071.70 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.39727502409368753 sec
Decode latency: 5.271622407017276 sec
Time for inference 7: 5.67 sec total, 722.45 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.76 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.39761257998179644 sec
Decode latency: 5.271551784011535 sec
Time for inference 8: 5.67 sec total, 722.39 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5072.37 GB/s
FLOPS achieved: 25.36 TF/s

Prefill latency: 0.3965807909844443 sec
Decode latency: 5.271675960975699 sec
Time for inference 9: 5.67 sec total, 722.50 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5073.11 GB/s
FLOPS achieved: 25.37 TF/s

Prefill latency: 0.39690533897373825 sec
Decode latency: 5.272768619004637 sec
Time for inference 10: 5.67 sec total, 722.32 tokens/sec
Decode latency: 5.27 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5071.88 GB/s
FLOPS achieved: 25.36 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.2718 sec
Average prefill latency: 0.3973 sec
Average tokens/sec: 722.41
Memory used: 24.99 GB
Done. we are killing the process
