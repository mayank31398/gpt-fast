W0930 18:37:42.849000 23205418264384 torch/distributed/run.py:779] 
W0930 18:37:42.849000 23205418264384 torch/distributed/run.py:779] *****************************************
W0930 18:37:42.849000 23205418264384 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 18:37:42.849000 23205418264384 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1280, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W930 18:37:48.390175466 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank1]:[W930 18:37:48.391754403 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.05523006699513644 sec
Decode latency: 2.502278713043779 sec
Compilation time: 2.56 seconds
Compilation time: 2.56 seconds
Prefill latency: 0.05383858899585903 sec
Decode latency: 2.502885494963266 sec
Prefill latency: 0.05388112599030137 sec
Decode latency: 2.50243966805283 sec
Prefill latency: 0.05376345198601484 sec
Decode latency: 2.502728363033384 sec
Prefill latency: 0.05381586798466742 sec
Decode latency: 2.50341526302509 sec
Prefill latency: 0.05390371195971966 sec
Decode latency: 2.5036345729604363 sec
Time for inference 1: 2.56 sec total, 800.49 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.87 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05395317205693573 sec
Decode latency: 2.5037439699517563 sec
Time for inference 2: 2.56 sec total, 800.50 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.88 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05392400699201971 sec
Decode latency: 2.5031758580589667 sec
Time for inference 3: 2.56 sec total, 800.67 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 927.08 GB/s
FLOPS achieved: 4.64 TF/s

Prefill latency: 0.053835850092582405 sec
Decode latency: 2.5036158729344606 sec
Time for inference 4: 2.56 sec total, 800.56 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.95 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05388545000459999 sec
Decode latency: 2.5032975369831547 sec
Time for inference 5: 2.56 sec total, 800.65 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 927.05 GB/s
FLOPS achieved: 4.64 TF/s

Prefill latency: 0.05397180002182722 sec
Decode latency: 2.503301777993329 sec
Time for inference 6: 2.56 sec total, 800.52 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.90 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.053961636032909155 sec
Decode latency: 2.503535815048963 sec
Time for inference 7: 2.56 sec total, 800.43 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.80 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05388445605058223 sec
Decode latency: 2.504000600078143 sec
Time for inference 8: 2.56 sec total, 800.36 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.71 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05404808896128088 sec
Decode latency: 2.503519147983752 sec
Time for inference 9: 2.56 sec total, 800.50 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 926.89 GB/s
FLOPS achieved: 4.63 TF/s

Prefill latency: 0.05387667298782617 sec
Decode latency: 2.502357798977755 sec
Time for inference 10: 2.56 sec total, 800.91 tokens/sec
Decode latency: 2.50 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 927.35 GB/s
FLOPS achieved: 4.64 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5034 sec
Average prefill latency: 0.0539 sec
Average tokens/sec: 800.56
Memory used: 5.67 GB
Done. we are killing the process
