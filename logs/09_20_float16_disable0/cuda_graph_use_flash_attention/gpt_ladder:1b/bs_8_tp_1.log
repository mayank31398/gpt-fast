flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W930 18:36:53.927955905 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.09305987996049225 sec
Decode latency: 3.011371804983355 sec
Compilation time: 3.11 seconds
Prefill latency: 0.09269966604188085 sec
Decode latency: 3.0021290649892762 sec
Prefill latency: 0.09243061195593327 sec
Decode latency: 3.002131685963832 sec
Prefill latency: 0.09252023894805461 sec
Decode latency: 3.0021794619970024 sec
Prefill latency: 0.09252048702910542 sec
Decode latency: 3.001892854925245 sec
Prefill latency: 0.09241408098023385 sec
Decode latency: 3.0021534269908443 sec
Time for inference 1: 3.10 sec total, 661.66 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.16 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.09240079508163035 sec
Decode latency: 2.9275997190270573 sec
Time for inference 2: 3.02 sec total, 677.99 tokens/sec
Decode latency: 2.93 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1467.51 GB/s
FLOPS achieved: 7.34 TF/s

Prefill latency: 0.09250881301704794 sec
Decode latency: 3.002177271991968 sec
Time for inference 3: 3.10 sec total, 661.58 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1431.99 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.09258478507399559 sec
Decode latency: 3.001866812002845 sec
Time for inference 4: 3.10 sec total, 661.65 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.16 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.09244015801232308 sec
Decode latency: 3.001646478078328 sec
Time for inference 5: 3.09 sec total, 661.75 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.36 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.0924813550664112 sec
Decode latency: 3.0019420169992372 sec
Time for inference 6: 3.10 sec total, 661.68 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.22 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.09252691303845495 sec
Decode latency: 2.960383013007231 sec
Time for inference 7: 3.05 sec total, 670.69 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1451.71 GB/s
FLOPS achieved: 7.26 TF/s

Prefill latency: 0.09243972401600331 sec
Decode latency: 3.0021010970231146 sec
Time for inference 8: 3.10 sec total, 661.67 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.20 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.09248602401930839 sec
Decode latency: 3.0021436070092022 sec
Time for inference 9: 3.10 sec total, 661.65 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.14 GB/s
FLOPS achieved: 7.16 TF/s

Prefill latency: 0.092410254990682 sec
Decode latency: 3.0015492300735787 sec
Time for inference 10: 3.09 sec total, 661.79 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1432.46 GB/s
FLOPS achieved: 7.16 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9904 sec
Average prefill latency: 0.0925 sec
Average tokens/sec: 664.21
Memory used: 7.30 GB
Done. we are killing the process
