flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.19 seconds
Prefill latency: 0.10755352105479687 sec
Decode latency: 2.768777712015435 sec
Compilation time: 2.88 seconds
Prefill latency: 0.10697338194586337 sec
Decode latency: 2.766325792996213 sec
Prefill latency: 0.1069433439988643 sec
Decode latency: 2.766437308047898 sec
Prefill latency: 0.10705880692694336 sec
Decode latency: 2.7663691750494763 sec
Prefill latency: 0.10708767198957503 sec
Decode latency: 2.766363532980904 sec
Prefill latency: 0.10698992596007884 sec
Decode latency: 2.766082755057141 sec
Time for inference 1: 2.87 sec total, 712.65 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.89 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10697291907854378 sec
Decode latency: 2.766392252058722 sec
Time for inference 2: 2.87 sec total, 712.58 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.72 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10697234596591443 sec
Decode latency: 2.766091178986244 sec
Time for inference 3: 2.87 sec total, 712.66 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.90 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10698113101534545 sec
Decode latency: 2.766090838937089 sec
Time for inference 4: 2.87 sec total, 712.66 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.90 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10706647392362356 sec
Decode latency: 2.766068398952484 sec
Time for inference 5: 2.87 sec total, 712.64 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.85 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10708536300808191 sec
Decode latency: 2.766098662978038 sec
Time for inference 6: 2.87 sec total, 712.62 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.82 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10703572409693152 sec
Decode latency: 2.7661331180715933 sec
Time for inference 7: 2.87 sec total, 712.62 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.81 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10698887403123081 sec
Decode latency: 2.766128193004988 sec
Time for inference 8: 2.87 sec total, 712.64 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.86 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.1070738920243457 sec
Decode latency: 2.7661573770456016 sec
Time for inference 9: 2.87 sec total, 712.62 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.80 GB/s
FLOPS achieved: 8.61 TF/s

Prefill latency: 0.10704846994485706 sec
Decode latency: 2.766235066927038 sec
Time for inference 10: 2.87 sec total, 712.60 tokens/sec
Decode latency: 2.77 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1721.76 GB/s
FLOPS achieved: 8.61 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7661 sec
Average prefill latency: 0.1070 sec
Average tokens/sec: 712.63
Memory used: 9.33 GB
Done. we are killing the process
