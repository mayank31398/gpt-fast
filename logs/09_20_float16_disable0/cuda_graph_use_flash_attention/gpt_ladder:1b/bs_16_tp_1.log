flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
Prefill latency: 0.20744400192052126 sec
Decode latency: 3.383518739952706 sec
Compilation time: 3.59 seconds
Prefill latency: 0.20687004597857594 sec
Decode latency: 3.3295225360197946 sec
Prefill latency: 0.20696893497370183 sec
Decode latency: 3.322414248017594 sec
Prefill latency: 0.2069609899772331 sec
Decode latency: 3.251325087971054 sec
Prefill latency: 0.2069899489870295 sec
Decode latency: 3.383010362042114 sec
Prefill latency: 0.20709595491643995 sec
Decode latency: 3.253914264962077 sec
Time for inference 1: 3.46 sec total, 1183.23 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2858.87 GB/s
FLOPS achieved: 14.29 TF/s

Prefill latency: 0.2070182920433581 sec
Decode latency: 3.2516679099062458 sec
Time for inference 2: 3.46 sec total, 1184.02 tokens/sec
Decode latency: 3.25 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2860.79 GB/s
FLOPS achieved: 14.30 TF/s

Prefill latency: 0.2069611189654097 sec
Decode latency: 3.3816752560669556 sec
Time for inference 3: 3.59 sec total, 1141.05 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.97 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20707831298932433 sec
Decode latency: 3.3592364930082113 sec
Time for inference 4: 3.57 sec total, 1148.24 tokens/sec
Decode latency: 3.36 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2774.34 GB/s
FLOPS achieved: 13.87 TF/s

Prefill latency: 0.20704142900649458 sec
Decode latency: 3.3348251080606133 sec
Time for inference 5: 3.54 sec total, 1156.18 tokens/sec
Decode latency: 3.33 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2793.54 GB/s
FLOPS achieved: 13.97 TF/s

Prefill latency: 0.20695430599153042 sec
Decode latency: 3.3001876620110124 sec
Time for inference 6: 3.51 sec total, 1167.63 tokens/sec
Decode latency: 3.30 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2821.19 GB/s
FLOPS achieved: 14.11 TF/s

Prefill latency: 0.20717089902609587 sec
Decode latency: 3.3522052030311897 sec
Time for inference 7: 3.56 sec total, 1150.51 tokens/sec
Decode latency: 3.35 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2779.83 GB/s
FLOPS achieved: 13.90 TF/s

Prefill latency: 0.2069517580093816 sec
Decode latency: 3.2719668180216104 sec
Time for inference 8: 3.48 sec total, 1177.12 tokens/sec
Decode latency: 3.27 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2844.11 GB/s
FLOPS achieved: 14.22 TF/s

Prefill latency: 0.20701461599674076 sec
Decode latency: 3.2582896141102538 sec
Time for inference 9: 3.47 sec total, 1181.75 tokens/sec
Decode latency: 3.26 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2855.30 GB/s
FLOPS achieved: 14.28 TF/s

Prefill latency: 0.207067176932469 sec
Decode latency: 3.2877727469895035 sec
Time for inference 10: 3.50 sec total, 1171.76 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2831.16 GB/s
FLOPS achieved: 14.16 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3052 sec
Average prefill latency: 0.2070 sec
Average tokens/sec: 1166.15
Memory used: 15.78 GB
Done. we are killing the process
