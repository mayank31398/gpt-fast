flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.13 seconds
[rank0]:[W930 18:40:05.137264659 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.17937785398680717 sec
Decode latency: 3.8715224988991395 sec
Compilation time: 4.05 seconds
Prefill latency: 0.17882585409097373 sec
Decode latency: 3.8704559339676052 sec
Prefill latency: 0.17873416701331735 sec
Decode latency: 3.8703647180227563 sec
Prefill latency: 0.17884309403598309 sec
Decode latency: 3.870663087000139 sec
Prefill latency: 0.17877604300156236 sec
Decode latency: 3.870171817019582 sec
Prefill latency: 0.1789174199802801 sec
Decode latency: 3.8703043659916148 sec
Time for inference 1: 4.05 sec total, 1011.35 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.07 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1787706280592829 sec
Decode latency: 3.8703068509930745 sec
Time for inference 2: 4.05 sec total, 1011.38 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.15 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17888352100271732 sec
Decode latency: 3.8704816240351647 sec
Time for inference 3: 4.05 sec total, 1011.32 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.01 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1787636219523847 sec
Decode latency: 3.869969206978567 sec
Time for inference 4: 4.05 sec total, 1011.49 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.38 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1788585518952459 sec
Decode latency: 3.8703358329366893 sec
Time for inference 5: 4.05 sec total, 1011.38 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.15 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17876677901949733 sec
Decode latency: 3.870469207991846 sec
Time for inference 6: 4.05 sec total, 1011.29 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2188.95 GB/s
FLOPS achieved: 10.94 TF/s

Prefill latency: 0.17889812402427197 sec
Decode latency: 3.870266397949308 sec
Time for inference 7: 4.05 sec total, 1011.33 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.04 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1788410219596699 sec
Decode latency: 3.8701220309594646 sec
Time for inference 8: 4.05 sec total, 1011.40 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.19 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1788987029576674 sec
Decode latency: 3.870284078991972 sec
Time for inference 9: 4.05 sec total, 1011.37 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.12 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17877454694826156 sec
Decode latency: 3.870133785996586 sec
Time for inference 10: 4.05 sec total, 1011.44 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.27 GB/s
FLOPS achieved: 10.95 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8703 sec
Average prefill latency: 0.1788 sec
Average tokens/sec: 1011.38
Memory used: 12.05 GB
Done. we are killing the process
