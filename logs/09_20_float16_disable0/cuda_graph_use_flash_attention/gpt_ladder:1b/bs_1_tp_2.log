W1001 01:08:48.849000 22763272259392 torch/distributed/run.py:779] 
W1001 01:08:48.849000 22763272259392 torch/distributed/run.py:779] *****************************************
W1001 01:08:48.849000 22763272259392 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:08:48.849000 22763272259392 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.17 seconds
[rank1]:[W1001 01:08:54.330818666 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank0]:[W1001 01:08:54.628752305 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.013388801948167384 sec
Decode latency: 1.8777014838997275 sec
Compilation time: 1.92 seconds
Compilation time: 1.89 seconds
Prefill latency: 0.01346321904566139 sec
Decode latency: 1.877656864002347 sec
Prefill latency: 0.013451616978272796 sec
Decode latency: 1.8776805909583345 sec
Prefill latency: 0.013491777935996652 sec
Decode latency: 1.8775474249850959 sec
Prefill latency: 0.013552538002841175 sec
Decode latency: 1.8775372540112585 sec
Prefill latency: 0.013459204114042222 sec
Decode latency: 1.8775221690302715 sec
Time for inference 1: 1.89 sec total, 135.33 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.72 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013483816990628839 sec
Decode latency: 1.8777601399924606 sec
Time for inference 2: 1.89 sec total, 135.31 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.70 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013446558034047484 sec
Decode latency: 1.8772965559037402 sec
Time for inference 3: 1.89 sec total, 135.35 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.75 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013514668913558125 sec
Decode latency: 1.8776304740458727 sec
Time for inference 4: 1.89 sec total, 135.32 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.71 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013521454995498061 sec
Decode latency: 1.8772600319935009 sec
Time for inference 5: 1.89 sec total, 135.34 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.74 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013478993903845549 sec
Decode latency: 1.8776050449814647 sec
Time for inference 6: 1.89 sec total, 135.32 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.72 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013520542066544294 sec
Decode latency: 1.8775266039883718 sec
Time for inference 7: 1.89 sec total, 135.32 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.71 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013552043936215341 sec
Decode latency: 1.877690872992389 sec
Time for inference 8: 1.89 sec total, 135.28 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.66 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.013492212980054319 sec
Decode latency: 1.8776483619585633 sec
Time for inference 9: 1.89 sec total, 135.30 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.69 GB/s
FLOPS achieved: 0.87 TF/s

Prefill latency: 0.01346880302298814 sec
Decode latency: 1.8779186980100349 sec
Time for inference 10: 1.89 sec total, 135.30 tokens/sec
Decode latency: 1.88 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 173.68 GB/s
FLOPS achieved: 0.87 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8776 sec
Average prefill latency: 0.0135 sec
Average tokens/sec: 135.32
Memory used: 2.26 GB
Done. we are killing the process
