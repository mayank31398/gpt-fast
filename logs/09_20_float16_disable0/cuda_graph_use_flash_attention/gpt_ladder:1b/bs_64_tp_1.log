flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W1001 01:20:19.871511224 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.8062860160134733 sec
Decode latency: 8.668600769946352 sec
Compilation time: 9.48 seconds
Prefill latency: 0.8066620579920709 sec
Decode latency: 8.663372270995751 sec
Prefill latency: 0.8122570749837905 sec
Decode latency: 8.664451639982872 sec
Prefill latency: 0.8146783709526062 sec
Decode latency: 8.665306405979209 sec
Prefill latency: 0.8127985489554703 sec
Decode latency: 8.664735000929795 sec
Prefill latency: 0.8126924040261656 sec
Decode latency: 8.664430066011846 sec
Time for inference 1: 9.48 sec total, 1728.60 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4176.60 GB/s
FLOPS achieved: 20.88 TF/s

Prefill latency: 0.8074282539309934 sec
Decode latency: 8.665690504945815 sec
Time for inference 2: 9.47 sec total, 1729.31 tokens/sec
Decode latency: 8.67 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4178.30 GB/s
FLOPS achieved: 20.89 TF/s

Prefill latency: 0.8064993880689144 sec
Decode latency: 8.665123015991412 sec
Time for inference 3: 9.47 sec total, 1729.62 tokens/sec
Decode latency: 8.67 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4179.05 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8095181100070477 sec
Decode latency: 8.662439647014253 sec
Time for inference 4: 9.47 sec total, 1729.56 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4178.91 GB/s
FLOPS achieved: 20.89 TF/s

Prefill latency: 0.8061184689868242 sec
Decode latency: 8.666827537934296 sec
Time for inference 5: 9.47 sec total, 1729.35 tokens/sec
Decode latency: 8.67 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4178.39 GB/s
FLOPS achieved: 20.89 TF/s

Prefill latency: 0.80624651000835 sec
Decode latency: 8.662914698012173 sec
Time for inference 6: 9.47 sec total, 1730.07 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.13 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.812242251005955 sec
Decode latency: 8.663823678041808 sec
Time for inference 7: 9.48 sec total, 1728.82 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4177.12 GB/s
FLOPS achieved: 20.89 TF/s

Prefill latency: 0.8072974429233 sec
Decode latency: 8.663560096989386 sec
Time for inference 8: 9.47 sec total, 1729.75 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4179.37 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8063239780021831 sec
Decode latency: 8.664877884904854 sec
Time for inference 9: 9.47 sec total, 1729.69 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4179.22 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.811387505964376 sec
Decode latency: 8.664795847958885 sec
Time for inference 10: 9.48 sec total, 1728.79 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4177.05 GB/s
FLOPS achieved: 20.89 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.6644 sec
Average prefill latency: 0.8086 sec
Average tokens/sec: 1729.36
Memory used: 54.53 GB
Done. we are killing the process
