flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.14 seconds
[rank0]:[W1001 01:10:49.955122883 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.05567725596483797 sec
Decode latency: 2.4520370269892737 sec
Compilation time: 2.51 seconds
Prefill latency: 0.055380885023623705 sec
Decode latency: 2.4441647860221565 sec
Prefill latency: 0.05535630800295621 sec
Decode latency: 2.4442365899449214 sec
Prefill latency: 0.05536397802643478 sec
Decode latency: 2.4438999659614637 sec
Prefill latency: 0.05525666999164969 sec
Decode latency: 2.44418093690183 sec
Prefill latency: 0.05525691993534565 sec
Decode latency: 2.4438546949531883 sec
Time for inference 1: 2.50 sec total, 409.62 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.72 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05528567300643772 sec
Decode latency: 2.443871066090651 sec
Time for inference 2: 2.50 sec total, 409.62 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.71 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05527955200523138 sec
Decode latency: 2.443165033007972 sec
Time for inference 3: 2.50 sec total, 409.73 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.97 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05540373804979026 sec
Decode latency: 2.443928794004023 sec
Time for inference 4: 2.50 sec total, 409.60 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.65 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.055242320988327265 sec
Decode latency: 2.4437720120185986 sec
Time for inference 5: 2.50 sec total, 409.64 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.76 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.0553600360872224 sec
Decode latency: 2.4440644229762256 sec
Time for inference 6: 2.50 sec total, 409.53 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.50 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05529422697145492 sec
Decode latency: 2.443861968931742 sec
Time for inference 7: 2.50 sec total, 409.59 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.64 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.055373225011862814 sec
Decode latency: 2.4439036559779197 sec
Time for inference 8: 2.50 sec total, 409.59 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.63 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05528568697627634 sec
Decode latency: 2.443842899054289 sec
Time for inference 9: 2.50 sec total, 409.62 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.70 GB/s
FLOPS achieved: 4.95 TF/s

Prefill latency: 0.05528552399482578 sec
Decode latency: 2.4440064770169556 sec
Time for inference 10: 2.50 sec total, 409.59 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 989.64 GB/s
FLOPS achieved: 4.95 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4438 sec
Average prefill latency: 0.0553 sec
Average tokens/sec: 409.61
Memory used: 6.17 GB
Done. we are killing the process
