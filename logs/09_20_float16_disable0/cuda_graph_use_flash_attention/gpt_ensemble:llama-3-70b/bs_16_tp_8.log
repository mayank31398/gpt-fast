W0928 17:07:41.786000 22906842892096 torch/distributed/run.py:779] 
W0928 17:07:41.786000 22906842892096 torch/distributed/run.py:779] *****************************************
W0928 17:07:41.786000 22906842892096 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:07:41.786000 22906842892096 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.31 seconds
Prefill latency: 0.8345909820054658 sec
Decode latency: 7.750897346006241 sec
Compilation time: 8.57 seconds
Compilation time: 8.59 secondsCompilation time: 8.60 seconds

Compilation time: 8.64 seconds
Compilation time: 8.55 seconds
Compilation time: 8.64 secondsCompilation time: 8.59 seconds

Compilation time: 8.64 seconds
Prefill latency: 0.8047324490034953 sec
Decode latency: 7.7505105160526 sec
Prefill latency: 0.8054870640044101 sec
Decode latency: 7.751737819053233 sec
Prefill latency: 0.8040501729701646 sec
Decode latency: 7.7497029270161875 sec
Prefill latency: 0.8068385710357688 sec
Decode latency: 7.750349368026946 sec
Prefill latency: 0.8025657840189524 sec
Decode latency: 7.756240410031751 sec
Time for inference 1: 8.56 sec total, 478.51 tokens/sec
Decode latency: 7.76 sec
Prefill latency: 0.80 sec
Bandwidth achieved: 9195.48 GB/s
FLOPS achieved: 45.98 TF/s

Prefill latency: 0.8068470610305667 sec
Decode latency: 7.750216935004573 sec
Time for inference 2: 8.56 sec total, 478.62 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9197.44 GB/s
FLOPS achieved: 45.99 TF/s

Prefill latency: 0.8068586989538744 sec
Decode latency: 7.7521037150290795 sec
Time for inference 3: 8.56 sec total, 478.51 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9195.36 GB/s
FLOPS achieved: 45.98 TF/s

Prefill latency: 0.8064152679871768 sec
Decode latency: 7.750242077978328 sec
Time for inference 4: 8.56 sec total, 478.64 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9197.88 GB/s
FLOPS achieved: 45.99 TF/s

Prefill latency: 0.8068749829544686 sec
Decode latency: 7.751850773987826 sec
Time for inference 5: 8.56 sec total, 478.51 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9195.44 GB/s
FLOPS achieved: 45.98 TF/s

Prefill latency: 0.8054748470312916 sec
Decode latency: 7.754008966963738 sec
Time for inference 6: 8.56 sec total, 478.48 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9194.76 GB/s
FLOPS achieved: 45.97 TF/s

Prefill latency: 0.8060227559763007 sec
Decode latency: 7.750604331027716 sec
Time for inference 7: 8.56 sec total, 478.64 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9197.94 GB/s
FLOPS achieved: 45.99 TF/s

Prefill latency: 0.8020099329878576 sec
Decode latency: 7.75469793000957 sec
Time for inference 8: 8.56 sec total, 478.64 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.80 sec
Bandwidth achieved: 9197.85 GB/s
FLOPS achieved: 45.99 TF/s

Prefill latency: 0.8058012680266984 sec
Decode latency: 7.750510910002049 sec
Time for inference 9: 8.56 sec total, 478.66 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9198.30 GB/s
FLOPS achieved: 45.99 TF/s

Prefill latency: 0.8069309399579652 sec
Decode latency: 7.754613736004103 sec
Time for inference 10: 8.56 sec total, 478.37 tokens/sec
Decode latency: 7.75 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 9192.72 GB/s
FLOPS achieved: 45.96 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.7525 sec
Average prefill latency: 0.8056 sec
Average tokens/sec: 478.56
Memory used: 49.68 GB
Done. we are killing the process
