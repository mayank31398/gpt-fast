W0928 17:04:53.839000 22476533671744 torch/distributed/run.py:779] 
W0928 17:04:53.839000 22476533671744 torch/distributed/run.py:779] *****************************************
W0928 17:04:53.839000 22476533671744 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:04:53.839000 22476533671744 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.42 seconds
Prefill latency: 0.39790004602400586 sec
Decode latency: 6.7527501009753905 sec
Compilation time: 7.23 seconds
Compilation time: 7.16 seconds
Compilation time: 7.15 seconds
Compilation time: 7.26 seconds
Compilation time: 7.16 secondsCompilation time: 7.16 seconds

Compilation time: 7.16 seconds
Compilation time: 7.16 seconds
Prefill latency: 0.4001302109682001 sec
Decode latency: 6.7541286550113 sec
Prefill latency: 0.40056099998764694 sec
Decode latency: 6.755362136987969 sec
Prefill latency: 0.4013319159857929 sec
Decode latency: 6.753814173978753 sec
Prefill latency: 0.4005403449991718 sec
Decode latency: 6.752948326000478 sec
Prefill latency: 0.401360955031123 sec
Decode latency: 6.753642713010777 sec
Time for inference 1: 7.16 sec total, 286.19 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5499.66 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.40106808103155345 sec
Decode latency: 6.753944634983782 sec
Time for inference 2: 7.16 sec total, 286.19 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5499.73 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.40031751501373947 sec
Decode latency: 6.753382991999388 sec
Time for inference 3: 7.15 sec total, 286.25 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5500.75 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.40103001502575353 sec
Decode latency: 6.752977019001264 sec
Time for inference 4: 7.15 sec total, 286.24 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5500.55 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.4014117249753326 sec
Decode latency: 6.753756524994969 sec
Time for inference 5: 7.16 sec total, 286.19 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5499.64 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.4017110849963501 sec
Decode latency: 6.75285680097295 sec
Time for inference 6: 7.16 sec total, 286.22 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5500.16 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.4009897169889882 sec
Decode latency: 6.7563786410028115 sec
Time for inference 7: 7.16 sec total, 286.10 tokens/sec
Decode latency: 6.76 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5497.96 GB/s
FLOPS achieved: 27.49 TF/s

Prefill latency: 0.40240454400191084 sec
Decode latency: 6.752026446978562 sec
Time for inference 8: 7.16 sec total, 286.22 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5500.28 GB/s
FLOPS achieved: 27.50 TF/s

Prefill latency: 0.4017607869463973 sec
Decode latency: 6.754754206049256 sec
Time for inference 9: 7.16 sec total, 286.13 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5498.54 GB/s
FLOPS achieved: 27.49 TF/s

Prefill latency: 0.4014583550160751 sec
Decode latency: 6.753288597974461 sec
Time for inference 10: 7.16 sec total, 286.20 tokens/sec
Decode latency: 6.75 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5499.93 GB/s
FLOPS achieved: 27.50 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.7537 sec
Average prefill latency: 0.4014 sec
Average tokens/sec: 286.19
Memory used: 35.56 GB
Done. we are killing the process
