W0928 16:45:29.350000 23454881756992 torch/distributed/run.py:779] 
W0928 16:45:29.350000 23454881756992 torch/distributed/run.py:779] *****************************************
W0928 16:45:29.350000 23454881756992 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 16:45:29.350000 23454881756992 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.41 seconds
Prefill latency: 0.10292688198387623 sec
Decode latency: 5.421010076010134 sec
Compilation time: 5.56 seconds
Compilation time: 5.53 seconds
Compilation time: 5.48 secondsCompilation time: 5.50 seconds

Compilation time: 5.53 seconds
Compilation time: 5.52 secondsCompilation time: 5.52 seconds

Compilation time: 5.53 seconds
Prefill latency: 0.0613402389572002 sec
Decode latency: 5.421366819005925 sec
Prefill latency: 0.061377528007142246 sec
Decode latency: 5.4221575059928 sec
Prefill latency: 0.0618429709575139 sec
Decode latency: 5.4237194760353304 sec
Prefill latency: 0.06137806503102183 sec
Decode latency: 5.423326377989724 sec
Prefill latency: 0.06148402899270877 sec
Decode latency: 5.423617445048876 sec
Time for inference 1: 5.49 sec total, 46.67 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.75 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06154337298357859 sec
Decode latency: 5.423291662009433 sec
Time for inference 2: 5.49 sec total, 46.67 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.77 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06135140097467229 sec
Decode latency: 5.423969183000736 sec
Time for inference 3: 5.49 sec total, 46.66 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.71 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06135165400337428 sec
Decode latency: 5.423293580999598 sec
Time for inference 4: 5.49 sec total, 46.67 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.81 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06197406997671351 sec
Decode latency: 5.42343389702728 sec
Time for inference 5: 5.49 sec total, 46.66 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.70 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06155216204933822 sec
Decode latency: 5.423978284990881 sec
Time for inference 6: 5.49 sec total, 46.66 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.67 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06142398400697857 sec
Decode latency: 5.423642835987266 sec
Time for inference 7: 5.49 sec total, 46.66 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.71 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.06136399297975004 sec
Decode latency: 5.422309519955888 sec
Time for inference 8: 5.48 sec total, 46.68 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.96 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.061450192995835096 sec
Decode latency: 5.423186197993346 sec
Time for inference 9: 5.49 sec total, 46.67 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.81 GB/s
FLOPS achieved: 4.48 TF/s

Prefill latency: 0.061392601986881346 sec
Decode latency: 5.422779090004042 sec
Time for inference 10: 5.48 sec total, 46.67 tokens/sec
Decode latency: 5.42 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 896.90 GB/s
FLOPS achieved: 4.48 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.4234 sec
Average prefill latency: 0.0615 sec
Average tokens/sec: 46.67
Memory used: 23.21 GB
[rank2]:[E928 16:48:07.813747601 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 2] Future for ProcessGroup abort timed out after 60000 ms
[rank5]:[E928 16:48:07.813750515 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 5] Future for ProcessGroup abort timed out after 60000 ms
[rank6]:[E928 16:48:07.813750355 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 6] Future for ProcessGroup abort timed out after 60000 ms
[rank4]:[E928 16:48:07.813753981 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 4] Future for ProcessGroup abort timed out after 60000 ms
[rank7]:[E928 16:48:07.813756245 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 7] Future for ProcessGroup abort timed out after 60000 ms
[rank3]:[E928 16:48:07.813755679 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 3] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E928 16:48:07.813760458 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
[rank1]:[E928 16:48:07.813863438 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
