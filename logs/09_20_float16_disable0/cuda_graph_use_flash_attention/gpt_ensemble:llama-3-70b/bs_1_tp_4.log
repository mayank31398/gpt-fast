W0928 16:41:39.126000 23002093913920 torch/distributed/run.py:779] 
W0928 16:41:39.126000 23002093913920 torch/distributed/run.py:779] *****************************************
W0928 16:41:39.126000 23002093913920 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 16:41:39.126000 23002093913920 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=2560, bias=False)
        (wo): Linear(in_features=2048, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.25 seconds
[rank1]:[W928 16:41:48.905693016 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.12197240599198267 sec
Decode latency: 6.971435119980015 sec
Compilation time: 7.13 seconds
Compilation time: 7.08 secondsCompilation time: 7.07 seconds

Compilation time: 7.09 seconds
Prefill latency: 0.09969331399770454 sec
Decode latency: 6.972611467994284 sec
Prefill latency: 0.0992732000304386 sec
Decode latency: 6.972213789005764 sec
Prefill latency: 0.09975142299663275 sec
Decode latency: 6.967295349983033 sec
Prefill latency: 0.09957533300621435 sec
Decode latency: 6.967411750985775 sec
Prefill latency: 0.09958601300604641 sec
Decode latency: 6.970853943028487 sec
Time for inference 1: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.22 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10000425804173574 sec
Decode latency: 6.970544935960788 sec
Time for inference 2: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.20 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.09990289201959968 sec
Decode latency: 6.967608223028947 sec
Time for inference 3: 7.07 sec total, 36.22 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.76 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.09982022602343932 sec
Decode latency: 6.971047369996086 sec
Time for inference 4: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.13 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.09964098304044455 sec
Decode latency: 6.9699899310362525 sec
Time for inference 5: 7.07 sec total, 36.21 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.36 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10026820603525266 sec
Decode latency: 6.970940706029069 sec
Time for inference 6: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.09 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10015809698961675 sec
Decode latency: 6.9700229780282825 sec
Time for inference 7: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.28 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.09984168398659676 sec
Decode latency: 6.969963344046846 sec
Time for inference 8: 7.07 sec total, 36.21 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.33 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.0998236850136891 sec
Decode latency: 6.970485215948429 sec
Time for inference 9: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.24 GB/s
FLOPS achieved: 6.58 TF/s

Prefill latency: 0.10062036098679528 sec
Decode latency: 6.970150189008564 sec
Time for inference 10: 7.07 sec total, 36.20 tokens/sec
Decode latency: 6.97 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 1315.18 GB/s
FLOPS achieved: 6.58 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.9702 sec
Average prefill latency: 0.1000 sec
Average tokens/sec: 36.20
Memory used: 40.42 GB
[rank1]:[E928 16:44:35.199316752 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 1] Future for ProcessGroup abort timed out after 60000 ms
[rank3]:[E928 16:44:35.199319259 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 3] Future for ProcessGroup abort timed out after 60000 ms
[rank0]:[E928 16:44:35.199326453 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 0] Future for ProcessGroup abort timed out after 60000 ms
[rank2]:[E928 16:44:35.199333201 ProcessGroupNCCL.cpp:1076] [PG 0 (default_pg) Rank 2] Future for ProcessGroup abort timed out after 60000 ms
