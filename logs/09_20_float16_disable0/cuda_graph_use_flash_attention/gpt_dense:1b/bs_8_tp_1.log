flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
[rank0]:[W1001 00:49:49.312775737 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.0929824230261147 sec
Decode latency: 3.008790872991085 sec
Compilation time: 3.10 seconds
Prefill latency: 0.09269020589999855 sec
Decode latency: 2.9991401800652966 sec
Prefill latency: 0.09239437198266387 sec
Decode latency: 2.950661582988687 sec
Prefill latency: 0.09245254995767027 sec
Decode latency: 2.9983902889071032 sec
Prefill latency: 0.09240929398220032 sec
Decode latency: 2.9988285639556125 sec
Prefill latency: 0.09239234705455601 sec
Decode latency: 2.9977060990640894 sec
Time for inference 1: 3.09 sec total, 662.61 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.23 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09233312401920557 sec
Decode latency: 2.8583976019872352 sec
Time for inference 2: 2.95 sec total, 693.91 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1501.97 GB/s
FLOPS achieved: 7.51 TF/s

Prefill latency: 0.0924209690419957 sec
Decode latency: 2.9986201559659094 sec
Time for inference 3: 3.09 sec total, 662.41 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1433.80 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09248989704065025 sec
Decode latency: 2.8577890900196508 sec
Time for inference 4: 2.95 sec total, 694.01 tokens/sec
Decode latency: 2.86 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1502.19 GB/s
FLOPS achieved: 7.51 TF/s

Prefill latency: 0.0923493760637939 sec
Decode latency: 2.998003576998599 sec
Time for inference 5: 3.09 sec total, 662.51 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.02 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.0923479920020327 sec
Decode latency: 2.997948778909631 sec
Time for inference 6: 3.09 sec total, 662.53 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.05 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09244656597729772 sec
Decode latency: 2.9982669660821557 sec
Time for inference 7: 3.09 sec total, 662.47 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1433.93 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09235372894909233 sec
Decode latency: 2.998331216047518 sec
Time for inference 8: 3.09 sec total, 662.49 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1433.97 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09247373300604522 sec
Decode latency: 2.9980991629417986 sec
Time for inference 9: 3.09 sec total, 662.51 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.02 GB/s
FLOPS achieved: 7.17 TF/s

Prefill latency: 0.09244432498235255 sec
Decode latency: 2.9969520419836044 sec
Time for inference 10: 3.09 sec total, 662.76 tokens/sec
Decode latency: 3.00 sec
Prefill latency: 0.09 sec
Bandwidth achieved: 1434.55 GB/s
FLOPS achieved: 7.17 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9700 sec
Average prefill latency: 0.0924 sec
Average tokens/sec: 668.82
Memory used: 7.29 GB
Done. we are killing the process
