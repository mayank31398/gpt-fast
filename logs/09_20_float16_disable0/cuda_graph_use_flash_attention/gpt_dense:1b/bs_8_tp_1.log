flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
Prefill latency: 0.10740688093937933 sec
Decode latency: 2.7640895480290055 sec
Compilation time: 2.87 seconds
Prefill latency: 0.10686029901262373 sec
Decode latency: 2.7607052830280736 sec
Prefill latency: 0.10685627104248852 sec
Decode latency: 2.762318123015575 sec
Prefill latency: 0.10682964790612459 sec
Decode latency: 2.7621441439259797 sec
Prefill latency: 0.10687181900721043 sec
Decode latency: 2.7621186840115115 sec
Prefill latency: 0.10688380699139088 sec
Decode latency: 2.762139957980253 sec
Time for inference 1: 2.87 sec total, 713.60 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.19 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10687716898974031 sec
Decode latency: 2.7048828010447323 sec
Time for inference 2: 2.81 sec total, 728.15 tokens/sec
Decode latency: 2.70 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1759.32 GB/s
FLOPS achieved: 8.80 TF/s

Prefill latency: 0.10681418399326503 sec
Decode latency: 2.7623396780109033 sec
Time for inference 3: 2.87 sec total, 713.59 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.16 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10679378802888095 sec
Decode latency: 2.7616406510351226 sec
Time for inference 4: 2.87 sec total, 713.77 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.58 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.1067961580120027 sec
Decode latency: 2.7622433439828455 sec
Time for inference 5: 2.87 sec total, 713.63 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.24 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10686324199195951 sec
Decode latency: 2.7620714139193296 sec
Time for inference 6: 2.87 sec total, 713.67 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.34 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10687277396209538 sec
Decode latency: 2.762033108039759 sec
Time for inference 7: 2.87 sec total, 713.58 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.13 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10682002804242074 sec
Decode latency: 2.7456870180321857 sec
Time for inference 8: 2.85 sec total, 717.77 tokens/sec
Decode latency: 2.75 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1734.26 GB/s
FLOPS achieved: 8.67 TF/s

Prefill latency: 0.10681820998433977 sec
Decode latency: 2.761556101962924 sec
Time for inference 9: 2.87 sec total, 713.78 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.60 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.10677705507259816 sec
Decode latency: 2.7612356260651723 sec
Time for inference 10: 2.87 sec total, 713.86 tokens/sec
Decode latency: 2.76 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 1724.80 GB/s
FLOPS achieved: 8.62 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7546 sec
Average prefill latency: 0.1068 sec
Average tokens/sec: 715.54
Memory used: 9.32 GB
Done. we are killing the process
