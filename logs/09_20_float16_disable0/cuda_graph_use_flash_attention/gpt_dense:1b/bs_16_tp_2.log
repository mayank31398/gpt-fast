W1001 01:37:00.533000 23331442599744 torch/distributed/run.py:779] 
W1001 01:37:00.533000 23331442599744 torch/distributed/run.py:779] *****************************************
W1001 01:37:00.533000 23331442599744 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:37:00.533000 23331442599744 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2304, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.26 seconds
[rank1]:[W1001 01:37:07.537405769 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.12842095491942018 sec
Decode latency: 2.9194421119755134 sec
Compilation time: 3.05 seconds
Compilation time: 3.06 seconds
Prefill latency: 0.1282316220458597 sec
Decode latency: 2.9171407799003646 sec
Prefill latency: 0.12807193398475647 sec
Decode latency: 2.91920896503143 sec
Prefill latency: 0.1282367690000683 sec
Decode latency: 2.919942252920009 sec
Prefill latency: 0.12796562490984797 sec
Decode latency: 2.9193147260230035 sec
Prefill latency: 0.12809634499717504 sec
Decode latency: 2.919519089977257 sec
Time for inference 1: 3.05 sec total, 1343.58 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1724.77 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.12802694004494697 sec
Decode latency: 2.919850105070509 sec
Time for inference 2: 3.05 sec total, 1343.53 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1724.70 GB/s
FLOPS achieved: 8.62 TF/s

Prefill latency: 0.12829819996841252 sec
Decode latency: 2.9182146639795974 sec
Time for inference 3: 3.05 sec total, 1344.16 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.51 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.12805091391783208 sec
Decode latency: 2.9187783299712464 sec
Time for inference 4: 3.05 sec total, 1344.03 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.34 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.12806693196762353 sec
Decode latency: 2.919035397004336 sec
Time for inference 5: 3.05 sec total, 1343.88 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.15 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.1280126830097288 sec
Decode latency: 2.9185551210539415 sec
Time for inference 6: 3.05 sec total, 1344.14 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.48 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.12806001992430538 sec
Decode latency: 2.9188466129126027 sec
Time for inference 7: 3.05 sec total, 1344.02 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.33 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.12799669499509037 sec
Decode latency: 2.9178939450066537 sec
Time for inference 8: 3.05 sec total, 1344.29 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.67 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.12815976492129266 sec
Decode latency: 2.917302443063818 sec
Time for inference 9: 3.05 sec total, 1344.48 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1725.92 GB/s
FLOPS achieved: 8.63 TF/s

Prefill latency: 0.1281344520393759 sec
Decode latency: 2.9191304390551522 sec
Time for inference 10: 3.05 sec total, 1343.66 tokens/sec
Decode latency: 2.92 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 1724.87 GB/s
FLOPS achieved: 8.62 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9187 sec
Average prefill latency: 0.1281 sec
Average tokens/sec: 1343.98
Memory used: 11.60 GB
Done. we are killing the process
