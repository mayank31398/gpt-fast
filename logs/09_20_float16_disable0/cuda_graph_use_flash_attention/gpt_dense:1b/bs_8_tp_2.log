W0930 18:57:47.484000 23008567486272 torch/distributed/run.py:779] 
W0930 18:57:47.484000 23008567486272 torch/distributed/run.py:779] *****************************************
W0930 18:57:47.484000 23008567486272 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 18:57:47.484000 23008567486272 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1280, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.90 seconds
Prefill latency: 0.06486927496735007 sec
Decode latency: 2.7154163339873776 sec
Compilation time: 2.78 seconds
Compilation time: 2.78 seconds
Prefill latency: 0.059889262076467276 sec
Decode latency: 2.711122566019185 sec
Prefill latency: 0.05977506597992033 sec
Decode latency: 2.710520247928798 sec
Prefill latency: 0.05988413700833917 sec
Decode latency: 2.7102835760451853 sec
Prefill latency: 0.05982483201660216 sec
Decode latency: 2.709931635996327 sec
Prefill latency: 0.05990454100538045 sec
Decode latency: 2.7110112740192562 sec
Time for inference 1: 2.77 sec total, 738.89 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.55 GB/s
FLOPS achieved: 4.28 TF/s

Prefill latency: 0.060057817958295345 sec
Decode latency: 2.710964584024623 sec
Time for inference 2: 2.77 sec total, 738.86 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.51 GB/s
FLOPS achieved: 4.28 TF/s

Prefill latency: 0.05995269399136305 sec
Decode latency: 2.7126861549913883 sec
Time for inference 3: 2.77 sec total, 738.37 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 854.94 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05985665996558964 sec
Decode latency: 2.7124445689842105 sec
Time for inference 4: 2.77 sec total, 738.46 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.04 GB/s
FLOPS achieved: 4.28 TF/s

Prefill latency: 0.05990631098393351 sec
Decode latency: 2.713170574977994 sec
Time for inference 5: 2.77 sec total, 738.24 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 854.79 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05998498189728707 sec
Decode latency: 2.7125789260026067 sec
Time for inference 6: 2.77 sec total, 738.41 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 854.99 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05989678401965648 sec
Decode latency: 2.7128788359696046 sec
Time for inference 7: 2.77 sec total, 738.35 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 854.92 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.059929804992862046 sec
Decode latency: 2.7116821409435943 sec
Time for inference 8: 2.77 sec total, 738.71 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.34 GB/s
FLOPS achieved: 4.28 TF/s

Prefill latency: 0.06002228090073913 sec
Decode latency: 2.712567319977097 sec
Time for inference 9: 2.77 sec total, 738.44 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.02 GB/s
FLOPS achieved: 4.28 TF/s

Prefill latency: 0.05996637395583093 sec
Decode latency: 2.712018646998331 sec
Time for inference 10: 2.77 sec total, 738.60 tokens/sec
Decode latency: 2.71 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 855.21 GB/s
FLOPS achieved: 4.28 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7122 sec
Average prefill latency: 0.0599 sec
Average tokens/sec: 738.53
Memory used: 5.70 GB
Done. we are killing the process
