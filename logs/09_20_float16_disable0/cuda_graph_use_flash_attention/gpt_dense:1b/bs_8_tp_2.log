W1001 00:50:37.843000 22582418933568 torch/distributed/run.py:779] 
W1001 00:50:37.843000 22582418933568 torch/distributed/run.py:779] *****************************************
W1001 00:50:37.843000 22582418933568 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:50:37.843000 22582418933568 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1280, bias=False)
        (wo): Linear(in_features=768, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=4096, bias=False)
        (w2): Linear(in_features=2048, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.89 seconds
Prefill latency: 0.07536634104326367 sec
Decode latency: 2.720226767938584 sec
Compilation time: 2.78 seconds
Compilation time: 2.80 seconds
Prefill latency: 0.0599060480017215 sec
Decode latency: 2.717577742994763 sec
Prefill latency: 0.060001298086717725 sec
Decode latency: 2.717614940018393 sec
Prefill latency: 0.05998531496152282 sec
Decode latency: 2.714890278992243 sec
Prefill latency: 0.05997557402588427 sec
Decode latency: 2.716909370967187 sec
Prefill latency: 0.05982833507005125 sec
Decode latency: 2.717172867967747 sec
Time for inference 1: 2.78 sec total, 737.22 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.61 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.059943009982816875 sec
Decode latency: 2.7175485340412706 sec
Time for inference 2: 2.78 sec total, 737.13 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.50 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05991021997760981 sec
Decode latency: 2.717064377036877 sec
Time for inference 3: 2.78 sec total, 737.30 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.70 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05984540097415447 sec
Decode latency: 2.7173811260145158 sec
Time for inference 4: 2.78 sec total, 737.25 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.64 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.0598728769691661 sec
Decode latency: 2.717360998969525 sec
Time for inference 5: 2.78 sec total, 737.20 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.59 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05994101008400321 sec
Decode latency: 2.7173608399461955 sec
Time for inference 6: 2.78 sec total, 737.18 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.56 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.059863346978090703 sec
Decode latency: 2.717520687961951 sec
Time for inference 7: 2.78 sec total, 737.10 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.47 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.059889744967222214 sec
Decode latency: 2.718184501049109 sec
Time for inference 8: 2.78 sec total, 736.93 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.28 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.059913919074460864 sec
Decode latency: 2.716909747105092 sec
Time for inference 9: 2.78 sec total, 737.31 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.71 GB/s
FLOPS achieved: 4.27 TF/s

Prefill latency: 0.05998884397558868 sec
Decode latency: 2.71849951997865 sec
Time for inference 10: 2.78 sec total, 736.88 tokens/sec
Decode latency: 2.72 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 853.21 GB/s
FLOPS achieved: 4.27 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.7175 sec
Average prefill latency: 0.0599 sec
Average tokens/sec: 737.15
Memory used: 5.70 GB
Done. we are killing the process
