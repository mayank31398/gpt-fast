W1001 00:56:18.046000 23200564750144 torch/distributed/run.py:779] 
W1001 00:56:18.046000 23200564750144 torch/distributed/run.py:779] *****************************************
W1001 00:56:18.046000 23200564750144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:56:18.046000 23200564750144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=320, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.11 seconds
Prefill latency: 0.05961154599208385 sec
Decode latency: 2.6287869180087 sec
Compilation time: 2.72 seconds
Compilation time: 2.72 secondsCompilation time: 2.77 seconds

Compilation time: 2.70 seconds
Compilation time: 2.69 seconds
Compilation time: 2.71 seconds
Compilation time: 2.73 seconds
Compilation time: 2.71 seconds
Prefill latency: 0.05941764893941581 sec
Decode latency: 2.6293181988876313 sec
Prefill latency: 0.05938236101064831 sec
Decode latency: 2.627333938027732 sec
Prefill latency: 0.05912800203077495 sec
Decode latency: 2.628597130998969 sec
Prefill latency: 0.059212256921455264 sec
Decode latency: 2.6280317180790007 sec
Prefill latency: 0.059157369076274335 sec
Decode latency: 2.6281106210080907 sec
Time for inference 1: 2.69 sec total, 1523.69 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 613.90 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.05922679300419986 sec
Decode latency: 2.6279110859613866 sec
Time for inference 2: 2.69 sec total, 1523.79 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 613.94 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.0593758940231055 sec
Decode latency: 2.6285023959353566 sec
Time for inference 3: 2.69 sec total, 1523.37 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 613.77 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.059186978032812476 sec
Decode latency: 2.6247485789936036 sec
Time for inference 4: 2.68 sec total, 1525.67 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.69 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.059228172060102224 sec
Decode latency: 2.6265807449817657 sec
Time for inference 5: 2.69 sec total, 1524.51 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.23 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.0592282060533762 sec
Decode latency: 2.6259237830527127 sec
Time for inference 6: 2.69 sec total, 1524.94 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.40 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.05912361200898886 sec
Decode latency: 2.626052301027812 sec
Time for inference 7: 2.69 sec total, 1524.86 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.37 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.05927809304557741 sec
Decode latency: 2.6259518160950392 sec
Time for inference 8: 2.69 sec total, 1524.84 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.36 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.059205678990110755 sec
Decode latency: 2.6268688909476623 sec
Time for inference 9: 2.69 sec total, 1524.45 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.20 GB/s
FLOPS achieved: 3.07 TF/s

Prefill latency: 0.05919213802553713 sec
Decode latency: 2.624765141052194 sec
Time for inference 10: 2.68 sec total, 1525.65 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.06 sec
Bandwidth achieved: 614.69 GB/s
FLOPS achieved: 3.07 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6265 sec
Average prefill latency: 0.0592 sec
Average tokens/sec: 1524.58
Memory used: 6.83 GB
Done. we are killing the process
