W1001 01:37:56.209000 22515959228224 torch/distributed/run.py:779] 
W1001 01:37:56.209000 22515959228224 torch/distributed/run.py:779] *****************************************
W1001 01:37:56.209000 22515959228224 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:37:56.209000 22515959228224 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.01 seconds
Prefill latency: 0.12682310200762004 sec
Decode latency: 2.628866914077662 sec
Compilation time: 2.73 seconds
Compilation time: 2.74 seconds
Compilation time: 2.71 seconds
Compilation time: 2.76 seconds
Prefill latency: 0.08439124608412385 sec
Decode latency: 2.62747616507113 sec
Prefill latency: 0.08436331199482083 sec
Decode latency: 2.6273593299556524 sec
Prefill latency: 0.0844679030124098 sec
Decode latency: 2.6283791370224208 sec
Prefill latency: 0.08444864500779659 sec
Decode latency: 2.6268815580988303 sec
Prefill latency: 0.08437531103845686 sec
Decode latency: 2.6266507409745827 sec
Time for inference 1: 2.71 sec total, 1510.31 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1083.61 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08438118093181401 sec
Decode latency: 2.6251993760233745 sec
Time for inference 2: 2.71 sec total, 1511.10 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.18 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08419808698818088 sec
Decode latency: 2.626435008016415 sec
Time for inference 3: 2.71 sec total, 1510.64 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1083.84 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08430361899081618 sec
Decode latency: 2.62550734099932 sec
Time for inference 4: 2.71 sec total, 1511.05 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.14 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08437618496827781 sec
Decode latency: 2.623895588913001 sec
Time for inference 5: 2.71 sec total, 1511.85 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.72 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08421472401823848 sec
Decode latency: 2.6223452580161393 sec
Time for inference 6: 2.71 sec total, 1512.90 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1085.46 GB/s
FLOPS achieved: 5.43 TF/s

Prefill latency: 0.08414401998743415 sec
Decode latency: 2.6254586279392242 sec
Time for inference 7: 2.71 sec total, 1511.08 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.16 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08417320589069277 sec
Decode latency: 2.6242824390064925 sec
Time for inference 8: 2.71 sec total, 1511.71 tokens/sec
Decode latency: 2.62 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.62 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.08425928291399032 sec
Decode latency: 2.6260562969837338 sec
Time for inference 9: 2.71 sec total, 1510.75 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1083.93 GB/s
FLOPS achieved: 5.42 TF/s

Prefill latency: 0.0842061439761892 sec
Decode latency: 2.625411936081946 sec
Time for inference 10: 2.71 sec total, 1511.17 tokens/sec
Decode latency: 2.63 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1084.23 GB/s
FLOPS achieved: 5.42 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.6251 sec
Average prefill latency: 0.0843 sec
Average tokens/sec: 1511.26
Memory used: 9.09 GB
Done. we are killing the process
