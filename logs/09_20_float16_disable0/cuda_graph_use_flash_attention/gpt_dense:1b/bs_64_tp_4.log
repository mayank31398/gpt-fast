W1001 01:44:01.048000 22752775735104 torch/distributed/run.py:779] 
W1001 01:44:01.048000 22752775735104 torch/distributed/run.py:779] *****************************************
W1001 01:44:01.048000 22752775735104 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:44:01.048000 22752775735104 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.12 seconds
Prefill latency: 0.31567630206700414 sec
Decode latency: 3.588777008932084 sec
Compilation time: 3.91 seconds
Compilation time: 3.91 seconds
Compilation time: 3.91 seconds
Compilation time: 3.96 seconds
Prefill latency: 0.31509133998770267 sec
Decode latency: 3.587966374005191 sec
Prefill latency: 0.31505448010284454 sec
Decode latency: 3.586431431933306 sec
Prefill latency: 0.3149933440145105 sec
Decode latency: 3.5897013210924342 sec
Prefill latency: 0.3150393409887329 sec
Decode latency: 3.5884579190751538 sec
Prefill latency: 0.3151870089350268 sec
Decode latency: 3.591312634991482 sec
Time for inference 1: 3.91 sec total, 4193.11 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3008.45 GB/s
FLOPS achieved: 15.04 TF/s

Prefill latency: 0.3148856349289417 sec
Decode latency: 3.5900910779600963 sec
Time for inference 2: 3.91 sec total, 4194.82 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.31 sec
Bandwidth achieved: 3009.68 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.31481125799473375 sec
Decode latency: 3.5903919659322128 sec
Time for inference 3: 3.91 sec total, 4194.64 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.31 sec
Bandwidth achieved: 3009.55 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.3149986549979076 sec
Decode latency: 3.5875650870148093 sec
Time for inference 4: 3.90 sec total, 4197.41 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.31 sec
Bandwidth achieved: 3011.54 GB/s
FLOPS achieved: 15.06 TF/s

Prefill latency: 0.3150436619762331 sec
Decode latency: 3.5917473069857806 sec
Time for inference 5: 3.91 sec total, 4192.65 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3008.12 GB/s
FLOPS achieved: 15.04 TF/s

Prefill latency: 0.3152842230629176 sec
Decode latency: 3.5878607960185036 sec
Time for inference 6: 3.90 sec total, 4196.61 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3010.96 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.3150554409949109 sec
Decode latency: 3.590627363999374 sec
Time for inference 7: 3.91 sec total, 4193.90 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3009.02 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.3151698980946094 sec
Decode latency: 3.589082802995108 sec
Time for inference 8: 3.91 sec total, 4195.51 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3010.17 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.31499718001578003 sec
Decode latency: 3.589749851031229 sec
Time for inference 9: 3.91 sec total, 4195.01 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.31 sec
Bandwidth achieved: 3009.81 GB/s
FLOPS achieved: 15.05 TF/s

Prefill latency: 0.31506136199459434 sec
Decode latency: 3.5888752460014075 sec
Time for inference 10: 3.90 sec total, 4195.66 tokens/sec
Decode latency: 3.59 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 3010.28 GB/s
FLOPS achieved: 15.05 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5897 sec
Average prefill latency: 0.3150 sec
Average tokens/sec: 4194.93
Memory used: 33.03 GB
Done. we are killing the process
