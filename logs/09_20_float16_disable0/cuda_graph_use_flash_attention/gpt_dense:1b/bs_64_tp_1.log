flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.94 seconds
[rank0]:[W1001 00:57:25.651783319 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.696548506966792 sec
Decode latency: 10.614973893971182 sec
Compilation time: 11.31 seconds
Prefill latency: 0.6988806300796568 sec
Decode latency: 10.606170515995473 sec
Prefill latency: 0.6986145590199158 sec
Decode latency: 10.480488022090867 sec
Prefill latency: 0.6988923419266939 sec
Decode latency: 10.608441272983328 sec
Prefill latency: 0.6987362649524584 sec
Decode latency: 10.604869104921818 sec
Prefill latency: 0.6987297480227426 sec
Decode latency: 10.605943139991723 sec
Time for inference 1: 11.31 sec total, 1449.17 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3136.74 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.6992107329424471 sec
Decode latency: 10.610638526035473 sec
Time for inference 2: 11.31 sec total, 1448.51 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3135.31 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.697411630069837 sec
Decode latency: 10.60972716996912 sec
Time for inference 3: 11.31 sec total, 1448.84 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3136.03 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.6984403519891202 sec
Decode latency: 10.615550191956572 sec
Time for inference 4: 11.32 sec total, 1447.98 tokens/sec
Decode latency: 10.62 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.17 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.6980093530146405 sec
Decode latency: 10.613346660044044 sec
Time for inference 5: 11.31 sec total, 1448.32 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.89 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.698698699939996 sec
Decode latency: 10.6091587850824 sec
Time for inference 6: 11.31 sec total, 1448.76 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3135.86 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.6969883269630373 sec
Decode latency: 10.613150559016503 sec
Time for inference 7: 11.31 sec total, 1448.48 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3135.25 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.6979698169743642 sec
Decode latency: 10.609888971084729 sec
Time for inference 8: 11.31 sec total, 1448.75 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3135.83 GB/s
FLOPS achieved: 15.68 TF/s

Prefill latency: 0.6977698910050094 sec
Decode latency: 10.614961109939031 sec
Time for inference 9: 11.31 sec total, 1448.13 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3134.49 GB/s
FLOPS achieved: 15.67 TF/s

Prefill latency: 0.6986527979606763 sec
Decode latency: 10.610310787917115 sec
Time for inference 10: 11.31 sec total, 1448.62 tokens/sec
Decode latency: 10.61 sec
Prefill latency: 0.70 sec
Bandwidth achieved: 3135.56 GB/s
FLOPS achieved: 15.68 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.6113 sec
Average prefill latency: 0.6982 sec
Average tokens/sec: 1448.56
Memory used: 40.57 GB
Done. we are killing the process
