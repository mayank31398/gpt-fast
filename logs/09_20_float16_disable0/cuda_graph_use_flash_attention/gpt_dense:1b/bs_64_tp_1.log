flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.8054233429720625 sec
Decode latency: 8.542426340049133 sec
Compilation time: 9.35 seconds
Prefill latency: 0.8074931600131094 sec
Decode latency: 8.658214599941857 sec
Prefill latency: 0.8054467829642817 sec
Decode latency: 8.660710525000468 sec
Prefill latency: 0.8128899650182575 sec
Decode latency: 8.660008175997064 sec
Prefill latency: 0.805655364994891 sec
Decode latency: 8.661421427037567 sec
Prefill latency: 0.8111100029200315 sec
Decode latency: 8.657133558066562 sec
Time for inference 1: 9.47 sec total, 1730.21 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.47 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8054250760469586 sec
Decode latency: 8.522019992931746 sec
Time for inference 2: 9.33 sec total, 1756.33 tokens/sec
Decode latency: 8.52 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4243.59 GB/s
FLOPS achieved: 21.22 TF/s

Prefill latency: 0.8109967210330069 sec
Decode latency: 8.657838804996572 sec
Time for inference 3: 9.47 sec total, 1730.13 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.29 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.8054570079548284 sec
Decode latency: 8.657162404968403 sec
Time for inference 4: 9.46 sec total, 1731.25 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4183.00 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.8055640100501478 sec
Decode latency: 8.66035150596872 sec
Time for inference 5: 9.47 sec total, 1730.66 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4181.55 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.8090976079693064 sec
Decode latency: 8.6597064769594 sec
Time for inference 6: 9.47 sec total, 1730.13 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4180.29 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.805402189027518 sec
Decode latency: 8.65901785704773 sec
Time for inference 7: 9.47 sec total, 1730.90 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4182.14 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.805422626901418 sec
Decode latency: 8.602347333915532 sec
Time for inference 8: 9.41 sec total, 1741.32 tokens/sec
Decode latency: 8.60 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4207.31 GB/s
FLOPS achieved: 21.04 TF/s

Prefill latency: 0.8074158370727673 sec
Decode latency: 8.658822142053396 sec
Time for inference 9: 9.47 sec total, 1730.58 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4181.38 GB/s
FLOPS achieved: 20.91 TF/s

Prefill latency: 0.8054793589981273 sec
Decode latency: 8.66012925398536 sec
Time for inference 10: 9.47 sec total, 1730.71 tokens/sec
Decode latency: 8.66 sec
Prefill latency: 0.81 sec
Bandwidth achieved: 4181.68 GB/s
FLOPS achieved: 20.91 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 8.6395 sec
Average prefill latency: 0.8071 sec
Average tokens/sec: 1734.22
Memory used: 54.46 GB
Done. we are killing the process
