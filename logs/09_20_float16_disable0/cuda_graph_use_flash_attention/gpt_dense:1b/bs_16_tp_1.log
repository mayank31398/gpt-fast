flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=2560, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
[rank0]:[W930 19:00:29.866739870 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.17913549405056983 sec
Decode latency: 3.8693828500108793 sec
Compilation time: 4.05 seconds
Prefill latency: 0.17856907506939024 sec
Decode latency: 3.8664874089881778 sec
Prefill latency: 0.17852879990823567 sec
Decode latency: 3.866632477962412 sec
Prefill latency: 0.1786169019760564 sec
Decode latency: 3.8681926609715447 sec
Prefill latency: 0.17853179399389774 sec
Decode latency: 3.8664364559808746 sec
Prefill latency: 0.17869858792982996 sec
Decode latency: 3.866555675980635 sec
Time for inference 1: 4.05 sec total, 1012.31 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.15 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.1786152949789539 sec
Decode latency: 3.8683269779430702 sec
Time for inference 2: 4.05 sec total, 1011.91 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2190.29 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.1785978979896754 sec
Decode latency: 3.866525918012485 sec
Time for inference 3: 4.05 sec total, 1012.37 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.29 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17859845701605082 sec
Decode latency: 3.8663221900351346 sec
Time for inference 4: 4.05 sec total, 1012.43 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.41 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.1785991000942886 sec
Decode latency: 3.8689577049808577 sec
Time for inference 5: 4.05 sec total, 1011.77 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2189.98 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17862133006565273 sec
Decode latency: 3.8664700420340523 sec
Time for inference 6: 4.05 sec total, 1012.40 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.34 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17867720604408532 sec
Decode latency: 3.8663756750756875 sec
Time for inference 7: 4.05 sec total, 1012.34 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.22 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17866341792978346 sec
Decode latency: 3.868024314986542 sec
Time for inference 8: 4.05 sec total, 1011.98 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2190.43 GB/s
FLOPS achieved: 10.95 TF/s

Prefill latency: 0.17857427999842912 sec
Decode latency: 3.8663196869893 sec
Time for inference 9: 4.05 sec total, 1012.44 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.43 GB/s
FLOPS achieved: 10.96 TF/s

Prefill latency: 0.17875074094627053 sec
Decode latency: 3.866504529956728 sec
Time for inference 10: 4.05 sec total, 1012.36 tokens/sec
Decode latency: 3.87 sec
Prefill latency: 0.18 sec
Bandwidth achieved: 2191.25 GB/s
FLOPS achieved: 10.96 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8670 sec
Average prefill latency: 0.1786 sec
Average tokens/sec: 1012.23
Memory used: 12.04 GB
Done. we are killing the process
