flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=4608, bias=False)
        (wo): Linear(in_features=1536, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=8192, bias=False)
        (w2): Linear(in_features=4096, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.00 seconds
Prefill latency: 0.2073244460625574 sec
Decode latency: 3.381012861034833 sec
Compilation time: 3.59 seconds
Prefill latency: 0.20692136301659048 sec
Decode latency: 3.2471597379771993 sec
Prefill latency: 0.20694355305749923 sec
Decode latency: 3.379149514948949 sec
Prefill latency: 0.20701461704447865 sec
Decode latency: 3.3794145910069346 sec
Prefill latency: 0.2070550830103457 sec
Decode latency: 3.379170974018052 sec
Prefill latency: 0.2069706580368802 sec
Decode latency: 3.379580094013363 sec
Time for inference 1: 3.59 sec total, 1141.75 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2758.65 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.20695789495948702 sec
Decode latency: 3.3802760769613087 sec
Time for inference 2: 3.59 sec total, 1141.54 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2758.16 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.20698651601560414 sec
Decode latency: 3.274621531018056 sec
Time for inference 3: 3.48 sec total, 1176.21 tokens/sec
Decode latency: 3.27 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2841.93 GB/s
FLOPS achieved: 14.21 TF/s

Prefill latency: 0.206905524013564 sec
Decode latency: 3.3793715530773625 sec
Time for inference 4: 3.59 sec total, 1141.88 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2758.97 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.20692817703820765 sec
Decode latency: 3.379326108028181 sec
Time for inference 5: 3.59 sec total, 1141.90 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2759.03 GB/s
FLOPS achieved: 13.80 TF/s

Prefill latency: 0.2068829230265692 sec
Decode latency: 3.38022732490208 sec
Time for inference 6: 3.59 sec total, 1141.62 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2758.33 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.2070157650159672 sec
Decode latency: 3.293659961083904 sec
Time for inference 7: 3.50 sec total, 1169.81 tokens/sec
Decode latency: 3.29 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2826.47 GB/s
FLOPS achieved: 14.13 TF/s

Prefill latency: 0.20702635706402361 sec
Decode latency: 3.3811999519821256 sec
Time for inference 8: 3.59 sec total, 1141.22 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2757.38 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.20715597900561988 sec
Decode latency: 3.3825558729004115 sec
Time for inference 9: 3.59 sec total, 1140.76 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2756.26 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.20704745093826205 sec
Decode latency: 3.38100736704655 sec
Time for inference 10: 3.59 sec total, 1141.29 tokens/sec
Decode latency: 3.38 sec
Prefill latency: 0.21 sec
Bandwidth achieved: 2757.56 GB/s
FLOPS achieved: 13.79 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.3612 sec
Average prefill latency: 0.2070 sec
Average tokens/sec: 1147.80
Memory used: 15.76 GB
Done. we are killing the process
