W1001 00:48:50.636000 23437261113152 torch/distributed/run.py:779] 
W1001 00:48:50.636000 23437261113152 torch/distributed/run.py:779] *****************************************
W1001 00:48:50.636000 23437261113152 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:48:50.636000 23437261113152 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=320, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.03 seconds
Prefill latency: 0.07543027901556343 sec
Decode latency: 2.2755267380271107 sec
Compilation time: 2.32 seconds
Compilation time: 2.34 seconds
Compilation time: 2.35 seconds
Compilation time: 2.34 seconds
Compilation time: 2.32 seconds
Compilation time: 2.30 seconds
Compilation time: 2.34 seconds
Compilation time: 2.35 seconds
Prefill latency: 0.02264819503761828 sec
Decode latency: 2.276800134917721 sec
Prefill latency: 0.02280479797627777 sec
Decode latency: 2.2757860019337386 sec
Prefill latency: 0.022578741889446974 sec
Decode latency: 2.274751176009886 sec
Prefill latency: 0.02254465699661523 sec
Decode latency: 2.276664723060094 sec
Prefill latency: 0.02267939900048077 sec
Decode latency: 2.2767567700939253 sec
Time for inference 1: 2.30 sec total, 445.17 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.36 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.02257875702343881 sec
Decode latency: 2.2742692170431837 sec
Time for inference 2: 2.30 sec total, 445.65 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.55 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022512745927087963 sec
Decode latency: 2.2768089970340952 sec
Time for inference 3: 2.30 sec total, 445.20 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.37 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.02251229004468769 sec
Decode latency: 2.2770194709300995 sec
Time for inference 4: 2.30 sec total, 445.17 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.36 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022795871016569436 sec
Decode latency: 2.2757487379712984 sec
Time for inference 5: 2.30 sec total, 445.33 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.43 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022500858991406858 sec
Decode latency: 2.277392814052291 sec
Time for inference 6: 2.30 sec total, 445.04 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.31 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022481083986349404 sec
Decode latency: 2.276950628031045 sec
Time for inference 7: 2.30 sec total, 445.17 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.36 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022485902067273855 sec
Decode latency: 2.275423795101233 sec
Time for inference 8: 2.30 sec total, 445.47 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.48 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022615105961449444 sec
Decode latency: 2.2776016040006652 sec
Time for inference 9: 2.30 sec total, 445.04 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.31 GB/s
FLOPS achieved: 0.90 TF/s

Prefill latency: 0.022501009982079268 sec
Decode latency: 2.2764953000005335 sec
Time for inference 10: 2.30 sec total, 445.26 tokens/sec
Decode latency: 2.28 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 179.39 GB/s
FLOPS achieved: 0.90 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2764 sec
Average prefill latency: 0.0226 sec
Average tokens/sec: 445.25
Memory used: 2.26 GB
Done. we are killing the process
