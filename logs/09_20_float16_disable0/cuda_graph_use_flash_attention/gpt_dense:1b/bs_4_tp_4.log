W1001 00:48:03.906000 23233001502528 torch/distributed/run.py:779] 
W1001 00:48:03.906000 23233001502528 torch/distributed/run.py:779] *****************************************
W1001 00:48:03.906000 23233001502528 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:48:03.906000 23233001502528 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.06837977399118245 sec
Decode latency: 2.262700138031505 sec
Compilation time: 2.31 secondsCompilation time: 2.29 seconds

Compilation time: 2.30 seconds
Compilation time: 2.33 seconds
Prefill latency: 0.025128557928837836 sec
Decode latency: 2.262398175080307 sec
Prefill latency: 0.02516179997473955 sec
Decode latency: 2.261572228046134 sec
Prefill latency: 0.025256906053982675 sec
Decode latency: 2.2625369720626622 sec
Prefill latency: 0.025118952966295183 sec
Decode latency: 2.2632016929564998 sec
Prefill latency: 0.025214839028194547 sec
Decode latency: 2.262698636041023 sec
Time for inference 1: 2.29 sec total, 447.41 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.86 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025395336095243692 sec
Decode latency: 2.2637210830580443 sec
Time for inference 2: 2.29 sec total, 447.18 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.70 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025157948024570942 sec
Decode latency: 2.2631305520189926 sec
Time for inference 3: 2.29 sec total, 447.31 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.79 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025210252031683922 sec
Decode latency: 2.262502996949479 sec
Time for inference 4: 2.29 sec total, 447.44 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.88 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025275888037867844 sec
Decode latency: 2.2635069540701807 sec
Time for inference 5: 2.29 sec total, 447.24 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.74 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.02515040698926896 sec
Decode latency: 2.262729653972201 sec
Time for inference 6: 2.29 sec total, 447.42 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.87 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.02519325097091496 sec
Decode latency: 2.262537758098915 sec
Time for inference 7: 2.29 sec total, 447.44 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.88 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025387690984643996 sec
Decode latency: 2.26325492199976 sec
Time for inference 8: 2.29 sec total, 447.27 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.76 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.0251467099878937 sec
Decode latency: 2.2629538100445643 sec
Time for inference 9: 2.29 sec total, 447.36 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.83 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025469082058407366 sec
Decode latency: 2.2624299590243027 sec
Time for inference 10: 2.29 sec total, 447.36 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.82 GB/s
FLOPS achieved: 1.46 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2629 sec
Average prefill latency: 0.0253 sec
Average tokens/sec: 447.34
Memory used: 2.72 GB
Done. we are killing the process
