W0930 18:55:13.300000 22708684527424 torch/distributed/run.py:779] 
W0930 18:55:13.300000 22708684527424 torch/distributed/run.py:779] *****************************************
W0930 18:55:13.300000 22708684527424 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0930 18:55:13.300000 22708684527424 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.16 seconds
Prefill latency: 0.041593267931602895 sec
Decode latency: 2.2650387010071427 sec
Compilation time: 2.29 seconds
Compilation time: 2.31 secondsCompilation time: 2.31 secondsCompilation time: 2.31 seconds


Prefill latency: 0.025135166011750698 sec
Decode latency: 2.265132685075514 sec
Prefill latency: 0.02509645593818277 sec
Decode latency: 2.2646231630351394 sec
Prefill latency: 0.025209344923496246 sec
Decode latency: 2.2630963569972664 sec
Prefill latency: 0.025120642967522144 sec
Decode latency: 2.264784441096708 sec
Prefill latency: 0.025292085018008947 sec
Decode latency: 2.2627404439263046 sec
Time for inference 1: 2.29 sec total, 447.41 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.86 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025149467051960528 sec
Decode latency: 2.265067735919729 sec
Time for inference 2: 2.29 sec total, 446.97 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.57 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025162329897284508 sec
Decode latency: 2.2653969440143555 sec
Time for inference 3: 2.29 sec total, 446.91 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.53 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025539715075865388 sec
Decode latency: 2.265415856963955 sec
Time for inference 4: 2.29 sec total, 446.83 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.48 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025211542029865086 sec
Decode latency: 2.2648527410347015 sec
Time for inference 5: 2.29 sec total, 447.00 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.59 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025168076041154563 sec
Decode latency: 2.2628573779948056 sec
Time for inference 6: 2.29 sec total, 447.33 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.81 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025125776999630034 sec
Decode latency: 2.2653424800373614 sec
Time for inference 7: 2.29 sec total, 446.84 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.49 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025179744930937886 sec
Decode latency: 2.264660609071143 sec
Time for inference 8: 2.29 sec total, 447.02 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.60 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.025138429016806185 sec
Decode latency: 2.264881910989061 sec
Time for inference 9: 2.29 sec total, 446.96 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.56 GB/s
FLOPS achieved: 1.46 TF/s

Prefill latency: 0.0251362620620057 sec
Decode latency: 2.2642994429916143 sec
Time for inference 10: 2.29 sec total, 447.09 tokens/sec
Decode latency: 2.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 292.65 GB/s
FLOPS achieved: 1.46 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2646 sec
Average prefill latency: 0.0252 sec
Average tokens/sec: 447.04
Memory used: 2.72 GB
Done. we are killing the process
