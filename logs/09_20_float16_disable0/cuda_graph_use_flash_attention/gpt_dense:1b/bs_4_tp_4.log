W1001 01:30:51.804000 22420180674368 torch/distributed/run.py:779] 
W1001 01:30:51.804000 22420180674368 torch/distributed/run.py:779] *****************************************
W1001 01:30:51.804000 22420180674368 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:30:51.804000 22420180674368 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.06283543491736054 sec
Decode latency: 2.2705615230370313 sec
Compilation time: 2.30 seconds
Compilation time: 2.33 seconds
Compilation time: 2.30 seconds
Compilation time: 2.33 seconds
Prefill latency: 0.02651146601419896 sec
Decode latency: 2.271096123033203 sec
Prefill latency: 0.026444814051501453 sec
Decode latency: 2.27024907595478 sec
Prefill latency: 0.026528935064561665 sec
Decode latency: 2.2700640980619937 sec
Prefill latency: 0.02646488300524652 sec
Decode latency: 2.271793560939841 sec
Prefill latency: 0.02645378897432238 sec
Decode latency: 2.2728648049524054 sec
Time for inference 1: 2.30 sec total, 445.20 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.42 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.02654202503617853 sec
Decode latency: 2.2712163740070537 sec
Time for inference 2: 2.30 sec total, 445.49 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.63 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026493006967939436 sec
Decode latency: 2.272755455924198 sec
Time for inference 3: 2.30 sec total, 445.11 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.35 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026539595099166036 sec
Decode latency: 2.2725366390077397 sec
Time for inference 4: 2.30 sec total, 445.21 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.43 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026480254950001836 sec
Decode latency: 2.2743502169614658 sec
Time for inference 5: 2.30 sec total, 444.87 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.18 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026525724912062287 sec
Decode latency: 2.2735634479904547 sec
Time for inference 6: 2.30 sec total, 445.04 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.31 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026569309062324464 sec
Decode latency: 2.274191637057811 sec
Time for inference 7: 2.30 sec total, 444.92 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.22 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026561309001408517 sec
Decode latency: 2.271846534917131 sec
Time for inference 8: 2.30 sec total, 445.38 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.55 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026524300104938447 sec
Decode latency: 2.273380881990306 sec
Time for inference 9: 2.30 sec total, 445.08 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.33 GB/s
FLOPS achieved: 1.60 TF/s

Prefill latency: 0.026603683945722878 sec
Decode latency: 2.2732549229403958 sec
Time for inference 10: 2.30 sec total, 445.10 tokens/sec
Decode latency: 2.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 319.35 GB/s
FLOPS achieved: 1.60 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.2730 sec
Average prefill latency: 0.0265 sec
Average tokens/sec: 445.14
Memory used: 3.01 GB
Done. we are killing the process
