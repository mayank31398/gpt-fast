W1001 00:51:29.244000 22494764496704 torch/distributed/run.py:779] 
W1001 00:51:29.244000 22494764496704 torch/distributed/run.py:779] *****************************************
W1001 00:51:29.244000 22494764496704 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 00:51:29.244000 22494764496704 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=640, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 1.22 seconds
Prefill latency: 0.05599534697830677 sec
Decode latency: 2.4668344259262085 sec
Compilation time: 2.52 seconds
Compilation time: 2.53 seconds
Compilation time: 2.51 seconds
Compilation time: 2.54 seconds
Prefill latency: 0.04308687907177955 sec
Decode latency: 2.465394133934751 sec
Prefill latency: 0.04319117299746722 sec
Decode latency: 2.4654334380757064 sec
Prefill latency: 0.04300019599031657 sec
Decode latency: 2.464675521943718 sec
Prefill latency: 0.04295551194809377 sec
Decode latency: 2.4632237729383633 sec
Prefill latency: 0.043000629055313766 sec
Decode latency: 2.4639822049066424 sec
Time for inference 1: 2.51 sec total, 816.61 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.52 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04293432296253741 sec
Decode latency: 2.4651245661079884 sec
Time for inference 2: 2.51 sec total, 816.27 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.30 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04288506705779582 sec
Decode latency: 2.4657279200619087 sec
Time for inference 3: 2.51 sec total, 816.13 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.21 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.042896136990748346 sec
Decode latency: 2.4645699120592326 sec
Time for inference 4: 2.51 sec total, 816.44 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.41 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04284682008437812 sec
Decode latency: 2.463703794986941 sec
Time for inference 5: 2.51 sec total, 816.81 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.65 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04289454501122236 sec
Decode latency: 2.4644107029307634 sec
Time for inference 6: 2.51 sec total, 816.55 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.48 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04303383396472782 sec
Decode latency: 2.465397238964215 sec
Time for inference 7: 2.51 sec total, 816.21 tokens/sec
Decode latency: 2.47 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.26 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.042945328052155674 sec
Decode latency: 2.4645312189823017 sec
Time for inference 8: 2.51 sec total, 816.46 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.42 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04300519195385277 sec
Decode latency: 2.4641344499541447 sec
Time for inference 9: 2.51 sec total, 816.65 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.55 GB/s
FLOPS achieved: 2.67 TF/s

Prefill latency: 0.04300066502764821 sec
Decode latency: 2.4646133029600605 sec
Time for inference 10: 2.51 sec total, 816.46 tokens/sec
Decode latency: 2.46 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 534.42 GB/s
FLOPS achieved: 2.67 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4646 sec
Average prefill latency: 0.0429 sec
Average tokens/sec: 816.46
Memory used: 4.49 GB
Done. we are killing the process
