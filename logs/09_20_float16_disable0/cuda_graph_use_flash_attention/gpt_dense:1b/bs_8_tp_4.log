W1001 01:34:13.486000 23341492176704 torch/distributed/run.py:779] 
W1001 01:34:13.486000 23341492176704 torch/distributed/run.py:779] *****************************************
W1001 01:34:13.486000 23341492176704 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:34:13.486000 23341492176704 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=1152, bias=False)
        (wo): Linear(in_features=384, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=2048, bias=False)
        (w2): Linear(in_features=1024, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.07029788102954626 sec
Decode latency: 2.4391317430417985 sec
Compilation time: 2.49 seconds
Compilation time: 2.50 secondsCompilation time: 2.49 seconds

Compilation time: 2.51 seconds
Prefill latency: 0.046790224965661764 sec
Decode latency: 2.440290794009343 sec
Prefill latency: 0.04686182807199657 sec
Decode latency: 2.4371619439916685 sec
Prefill latency: 0.04691941710188985 sec
Decode latency: 2.4361940230010077 sec
Prefill latency: 0.04682381101883948 sec
Decode latency: 2.4361613530199975 sec
Prefill latency: 0.046727609005756676 sec
Decode latency: 2.4369207130512223 sec
Time for inference 1: 2.49 sec total, 824.05 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.23 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04684579896274954 sec
Decode latency: 2.434971156064421 sec
Time for inference 2: 2.48 sec total, 824.91 tokens/sec
Decode latency: 2.43 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.85 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04691957402974367 sec
Decode latency: 2.4374515740200877 sec
Time for inference 3: 2.49 sec total, 824.02 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.21 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04699298704508692 sec
Decode latency: 2.4367414079606533 sec
Time for inference 4: 2.48 sec total, 824.33 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.44 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.047111271996982396 sec
Decode latency: 2.4363219649530947 sec
Time for inference 5: 2.48 sec total, 824.31 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.42 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04692675301339477 sec
Decode latency: 2.436155725037679 sec
Time for inference 6: 2.48 sec total, 824.41 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.50 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04683862300589681 sec
Decode latency: 2.4366364390589297 sec
Time for inference 7: 2.48 sec total, 824.33 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.44 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.046850860002450645 sec
Decode latency: 2.4347535270499066 sec
Time for inference 8: 2.48 sec total, 824.97 tokens/sec
Decode latency: 2.43 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.89 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04683163808658719 sec
Decode latency: 2.436131116002798 sec
Time for inference 9: 2.48 sec total, 824.52 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.57 GB/s
FLOPS achieved: 2.96 TF/s

Prefill latency: 0.04691369901411235 sec
Decode latency: 2.435834508971311 sec
Time for inference 10: 2.48 sec total, 824.59 tokens/sec
Decode latency: 2.44 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 591.62 GB/s
FLOPS achieved: 2.96 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4362 sec
Average prefill latency: 0.0469 sec
Average tokens/sec: 824.44
Memory used: 5.19 GB
Done. we are killing the process
