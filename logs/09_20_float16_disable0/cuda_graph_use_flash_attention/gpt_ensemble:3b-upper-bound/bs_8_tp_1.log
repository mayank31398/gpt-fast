flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.96 seconds
Prefill latency: 0.2026404089992866 sec
Decode latency: 3.5143711150158197 sec
Compilation time: 3.72 seconds
Prefill latency: 0.20111583196558058 sec
Decode latency: 3.5142868000548333 sec
Prefill latency: 0.20130409102421254 sec
Decode latency: 3.390406411024742 sec
Prefill latency: 0.2017336149001494 sec
Decode latency: 3.513976930989884 sec
Prefill latency: 0.200581990997307 sec
Decode latency: 3.509847790002823 sec
Prefill latency: 0.20178715302608907 sec
Decode latency: 3.5133467479608953 sec
Time for inference 1: 3.72 sec total, 551.16 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3870.03 GB/s
FLOPS achieved: 19.35 TF/s

Prefill latency: 0.20190064189955592 sec
Decode latency: 3.514335363986902 sec
Time for inference 2: 3.72 sec total, 550.99 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.87 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20091476605739444 sec
Decode latency: 3.5154721930157393 sec
Time for inference 3: 3.72 sec total, 550.97 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.68 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20152608305215836 sec
Decode latency: 3.5131561090238392 sec
Time for inference 4: 3.72 sec total, 551.19 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3870.26 GB/s
FLOPS achieved: 19.35 TF/s

Prefill latency: 0.2024384899996221 sec
Decode latency: 3.5139247979968786 sec
Time for inference 5: 3.72 sec total, 550.95 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3868.60 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.2016590010607615 sec
Decode latency: 3.399440104025416 sec
Time for inference 6: 3.60 sec total, 568.60 tokens/sec
Decode latency: 3.40 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3992.53 GB/s
FLOPS achieved: 19.96 TF/s

Prefill latency: 0.201648925896734 sec
Decode latency: 3.5140093750087544 sec
Time for inference 7: 3.72 sec total, 551.08 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3869.45 GB/s
FLOPS achieved: 19.35 TF/s

Prefill latency: 0.20067018491681665 sec
Decode latency: 3.513055693008937 sec
Time for inference 8: 3.71 sec total, 551.36 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3871.46 GB/s
FLOPS achieved: 19.36 TF/s

Prefill latency: 0.2020948639838025 sec
Decode latency: 3.5153073580004275 sec
Time for inference 9: 3.72 sec total, 550.82 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.67 GB/s
FLOPS achieved: 19.34 TF/s

Prefill latency: 0.20167591806966811 sec
Decode latency: 3.5154464869992808 sec
Time for inference 10: 3.72 sec total, 550.87 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.20 sec
Bandwidth achieved: 3867.98 GB/s
FLOPS achieved: 19.34 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5027 sec
Average prefill latency: 0.2016 sec
Average tokens/sec: 552.80
Memory used: 13.57 GB
Done. we are killing the process
