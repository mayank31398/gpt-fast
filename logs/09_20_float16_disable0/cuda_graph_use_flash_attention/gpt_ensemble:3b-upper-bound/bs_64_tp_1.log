flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.91 seconds
Prefill latency: 1.6184433239977807 sec
Decode latency: 12.62064494099468 sec
Compilation time: 14.24 seconds
Prefill latency: 1.6182337199570611 sec
Decode latency: 12.675369984004647 sec
Prefill latency: 1.6177403200417757 sec
Decode latency: 12.675348016084172 sec
Prefill latency: 1.623296765028499 sec
Decode latency: 12.677896909066476 sec
Prefill latency: 1.6209127070615068 sec
Decode latency: 12.52999930398073 sec
Prefill latency: 1.6148177590221167 sec
Decode latency: 12.609758440987207 sec
Time for inference 1: 14.23 sec total, 1151.72 tokens/sec
Decode latency: 12.61 sec
Prefill latency: 1.61 sec
Bandwidth achieved: 8086.99 GB/s
FLOPS achieved: 40.43 TF/s

Prefill latency: 1.6235633259639144 sec
Decode latency: 12.530184941017069 sec
Time for inference 2: 14.15 sec total, 1157.49 tokens/sec
Decode latency: 12.53 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8127.48 GB/s
FLOPS achieved: 40.64 TF/s

Prefill latency: 1.6148057570680976 sec
Decode latency: 12.674866874935105 sec
Time for inference 3: 14.29 sec total, 1146.48 tokens/sec
Decode latency: 12.67 sec
Prefill latency: 1.61 sec
Bandwidth achieved: 8050.19 GB/s
FLOPS achieved: 40.25 TF/s

Prefill latency: 1.618591726059094 sec
Decode latency: 12.618741996935569 sec
Time for inference 4: 14.24 sec total, 1150.70 tokens/sec
Decode latency: 12.62 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8079.81 GB/s
FLOPS achieved: 40.40 TF/s

Prefill latency: 1.6202319720759988 sec
Decode latency: 12.676403316901997 sec
Time for inference 5: 14.30 sec total, 1145.94 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8046.37 GB/s
FLOPS achieved: 40.23 TF/s

Prefill latency: 1.622434804099612 sec
Decode latency: 12.676580204977654 sec
Time for inference 6: 14.30 sec total, 1145.73 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8044.93 GB/s
FLOPS achieved: 40.22 TF/s

Prefill latency: 1.6221111059421673 sec
Decode latency: 12.67561419098638 sec
Time for inference 7: 14.30 sec total, 1145.84 tokens/sec
Decode latency: 12.68 sec
Prefill latency: 1.62 sec
Bandwidth achieved: 8045.67 GB/s
FLOPS achieved: 40.23 TF/s

Prefill latency: 1.6236144810682163 sec
