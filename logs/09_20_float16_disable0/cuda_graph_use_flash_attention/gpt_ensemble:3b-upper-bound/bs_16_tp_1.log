flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.39550014305859804 sec
Decode latency: 5.1553268319694325 sec
Compilation time: 5.55 seconds
Prefill latency: 0.3950940070208162 sec
Decode latency: 5.154246323974803 sec
Prefill latency: 0.395069238031283 sec
Decode latency: 5.1547728379955515 sec
Prefill latency: 0.3958679150091484 sec
Decode latency: 5.152254110085778 sec
Prefill latency: 0.3957513589411974 sec
Decode latency: 5.155608025030233 sec
Prefill latency: 0.39623942296020687 sec
Decode latency: 5.143846928956918 sec
Time for inference 1: 5.54 sec total, 739.25 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5190.74 GB/s
FLOPS achieved: 25.95 TF/s

Prefill latency: 0.39654571702703834 sec
Decode latency: 5.144816154032014 sec
Time for inference 2: 5.54 sec total, 739.06 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5189.44 GB/s
FLOPS achieved: 25.95 TF/s

Prefill latency: 0.39917132805567235 sec
Decode latency: 5.156759829027578 sec
Time for inference 3: 5.56 sec total, 737.13 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5175.85 GB/s
FLOPS achieved: 25.88 TF/s

Prefill latency: 0.4009992820210755 sec
Decode latency: 5.157012001029216 sec
Time for inference 4: 5.56 sec total, 736.86 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5173.94 GB/s
FLOPS achieved: 25.87 TF/s

Prefill latency: 0.3973789910087362 sec
Decode latency: 5.155976330977865 sec
Time for inference 5: 5.55 sec total, 737.49 tokens/sec
Decode latency: 5.16 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5178.36 GB/s
FLOPS achieved: 25.89 TF/s

Prefill latency: 0.3988050940679386 sec
Decode latency: 5.071235958021134 sec
Time for inference 6: 5.47 sec total, 748.71 tokens/sec
Decode latency: 5.07 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5257.17 GB/s
FLOPS achieved: 26.29 TF/s

Prefill latency: 0.395710609969683 sec
Decode latency: 5.154948225012049 sec
Time for inference 7: 5.55 sec total, 737.83 tokens/sec
Decode latency: 5.15 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5180.78 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.39733782096300274 sec
Decode latency: 5.119335153023712 sec
Time for inference 8: 5.52 sec total, 742.38 tokens/sec
Decode latency: 5.12 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5212.72 GB/s
FLOPS achieved: 26.06 TF/s

Prefill latency: 0.39667895808815956 sec
Decode latency: 5.153953106026165 sec
Time for inference 9: 5.55 sec total, 737.83 tokens/sec
Decode latency: 5.15 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5180.81 GB/s
FLOPS achieved: 25.90 TF/s

Prefill latency: 0.3984713680110872 sec
Decode latency: 5.143988444004208 sec
Time for inference 10: 5.54 sec total, 738.93 tokens/sec
Decode latency: 5.14 sec
Prefill latency: 0.40 sec
Bandwidth achieved: 5188.48 GB/s
FLOPS achieved: 25.94 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.1402 sec
Average prefill latency: 0.3977 sec
Average tokens/sec: 739.55
Memory used: 19.32 GB
Done. we are killing the process
