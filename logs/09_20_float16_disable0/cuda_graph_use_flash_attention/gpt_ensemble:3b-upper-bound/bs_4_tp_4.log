W1001 01:51:53.110000 22822396077888 torch/distributed/run.py:779] 
W1001 01:51:53.110000 22822396077888 torch/distributed/run.py:779] *****************************************
W1001 01:51:53.110000 22822396077888 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:51:53.110000 22822396077888 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.97 seconds
Prefill latency: 0.033087461022660136 sec
Compilation time: 2.16 seconds
Compilation time: 2.20 seconds
Compilation time: 2.16 seconds
Decode latency: 2.1205540460068733 sec
Compilation time: 2.15 seconds
Prefill latency: 0.032790919998660684 sec
Decode latency: 2.120733720017597 sec
Prefill latency: 0.03285325097385794 sec
Decode latency: 2.120592217077501 sec
Prefill latency: 0.0327796550700441 sec
Decode latency: 2.1207521059550345 sec
Prefill latency: 0.03280248597729951 sec
Decode latency: 2.1206852140603587 sec
Prefill latency: 0.032797800027765334 sec
Decode latency: 2.120234653004445 sec
Time for inference 1: 2.15 sec total, 475.47 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.55 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03275988402310759 sec
Decode latency: 2.120666414964944 sec
Time for inference 2: 2.15 sec total, 475.38 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.38 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03283864795230329 sec
Decode latency: 2.1208153730258346 sec
Time for inference 3: 2.15 sec total, 475.33 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.28 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03277360799256712 sec
Decode latency: 2.1210127089871094 sec
Time for inference 4: 2.15 sec total, 475.30 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.21 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03284728201106191 sec
Decode latency: 2.1203505269950256 sec
Time for inference 5: 2.15 sec total, 475.42 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.46 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03275933605618775 sec
Decode latency: 2.1207381340209395 sec
Time for inference 6: 2.15 sec total, 475.36 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.34 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.032901833998039365 sec
Decode latency: 2.120935720973648 sec
Time for inference 7: 2.15 sec total, 475.29 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.20 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03278837294783443 sec
Decode latency: 2.120768159045838 sec
Time for inference 8: 2.15 sec total, 475.31 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.25 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.03283188899513334 sec
Decode latency: 2.120802025892772 sec
Time for inference 9: 2.15 sec total, 475.32 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.26 GB/s
FLOPS achieved: 4.58 TF/s

Prefill latency: 0.032772429985925555 sec
Decode latency: 2.120308502926491 sec
Time for inference 10: 2.15 sec total, 475.45 tokens/sec
Decode latency: 2.12 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 915.50 GB/s
FLOPS achieved: 4.58 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.1207 sec
Average prefill latency: 0.0328 sec
Average tokens/sec: 475.36
Memory used: 3.60 GB
Done. we are killing the process
