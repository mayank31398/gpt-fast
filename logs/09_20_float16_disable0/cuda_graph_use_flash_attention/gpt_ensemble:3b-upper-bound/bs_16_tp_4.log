W1001 01:58:14.377000 22961793378112 torch/distributed/run.py:779] 
W1001 01:58:14.377000 22961793378112 torch/distributed/run.py:779] *****************************************
W1001 01:58:14.377000 22961793378112 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 01:58:14.377000 22961793378112 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.11 seconds
Prefill latency: 0.11344850389286876 sec
Compilation time: 2.68 seconds
Compilation time: 2.70 seconds
Compilation time: 2.68 seconds
Decode latency: 2.566433929023333 sec
Compilation time: 2.68 seconds
Prefill latency: 0.11336539697367698 sec
Decode latency: 2.566645729006268 sec
Prefill latency: 0.11335968493949622 sec
Decode latency: 2.5674741030670702 sec
Prefill latency: 0.11341033002827317 sec
Decode latency: 2.566835204954259 sec
Prefill latency: 0.11334582197014242 sec
Decode latency: 2.5669977320358157 sec
Prefill latency: 0.11319965298753232 sec
Decode latency: 2.565583726973273 sec
Time for inference 1: 2.68 sec total, 1528.65 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2943.50 GB/s
FLOPS achieved: 14.72 TF/s

Prefill latency: 0.11314517701976001 sec
Decode latency: 2.5663850100245327 sec
Time for inference 2: 2.68 sec total, 1528.20 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2942.63 GB/s
FLOPS achieved: 14.71 TF/s

Prefill latency: 0.11350079602561891 sec
Decode latency: 2.5678214409854263 sec
Time for inference 3: 2.68 sec total, 1527.16 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2940.63 GB/s
FLOPS achieved: 14.70 TF/s

Prefill latency: 0.11329766805283725 sec
Decode latency: 2.5674348369939253 sec
Time for inference 4: 2.68 sec total, 1527.48 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2941.26 GB/s
FLOPS achieved: 14.71 TF/s

Prefill latency: 0.11328797391615808 sec
Decode latency: 2.5670390439918265 sec
Time for inference 5: 2.68 sec total, 1527.79 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2941.85 GB/s
FLOPS achieved: 14.71 TF/s

Prefill latency: 0.11327751097269356 sec
Decode latency: 2.5378950550220907 sec
Time for inference 6: 2.65 sec total, 1544.51 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2974.05 GB/s
FLOPS achieved: 14.87 TF/s

Prefill latency: 0.11329905001912266 sec
Decode latency: 2.568144452990964 sec
Time for inference 7: 2.68 sec total, 1527.11 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2940.54 GB/s
FLOPS achieved: 14.70 TF/s

Prefill latency: 0.11336940189357847 sec
Decode latency: 2.5675456080352888 sec
Time for inference 8: 2.68 sec total, 1527.32 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2940.95 GB/s
FLOPS achieved: 14.70 TF/s

Prefill latency: 0.11325345898512751 sec
Decode latency: 2.5650969189591706 sec
Time for inference 9: 2.68 sec total, 1528.83 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2943.85 GB/s
FLOPS achieved: 14.72 TF/s

Prefill latency: 0.11334488692227751 sec
Decode latency: 2.5685861880192533 sec
Time for inference 10: 2.68 sec total, 1526.84 tokens/sec
Decode latency: 2.57 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 2940.02 GB/s
FLOPS achieved: 14.70 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5642 sec
Average prefill latency: 0.1133 sec
Average tokens/sec: 1529.39
Memory used: 6.90 GB
Done. we are killing the process
