flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.03141586005222052 sec
Decode latency: 2.5383385609602556 sec
Compilation time: 2.57 seconds
Prefill latency: 0.03129252197686583 sec
Decode latency: 2.439061944023706 sec
Prefill latency: 0.03130982699804008 sec
Decode latency: 2.4900174940703437 sec
Prefill latency: 0.031270651961676776 sec
Decode latency: 2.5383551680715755 sec
Prefill latency: 0.03124713501892984 sec
Decode latency: 2.53840241197031 sec
Prefill latency: 0.0312723129754886 sec
Decode latency: 2.536573670920916 sec
Time for inference 1: 2.57 sec total, 99.67 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.83 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031288297032006085 sec
Decode latency: 2.5384530030423775 sec
Time for inference 2: 2.57 sec total, 99.60 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.33 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031357132946141064 sec
Decode latency: 2.4122464809333906 sec
Time for inference 3: 2.44 sec total, 104.74 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 735.43 GB/s
FLOPS achieved: 3.68 TF/s

Prefill latency: 0.031246596947312355 sec
Decode latency: 2.5387462590588257 sec
Time for inference 4: 2.57 sec total, 99.59 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.27 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031296580913476646 sec
Decode latency: 2.5382335010217503 sec
Time for inference 5: 2.57 sec total, 99.61 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.40 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031299346941523254 sec
Decode latency: 2.538226475007832 sec
Time for inference 6: 2.57 sec total, 99.61 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.39 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.0312583539634943 sec
Decode latency: 2.5371952359564602 sec
Time for inference 7: 2.57 sec total, 99.65 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.68 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.03128597093746066 sec
Decode latency: 2.5382831069873646 sec
Time for inference 8: 2.57 sec total, 99.60 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.39 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.031208809930831194 sec
Decode latency: 2.538400359102525 sec
Time for inference 9: 2.57 sec total, 99.60 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.35 GB/s
FLOPS achieved: 3.50 TF/s

Prefill latency: 0.03128077497240156 sec
Decode latency: 2.5362997979391366 sec
Time for inference 10: 2.57 sec total, 99.68 tokens/sec
Decode latency: 2.54 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 699.90 GB/s
FLOPS achieved: 3.50 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.5253 sec
Average prefill latency: 0.0313 sec
Average tokens/sec: 100.13
Memory used: 8.41 GB
Done. we are killing the process
