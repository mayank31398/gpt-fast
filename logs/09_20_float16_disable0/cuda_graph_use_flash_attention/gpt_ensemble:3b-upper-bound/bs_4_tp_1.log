flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=6912, bias=False)
        (wo): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=18432, bias=False)
        (w2): Linear(in_features=9216, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.16 seconds
Prefill latency: 0.10205828794278204 sec
Decode latency: 3.0351301359478384 sec
Compilation time: 3.14 seconds
Prefill latency: 0.10213597503025085 sec
Decode latency: 3.035371254896745 sec
Prefill latency: 0.10197993402834982 sec
Decode latency: 3.034221387002617 sec
Prefill latency: 0.102146988036111 sec
Decode latency: 3.0343893240205944 sec
Prefill latency: 0.10244914703071117 sec
Decode latency: 3.035123709938489 sec
Prefill latency: 0.102008406072855 sec
Decode latency: 3.0348209240473807 sec
Time for inference 1: 3.14 sec total, 326.36 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.56 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10212091298308223 sec
Decode latency: 3.0344910270068794 sec
Time for inference 2: 3.14 sec total, 326.40 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.84 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10209563001990318 sec
Decode latency: 3.0348244599299505 sec
Time for inference 3: 3.14 sec total, 326.37 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.63 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10228841204661876 sec
Decode latency: 3.0343570299446583 sec
Time for inference 4: 3.14 sec total, 326.40 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.83 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.1025142699945718 sec
Decode latency: 3.0348889010492712 sec
Time for inference 5: 3.14 sec total, 326.31 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.26 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10200921096839011 sec
Decode latency: 3.034792828024365 sec
Time for inference 6: 3.14 sec total, 326.38 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.71 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10221722698770463 sec
Decode latency: 3.0181305010337383 sec
Time for inference 7: 3.12 sec total, 328.10 tokens/sec
Decode latency: 3.02 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2303.79 GB/s
FLOPS achieved: 11.52 TF/s

Prefill latency: 0.10237694706302136 sec
Decode latency: 3.0345944949658588 sec
Time for inference 8: 3.14 sec total, 326.36 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.56 GB/s
FLOPS achieved: 11.46 TF/s

Prefill latency: 0.10254275903571397 sec
Decode latency: 2.9056299480143934 sec
Time for inference 9: 3.01 sec total, 340.32 tokens/sec
Decode latency: 2.91 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2389.57 GB/s
FLOPS achieved: 11.95 TF/s

Prefill latency: 0.10262030898593366 sec
Decode latency: 3.033854176988825 sec
Time for inference 10: 3.14 sec total, 326.39 tokens/sec
Decode latency: 3.03 sec
Prefill latency: 0.10 sec
Bandwidth achieved: 2291.82 GB/s
FLOPS achieved: 11.46 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.0200 sec
Average prefill latency: 0.1023 sec
Average tokens/sec: 327.94
Memory used: 10.66 GB
Done. we are killing the process
