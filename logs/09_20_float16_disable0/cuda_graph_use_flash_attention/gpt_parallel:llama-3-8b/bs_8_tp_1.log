flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.77 seconds
Prefill latency: 0.2971009211614728 sec
Decode latency: 4.565736465156078 sec
Compilation time: 4.86 seconds
Prefill latency: 0.2979732733219862 sec
Decode latency: 4.566058553755283 sec
Prefill latency: 0.29779396764934063 sec
Decode latency: 4.56479764636606 sec
Prefill latency: 0.2988633746281266 sec
Decode latency: 4.5647222604602575 sec
Prefill latency: 0.29796158242970705 sec
Decode latency: 4.5660901525989175 sec
Prefill latency: 0.29746832605451345 sec
Decode latency: 4.564473893493414 sec
Time for inference 1: 4.86 sec total, 421.17 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6321.63 GB/s
FLOPS achieved: 31.61 TF/s

Prefill latency: 0.29870504420250654 sec
Decode latency: 4.563501857221127 sec
Time for inference 2: 4.86 sec total, 421.15 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6321.22 GB/s
FLOPS achieved: 31.61 TF/s

Prefill latency: 0.2984579047188163 sec
Decode latency: 4.5639635138213634 sec
Time for inference 3: 4.86 sec total, 421.13 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6320.96 GB/s
FLOPS achieved: 31.60 TF/s

Prefill latency: 0.2995002893730998 sec
Decode latency: 4.5628417348489165 sec
Time for inference 4: 4.86 sec total, 421.14 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6321.16 GB/s
FLOPS achieved: 31.61 TF/s

Prefill latency: 0.2980951815843582 sec
Decode latency: 4.56435258127749 sec
Time for inference 5: 4.86 sec total, 421.12 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6320.86 GB/s
FLOPS achieved: 31.60 TF/s

Prefill latency: 0.29876691848039627 sec
Decode latency: 4.564292776398361 sec
Time for inference 6: 4.86 sec total, 421.07 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6320.07 GB/s
FLOPS achieved: 31.60 TF/s

Prefill latency: 0.2980382954701781 sec
Decode latency: 4.56534469127655 sec
Time for inference 7: 4.86 sec total, 421.04 tokens/sec
Decode latency: 4.57 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6319.63 GB/s
FLOPS achieved: 31.60 TF/s

Prefill latency: 0.2984080435708165 sec
Decode latency: 4.564499611034989 sec
Time for inference 8: 4.86 sec total, 421.08 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6320.27 GB/s
FLOPS achieved: 31.60 TF/s

Prefill latency: 0.29840267170220613 sec
Decode latency: 4.5636921264231205 sec
Time for inference 9: 4.86 sec total, 421.16 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6321.37 GB/s
FLOPS achieved: 31.61 TF/s

Prefill latency: 0.2992703365162015 sec
Decode latency: 4.562382662668824 sec
Time for inference 10: 4.86 sec total, 421.20 tokens/sec
Decode latency: 4.56 sec
Prefill latency: 0.30 sec
Bandwidth achieved: 6322.04 GB/s
FLOPS achieved: 31.61 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.5639 sec
Average prefill latency: 0.2985 sec
Average tokens/sec: 421.13
Memory used: 23.88 GB
Done. we are killing the process
