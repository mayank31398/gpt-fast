flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.79 seconds
[rank0]:[W928 17:15:56.694720945 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.6023642672225833 sec
Decode latency: 6.685707609169185 sec
Compilation time: 7.29 seconds
Prefill latency: 0.6039450652897358 sec
Decode latency: 6.688127413392067 sec
Prefill latency: 0.6042483998462558 sec
Decode latency: 6.686534545384347 sec
Prefill latency: 0.6026617037132382 sec
Decode latency: 6.687172780744731 sec
Prefill latency: 0.6037002084776759 sec
Decode latency: 6.685931040905416 sec
Prefill latency: 0.600295826792717 sec
Decode latency: 6.687771704979241 sec
Time for inference 1: 7.29 sec total, 561.95 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8434.70 GB/s
FLOPS achieved: 42.17 TF/s

Prefill latency: 0.6041515935212374 sec
Decode latency: 6.6852864399552345 sec
Time for inference 2: 7.29 sec total, 561.84 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8433.03 GB/s
FLOPS achieved: 42.17 TF/s

Prefill latency: 0.6019968912005424 sec
Decode latency: 6.688398974947631 sec
Time for inference 3: 7.29 sec total, 561.78 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8432.07 GB/s
FLOPS achieved: 42.16 TF/s

Prefill latency: 0.6031318018212914 sec
Decode latency: 6.684418820776045 sec
Time for inference 4: 7.29 sec total, 562.00 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8435.34 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.603416295722127 sec
Decode latency: 6.6842479249462485 sec
Time for inference 5: 7.29 sec total, 561.99 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8435.17 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.6026201248168945 sec
Decode latency: 6.686537140980363 sec
Time for inference 6: 7.29 sec total, 561.87 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8433.37 GB/s
FLOPS achieved: 42.17 TF/s

Prefill latency: 0.6051355879753828 sec
Decode latency: 6.684304096736014 sec
Time for inference 7: 7.29 sec total, 561.85 tokens/sec
Decode latency: 6.68 sec
Prefill latency: 0.61 sec
Bandwidth achieved: 8433.08 GB/s
FLOPS achieved: 42.17 TF/s

Prefill latency: 0.6020694272592664 sec
Decode latency: 6.685160177759826 sec
Time for inference 8: 7.29 sec total, 562.02 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8435.65 GB/s
FLOPS achieved: 42.18 TF/s

Prefill latency: 0.6022501457482576 sec
Decode latency: 6.689285594969988 sec
Time for inference 9: 7.29 sec total, 561.69 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8430.70 GB/s
FLOPS achieved: 42.15 TF/s

Prefill latency: 0.6030381433665752 sec
Decode latency: 6.686283254995942 sec
Time for inference 10: 7.29 sec total, 561.85 tokens/sec
Decode latency: 6.69 sec
Prefill latency: 0.60 sec
Bandwidth achieved: 8433.19 GB/s
FLOPS achieved: 42.17 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 6.6862 sec
Average prefill latency: 0.6028 sec
Average tokens/sec: 561.88
Memory used: 31.58 GB
Done. we are killing the process
