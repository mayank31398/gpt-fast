flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.81 seconds
Prefill latency: 0.14826837368309498 sec
Decode latency: 3.616460816934705 sec
Compilation time: 3.77 seconds
Prefill latency: 0.14863302651792765 sec
Decode latency: 3.615394050255418 sec
Prefill latency: 0.14898080099374056 sec
Decode latency: 3.6156063694506884 sec
Prefill latency: 0.14821399375796318 sec
Decode latency: 3.615672797895968 sec
Prefill latency: 0.14760596584528685 sec
Decode latency: 3.6170638548210263 sec
Prefill latency: 0.14892473630607128 sec
Decode latency: 3.6176752531901 sec
Time for inference 1: 3.77 sec total, 271.81 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4079.77 GB/s
FLOPS achieved: 20.40 TF/s

Prefill latency: 0.14885127171874046 sec
Decode latency: 3.6151249054819345 sec
Time for inference 2: 3.76 sec total, 272.00 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4082.67 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.14860152918845415 sec
Decode latency: 3.616584625095129 sec
Time for inference 3: 3.77 sec total, 271.92 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4081.39 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.14858609531074762 sec
Decode latency: 3.6176310386508703 sec
Time for inference 4: 3.77 sec total, 271.84 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4080.20 GB/s
FLOPS achieved: 20.40 TF/s

Prefill latency: 0.14918287005275488 sec
Decode latency: 3.616217391565442 sec
Time for inference 5: 3.77 sec total, 271.90 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4081.17 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.14871468674391508 sec
Decode latency: 3.615739076398313 sec
Time for inference 6: 3.77 sec total, 271.96 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4082.02 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.14921970572322607 sec
Decode latency: 3.6162272915244102 sec
Time for inference 7: 3.77 sec total, 271.89 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4080.95 GB/s
FLOPS achieved: 20.40 TF/s

Prefill latency: 0.14903944078832865 sec
Decode latency: 3.615138104185462 sec
Time for inference 8: 3.76 sec total, 271.99 tokens/sec
Decode latency: 3.62 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4082.39 GB/s
FLOPS achieved: 20.41 TF/s

Prefill latency: 0.14855227805674076 sec
Decode latency: 3.613247921690345 sec
Time for inference 9: 3.76 sec total, 272.15 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4084.92 GB/s
FLOPS achieved: 20.42 TF/s

Prefill latency: 0.14859234634786844 sec
Decode latency: 3.6142463078722358 sec
Time for inference 10: 3.76 sec total, 272.09 tokens/sec
Decode latency: 3.61 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4083.95 GB/s
FLOPS achieved: 20.42 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.6158 sec
Average prefill latency: 0.1488 sec
Average tokens/sec: 271.96
Memory used: 20.05 GB
Done. we are killing the process
