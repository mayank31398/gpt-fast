W0928 17:06:58.797000 22561907382080 torch/distributed/run.py:779] 
W0928 17:06:58.797000 22561907382080 torch/distributed/run.py:779] *****************************************
W0928 17:06:58.797000 22561907382080 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:06:58.797000 22561907382080 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=8704, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.86 seconds
Prefill latency: 0.017256897874176502 sec
Decode latency: 1.798138227313757 sec
Compilation time: 1.82 seconds
Compilation time: 1.83 seconds
Compilation time: 1.82 seconds
Compilation time: 1.82 seconds
Prefill latency: 0.016895542852580547 sec
Decode latency: 1.7974055539816618 sec
Prefill latency: 0.016910112462937832 sec
Decode latency: 1.7971259141340852 sec
Prefill latency: 0.01691465452313423 sec
Decode latency: 1.7975793657824397 sec
Prefill latency: 0.016810608096420765 sec
Decode latency: 1.7974876323714852 sec
Prefill latency: 0.01694114226847887 sec
Decode latency: 1.7966549415141344 sec
Time for inference 1: 1.81 sec total, 141.11 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.73 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.017075407318770885 sec
Decode latency: 1.7958586001768708 sec
Time for inference 2: 1.81 sec total, 141.16 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.94 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01685771904885769 sec
Decode latency: 1.7967432895675302 sec
Time for inference 3: 1.81 sec total, 141.10 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.70 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.017021124251186848 sec
Decode latency: 1.7961881812661886 sec
Time for inference 4: 1.81 sec total, 141.14 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.85 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01700518000870943 sec
Decode latency: 1.7967345053330064 sec
Time for inference 5: 1.81 sec total, 141.10 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.67 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.016997638158500195 sec
Decode latency: 1.7959020296111703 sec
Time for inference 6: 1.81 sec total, 141.15 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.93 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01685076393187046 sec
Decode latency: 1.7967072427272797 sec
Time for inference 7: 1.81 sec total, 141.10 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.68 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01683217193931341 sec
Decode latency: 1.7972295125946403 sec
Time for inference 8: 1.81 sec total, 141.06 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.52 GB/s
FLOPS achieved: 3.20 TF/s

Prefill latency: 0.01686498336493969 sec
Decode latency: 1.7955961087718606 sec
Time for inference 9: 1.81 sec total, 141.19 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 641.10 GB/s
FLOPS achieved: 3.21 TF/s

Prefill latency: 0.01692485809326172 sec
Decode latency: 1.7959276251494884 sec
Time for inference 10: 1.81 sec total, 141.16 tokens/sec
Decode latency: 1.80 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 640.96 GB/s
FLOPS achieved: 3.20 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.7964 sec
Average prefill latency: 0.0169 sec
Average tokens/sec: 141.13
Memory used: 6.50 GB
Done. we are killing the process
