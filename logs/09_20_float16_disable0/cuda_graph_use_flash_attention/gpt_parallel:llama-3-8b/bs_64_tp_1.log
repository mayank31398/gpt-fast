flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.79 seconds
Prefill latency: 2.503368821926415 sec
Decode latency: 19.211698830127716 sec
Compilation time: 21.72 seconds
Prefill latency: 2.502141200006008 sec
Decode latency: 19.210029497742653 sec
Prefill latency: 2.5017914436757565 sec
Decode latency: 19.21585362404585 sec
Prefill latency: 2.504926584661007 sec
Decode latency: 19.215586591511965 sec
Prefill latency: 2.50669211614877 sec
Decode latency: 19.216971157118678 sec
Prefill latency: 2.4916878566145897 sec
Decode latency: 19.216671966947615 sec
Time for inference 1: 21.71 sec total, 754.70 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.49 sec
Bandwidth achieved: 11327.71 GB/s
FLOPS achieved: 56.64 TF/s

Prefill latency: 2.5007539354264736 sec
Decode latency: 19.215510869398713 sec
Time for inference 2: 21.72 sec total, 754.42 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11323.51 GB/s
FLOPS achieved: 56.62 TF/s

Prefill latency: 2.508512639440596 sec
Decode latency: 19.21514014340937 sec
Time for inference 3: 21.72 sec total, 754.17 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.51 sec
Bandwidth achieved: 11319.73 GB/s
FLOPS achieved: 56.60 TF/s

Prefill latency: 2.4958350155502558 sec
Decode latency: 19.211868884973228 sec
Time for inference 4: 21.71 sec total, 754.72 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11328.07 GB/s
FLOPS achieved: 56.64 TF/s

Prefill latency: 2.4997178837656975 sec
Decode latency: 19.217367664910853 sec
Time for inference 5: 21.72 sec total, 754.40 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11323.16 GB/s
FLOPS achieved: 56.62 TF/s

Prefill latency: 2.5043985079973936 sec
Decode latency: 19.21941010840237 sec
Time for inference 6: 21.72 sec total, 754.16 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11319.67 GB/s
FLOPS achieved: 56.60 TF/s

Prefill latency: 2.5072130020707846 sec
Decode latency: 19.210028558969498 sec
Time for inference 7: 21.72 sec total, 754.38 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.51 sec
Bandwidth achieved: 11322.97 GB/s
FLOPS achieved: 56.61 TF/s

Prefill latency: 2.5000570621341467 sec
Decode latency: 19.153164436109364 sec
Time for inference 8: 21.65 sec total, 756.62 tokens/sec
Decode latency: 19.15 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11356.51 GB/s
FLOPS achieved: 56.78 TF/s

Prefill latency: 2.5026246812194586 sec
Decode latency: 19.222485480830073 sec
Time for inference 9: 21.73 sec total, 754.11 tokens/sec
Decode latency: 19.22 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11318.87 GB/s
FLOPS achieved: 56.59 TF/s

Prefill latency: 2.495569013990462 sec
Decode latency: 19.211978130973876 sec
Time for inference 10: 21.71 sec total, 754.72 tokens/sec
Decode latency: 19.21 sec
Prefill latency: 2.50 sec
Bandwidth achieved: 11328.09 GB/s
FLOPS achieved: 56.64 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 19.2094 sec
Average prefill latency: 2.5006 sec
Average tokens/sec: 754.64
Memory used: 77.63 GB
Done. we are killing the process
