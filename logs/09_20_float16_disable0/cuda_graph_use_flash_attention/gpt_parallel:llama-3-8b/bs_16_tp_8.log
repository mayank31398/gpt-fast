W0928 17:19:59.572000 22484599220032 torch/distributed/run.py:779] 
W0928 17:19:59.572000 22484599220032 torch/distributed/run.py:779] *****************************************
W0928 17:19:59.572000 22484599220032 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:19:59.572000 22484599220032 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=4352, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.04 seconds
Prefill latency: 0.17431303951889277 sec
Decode latency: 2.4119815062731504 sec
Compilation time: 2.55 seconds
Compilation time: 2.57 seconds
Compilation time: 2.59 seconds
Compilation time: 2.59 seconds
Compilation time: 2.54 seconds
Compilation time: 2.58 seconds
Compilation time: 2.56 seconds
Compilation time: 2.57 seconds
Prefill latency: 0.13147676456719637 sec
Decode latency: 2.4126364709809422 sec
Prefill latency: 0.13171070162206888 sec
Decode latency: 2.415926699526608 sec
Prefill latency: 0.13184698298573494 sec
Decode latency: 2.413440713658929 sec
Prefill latency: 0.1315050544217229 sec
Decode latency: 2.413064963184297 sec
Prefill latency: 0.13186657987535 sec
Decode latency: 2.4118229914456606 sec
Time for inference 1: 2.54 sec total, 1609.75 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4500.49 GB/s
FLOPS achieved: 22.50 TF/s

Prefill latency: 0.13157102838158607 sec
Decode latency: 2.413229472003877 sec
Time for inference 2: 2.55 sec total, 1609.06 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4498.56 GB/s
FLOPS achieved: 22.49 TF/s

Prefill latency: 0.1320596793666482 sec
Decode latency: 2.412464192137122 sec
Time for inference 3: 2.55 sec total, 1609.35 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4499.38 GB/s
FLOPS achieved: 22.50 TF/s

Prefill latency: 0.13167116232216358 sec
Decode latency: 2.4139226712286472 sec
Time for inference 4: 2.55 sec total, 1608.70 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4497.57 GB/s
FLOPS achieved: 22.49 TF/s

Prefill latency: 0.1314766239374876 sec
Decode latency: 2.415728227235377 sec
Time for inference 5: 2.55 sec total, 1607.43 tokens/sec
Decode latency: 2.42 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4494.02 GB/s
FLOPS achieved: 22.47 TF/s

Prefill latency: 0.13137571141123772 sec
Decode latency: 2.4129349924623966 sec
Time for inference 6: 2.55 sec total, 1609.36 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4499.40 GB/s
FLOPS achieved: 22.50 TF/s

Prefill latency: 0.13165448419749737 sec
Decode latency: 2.4136264119297266 sec
Time for inference 7: 2.55 sec total, 1608.86 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4498.00 GB/s
FLOPS achieved: 22.49 TF/s

Prefill latency: 0.13191839214414358 sec
Decode latency: 2.4140895195305347 sec
Time for inference 8: 2.55 sec total, 1608.24 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4496.27 GB/s
FLOPS achieved: 22.48 TF/s

Prefill latency: 0.13178869057446718 sec
Decode latency: 2.412224853411317 sec
Time for inference 9: 2.54 sec total, 1609.43 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4499.61 GB/s
FLOPS achieved: 22.50 TF/s

Prefill latency: 0.1315439585596323 sec
Decode latency: 2.4130068412050605 sec
Time for inference 10: 2.55 sec total, 1609.23 tokens/sec
Decode latency: 2.41 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4499.04 GB/s
FLOPS achieved: 22.50 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.4133 sec
Average prefill latency: 0.1317 sec
Average tokens/sec: 1608.94
Memory used: 15.80 GB
Done. we are killing the process
