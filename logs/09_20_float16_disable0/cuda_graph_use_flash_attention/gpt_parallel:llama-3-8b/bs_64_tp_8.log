W0928 17:31:42.990000 23273480173376 torch/distributed/run.py:779] 
W0928 17:31:42.990000 23273480173376 torch/distributed/run.py:779] *****************************************
W0928 17:31:42.990000 23273480173376 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0928 17:31:42.990000 23273480173376 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=4352, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.01 seconds
Prefill latency: 0.5024116486310959 sec
Decode latency: 4.053220555186272 sec
Compilation time: 4.56 seconds
Compilation time: 4.56 seconds
Compilation time: 4.56 secondsCompilation time: 4.57 seconds
Compilation time: 4.56 seconds

Compilation time: 4.56 secondsCompilation time: 4.57 seconds

Compilation time: 4.56 seconds
Prefill latency: 0.5038078473880887 sec
Decode latency: 4.05220727995038 sec
Prefill latency: 0.5032180370762944 sec
Decode latency: 4.052257176488638 sec
Prefill latency: 0.5008371435105801 sec
Decode latency: 4.054026345722377 sec
Prefill latency: 0.5001074569299817 sec
Decode latency: 4.054328057914972 sec
Prefill latency: 0.5014217449352145 sec
Decode latency: 4.052674104459584 sec
Time for inference 1: 4.55 sec total, 3597.01 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10056.42 GB/s
FLOPS achieved: 50.28 TF/s

Prefill latency: 0.49880304746329784 sec
Decode latency: 4.054679982364178 sec
Time for inference 2: 4.55 sec total, 3597.54 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10057.91 GB/s
FLOPS achieved: 50.29 TF/s

Prefill latency: 0.5023061223328114 sec
Decode latency: 4.052242903970182 sec
Time for inference 3: 4.56 sec total, 3596.54 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10055.12 GB/s
FLOPS achieved: 50.28 TF/s

Prefill latency: 0.5023170076310635 sec
Decode latency: 4.053990692831576 sec
Time for inference 4: 4.56 sec total, 3595.35 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10051.79 GB/s
FLOPS achieved: 50.26 TF/s

Prefill latency: 0.5029653450474143 sec
Decode latency: 4.05089392978698 sec
Time for inference 5: 4.55 sec total, 3597.13 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10056.76 GB/s
FLOPS achieved: 50.28 TF/s

Prefill latency: 0.5043601896613836 sec
Decode latency: 4.05381684936583 sec
Time for inference 6: 4.56 sec total, 3593.83 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10047.54 GB/s
FLOPS achieved: 50.24 TF/s

Prefill latency: 0.506557579152286 sec
Decode latency: 4.053109045140445 sec
Time for inference 7: 4.56 sec total, 3592.61 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.51 sec
Bandwidth achieved: 10044.13 GB/s
FLOPS achieved: 50.22 TF/s

Prefill latency: 0.5033499971032143 sec
Decode latency: 4.056204745545983 sec
Time for inference 8: 4.56 sec total, 3592.73 tokens/sec
Decode latency: 4.06 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10044.47 GB/s
FLOPS achieved: 50.22 TF/s

Prefill latency: 0.5032182689756155 sec
Decode latency: 4.056106206960976 sec
Time for inference 9: 4.56 sec total, 3592.88 tokens/sec
Decode latency: 4.06 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10044.88 GB/s
FLOPS achieved: 50.22 TF/s

Prefill latency: 0.504160194657743 sec
Decode latency: 4.054453054443002 sec
Time for inference 10: 4.56 sec total, 3593.44 tokens/sec
Decode latency: 4.05 sec
Prefill latency: 0.50 sec
Bandwidth achieved: 10046.44 GB/s
FLOPS achieved: 50.23 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 4.0538 sec
Average prefill latency: 0.5029 sec
Average tokens/sec: 3594.91
Memory used: 55.57 GB
Done. we are killing the process
