flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.34 seconds
CUDA_GRAPH are activate
Prefill latency: 0.13078339211642742 sec
Decode latency: 2.3812512420117855 sec
Compilation time: 2.51 seconds
Prefill latency: 0.1299033872783184 sec
Decode latency: 2.3791700787842274 sec
Prefill latency: 0.1297261156141758 sec
Decode latency: 2.38006585650146 sec
Prefill latency: 0.13052685000002384 sec
Decode latency: 2.3794523552060127 sec
Prefill latency: 0.13132494874298573 sec
Decode latency: 2.3770459182560444 sec
Prefill latency: 0.1307711824774742 sec
Decode latency: 2.2944261990487576 sec
Time for inference 1: 2.43 sec total, 422.13 tokens/sec
Decode latency: 2.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6336.17 GB/s
FLOPS achieved: 31.68 TF/s

Prefill latency: 0.1331281065940857 sec
Decode latency: 2.37907943315804 sec
Time for inference 2: 2.51 sec total, 407.50 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6116.53 GB/s
FLOPS achieved: 30.58 TF/s

Prefill latency: 0.13141655176877975 sec
Decode latency: 2.378834256902337 sec
Time for inference 3: 2.51 sec total, 407.80 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6121.03 GB/s
FLOPS achieved: 30.61 TF/s

Prefill latency: 0.1305480133742094 sec
Decode latency: 2.3802568037062883 sec
Time for inference 4: 2.51 sec total, 407.70 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6119.59 GB/s
FLOPS achieved: 30.60 TF/s

Prefill latency: 0.13170652091503143 sec
Decode latency: 2.3462754786014557 sec
Time for inference 5: 2.48 sec total, 413.10 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6200.56 GB/s
FLOPS achieved: 31.00 TF/s

Prefill latency: 0.13168608397245407 sec
Decode latency: 2.378777103498578 sec
Time for inference 6: 2.51 sec total, 407.79 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6120.82 GB/s
FLOPS achieved: 30.60 TF/s

Prefill latency: 0.13011177629232407 sec
Decode latency: 2.379911867901683 sec
Time for inference 7: 2.51 sec total, 407.87 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6122.05 GB/s
FLOPS achieved: 30.61 TF/s

Prefill latency: 0.13043889589607716 sec
Decode latency: 2.3785621747374535 sec
Time for inference 8: 2.51 sec total, 408.04 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6124.57 GB/s
FLOPS achieved: 30.62 TF/s

Prefill latency: 0.12984094582498074 sec
Decode latency: 2.378882372751832 sec
Time for inference 9: 2.51 sec total, 408.05 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6124.83 GB/s
FLOPS achieved: 30.62 TF/s

Prefill latency: 0.13029450364410877 sec
Decode latency: 2.3787785600870848 sec
Time for inference 10: 2.51 sec total, 407.99 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6123.86 GB/s
FLOPS achieved: 30.62 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3674 sec
Average prefill latency: 0.1310 sec
Average tokens/sec: 409.80
Memory used: 21.01 GB
Done. we are killing the process
