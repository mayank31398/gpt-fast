W1113 10:47:59.286000 23411636840256 torch/distributed/run.py:779] 
W1113 10:47:59.286000 23411636840256 torch/distributed/run.py:779] *****************************************
W1113 10:47:59.286000 23411636840256 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1113 10:47:59.286000 23411636840256 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.49 seconds
CUDA_GRAPH are activate
Prefill latency: 0.0473758764564991 sec
Decode latency: 1.3895072061568499 sec
Compilation time: 2.02 seconds
Compilation time: 2.03 seconds
Compilation time: 1.46 seconds
Compilation time: 1.44 seconds
Prefill latency: 0.047137005254626274 sec
Decode latency: 1.3894745241850615 sec
Prefill latency: 0.04723869077861309 sec
Decode latency: 1.389911500737071 sec
Prefill latency: 0.04731442406773567 sec
Decode latency: 1.3898021448403597 sec
Prefill latency: 0.0473523885011673 sec
Decode latency: 1.3901126310229301 sec
Prefill latency: 0.047377847135066986 sec
Decode latency: 1.3915481492877007 sec
Time for inference 1: 1.44 sec total, 711.33 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3230.03 GB/s
FLOPS achieved: 16.15 TF/s

Prefill latency: 0.047341687604784966 sec
Decode latency: 1.3908235039561987 sec
Time for inference 2: 1.44 sec total, 711.69 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3231.68 GB/s
FLOPS achieved: 16.16 TF/s

Prefill latency: 0.047143248841166496 sec
Decode latency: 1.390411013737321 sec
Time for inference 3: 1.44 sec total, 711.99 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3233.06 GB/s
FLOPS achieved: 16.17 TF/s

Prefill latency: 0.04709180258214474 sec
Decode latency: 1.3905666787177324 sec
Time for inference 4: 1.44 sec total, 711.91 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3232.67 GB/s
FLOPS achieved: 16.16 TF/s

Prefill latency: 0.04711046442389488 sec
Decode latency: 1.3909560926258564 sec
Time for inference 5: 1.44 sec total, 711.76 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3231.99 GB/s
FLOPS achieved: 16.16 TF/s

Prefill latency: 0.04730080999433994 sec
Decode latency: 1.389814529567957 sec
Time for inference 6: 1.44 sec total, 712.14 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3233.72 GB/s
FLOPS achieved: 16.17 TF/s

Prefill latency: 0.04706583917140961 sec
Decode latency: 1.390713032335043 sec
Time for inference 7: 1.44 sec total, 711.86 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3232.47 GB/s
FLOPS achieved: 16.16 TF/s

Prefill latency: 0.04720360413193703 sec
Decode latency: 1.3897970244288445 sec
Time for inference 8: 1.44 sec total, 712.31 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3234.49 GB/s
FLOPS achieved: 16.17 TF/s

Prefill latency: 0.047370513901114464 sec
Decode latency: 1.3901838902384043 sec
Time for inference 9: 1.44 sec total, 712.06 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3233.38 GB/s
FLOPS achieved: 16.17 TF/s

Prefill latency: 0.04729313403367996 sec
Decode latency: 1.3899966776371002 sec
Time for inference 10: 1.44 sec total, 712.20 tokens/sec
Decode latency: 1.39 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 3234.02 GB/s
FLOPS achieved: 16.17 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.3905 sec
Average prefill latency: 0.0472 sec
Average tokens/sec: 711.92
Memory used: 10.16 GB
Done. we are killing the process
