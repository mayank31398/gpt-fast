flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 2.02 seconds
CUDA_GRAPH are activate
Prefill latency: 0.13049370050430298 sec
Decode latency: 2.329577684402466 sec
Compilation time: 2.46 seconds
Prefill latency: 0.13334093056619167 sec
Decode latency: 2.368645252659917 sec
Prefill latency: 0.13078968413174152 sec
Decode latency: 2.3804744444787502 sec
Prefill latency: 0.13128739409148693 sec
Decode latency: 2.3817269559949636 sec
Prefill latency: 0.1313020046800375 sec
Decode latency: 2.380756849423051 sec
Prefill latency: 0.13065547496080399 sec
Decode latency: 2.3524505123496056 sec
Time for inference 1: 2.48 sec total, 412.27 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6188.12 GB/s
FLOPS achieved: 30.94 TF/s

Prefill latency: 0.1335017792880535 sec
Decode latency: 2.3809991106390953 sec
Time for inference 2: 2.52 sec total, 407.12 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6110.88 GB/s
FLOPS achieved: 30.55 TF/s

Prefill latency: 0.1323701422661543 sec
Decode latency: 2.355500228703022 sec
Time for inference 3: 2.49 sec total, 411.50 tokens/sec
Decode latency: 2.36 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6176.57 GB/s
FLOPS achieved: 30.88 TF/s

Prefill latency: 0.1314663030207157 sec
Decode latency: 2.3292365577071905 sec
Time for inference 4: 2.46 sec total, 416.05 tokens/sec
Decode latency: 2.33 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6244.81 GB/s
FLOPS achieved: 31.22 TF/s

Prefill latency: 0.1317634154111147 sec
Decode latency: 2.361411591991782 sec
Time for inference 5: 2.49 sec total, 410.63 tokens/sec
Decode latency: 2.36 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6163.46 GB/s
FLOPS achieved: 30.82 TF/s

Prefill latency: 0.1313980482518673 sec
Decode latency: 2.3517017420381308 sec
Time for inference 6: 2.48 sec total, 412.28 tokens/sec
Decode latency: 2.35 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6188.28 GB/s
FLOPS achieved: 30.94 TF/s

Prefill latency: 0.13097585178911686 sec
Decode latency: 2.375863114371896 sec
Time for inference 7: 2.51 sec total, 408.38 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6129.78 GB/s
FLOPS achieved: 30.65 TF/s

Prefill latency: 0.13110646605491638 sec
Decode latency: 2.2996527533978224 sec
Time for inference 8: 2.43 sec total, 421.17 tokens/sec
Decode latency: 2.30 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6321.75 GB/s
FLOPS achieved: 31.61 TF/s

Prefill latency: 0.13034796714782715 sec
Decode latency: 2.380965929478407 sec
Time for inference 9: 2.51 sec total, 407.66 tokens/sec
Decode latency: 2.38 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6118.96 GB/s
FLOPS achieved: 30.59 TF/s

Prefill latency: 0.13179395534098148 sec
Decode latency: 2.3565249890089035 sec
Time for inference 10: 2.49 sec total, 411.43 tokens/sec
Decode latency: 2.36 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 6175.51 GB/s
FLOPS achieved: 30.88 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3544 sec
Average prefill latency: 0.1315 sec
Average tokens/sec: 411.85
Memory used: 21.03 GB
Done. we are killing the process
