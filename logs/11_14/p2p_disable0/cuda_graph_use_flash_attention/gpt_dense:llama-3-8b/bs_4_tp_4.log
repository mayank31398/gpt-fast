W1113 10:56:30.499000 22731484591936 torch/distributed/run.py:779] 
W1113 10:56:30.499000 22731484591936 torch/distributed/run.py:779] *****************************************
W1113 10:56:30.499000 22731484591936 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1113 10:56:30.499000 22731484591936 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 51.41 seconds
CUDA_GRAPH are activate
Prefill latency: 0.08876744098961353 sec
Decode latency: 1.6325140204280615 sec
Compilation time: 1.72 seconds
Compilation time: 1.72 seconds
Compilation time: 1.69 seconds
Compilation time: 1.72 seconds
Prefill latency: 0.05416266806423664 sec
Decode latency: 1.6337141003459692 sec
Prefill latency: 0.05415271408855915 sec
Decode latency: 1.6334445923566818 sec
Prefill latency: 0.05418086051940918 sec
Decode latency: 1.632233239710331 sec
Prefill latency: 0.054103756323456764 sec
Decode latency: 1.632492894306779 sec
Prefill latency: 0.05423906445503235 sec
Decode latency: 1.6309739705175161 sec
Time for inference 1: 1.69 sec total, 607.46 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2758.38 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.05395047180354595 sec
Decode latency: 1.6305996030569077 sec
Time for inference 2: 1.69 sec total, 607.66 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2759.28 GB/s
FLOPS achieved: 13.80 TF/s

Prefill latency: 0.05397706292569637 sec
Decode latency: 1.6337081994861364 sec
Time for inference 3: 1.69 sec total, 606.47 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2753.91 GB/s
FLOPS achieved: 13.77 TF/s

Prefill latency: 0.05402425117790699 sec
Decode latency: 1.632281057536602 sec
Time for inference 4: 1.69 sec total, 606.94 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2756.02 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.053999703377485275 sec
Decode latency: 1.6318477913737297 sec
Time for inference 5: 1.69 sec total, 607.10 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2756.78 GB/s
FLOPS achieved: 13.78 TF/s

Prefill latency: 0.05399217829108238 sec
Decode latency: 1.6332200188189745 sec
Time for inference 6: 1.69 sec total, 606.67 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2754.81 GB/s
FLOPS achieved: 13.77 TF/s

Prefill latency: 0.054070038720965385 sec
Decode latency: 1.6311750132590532 sec
Time for inference 7: 1.69 sec total, 607.37 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2758.00 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.054050080478191376 sec
Decode latency: 1.6312727145850658 sec
Time for inference 8: 1.69 sec total, 607.31 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2757.70 GB/s
FLOPS achieved: 13.79 TF/s

Prefill latency: 0.05411570332944393 sec
Decode latency: 1.635080074891448 sec
Time for inference 9: 1.69 sec total, 605.97 tokens/sec
Decode latency: 1.64 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2751.62 GB/s
FLOPS achieved: 13.76 TF/s

Prefill latency: 0.05404319427907467 sec
Decode latency: 1.6307688988745213 sec
Time for inference 10: 1.69 sec total, 607.56 tokens/sec
Decode latency: 1.63 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2758.85 GB/s
FLOPS achieved: 13.79 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.6321 sec
Average prefill latency: 0.0540 sec
Average tokens/sec: 607.05
Memory used: 10.18 GB
Done. we are killing the process
