W1113 10:55:26.680000 22454993704768 torch/distributed/run.py:779] 
W1113 10:55:26.680000 22454993704768 torch/distributed/run.py:779] *****************************************
W1113 10:55:26.680000 22454993704768 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1113 10:55:26.680000 22454993704768 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.98 seconds
CUDA_GRAPH are activate
Prefill latency: 0.08189008012413979 sec
Decode latency: 1.9247837625443935 sec
Compilation time: 2.04 seconds
Compilation time: 2.01 seconds
Prefill latency: 0.08091319166123867 sec
Decode latency: 1.921134952455759 sec
Prefill latency: 0.08092283830046654 sec
Decode latency: 1.921213123947382 sec
Prefill latency: 0.0812000036239624 sec
Decode latency: 1.9217470213770866 sec
Prefill latency: 0.08109735511243343 sec
Decode latency: 1.9212871454656124 sec
Prefill latency: 0.08116209134459496 sec
Decode latency: 1.9204459302127361 sec
Time for inference 1: 2.00 sec total, 511.46 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4107.31 GB/s
FLOPS achieved: 20.54 TF/s

Prefill latency: 0.08109126426279545 sec
Decode latency: 1.9203078728169203 sec
Time for inference 2: 2.00 sec total, 511.50 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4107.59 GB/s
FLOPS achieved: 20.54 TF/s

Prefill latency: 0.08118326030671597 sec
Decode latency: 1.9201564192771912 sec
Time for inference 3: 2.00 sec total, 511.52 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4107.79 GB/s
FLOPS achieved: 20.54 TF/s

Prefill latency: 0.08101821132004261 sec
Decode latency: 1.92002765648067 sec
Time for inference 4: 2.00 sec total, 511.60 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4108.43 GB/s
FLOPS achieved: 20.54 TF/s

Prefill latency: 0.08104583248496056 sec
Decode latency: 1.9206726178526878 sec
Time for inference 5: 2.00 sec total, 511.40 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4106.82 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.08084713853895664 sec
Decode latency: 1.9208448324352503 sec
Time for inference 6: 2.00 sec total, 511.42 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4106.97 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.081068629398942 sec
Decode latency: 1.9206284768879414 sec
Time for inference 7: 2.00 sec total, 511.42 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4106.99 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.08101837523281574 sec
Decode latency: 1.9219227619469166 sec
Time for inference 8: 2.00 sec total, 511.09 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4104.36 GB/s
FLOPS achieved: 20.52 TF/s

Prefill latency: 0.08116245456039906 sec
Decode latency: 1.9210889413952827 sec
Time for inference 9: 2.00 sec total, 511.27 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4105.81 GB/s
FLOPS achieved: 20.53 TF/s

Prefill latency: 0.08129487000405788 sec
Decode latency: 1.9210023060441017 sec
Time for inference 10: 2.00 sec total, 511.28 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 4105.84 GB/s
FLOPS achieved: 20.53 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.9207 sec
Average prefill latency: 0.0811 sec
Average tokens/sec: 511.40
Memory used: 14.71 GB
Done. we are killing the process
