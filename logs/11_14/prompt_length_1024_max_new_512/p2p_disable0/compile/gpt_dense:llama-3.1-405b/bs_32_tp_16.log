W1118 13:35:54.196000 2451307 site-packages/torch/distributed/run.py:793] 
W1118 13:35:54.196000 2451307 site-packages/torch/distributed/run.py:793] *****************************************
W1118 13:35:54.196000 2451307 site-packages/torch/distributed/run.py:793] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1118 13:35:54.196000 2451307 site-packages/torch/distributed/run.py:793] *****************************************
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
rank: 6, global_rank: 6, world_size: 8, global_world_size: 16
rank: 4, global_rank: 4, world_size: 8, global_world_size: 16
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
flash_kv_decode is set to False
rank: 0, global_rank: 0, world_size: 8, global_world_size: 16
our world size=16
Using device=cuda
Loading model ...
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 1, global_rank: 1, world_size: 8, global_world_size: 16
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 2, global_rank: 2, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 7, global_rank: 7, world_size: 8, global_world_size: 16
rank: 4, global_rank: 4, world_size: 8, global_world_size: 16
rank: 4, global_rank: 4, world_size: 8, global_world_size: 16
rank: 6, global_rank: 6, world_size: 8, global_world_size: 16rank: 4, global_rank: 4, world_size: 8, global_world_size: 16

rank: 6, global_rank: 6, world_size: 8, global_world_size: 16
rank: 4, global_rank: 4, world_size: 8, global_world_size: 16
rank: 6, global_rank: 6, world_size: 8, global_world_size: 16
rank: 4, global_rank: 4, world_size: 8, global_world_size: 16
rank: 6, global_rank: 6, world_size: 8, global_world_size: 16
rank: 6, global_rank: 6, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 3, global_rank: 3, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
rank: 5, global_rank: 5, world_size: 8, global_world_size: 16
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()`r will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warvailable but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:222: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
[rank12]: Traceback (most recent call last):
[rank12]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank12]:     main(
[rank12]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank12]:     y, decode_latency, prefill_latency = generate(
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank12]:     return func(*args, **kwargs)
[rank12]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank12]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank12]:     return fn(*args, **kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank12]:     @functools.wraps(fn)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank12]:     return fn(*args, **kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank12]:     return compiled_fn(full_args)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank12]:     all_outs = call_func_at_runtime_with_args(
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank12]:     out = normalize_as_list(f(args))
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank12]:     outs = compiled_fn(args)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank12]:     return compiled_fn(runtime_args)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank12]:     return self.current_callable(inputs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank12]:     return compiled_fn(new_inputs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank12]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank12]:     return manager.add_function(
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank12]:     return fn, fn(inputs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank12]:     out = self._run(new_inputs, function_id)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank12]:     out = self.run_eager(new_inputs, function_id)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank12]:     return node.run(new_inputs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank12]:     out = self.wrapped_function.model(new_inputs)
[rank12]:   File "/tmp/torchinductor_charlie/qq/cqqfp36mlhu4y6tavzhzpxkdoo3s6qtbnsswhfti2yigcit6i7lp.py", line 2775, in call
[rank12]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank12]:     return self._op(*args, **kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank12]:     return func(*args, **kwargs)
[rank12]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank12]:     return self._op(*args, **kwargs)
[rank12]: torch.distributed.DistBackendError: [12] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank12]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank12]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x14bd050f9106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank12]: frame #1: <unknown function> + 0x62f51d8 (0x14bd409d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x14bd409cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x14bd409ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x14bd409cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14bd4097c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14bd4097c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14bd4097c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x14bd063d681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank12]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x14bd063e4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank12]: frame #10: <unknown function> + 0x125d029 (0x14bd063ea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank12]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x14bd063ea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank12]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x14bd063eb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank12]: frame #13: <unknown function> + 0x629407e (0x14bd4097007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #14: <unknown function> + 0x629eb54 (0x14bd4097ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #15: <unknown function> + 0x629f8d9 (0x14bd4097b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #16: <unknown function> + 0x58a83bb (0x14bd3ff843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #17: <unknown function> + 0x58a5c39 (0x14bd3ff81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #18: <unknown function> + 0x1aa3808 (0x14bd3c17f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #19: <unknown function> + 0x62a7385 (0x14bd40983385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #20: <unknown function> + 0x62b58cd (0x14bd409918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #21: <unknown function> + 0x6275480 (0x14bd40951480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #22: <unknown function> + 0x6282f17 (0x14bd4095ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #23: <unknown function> + 0x6283085 (0x14bd4095f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #24: <unknown function> + 0x58a83bb (0x14bd3ff843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #25: <unknown function> + 0x58a5c39 (0x14bd3ff81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #26: <unknown function> + 0x1aa3808 (0x14bd3c17f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank12]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x14bd50683908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x14bd5040dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x14bd5040dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #30: <unknown function> + 0x97ada2 (0x14bd502feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #31: <unknown function> + 0x4d9367 (0x14bd4fe5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank12]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank12]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank12]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank12]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x14bd5064ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x14bd504071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x14bd5040df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #46: <unknown function> + 0x97ada2 (0x14bd502feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #47: <unknown function> + 0x4d9367 (0x14bd4fe5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank12]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank12]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank12]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank12]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank15]: Traceback (most recent call last):
[rank15]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank15]:     main(
[rank15]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank15]:     y, decode_latency, prefill_latency = generate(
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank15]:     return func(*args, **kwargs)
[rank15]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank15]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank15]:     return fn(*args, **kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank15]:     @functools.wraps(fn)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank15]:     return fn(*args, **kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank15]:     return compiled_fn(full_args)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank15]:     all_outs = call_func_at_runtime_with_args(
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank15]:     out = normalize_as_list(f(args))
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank15]:     outs = compiled_fn(args)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank15]:     return compiled_fn(runtime_args)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank15]:     return self.current_callable(inputs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank15]:     return compiled_fn(new_inputs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank15]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank15]:     return manager.add_function(
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank15]:     return fn, fn(inputs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank15]:     out = self._run(new_inputs, function_id)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank15]:     out = self.run_eager(new_inputs, function_id)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank15]:     return node.run(new_inputs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank15]:     out = self.wrapped_function.model(new_inputs)
[rank15]:   File "/tmp/torchinductor_charlie/vb/cvb2xs6mhtg7yfolity6mpsjwwu6ghcrupzql6woeomhxo7rtmmb.py", line 2775, in call
[rank15]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank15]:     return self._op(*args, **kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank15]:     return func(*args, **kwargs)
[rank15]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank15]:     return self._op(*args, **kwargs)
[rank15]: torch.distributed.DistBackendError: [15] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank15]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank15]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x14c7c776c106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank15]: frame #1: <unknown function> + 0x62f51d8 (0x14c7b6fd11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x14c7b6fcdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x14c7b6fce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x14c7b6fcf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14c7b6f7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14c7b6f7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14c7b6f7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x14c77c9d681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank15]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x14c77c9e4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank15]: frame #10: <unknown function> + 0x125d029 (0x14c77c9ea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank15]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x14c77c9ea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank15]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x14c77c9eb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank15]: frame #13: <unknown function> + 0x629407e (0x14c7b6f7007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #14: <unknown function> + 0x629eb54 (0x14c7b6f7ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #15: <unknown function> + 0x629f8d9 (0x14c7b6f7b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #16: <unknown function> + 0x58a83bb (0x14c7b65843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #17: <unknown function> + 0x58a5c39 (0x14c7b6581c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #18: <unknown function> + 0x1aa3808 (0x14c7b277f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #19: <unknown function> + 0x62a7385 (0x14c7b6f83385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #20: <unknown function> + 0x62b58cd (0x14c7b6f918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #21: <unknown function> + 0x6275480 (0x14c7b6f51480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #22: <unknown function> + 0x6282f17 (0x14c7b6f5ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #23: <unknown function> + 0x6283085 (0x14c7b6f5f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #24: <unknown function> + 0x58a83bb (0x14c7b65843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #25: <unknown function> + 0x58a5c39 (0x14c7b6581c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #26: <unknown function> + 0x1aa3808 (0x14c7b277f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank15]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x14c7c6c83908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x14c7c6a0dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x14c7c6a0dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #30: <unknown function> + 0x97ada2 (0x14c7c68feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #31: <unknown function> + 0x4d9367 (0x14c7c645d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank15]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank15]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank15]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank15]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x14c7c6c4ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x14c7c6a071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x14c7c6a0df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #46: <unknown function> + 0x97ada2 (0x14c7c68feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #47: <unknown function> + 0x4d9367 (0x14c7c645d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank15]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank15]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank15]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank15]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank9]: Traceback (most recent call last):
[rank9]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank9]:     main(
[rank9]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank9]:     y, decode_latency, prefill_latency = generate(
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank9]:     return func(*args, **kwargs)
[rank9]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank9]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank9]:     return fn(*args, **kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank9]:     @functools.wraps(fn)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank9]:     return fn(*args, **kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank9]:     return compiled_fn(full_args)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank9]:     all_outs = call_func_at_runtime_with_args(
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank9]:     out = normalize_as_list(f(args))
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank9]:     outs = compiled_fn(args)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank9]:     return compiled_fn(runtime_args)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank9]:     return self.current_callable(inputs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank9]:     return compiled_fn(new_inputs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank9]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank9]:     return manager.add_function(
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank9]:     return fn, fn(inputs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank9]:     out = self._run(new_inputs, function_id)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank9]:     out = self.run_eager(new_inputs, function_id)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank9]:     return node.run(new_inputs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank9]:     out = self.wrapped_function.model(new_inputs)
[rank9]:   File "/tmp/torchinductor_charlie/qf/cqf26ixljqh6b5evahisy3tg2bhz5cja6yut3mvpxiqbuazfkotz.py", line 2775, in call
[rank9]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank9]:     return self._op(*args, **kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank9]:     return func(*args, **kwargs)
[rank9]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank9]:     return self._op(*args, **kwargs)
[rank9]: torch.distributed.DistBackendError: [9] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank9]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank9]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x150ca5b6c106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank9]: frame #1: <unknown function> + 0x62f51d8 (0x150c953d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x150c953cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x150c953ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x150c953cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150c9537c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150c9537c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150c9537c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x150c5add681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x150c5ade4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #10: <unknown function> + 0x125d029 (0x150c5adea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x150c5adea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x150c5adeb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank9]: frame #13: <unknown function> + 0x629407e (0x150c9537007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #14: <unknown function> + 0x629eb54 (0x150c9537ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #15: <unknown function> + 0x629f8d9 (0x150c9537b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #16: <unknown function> + 0x58a83bb (0x150c949843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #17: <unknown function> + 0x58a5c39 (0x150c94981c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #18: <unknown function> + 0x1aa3808 (0x150c90b7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #19: <unknown function> + 0x62a7385 (0x150c95383385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #20: <unknown function> + 0x62b58cd (0x150c953918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #21: <unknown function> + 0x6275480 (0x150c95351480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #22: <unknown function> + 0x6282f17 (0x150c9535ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #23: <unknown function> + 0x6283085 (0x150c9535f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #24: <unknown function> + 0x58a83bb (0x150c949843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #25: <unknown function> + 0x58a5c39 (0x150c94981c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #26: <unknown function> + 0x1aa3808 (0x150c90b7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank9]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x150ca5083908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x150ca4e0dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x150ca4e0dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #30: <unknown function> + 0x97ada2 (0x150ca4cfeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #31: <unknown function> + 0x4d9367 (0x150ca485d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank9]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank9]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank9]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank9]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x150ca504ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x150ca4e071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x150ca4e0df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #46: <unknown function> + 0x97ada2 (0x150ca4cfeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #47: <unknown function> + 0x4d9367 (0x150ca485d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank9]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank9]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank9]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank9]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank14]: Traceback (most recent call last):
[rank14]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank14]:     main(
[rank14]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank14]:     y, decode_latency, prefill_latency = generate(
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank14]:     return func(*args, **kwargs)
[rank14]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank14]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank14]:     return fn(*args, **kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank14]:     @functools.wraps(fn)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank14]:     return fn(*args, **kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank14]:     return compiled_fn(full_args)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank14]:     all_outs = call_func_at_runtime_with_args(
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank14]:     out = normalize_as_list(f(args))
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank14]:     outs = compiled_fn(args)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank14]:     return compiled_fn(runtime_args)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank14]:     return self.current_callable(inputs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank14]:     return compiled_fn(new_inputs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank14]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank14]:     return manager.add_function(
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank14]:     return fn, fn(inputs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank14]:     out = self._run(new_inputs, function_id)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank14]:     out = self.run_eager(new_inputs, function_id)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank14]:     return node.run(new_inputs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank14]:     out = self.wrapped_function.model(new_inputs)
[rank14]:   File "/tmp/torchinductor_charlie/yw/cywnj2khfnfs3ized4evobkam4odzfxgw5jqco42lyusnka3kib6.py", line 2775, in call
[rank14]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank14]:     return self._op(*args, **kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank14]:     return func(*args, **kwargs)
[rank14]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank14]:     return self._op(*args, **kwargs)
[rank14]: torch.distributed.DistBackendError: [14] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank14]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank14]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1509714f9106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank14]: frame #1: <unknown function> + 0x62f51d8 (0x1509acdd11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x1509acdcdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x1509acdce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x1509acdcf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1509acd7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1509acd7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1509acd7c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x1509727d681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank14]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x1509727e4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank14]: frame #10: <unknown function> + 0x125d029 (0x1509727ea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank14]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x1509727ea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank14]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x1509727eb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank14]: frame #13: <unknown function> + 0x629407e (0x1509acd7007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #14: <unknown function> + 0x629eb54 (0x1509acd7ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #15: <unknown function> + 0x629f8d9 (0x1509acd7b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #16: <unknown function> + 0x58a83bb (0x1509ac3843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #17: <unknown function> + 0x58a5c39 (0x1509ac381c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #18: <unknown function> + 0x1aa3808 (0x1509a857f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #19: <unknown function> + 0x62a7385 (0x1509acd83385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #20: <unknown function> + 0x62b58cd (0x1509acd918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #21: <unknown function> + 0x6275480 (0x1509acd51480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #22: <unknown function> + 0x6282f17 (0x1509acd5ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #23: <unknown function> + 0x6283085 (0x1509acd5f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #24: <unknown function> + 0x58a83bb (0x1509ac3843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #25: <unknown function> + 0x58a5c39 (0x1509ac381c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #26: <unknown function> + 0x1aa3808 (0x1509a857f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank14]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x1509bca83908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x1509bc80dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x1509bc80dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #30: <unknown function> + 0x97ada2 (0x1509bc6feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #31: <unknown function> + 0x4d9367 (0x1509bc25d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank14]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank14]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank14]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank14]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x1509bca4ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x1509bc8071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x1509bc80df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #46: <unknown function> + 0x97ada2 (0x1509bc6feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #47: <unknown function> + 0x4d9367 (0x1509bc25d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank14]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank14]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank14]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank14]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank13]: Traceback (most recent call last):
[rank13]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank13]:     main(
[rank13]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank13]:     y, decode_latency, prefill_latency = generate(
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank13]:     return func(*args, **kwargs)
[rank13]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank13]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank13]:     return fn(*args, **kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank13]:     @functools.wraps(fn)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank13]:     return fn(*args, **kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank13]:     return compiled_fn(full_args)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank13]:     all_outs = call_func_at_runtime_with_args(
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank13]:     out = normalize_as_list(f(args))
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank13]:     outs = compiled_fn(args)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank13]:     return compiled_fn(runtime_args)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank13]:     return self.current_callable(inputs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank13]:     return compiled_fn(new_inputs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank13]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank13]:     return manager.add_function(
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank13]:     return fn, fn(inputs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank13]:     out = self._run(new_inputs, function_id)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank13]:     out = self.run_eager(new_inputs, function_id)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank13]:     return node.run(new_inputs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank13]:     out = self.wrapped_function.model(new_inputs)
[rank13]:   File "/tmp/torchinductor_charlie/cy/ccyvdiatymnjhjopclaybt4uhl3wvccyvri656rhulp34nvf3ulj.py", line 2775, in call
[rank13]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank13]:     return self._op(*args, **kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank13]:     return func(*args, **kwargs)
[rank13]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank13]:     return self._op(*args, **kwargs)
[rank13]: torch.distributed.DistBackendError: [13] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank13]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank13]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x150e8f96c106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank13]: frame #1: <unknown function> + 0x62f51d8 (0x150e7f1d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x150e7f1cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x150e7f1ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x150e7f1cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150e7f17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150e7f17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150e7f17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x150e44bd681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank13]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x150e44be4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank13]: frame #10: <unknown function> + 0x125d029 (0x150e44bea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank13]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x150e44bea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank13]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x150e44beb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank13]: frame #13: <unknown function> + 0x629407e (0x150e7f17007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #14: <unknown function> + 0x629eb54 (0x150e7f17ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #15: <unknown function> + 0x629f8d9 (0x150e7f17b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #16: <unknown function> + 0x58a83bb (0x150e7e7843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #17: <unknown function> + 0x58a5c39 (0x150e7e781c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #18: <unknown function> + 0x1aa3808 (0x150e7a97f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #19: <unknown function> + 0x62a7385 (0x150e7f183385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #20: <unknown function> + 0x62b58cd (0x150e7f1918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #21: <unknown function> + 0x6275480 (0x150e7f151480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #22: <unknown function> + 0x6282f17 (0x150e7f15ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #23: <unknown function> + 0x6283085 (0x150e7f15f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #24: <unknown function> + 0x58a83bb (0x150e7e7843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #25: <unknown function> + 0x58a5c39 (0x150e7e781c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #26: <unknown function> + 0x1aa3808 (0x150e7a97f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank13]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x150e8ee83908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x150e8ec0dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x150e8ec0dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #30: <unknown function> + 0x97ada2 (0x150e8eafeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #31: <unknown function> + 0x4d9367 (0x150e8e65d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank13]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank13]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank13]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank13]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x150e8ee4ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x150e8ec071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x150e8ec0df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #46: <unknown function> + 0x97ada2 (0x150e8eafeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #47: <unknown function> + 0x4d9367 (0x150e8e65d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank13]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank13]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank13]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank13]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank8]: Traceback (most recent call last):
[rank8]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank8]:     main(
[rank8]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank8]:     y, decode_latency, prefill_latency = generate(
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank8]:     return func(*args, **kwargs)
[rank8]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank8]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank8]:     return fn(*args, **kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank8]:     @functools.wraps(fn)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank8]:     return fn(*args, **kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank8]:     return compiled_fn(full_args)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank8]:     all_outs = call_func_at_runtime_with_args(
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank8]:     out = normalize_as_list(f(args))
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank8]:     outs = compiled_fn(args)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank8]:     return compiled_fn(runtime_args)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank8]:     return self.current_callable(inputs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank8]:     return compiled_fn(new_inputs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank8]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank8]:     return manager.add_function(
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank8]:     return fn, fn(inputs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank8]:     out = self._run(new_inputs, function_id)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank8]:     out = self.run_eager(new_inputs, function_id)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank8]:     return node.run(new_inputs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank8]:     out = self.wrapped_function.model(new_inputs)
[rank8]:   File "/tmp/torchinductor_charlie/bk/cbkgb4bi4uotg4mjl234d3uger7ovnjufentbo7hdft735etnaxx.py", line 2775, in call
[rank8]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank8]:     return self._op(*args, **kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank8]:     return func(*args, **kwargs)
[rank8]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank8]:     return self._op(*args, **kwargs)
[rank8]: torch.distributed.DistBackendError: [8] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank8]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank8]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x147d11cf9106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank8]: frame #1: <unknown function> + 0x62f51d8 (0x147d4d5d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x147d4d5cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x147d4d5ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x147d4d5cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x147d4d57c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x147d4d57c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x147d4d57c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x147d12fd681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x147d12fe4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #10: <unknown function> + 0x125d029 (0x147d12fea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x147d12fea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x147d12feb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank8]: frame #13: <unknown function> + 0x629407e (0x147d4d57007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #14: <unknown function> + 0x629eb54 (0x147d4d57ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #15: <unknown function> + 0x629f8d9 (0x147d4d57b8d9 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_c[rank10]: Traceback (most recent call last):
[rank10]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank10]:     main(
[rank10]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank10]:     y, decode_latency, prefill_latency = generate(
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank10]:     return func(*args, **kwargs)
[rank10]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank10]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank10]:     return fn(*args, **kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank10]:     @functools.wraps(fn)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank10]:     return fn(*args, **kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank10]:     return compiled_fn(full_args)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank10]:     all_outs = call_func_at_runtime_with_args(
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank10]:     out = normalize_as_list(f(args))
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank10]:     outs = compiled_fn(args)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank10]:     return compiled_fn(runtime_args)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank10]:     return self.current_callable(inputs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank10]:     return compiled_fn(new_inputs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank10]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank10]:     return manager.add_function(
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank10]:     return fn, fn(inputs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank10]:     out = self._run(new_inputs, function_id)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank10]:     out = self.run_eager(new_inputs, function_id)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank10]:     return node.run(new_inputs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank10]:     out = self.wrapped_function.model(new_inputs)
[rank10]:   File "/tmp/torchinductor_charlie/ls/cls4znqrju2nbowjmugg7qzw5gjjmt7hmqwytxandawkl52auvqv.py", line 2775, in call
[rank10]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank10]:     return self._op(*args, **kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank10]:     return func(*args, **kwargs)
[rank10]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank10]:     return self._op(*args, **kwargs)
[rank10]: torch.distributed.DistBackendError: [10] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank10]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank10]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x14f95e8f9106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank10]: frame #1: <unknown function> + 0x62f51d8 (0x14f99a1d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x14f99a1cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x14f99a1ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x14f99a1cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f99a17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f99a17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14f99a17c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x14f95fbd681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x14f95fbe4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #10: <unknown function> + 0x125d029 (0x14f95fbea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x14f95fbea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x14f95fbeb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank10]: frame #13: <unknown function> + 0x629407e (0x14f99a17007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #14: <unknown function> + 0x629eb54 (0x14f99a17ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #15: <unknown function> + 0x629f8d9 (0x14f99a17b8d9 in /home/charlie/ana[rank11]: Traceback (most recent call last):
[rank11]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 492, in <module>
[rank11]:     main(
[rank11]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 419, in main
[rank11]:     y, decode_latency, prefill_latency = generate(
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank11]:     return func(*args, **kwargs)
[rank11]:   File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 140, in generate
[rank11]:     next_token = prefill(model, prompt.view(batch_size, -1), input_pos, **sampling_kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 556, in _fn
[rank11]:     return fn(*args, **kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/external_utils.py", line 29, in inner
[rank11]:     @functools.wraps(fn)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
[rank11]:     return fn(*args, **kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1132, in forward
[rank11]:     return compiled_fn(full_args)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 324, in runtime_wrapper
[rank11]:     all_outs = call_func_at_runtime_with_args(
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/utils.py", line 126, in call_func_at_runtime_with_args
[rank11]:     out = normalize_as_list(f(args))
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 673, in inner_fn
[rank11]:     outs = compiled_fn(args)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/runtime_wrappers.py", line 491, in wrapper
[rank11]:     return compiled_fn(runtime_args)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/codecache.py", line 1686, in __call__
[rank11]:     return self.current_callable(inputs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1104, in run
[rank11]:     return compiled_fn(new_inputs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 398, in deferred_cudagraphify
[rank11]:     fn, out = cudagraphify(model, inputs, new_static_input_idxs, *args, **kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 428, in cudagraphify
[rank11]:     return manager.add_function(
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2235, in add_function
[rank11]:     return fn, fn(inputs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 1929, in run
[rank11]:     out = self._run(new_inputs, function_id)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2037, in _run
[rank11]:     out = self.run_eager(new_inputs, function_id)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 2201, in run_eager
[rank11]:     return node.run(new_inputs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_inductor/cudagraph_trees.py", line 644, in run
[rank11]:     out = self.wrapped_function.model(new_inputs)
[rank11]:   File "/tmp/torchinductor_charlie/ub/cubxsi5r5qwbgzrguuvh5762gi2hylyolfvkaay7fcsoljlvpqhl.py", line 2775, in call
[rank11]:     torch.ops._c10d_functional.all_reduce_.default(reinterpret_tensor(buf15, (32, 1024, 16384), (16777216, 16384, 1), 0), 'sum', '0')
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank11]:     return self._op(*args, **kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_device.py", line 106, in __torch_function__
[rank11]:     return func(*args, **kwargs)
[rank11]:   File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/_ops.py", line 723, in __call__
[rank11]:     return self._op(*args, **kwargs)
[rank11]: torch.distributed.DistBackendError: [11] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: failed to recv, got 0 bytes
[rank11]: Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
[rank11]: frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x14e794ef9106 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libc10.so)
[rank11]: frame #1: <unknown function> + 0x62f51d8 (0x14e7d07d11d8 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x367 (0x14e7d07cdf57 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #3: c10d::TCPStore::doGet(std::string const&) + 0x2a (0x14e7d07ce2da in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #4: c10d::TCPStore::get(std::string const&) + 0x7a (0x14e7d07cf07a in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e7d077c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e7d077c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e7d077c4a1 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xaf (0x14e7961d681f in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #9: c10d::ProcessGroupNCCL::initNCCLComm(std::string const&, c10::Device&, c10d::OpType, int, bool) + 0x10c6 (0x14e7961e4386 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #10: <unknown function> + 0x125d029 (0x14e7961ea029 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #11: c10d::ProcessGroupNCCL::allreduce_impl(at::Tensor&, c10d::AllreduceOptions const&) + 0x12c (0x14e7961ea9fc in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x6a3 (0x14e7961eb283 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
[rank11]: frame #13: <unknown function> + 0x629407e (0x14e7d077007e in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #14: <unknown function> + 0x629eb54 (0x14e7d077ab54 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #15: <unknown function> + 0x629f8d9 (0x14e7d077b8d9 in /home/charlie/anapu.so)
[rank8]: frame #16: <unknown function> + 0x58a83bb (0x147d4cb843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #17: <unknown function> + 0x58a5c39 (0x147d4cb81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #18: <unknown function> + 0x1aa3808 (0x147d48d7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #19: <unknown function> + 0x62a7385 (0x147d4d583385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #20: <unknown function> + 0x62b58cd (0x147d4d5918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #21: <unknown function> + 0x6275480 (0x147d4d551480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #22: <unknown function> + 0x6282f17 (0x147d4d55ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #23: <unknown function> + 0x6283085 (0x147d4d55f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #24: <unknown function> + 0x58a83bb (0x147d4cb843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #25: <unknown function> + 0x58a5c39 (0x147d4cb81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #26: <unknown function> + 0x1aa3808 (0x147d48d7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank8]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x147d5d283908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x147d5d00dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x147d5d00dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #30: <unknown function> + 0x97ada2 (0x147d5cefeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #31: <unknown function> + 0x4d9367 (0x147d5ca5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank8]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank8]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank8]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank8]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x147d5d24ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x147d5d0071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x147d5d00df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #46: <unknown function> + 0x97ada2 (0x147d5cefeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #47: <unknown function> + 0x4d9367 (0x147d5ca5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank8]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank8]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank8]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank8]: . This may indicate a possible application crash on rank 0 or a network set up issue.
conda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #16: <unknown function> + 0x58a83bb (0x14f9997843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #17: <unknown function> + 0x58a5c39 (0x14f999781c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #18: <unknown function> + 0x1aa3808 (0x14f99597f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #19: <unknown function> + 0x62a7385 (0x14f99a183385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #20: <unknown function> + 0x62b58cd (0x14f99a1918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #21: <unknown function> + 0x6275480 (0x14f99a151480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #22: <unknown function> + 0x6282f17 (0x14f99a15ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #23: <unknown function> + 0x6283085 (0x14f99a15f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #24: <unknown function> + 0x58a83bb (0x14f9997843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #25: <unknown function> + 0x58a5c39 (0x14f999781c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #26: <unknown function> + 0x1aa3808 (0x14f99597f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank10]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x14f9a9e83908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x14f9a9c0dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x14f9a9c0dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #30: <unknown function> + 0x97ada2 (0x14f9a9afeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #31: <unknown function> + 0x4d9367 (0x14f9a965d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank10]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank10]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank10]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank10]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x14f9a9e4ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x14f9a9c071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x14f9a9c0df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #46: <unknown function> + 0x97ada2 (0x14f9a9afeda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #47: <unknown function> + 0x4d9367 (0x14f9a965d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank10]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank10]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank10]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank10]: . This may indicate a possible application crash on rank 0 or a network set up issue.
conda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #16: <unknown function> + 0x58a83bb (0x14e7cfd843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #17: <unknown function> + 0x58a5c39 (0x14e7cfd81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #18: <unknown function> + 0x1aa3808 (0x14e7cbf7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #19: <unknown function> + 0x62a7385 (0x14e7d0783385 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #20: <unknown function> + 0x62b58cd (0x14e7d07918cd in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #21: <unknown function> + 0x6275480 (0x14e7d0751480 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #22: <unknown function> + 0x6282f17 (0x14e7d075ef17 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #23: <unknown function> + 0x6283085 (0x14e7d075f085 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #24: <unknown function> + 0x58a83bb (0x14e7cfd843bb in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #25: <unknown function> + 0x58a5c39 (0x14e7cfd81c39 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #26: <unknown function> + 0x1aa3808 (0x14e7cbf7f808 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
[rank11]: frame #27: c10::Dispatcher::callBoxed(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const + 0x238 (0x14e7e0483908 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #28: torch::jit::invokeOperatorFromPython(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, pybind11::args const&, pybind11::kwargs const&, std::optional<c10::DispatchKey>) + 0x1a6 (0x14e7e020dc46 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #29: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0x157 (0x14e7e020dfa7 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #30: <unknown function> + 0x97ada2 (0x14e7e00feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #31: <unknown function> + 0x4d9367 (0x14e7dfc5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #32: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank11]: frame #33: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #34: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #35: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #36: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #37: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank11]: frame #38: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #39: _PyEval_EvalFrameDefault + 0x2b79 (0x4f0c69 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #40: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x509b26]
[rank11]: frame #41: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5934c6]
[rank11]: frame #42: PyObject_CallMethod + 0xcd (0x597eed in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #43: torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName) + 0x423 (0x14e7e044ff73 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #44: torch::jit::_maybe_handle_torch_function(std::string const&, std::string const&, std::string const&, bool, pybind11::args const&, pybind11::kwargs const&) + 0x43a (0x14e7e02071ea in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #45: torch::jit::_get_operation_for_overload_or_packet(std::vector<std::shared_ptr<torch::jit::Operator>, std::allocator<std::shared_ptr<torch::jit::Operator> > > const&, c10::Symbol, pybind11::args const&, pybind11::kwargs const&, bool, std::optional<c10::DispatchKey>) + 0xc5 (0x14e7e020df15 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #46: <unknown function> + 0x97ada2 (0x14e7e00feda2 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #47: <unknown function> + 0x4d9367 (0x14e7dfc5d367 in /home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
[rank11]: frame #48: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x4fdc87]
[rank11]: frame #49: PyObject_Call + 0x209 (0x50a659 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #50: _PyEval_EvalFrameDefault + 0x5a74 (0x4f3b64 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #51: _PyObject_FastCallDictTstate + 0xcd (0x4f676d in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #52: _PyObject_Call_Prepend + 0x66 (0x507f36 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #53: /home/charlie/anaconda3/envs/gpt-fast/bin/python() [0x5cf883]
[rank11]: frame #54: _PyObject_MakeTpCall + 0x25b (0x4f741b in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #55: _PyEval_EvalFrameDefault + 0x53d6 (0x4f34c6 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #56: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #57: _PyEval_EvalFrameDefault + 0x4b26 (0x4f2c16 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #58: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #59: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #60: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #61: _PyEval_EvalFrameDefault + 0x731 (0x4ee821 in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: frame #62: _PyFunction_Vectorcall + 0x6f (0x4fe0cf in /home/charlie/anaconda3/envs/gpt-fast/bin/python)
[rank11]: . This may indicate a possible application crash on rank 0 or a network set up issue.
[rank8]:[W1118 13:38:38.635039910 ProcessGroupNCCL.cpp:1374] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W1118 13:38:40.948000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670310 closing signal SIGTERM
W1118 13:38:41.007000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670311 closing signal SIGTERM
W1118 13:38:41.016000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670312 closing signal SIGTERM
W1118 13:38:41.028000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670313 closing signal SIGTERM
W1118 13:38:41.036000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670314 closing signal SIGTERM
W1118 13:38:41.045000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670316 closing signal SIGTERM
W1118 13:38:41.053000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 2670317 closing signal SIGTERM
E1118 13:38:43.602000 2670235 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 5 (pid: 2670315) of binary: /home/charlie/anaconda3/envs/gpt-fast/bin/python
Traceback (most recent call last):
  File "/home/charlie/anaconda3/envs/gpt-fast/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
benchmark.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-11-18_13:38:40
  host      : mk-xii-06.cloud.together.ai
  rank      : 13 (local_rank: 5)
  exitcode  : 1 (pid: 2670315)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
