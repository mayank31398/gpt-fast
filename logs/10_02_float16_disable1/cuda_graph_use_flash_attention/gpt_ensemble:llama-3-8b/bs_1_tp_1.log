flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.96 seconds
[rank0]:[W1001 20:41:32.718417141 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.034342424012720585 sec
Decode latency: 0.2689670769032091 sec
Compilation time: 0.30 seconds
Prefill latency: 0.03395750210620463 sec
Decode latency: 0.2665849190670997 sec
Prefill latency: 0.03399300994351506 sec
Decode latency: 0.26961033802945167 sec
Prefill latency: 0.034023168962448835 sec
Decode latency: 0.2664505570428446 sec
Prefill latency: 0.03409812494646758 sec
Decode latency: 0.2617359550204128 sec
Prefill latency: 0.03399224206805229 sec
Decode latency: 0.26763593906071037 sec
Time for inference 1: 0.30 sec total, 105.93 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1590.06 GB/s
FLOPS achieved: 52.47 TF/s

Prefill latency: 0.03397475206293166 sec
Decode latency: 0.26965282298624516 sec
Time for inference 2: 0.30 sec total, 105.23 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1579.42 GB/s
FLOPS achieved: 52.12 TF/s

Prefill latency: 0.034024716005660594 sec
Decode latency: 0.26769518305081874 sec
Time for inference 3: 0.30 sec total, 105.89 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1589.38 GB/s
FLOPS achieved: 52.45 TF/s

Prefill latency: 0.033955145976506174 sec
Decode latency: 0.2663966310210526 sec
Time for inference 4: 0.30 sec total, 106.38 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1596.76 GB/s
FLOPS achieved: 52.69 TF/s

Prefill latency: 0.03398931899573654 sec
Decode latency: 0.265824688016437 sec
Time for inference 5: 0.30 sec total, 106.58 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1599.69 GB/s
FLOPS achieved: 52.79 TF/s

Prefill latency: 0.03389402397442609 sec
Decode latency: 0.26641934900544584 sec
Time for inference 6: 0.30 sec total, 106.39 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1596.95 GB/s
FLOPS achieved: 52.70 TF/s

Prefill latency: 0.03399310796521604 sec
Decode latency: 0.26941638195421547 sec
Time for inference 7: 0.30 sec total, 105.32 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1580.84 GB/s
FLOPS achieved: 52.17 TF/s

Prefill latency: 0.03396179003175348 sec
Decode latency: 0.26675438904203475 sec
Time for inference 8: 0.30 sec total, 106.25 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1594.82 GB/s
FLOPS achieved: 52.63 TF/s

Prefill latency: 0.0339722620556131 sec
Decode latency: 0.26994592894334346 sec
Time for inference 9: 0.30 sec total, 105.13 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1577.93 GB/s
FLOPS achieved: 52.07 TF/s

Prefill latency: 0.03407666110433638 sec
Decode latency: 0.2696090399986133 sec
Time for inference 10: 0.30 sec total, 105.20 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1578.98 GB/s
FLOPS achieved: 52.11 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2679 sec
Average prefill latency: 0.0340 sec
Average tokens/sec: 105.83
Memory used: 17.06 GB
Done. we are killing the process
