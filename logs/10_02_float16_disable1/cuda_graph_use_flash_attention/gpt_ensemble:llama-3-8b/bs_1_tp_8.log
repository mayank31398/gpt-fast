W1001 20:42:07.199000 22474058196800 torch/distributed/run.py:779] 
W1001 20:42:07.199000 22474058196800 torch/distributed/run.py:779] *****************************************
W1001 20:42:07.199000 22474058196800 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:42:07.199000 22474058196800 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.06 seconds
[rank0]:[W1001 20:42:21.707065609 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.07867741899099201 sec
Decode latency: 0.18065737397409976 sec
Compilation time: 0.20 secondsCompilation time: 0.22 seconds

Compilation time: 0.20 seconds
Compilation time: 0.21 seconds
Compilation time: 0.25 seconds
Compilation time: 0.20 seconds
Compilation time: 0.20 seconds
Compilation time: 0.26 seconds
Prefill latency: 0.015312594012357295 sec
Decode latency: 0.17579722392838448 sec
Prefill latency: 0.015699745039455593 sec
Decode latency: 0.1743640109198168 sec
Prefill latency: 0.015304696979001164 sec
Decode latency: 0.17462039005476981 sec
Prefill latency: 0.015416888985782862 sec
Decode latency: 0.1740391650237143 sec
Prefill latency: 0.015445371973328292 sec
Decode latency: 0.17603568802587688 sec
Time for inference 1: 0.19 sec total, 166.70 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 466.09 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.015112555003724992 sec
Decode latency: 0.17435140907764435 sec
Time for inference 2: 0.19 sec total, 168.38 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 470.79 GB/s
FLOPS achieved: 15.54 TF/s

Prefill latency: 0.015435434994287789 sec
Decode latency: 0.17607832804787904 sec
Time for inference 3: 0.19 sec total, 166.62 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 465.87 GB/s
FLOPS achieved: 15.37 TF/s

Prefill latency: 0.015390566899441183 sec
Decode latency: 0.1741332069505006 sec
Time for inference 4: 0.19 sec total, 168.27 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 470.49 GB/s
FLOPS achieved: 15.53 TF/s

Prefill latency: 0.016498949960805476 sec
Decode latency: 0.1746476540574804 sec
Time for inference 5: 0.19 sec total, 166.88 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 466.60 GB/s
FLOPS achieved: 15.40 TF/s

Prefill latency: 0.017611662042327225 sec
Decode latency: 0.17377473798114806 sec
Time for inference 6: 0.19 sec total, 166.72 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 466.16 GB/s
FLOPS achieved: 15.38 TF/s

Prefill latency: 0.015473903971724212 sec
Decode latency: 0.17352218099404126 sec
Time for inference 7: 0.19 sec total, 168.87 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 472.16 GB/s
FLOPS achieved: 15.58 TF/s

Prefill latency: 0.01537918602116406 sec
Decode latency: 0.1742885389830917 sec
Time for inference 8: 0.19 sec total, 168.12 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 470.07 GB/s
FLOPS achieved: 15.51 TF/s

Prefill latency: 0.01531262299977243 sec
Decode latency: 0.17508531699422747 sec
Time for inference 9: 0.19 sec total, 167.56 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 468.50 GB/s
FLOPS achieved: 15.46 TF/s

Prefill latency: 0.015255994978360832 sec
Decode latency: 0.17526388296391815 sec
Time for inference 10: 0.19 sec total, 167.43 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.02 sec
Bandwidth achieved: 468.14 GB/s
FLOPS achieved: 15.45 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1747 sec
Average prefill latency: 0.0157 sec
Average tokens/sec: 167.55
Memory used: 4.64 GB
Done. we are killing the process
