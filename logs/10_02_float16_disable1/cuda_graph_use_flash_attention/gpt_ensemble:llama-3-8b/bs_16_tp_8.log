W1001 20:44:42.902000 23245801080640 torch/distributed/run.py:779] 
W1001 20:44:42.902000 23245801080640 torch/distributed/run.py:779] *****************************************
W1001 20:44:42.902000 23245801080640 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:44:42.902000 23245801080640 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.07 seconds
Prefill latency: 0.14128921693190932 sec
Decode latency: 0.24376671691425145 sec
Compilation time: 0.38 seconds
Compilation time: 0.39 seconds
Compilation time: 0.38 seconds
Compilation time: 0.38 seconds
Compilation time: 0.38 secondsCompilation time: 0.39 seconds

Compilation time: 0.38 seconds
Compilation time: 0.38 seconds
Prefill latency: 0.13482236303389072 sec
Decode latency: 0.2551224669441581 sec
Prefill latency: 0.1327718870015815 sec
Decode latency: 0.2435984449693933 sec
Prefill latency: 0.1355235209921375 sec
Decode latency: 0.2435506209731102 sec
Prefill latency: 0.13112241600174457 sec
Decode latency: 0.241211456945166 sec
Prefill latency: 0.1349521919619292 sec
Decode latency: 0.2478435569209978 sec
Time for inference 1: 0.38 sec total, 1335.26 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3733.43 GB/s
FLOPS achieved: 123.20 TF/s

Prefill latency: 0.1303266129689291 sec
Decode latency: 0.2529767450178042 sec
Time for inference 2: 0.38 sec total, 1333.57 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3728.71 GB/s
FLOPS achieved: 123.05 TF/s

Prefill latency: 0.13530128402635455 sec
Decode latency: 0.24067912192549556 sec
Time for inference 3: 0.38 sec total, 1359.97 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 3802.52 GB/s
FLOPS achieved: 125.48 TF/s

Prefill latency: 0.1343209110200405 sec
Decode latency: 0.24666688404977322 sec
Time for inference 4: 0.38 sec total, 1342.07 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3752.47 GB/s
FLOPS achieved: 123.83 TF/s

Prefill latency: 0.13811691594310105 sec
Decode latency: 0.2396832200465724 sec
Time for inference 5: 0.38 sec total, 1353.30 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 3783.87 GB/s
FLOPS achieved: 124.87 TF/s

Prefill latency: 0.1356733279535547 sec
Decode latency: 0.24419324100017548 sec
Time for inference 6: 0.38 sec total, 1345.95 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 3763.33 GB/s
FLOPS achieved: 124.19 TF/s

Prefill latency: 0.1321120000211522 sec
Decode latency: 0.29010641609784216 sec
Time for inference 7: 0.42 sec total, 1210.12 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3383.53 GB/s
FLOPS achieved: 111.66 TF/s

Prefill latency: 0.13671296299435198 sec
Decode latency: 0.24605239590164274 sec
Time for inference 8: 0.38 sec total, 1335.32 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 3733.59 GB/s
FLOPS achieved: 123.21 TF/s

Prefill latency: 0.13126532593742013 sec
Decode latency: 0.24204048002138734 sec
Time for inference 9: 0.37 sec total, 1369.23 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3828.42 GB/s
FLOPS achieved: 126.34 TF/s

Prefill latency: 0.1368873140309006 sec
Decode latency: 0.24435235804412514 sec
Time for inference 10: 0.38 sec total, 1340.92 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.14 sec
Bandwidth achieved: 3749.26 GB/s
FLOPS achieved: 123.73 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2495 sec
Average prefill latency: 0.1346 sec
Average tokens/sec: 1332.57
Memory used: 15.46 GB
Done. we are killing the process
