W1001 20:41:39.565000 23445173356352 torch/distributed/run.py:779] 
W1001 20:41:39.565000 23445173356352 torch/distributed/run.py:779] *****************************************
W1001 20:41:39.565000 23445173356352 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:41:39.565000 23445173356352 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.04646138404496014 sec
Decode latency: 0.21203826798591763 sec
Compilation time: 0.27 seconds
Compilation time: 0.26 seconds
Prefill latency: 0.039131936035119 sec
Decode latency: 0.21192242403049022 sec
Prefill latency: 0.03922571998555213 sec
Decode latency: 0.21160392905585468 sec
Prefill latency: 0.03937082597985864 sec
Decode latency: 0.21182960900478065 sec
Prefill latency: 0.039454250945709646 sec
Decode latency: 0.21182186692021787 sec
Prefill latency: 0.03942812897730619 sec
Decode latency: 0.2117725460557267 sec
Time for inference 1: 0.25 sec total, 127.15 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.06 GB/s
FLOPS achieved: 33.69 TF/s

Prefill latency: 0.03922973002772778 sec
Decode latency: 0.2115399519680068 sec
Time for inference 2: 0.25 sec total, 127.36 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1022.78 GB/s
FLOPS achieved: 33.75 TF/s

Prefill latency: 0.03929784696083516 sec
Decode latency: 0.21185548603534698 sec
Time for inference 3: 0.25 sec total, 127.17 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.28 GB/s
FLOPS achieved: 33.70 TF/s

Prefill latency: 0.03921747894492 sec
Decode latency: 0.21185175003483891 sec
Time for inference 4: 0.25 sec total, 127.18 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.34 GB/s
FLOPS achieved: 33.70 TF/s

Prefill latency: 0.03928950696717948 sec
Decode latency: 0.2115747299976647 sec
Time for inference 5: 0.25 sec total, 127.36 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1022.73 GB/s
FLOPS achieved: 33.75 TF/s

Prefill latency: 0.03927247493993491 sec
Decode latency: 0.211211659014225 sec
Time for inference 6: 0.25 sec total, 127.52 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1024.09 GB/s
FLOPS achieved: 33.79 TF/s

Prefill latency: 0.03929845790844411 sec
Decode latency: 0.21187690901570022 sec
Time for inference 7: 0.25 sec total, 127.16 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.19 GB/s
FLOPS achieved: 33.70 TF/s

Prefill latency: 0.039328580955043435 sec
Decode latency: 0.21176399500109255 sec
Time for inference 8: 0.25 sec total, 127.24 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.79 GB/s
FLOPS achieved: 33.72 TF/s

Prefill latency: 0.039429294993169606 sec
Decode latency: 0.2118123440304771 sec
Time for inference 9: 0.25 sec total, 127.16 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1021.20 GB/s
FLOPS achieved: 33.70 TF/s

Prefill latency: 0.03935558605007827 sec
Decode latency: 0.212055834941566 sec
Time for inference 10: 0.25 sec total, 127.07 tokens/sec
Decode latency: 0.21 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1020.42 GB/s
FLOPS achieved: 33.67 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2117 sec
Average prefill latency: 0.0393 sec
Average tokens/sec: 127.24
Memory used: 10.09 GB
Done. we are killing the process
