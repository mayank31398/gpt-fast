W1001 20:27:40.182000 23285742802752 torch/distributed/run.py:779] 
W1001 20:27:40.182000 23285742802752 torch/distributed/run.py:779] *****************************************
W1001 20:27:40.182000 23285742802752 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:27:40.182000 23285742802752 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.13 seconds
Prefill latency: 0.11229489196557552 sec
Decode latency: 0.2771834189770743 sec
Compilation time: 0.38 secondsCompilation time: 0.33 seconds

Compilation time: 0.33 seconds
Compilation time: 0.33 seconds
Compilation time: 0.35 seconds
Compilation time: 0.39 seconds
Compilation time: 0.38 seconds
Compilation time: 0.39 seconds
Prefill latency: 0.05028463003691286 sec
Decode latency: 0.2694740379229188 sec
Prefill latency: 0.04956761701032519 sec
Decode latency: 0.2742176619358361 sec
Prefill latency: 0.04896734608337283 sec
Decode latency: 0.27499660896137357 sec
Prefill latency: 0.04861171299125999 sec
Decode latency: 0.2673055819468573 sec
Prefill latency: 0.04873517097439617 sec
Decode latency: 0.2668106759665534 sec
Time for inference 1: 0.32 sec total, 404.99 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1132.38 GB/s
FLOPS achieved: 37.37 TF/s

Prefill latency: 0.049004763015545905 sec
Decode latency: 0.2718658240046352 sec
Time for inference 2: 0.32 sec total, 398.17 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1113.29 GB/s
FLOPS achieved: 36.74 TF/s

Prefill latency: 0.04787662404123694 sec
Decode latency: 0.270454369019717 sec
Time for inference 3: 0.32 sec total, 401.28 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1122.00 GB/s
FLOPS achieved: 37.03 TF/s

Prefill latency: 0.04891730996314436 sec
Decode latency: 0.27113281306810677 sec
Time for inference 4: 0.32 sec total, 399.16 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1116.06 GB/s
FLOPS achieved: 36.83 TF/s

Prefill latency: 0.04782939900178462 sec
Decode latency: 0.2693995280424133 sec
Time for inference 5: 0.32 sec total, 402.65 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1125.82 GB/s
FLOPS achieved: 37.15 TF/s

Prefill latency: 0.04872305388562381 sec
Decode latency: 0.268271517008543 sec
Time for inference 6: 0.32 sec total, 403.04 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1126.91 GB/s
FLOPS achieved: 37.19 TF/s

Prefill latency: 0.04865675896871835 sec
Decode latency: 0.2800716729834676 sec
Time for inference 7: 0.33 sec total, 388.67 tokens/sec
Decode latency: 0.28 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1086.75 GB/s
FLOPS achieved: 35.86 TF/s

Prefill latency: 0.04882096906658262 sec
Decode latency: 0.2717050400096923 sec
Time for inference 8: 0.32 sec total, 398.65 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1114.65 GB/s
FLOPS achieved: 36.78 TF/s

Prefill latency: 0.05207076796796173 sec
Decode latency: 0.2665268450509757 sec
Time for inference 9: 0.32 sec total, 400.99 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1121.17 GB/s
FLOPS achieved: 37.00 TF/s

Prefill latency: 0.04904579999856651 sec
Decode latency: 0.26886186201591045 sec
Time for inference 10: 0.32 sec total, 401.93 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 1123.80 GB/s
FLOPS achieved: 37.09 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2705 sec
Average prefill latency: 0.0490 sec
Average tokens/sec: 399.95
Memory used: 7.42 GB
Done. we are killing the process
