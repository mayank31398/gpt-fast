W1001 20:29:19.564000 22883085715264 torch/distributed/run.py:779] 
W1001 20:29:19.564000 22883085715264 torch/distributed/run.py:779] *****************************************
W1001 20:29:19.564000 22883085715264 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:29:19.564000 22883085715264 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.15 seconds
Prefill latency: 0.16325390408746898 sec
Decode latency: 0.3303157560294494 sec
Compilation time: 0.51 seconds
Compilation time: 0.49 seconds
Compilation time: 0.50 seconds
Compilation time: 0.49 seconds
Compilation time: 0.49 secondsCompilation time: 0.49 seconds

Compilation time: 0.49 seconds
Compilation time: 0.53 seconds
Prefill latency: 0.15537262696307153 sec
Decode latency: 0.3247611530823633 sec
Prefill latency: 0.15405562601517886 sec
Decode latency: 0.3328928699484095 sec
Prefill latency: 0.15389981598127633 sec
Decode latency: 0.32339710800442845 sec
Prefill latency: 0.15586567297577858 sec
Decode latency: 0.32505826302804053 sec
Prefill latency: 0.153599563986063 sec
Decode latency: 0.31972150306683034 sec
Time for inference 1: 0.47 sec total, 1080.21 tokens/sec
Decode latency: 0.32 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 3020.32 GB/s
FLOPS achieved: 99.67 TF/s

Prefill latency: 0.15379040804691613 sec
Decode latency: 0.3164556419942528 sec
Time for inference 2: 0.47 sec total, 1087.32 tokens/sec
Decode latency: 0.32 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 3040.19 GB/s
FLOPS achieved: 100.33 TF/s

Prefill latency: 0.15407364803832024 sec
Decode latency: 0.32747239200398326 sec
Time for inference 3: 0.48 sec total, 1061.97 tokens/sec
Decode latency: 0.33 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2969.30 GB/s
FLOPS achieved: 97.99 TF/s

Prefill latency: 0.154373608995229 sec
Decode latency: 0.3244839960243553 sec
Time for inference 4: 0.48 sec total, 1067.90 tokens/sec
Decode latency: 0.32 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2985.90 GB/s
FLOPS achieved: 98.53 TF/s

Prefill latency: 0.15427074604667723 sec
Decode latency: 0.3318987030070275 sec
Time for inference 5: 0.49 sec total, 1051.83 tokens/sec
Decode latency: 0.33 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2940.96 GB/s
FLOPS achieved: 97.05 TF/s

Prefill latency: 0.154282886069268 sec
Decode latency: 0.32949655794072896 sec
Time for inference 6: 0.48 sec total, 1057.06 tokens/sec
Decode latency: 0.33 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2955.58 GB/s
FLOPS achieved: 97.53 TF/s

Prefill latency: 0.15356173098552972 sec
Decode latency: 0.326467692037113 sec
Time for inference 7: 0.48 sec total, 1065.16 tokens/sec
Decode latency: 0.33 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2978.24 GB/s
FLOPS achieved: 98.28 TF/s

Prefill latency: 0.15385678398888558 sec
Decode latency: 0.3247974659316242 sec
Time for inference 8: 0.48 sec total, 1067.89 tokens/sec
Decode latency: 0.32 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2985.86 GB/s
FLOPS achieved: 98.53 TF/s

Prefill latency: 0.15410353895276785 sec
Decode latency: 0.32157935900613666 sec
Time for inference 9: 0.48 sec total, 1074.91 tokens/sec
Decode latency: 0.32 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 3005.48 GB/s
FLOPS achieved: 99.18 TF/s

Prefill latency: 0.15283880895003676 sec
Decode latency: 0.32714357099030167 sec
Time for inference 10: 0.48 sec total, 1065.09 tokens/sec
Decode latency: 0.33 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 2978.03 GB/s
FLOPS achieved: 98.27 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.3250 sec
Average prefill latency: 0.1539 sec
Average tokens/sec: 1067.94
Memory used: 17.91 GB
Done. we are killing the process
