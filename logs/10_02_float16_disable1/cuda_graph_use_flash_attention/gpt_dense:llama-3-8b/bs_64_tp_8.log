W1001 20:31:05.651000 22379286107968 torch/distributed/run.py:779] 
W1001 20:31:05.651000 22379286107968 torch/distributed/run.py:779] *****************************************
W1001 20:31:05.651000 22379286107968 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:31:05.651000 22379286107968 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.20 seconds
Prefill latency: 0.6439134639222175 sec
Decode latency: 0.3527088499395177 sec
Compilation time: 0.97 seconds
Compilation time: 0.98 seconds
Compilation time: 0.97 seconds
Compilation time: 1.00 seconds
Compilation time: 1.00 seconds
Compilation time: 1.00 seconds
Compilation time: 1.00 seconds
Compilation time: 0.97 seconds
Prefill latency: 0.5912503129802644 sec
Decode latency: 0.3474453380331397 sec
Prefill latency: 0.5923921089852229 sec
Decode latency: 0.3651019179960713 sec
Prefill latency: 0.5908965299604461 sec
Decode latency: 0.3666223989566788 sec
Prefill latency: 0.58585548796691 sec
Decode latency: 0.3602141620358452 sec
Prefill latency: 0.5900453568901867 sec
Decode latency: 0.3638381930068135 sec
Time for inference 1: 0.95 sec total, 2145.70 tokens/sec
Decode latency: 0.36 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5999.45 GB/s
FLOPS achieved: 197.98 TF/s

Prefill latency: 0.5916578799951822 sec
Decode latency: 0.36585293407551944 sec
Time for inference 2: 0.96 sec total, 2137.41 tokens/sec
Decode latency: 0.37 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5976.28 GB/s
FLOPS achieved: 197.22 TF/s

Prefill latency: 0.5932853240519762 sec
Decode latency: 0.377656765980646 sec
Time for inference 3: 0.97 sec total, 2107.93 tokens/sec
Decode latency: 0.38 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5893.84 GB/s
FLOPS achieved: 194.50 TF/s

Prefill latency: 0.5852570229908451 sec
Decode latency: 0.36122323805466294 sec
Time for inference 4: 0.95 sec total, 2162.49 tokens/sec
Decode latency: 0.36 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 6046.40 GB/s
FLOPS achieved: 199.53 TF/s

Prefill latency: 0.5910333569627255 sec
Decode latency: 0.36587992298882455 sec
Time for inference 5: 0.96 sec total, 2138.86 tokens/sec
Decode latency: 0.37 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5980.34 GB/s
FLOPS achieved: 197.35 TF/s

Prefill latency: 0.587855817982927 sec
Decode latency: 0.36378553800750524 sec
Time for inference 6: 0.95 sec total, 2150.72 tokens/sec
Decode latency: 0.36 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 6013.48 GB/s
FLOPS achieved: 198.44 TF/s

Prefill latency: 0.5915004200069234 sec
Decode latency: 0.3654101639986038 sec
Time for inference 7: 0.96 sec total, 2138.74 tokens/sec
Decode latency: 0.37 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5979.99 GB/s
FLOPS achieved: 197.34 TF/s

Prefill latency: 0.5906846929574385 sec
Decode latency: 0.36459494393784553 sec
Time for inference 8: 0.96 sec total, 2142.83 tokens/sec
Decode latency: 0.36 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5991.42 GB/s
FLOPS achieved: 197.72 TF/s

Prefill latency: 0.5860778520582244 sec
Decode latency: 0.3594646449200809 sec
Time for inference 9: 0.95 sec total, 2164.68 tokens/sec
Decode latency: 0.36 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 6052.51 GB/s
FLOPS achieved: 199.73 TF/s

Prefill latency: 0.5909135550027713 sec
Decode latency: 0.37522505898959935 sec
Time for inference 10: 0.97 sec total, 2118.61 tokens/sec
Decode latency: 0.38 sec
Prefill latency: 0.59 sec
Bandwidth achieved: 5923.72 GB/s
FLOPS achieved: 195.48 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.3663 sec
Average prefill latency: 0.5898 sec
Average tokens/sec: 2140.80
Memory used: 65.03 GB
Done. we are killing the process
