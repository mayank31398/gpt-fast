flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.14 seconds
Prefill latency: 0.03418108192272484 sec
Decode latency: 0.26815610798075795 sec
Compilation time: 0.30 seconds
Prefill latency: 0.03405022108927369 sec
Decode latency: 0.2673548510065302 sec
Prefill latency: 0.03404082800261676 sec
Decode latency: 0.2672235789941624 sec
Prefill latency: 0.034017518046312034 sec
Decode latency: 0.270276655908674 sec
Prefill latency: 0.03400584706105292 sec
Decode latency: 0.2686745940009132 sec
Prefill latency: 0.033920396002940834 sec
Decode latency: 0.26788181997835636 sec
Time for inference 1: 0.30 sec total, 105.90 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1589.60 GB/s
FLOPS achieved: 52.46 TF/s

Prefill latency: 0.03394328395370394 sec
Decode latency: 0.2684987320099026 sec
Time for inference 2: 0.30 sec total, 105.67 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1586.14 GB/s
FLOPS achieved: 52.34 TF/s

Prefill latency: 0.03396793408319354 sec
Decode latency: 0.2675340040586889 sec
Time for inference 3: 0.30 sec total, 106.00 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1591.03 GB/s
FLOPS achieved: 52.50 TF/s

Prefill latency: 0.03394241107162088 sec
Decode latency: 0.2687651449814439 sec
Time for inference 4: 0.30 sec total, 105.58 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1584.75 GB/s
FLOPS achieved: 52.30 TF/s

Prefill latency: 0.03397748805582523 sec
Decode latency: 0.2703754890244454 sec
Time for inference 5: 0.30 sec total, 105.01 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1576.16 GB/s
FLOPS achieved: 52.01 TF/s

Prefill latency: 0.03407363500446081 sec
Decode latency: 0.2684857939602807 sec
Time for inference 6: 0.30 sec total, 105.63 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1585.45 GB/s
FLOPS achieved: 52.32 TF/s

Prefill latency: 0.03392646601423621 sec
Decode latency: 0.26880002894904464 sec
Time for inference 7: 0.30 sec total, 105.57 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1584.66 GB/s
FLOPS achieved: 52.29 TF/s

Prefill latency: 0.03396687202621251 sec
Decode latency: 0.2665675029857084 sec
Time for inference 8: 0.30 sec total, 106.34 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1596.15 GB/s
FLOPS achieved: 52.67 TF/s

Prefill latency: 0.03386522002983838 sec
Decode latency: 0.26720717607531697 sec
Time for inference 9: 0.30 sec total, 106.14 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1593.11 GB/s
FLOPS achieved: 52.57 TF/s

Prefill latency: 0.03393505502026528 sec
Decode latency: 0.2707477529766038 sec
Time for inference 10: 0.31 sec total, 104.89 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1574.41 GB/s
FLOPS achieved: 51.96 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2685 sec
Average prefill latency: 0.0340 sec
Average tokens/sec: 105.67
Memory used: 17.39 GB
Done. we are killing the process
