W1001 20:27:06.588000 22747601307456 torch/distributed/run.py:779] 
W1001 20:27:06.588000 22747601307456 torch/distributed/run.py:779] *****************************************
W1001 20:27:06.588000 22747601307456 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:27:06.588000 22747601307456 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.02 seconds
Prefill latency: 0.23562236200086772 sec
Decode latency: 0.2517988410545513 sec
Compilation time: 0.49 seconds
Compilation time: 0.49 seconds
Prefill latency: 0.21737456298433244 sec
Decode latency: 0.2514078040840104 sec
Prefill latency: 0.21729445201344788 sec
Decode latency: 0.25170816003810614 sec
Prefill latency: 0.21763419697526842 sec
Decode latency: 0.25146504398435354 sec
Prefill latency: 0.21694875496905297 sec
Decode latency: 0.2510605560382828 sec
Prefill latency: 0.21760964998975396 sec
Decode latency: 0.25124476000200957 sec
Time for inference 1: 0.47 sec total, 272.76 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2190.44 GB/s
FLOPS achieved: 72.28 TF/s

Prefill latency: 0.21754166798200458 sec
Decode latency: 0.25154625601135194 sec
Time for inference 2: 0.47 sec total, 272.58 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2188.98 GB/s
FLOPS achieved: 72.24 TF/s

Prefill latency: 0.21777719201054424 sec
Decode latency: 0.2514415670884773 sec
Time for inference 3: 0.47 sec total, 272.51 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2188.39 GB/s
FLOPS achieved: 72.22 TF/s

Prefill latency: 0.21755577600561082 sec
Decode latency: 0.2512466770131141 sec
Time for inference 4: 0.47 sec total, 272.73 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2190.19 GB/s
FLOPS achieved: 72.28 TF/s

Prefill latency: 0.21776754001621157 sec
Decode latency: 0.25131587497889996 sec
Time for inference 5: 0.47 sec total, 272.59 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2189.02 GB/s
FLOPS achieved: 72.24 TF/s

Prefill latency: 0.2177644990151748 sec
Decode latency: 0.25168990809470415 sec
Time for inference 6: 0.47 sec total, 272.40 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2187.48 GB/s
FLOPS achieved: 72.19 TF/s

Prefill latency: 0.2179147700080648 sec
Decode latency: 0.2514569900231436 sec
Time for inference 7: 0.47 sec total, 272.46 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2187.99 GB/s
FLOPS achieved: 72.20 TF/s

Prefill latency: 0.21755432209465653 sec
Decode latency: 0.25108050904236734 sec
Time for inference 8: 0.47 sec total, 272.84 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2191.08 GB/s
FLOPS achieved: 72.31 TF/s

Prefill latency: 0.2178143650526181 sec
Decode latency: 0.2513163749827072 sec
Time for inference 9: 0.47 sec total, 272.58 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2188.96 GB/s
FLOPS achieved: 72.24 TF/s

Prefill latency: 0.21790076605975628 sec
Decode latency: 0.2514923569979146 sec
Time for inference 10: 0.47 sec total, 272.43 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.22 sec
Bandwidth achieved: 2187.77 GB/s
FLOPS achieved: 72.20 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2514 sec
Average prefill latency: 0.2177 sec
Average tokens/sec: 272.59
Memory used: 14.69 GB
Done. we are killing the process
