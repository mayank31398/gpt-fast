W1002 00:32:58.833000 23149677664064 torch/distributed/run.py:779] 
W1002 00:32:58.833000 23149677664064 torch/distributed/run.py:779] *****************************************
W1002 00:32:58.833000 23149677664064 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1002 00:32:58.833000 23149677664064 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.42 seconds
[rank5]:[W1002 00:33:14.508780716 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.7256412650458515 sec
Decode latency: 5.534918766003102 sec
Compilation time: 6.41 seconds
Compilation time: 6.49 seconds
Compilation time: 6.57 seconds
Compilation time: 6.26 seconds
Compilation time: 6.26 secondsCompilation time: 6.26 seconds

Compilation time: 6.26 seconds
Compilation time: 6.46 seconds
Prefill latency: 0.7145801989827305 sec
Decode latency: 5.482234086026438 sec
Prefill latency: 0.7162549070781097 sec
Decode latency: 5.485947159002535 sec
Prefill latency: 0.7135806529549882 sec
Decode latency: 5.491841068957001 sec
Prefill latency: 0.7186412980081514 sec
Decode latency: 5.4993045310257 sec
Prefill latency: 0.7196737800259143 sec
Decode latency: 5.4442518029827625 sec
Time for inference 1: 6.17 sec total, 664.37 tokens/sec
Decode latency: 5.44 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12766.95 GB/s
FLOPS achieved: 63.83 TF/s

Prefill latency: 0.7177592370426282 sec
Decode latency: 5.516881400020793 sec
Time for inference 2: 6.24 sec total, 656.84 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12622.29 GB/s
FLOPS achieved: 63.11 TF/s

Prefill latency: 0.7192726370412856 sec
Decode latency: 5.491568270022981 sec
Time for inference 3: 6.21 sec total, 659.36 tokens/sec
Decode latency: 5.49 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12670.67 GB/s
FLOPS achieved: 63.35 TF/s

Prefill latency: 0.7186635489342734 sec
Decode latency: 5.463503294042312 sec
Time for inference 4: 6.18 sec total, 662.41 tokens/sec
Decode latency: 5.46 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12729.42 GB/s
FLOPS achieved: 63.65 TF/s

Prefill latency: 0.7176796160638332 sec
Decode latency: 5.456391696003266 sec
Time for inference 5: 6.18 sec total, 663.24 tokens/sec
Decode latency: 5.46 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12745.29 GB/s
FLOPS achieved: 63.73 TF/s

Prefill latency: 0.7172225510003045 sec
Decode latency: 5.4724935569101945 sec
Time for inference 6: 6.19 sec total, 661.58 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12713.37 GB/s
FLOPS achieved: 63.57 TF/s

Prefill latency: 0.7156571659725159 sec
Decode latency: 5.479535849997774 sec
Time for inference 7: 6.20 sec total, 661.02 tokens/sec
Decode latency: 5.48 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12702.60 GB/s
FLOPS achieved: 63.51 TF/s

Prefill latency: 0.7167594549246132 sec
Decode latency: 5.470478404080495 sec
Time for inference 8: 6.19 sec total, 661.87 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12719.05 GB/s
FLOPS achieved: 63.60 TF/s

Prefill latency: 0.7188981180079281 sec
Decode latency: 5.5028461109614 sec
Time for inference 9: 6.22 sec total, 658.20 tokens/sec
Decode latency: 5.50 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12648.40 GB/s
FLOPS achieved: 63.24 TF/s

Prefill latency: 0.7185131770092994 sec
Decode latency: 5.4661852980498224 sec
Time for inference 10: 6.19 sec total, 662.12 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 12723.81 GB/s
FLOPS achieved: 63.62 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.4764 sec
Average prefill latency: 0.7180 sec
Average tokens/sec: 661.10
Memory used: 71.11 GB
Done. we are killing the process
