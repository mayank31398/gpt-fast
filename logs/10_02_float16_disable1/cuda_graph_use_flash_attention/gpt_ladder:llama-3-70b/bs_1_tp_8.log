W1001 21:19:31.658000 23408777250624 torch/distributed/run.py:779] 
W1001 21:19:31.658000 23408777250624 torch/distributed/run.py:779] *****************************************
W1001 21:19:31.658000 23408777250624 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 21:19:31.658000 23408777250624 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 0.43 seconds
Prefill latency: 0.10114511696156114 sec
Decode latency: 3.869812770979479 sec
Compilation time: 3.98 seconds
Compilation time: 3.97 seconds
Compilation time: 3.97 secondsCompilation time: 3.95 seconds

Compilation time: 3.98 seconds
Compilation time: 3.97 seconds
Compilation time: 3.96 seconds
Compilation time: 3.96 seconds
Prefill latency: 0.06769970303867012 sec
Decode latency: 3.8929622439900413 sec
Prefill latency: 0.06705708999652416 sec
Decode latency: 3.8965864399215207 sec
Prefill latency: 0.06809697393327951 sec
Decode latency: 3.8893053350038826 sec
Prefill latency: 0.06857839704025537 sec
Decode latency: 3.8819564488949254 sec
Prefill latency: 0.0671030730009079 sec
Decode latency: 3.881326792994514 sec
Time for inference 1: 3.95 sec total, 64.82 tokens/sec
Decode latency: 3.88 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1245.60 GB/s
FLOPS achieved: 6.23 TF/s

Prefill latency: 0.06759103189688176 sec
Decode latency: 3.885471875080839 sec
Time for inference 2: 3.95 sec total, 64.74 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1244.11 GB/s
FLOPS achieved: 6.22 TF/s

Prefill latency: 0.067561274045147 sec
Decode latency: 3.891710515948944 sec
Time for inference 3: 3.96 sec total, 64.64 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1242.19 GB/s
FLOPS achieved: 6.21 TF/s

Prefill latency: 0.06718335195910186 sec
Decode latency: 3.894176511093974 sec
Time for inference 4: 3.96 sec total, 64.60 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1241.48 GB/s
FLOPS achieved: 6.21 TF/s

Prefill latency: 0.06776977807749063 sec
Decode latency: 3.8896947079338133 sec
Time for inference 5: 3.96 sec total, 64.67 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1242.65 GB/s
FLOPS achieved: 6.21 TF/s

Prefill latency: 0.0727280699647963 sec
Decode latency: 3.891274939989671 sec
Time for inference 6: 3.97 sec total, 64.55 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1240.53 GB/s
FLOPS achieved: 6.20 TF/s

Prefill latency: 0.06746288493741304 sec
Decode latency: 3.885003168019466 sec
Time for inference 7: 3.95 sec total, 64.75 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1244.32 GB/s
FLOPS achieved: 6.22 TF/s

Prefill latency: 0.07697760395240039 sec
Decode latency: 3.8771118680015206 sec
Time for inference 8: 3.96 sec total, 64.73 tokens/sec
Decode latency: 3.88 sec
Prefill latency: 0.08 sec
Bandwidth achieved: 1243.81 GB/s
FLOPS achieved: 6.22 TF/s

Prefill latency: 0.06991651398129761 sec
Decode latency: 3.888797826017253 sec
Time for inference 9: 3.96 sec total, 64.65 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1242.33 GB/s
FLOPS achieved: 6.21 TF/s

Prefill latency: 0.06745463598053902 sec
Decode latency: 3.888504847069271 sec
Time for inference 10: 3.96 sec total, 64.69 tokens/sec
Decode latency: 3.89 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 1243.21 GB/s
FLOPS achieved: 6.22 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8873 sec
Average prefill latency: 0.0692 sec
Average tokens/sec: 64.68
Memory used: 24.88 GB
Done. we are killing the process
