W1001 20:48:36.229000 23436463605568 torch/distributed/run.py:779] 
W1001 20:48:36.229000 23436463605568 torch/distributed/run.py:779] *****************************************
W1001 20:48:36.229000 23436463605568 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:48:36.229000 23436463605568 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.99 seconds
Prefill latency: 0.12748635606840253 sec
Decode latency: 0.17418270593043417 sec
Compilation time: 0.26 seconds
Compilation time: 0.27 seconds
Compilation time: 0.24 seconds
Compilation time: 0.21 secondsCompilation time: 0.25 seconds

Compilation time: 0.25 secondsCompilation time: 0.25 seconds

Compilation time: 0.30 seconds
Prefill latency: 0.03358563000801951 sec
Decode latency: 0.17351234110537916 sec
Prefill latency: 0.033809221000410616 sec
Decode latency: 0.17186113097704947 sec
Prefill latency: 0.03386257600504905 sec
Decode latency: 0.175246802973561 sec
Prefill latency: 0.034069176064804196 sec
Decode latency: 0.1711725649656728 sec
Prefill latency: 0.034223982016555965 sec
Decode latency: 0.17135573900304735 sec
Time for inference 1: 0.21 sec total, 620.92 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1736.12 GB/s
FLOPS achieved: 57.29 TF/s

Prefill latency: 0.033863594988361 sec
Decode latency: 0.1713147850241512 sec
Time for inference 2: 0.21 sec total, 622.02 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1739.18 GB/s
FLOPS achieved: 57.39 TF/s

Prefill latency: 0.033344676019623876 sec
Decode latency: 0.17279123701155186 sec
Time for inference 3: 0.21 sec total, 619.15 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1731.16 GB/s
FLOPS achieved: 57.13 TF/s

Prefill latency: 0.03387957694940269 sec
Decode latency: 0.17246730695478618 sec
Time for inference 4: 0.21 sec total, 618.58 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1729.56 GB/s
FLOPS achieved: 57.08 TF/s

Prefill latency: 0.0338178490055725 sec
Decode latency: 0.17341590498108417 sec
Time for inference 5: 0.21 sec total, 616.07 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1722.55 GB/s
FLOPS achieved: 56.84 TF/s

Prefill latency: 0.034784632967785 sec
Decode latency: 0.17332107294350863 sec
Time for inference 6: 0.21 sec total, 613.71 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1715.96 GB/s
FLOPS achieved: 56.63 TF/s

Prefill latency: 0.03378182393498719 sec
Decode latency: 0.17927604704163969 sec
Time for inference 7: 0.21 sec total, 599.25 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1675.52 GB/s
FLOPS achieved: 55.29 TF/s

Prefill latency: 0.0343609870178625 sec
Decode latency: 0.17579723603557795 sec
Time for inference 8: 0.21 sec total, 606.91 tokens/sec
Decode latency: 0.18 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1696.94 GB/s
FLOPS achieved: 56.00 TF/s

Prefill latency: 0.03368208999745548 sec
Decode latency: 0.17289213300682604 sec
Time for inference 9: 0.21 sec total, 615.44 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1720.78 GB/s
FLOPS achieved: 56.79 TF/s

Prefill latency: 0.033472485025413334 sec
Decode latency: 0.17245031404308975 sec
Time for inference 10: 0.21 sec total, 619.48 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1732.09 GB/s
FLOPS achieved: 57.16 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1735 sec
Average prefill latency: 0.0339 sec
Average tokens/sec: 615.15
Memory used: 5.84 GB
Done. we are killing the process
