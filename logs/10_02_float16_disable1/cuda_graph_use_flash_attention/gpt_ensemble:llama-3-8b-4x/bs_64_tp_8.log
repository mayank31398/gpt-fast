W1001 20:51:20.973000 23237293070144 torch/distributed/run.py:779] 
W1001 20:51:20.973000 23237293070144 torch/distributed/run.py:779] *****************************************
W1001 20:51:20.973000 23237293070144 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:51:20.973000 23237293070144 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.16 seconds
Prefill latency: 0.46243633795529604 sec
Decode latency: 0.2307281969115138 sec
Compilation time: 0.69 seconds
Compilation time: 0.69 secondsCompilation time: 0.69 seconds

Compilation time: 0.69 seconds
Compilation time: 0.69 secondsCompilation time: 0.69 seconds

Compilation time: 0.69 seconds
Compilation time: 0.69 seconds
Prefill latency: 0.45955558796413243 sec
Decode latency: 0.22350092499982566 sec
Prefill latency: 0.45947703102137893 sec
Decode latency: 0.22405418602284044 sec
Prefill latency: 0.4557855239836499 sec
Decode latency: 0.2397408370161429 sec
Prefill latency: 0.4589565210044384 sec
Decode latency: 0.22542067698668689 sec
Prefill latency: 0.45956965698860586 sec
Decode latency: 0.23217233701143414 sec
Time for inference 1: 0.69 sec total, 2958.70 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8272.64 GB/s
FLOPS achieved: 273.00 TF/s

Prefill latency: 0.4594357270980254 sec
Decode latency: 0.22580426500644535 sec
Time for inference 2: 0.69 sec total, 2986.46 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8350.25 GB/s
FLOPS achieved: 275.56 TF/s

Prefill latency: 0.45825021795462817 sec
Decode latency: 0.2248487239703536 sec
Time for inference 3: 0.68 sec total, 2995.27 tokens/sec
Decode latency: 0.22 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8374.89 GB/s
FLOPS achieved: 276.37 TF/s

Prefill latency: 0.45797004003543407 sec
Decode latency: 0.22619187808595598 sec
Time for inference 4: 0.68 sec total, 2990.66 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8361.99 GB/s
FLOPS achieved: 275.95 TF/s

Prefill latency: 0.4596421830356121 sec
Decode latency: 0.23115129803773016 sec
Time for inference 5: 0.69 sec total, 2961.83 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8281.37 GB/s
FLOPS achieved: 273.29 TF/s

Prefill latency: 0.4601200569886714 sec
Decode latency: 0.2228693689685315 sec
Time for inference 6: 0.68 sec total, 2995.24 tokens/sec
Decode latency: 0.22 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8374.81 GB/s
FLOPS achieved: 276.37 TF/s

Prefill latency: 0.4597857710905373 sec
Decode latency: 0.23220198298804462 sec
Time for inference 7: 0.69 sec total, 2956.24 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8265.74 GB/s
FLOPS achieved: 272.77 TF/s

Prefill latency: 0.4617997939931229 sec
Decode latency: 0.22654544096440077 sec
Time for inference 8: 0.69 sec total, 2972.03 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8309.91 GB/s
FLOPS achieved: 274.23 TF/s

Prefill latency: 0.4600873379968107 sec
Decode latency: 0.22941311600152403 sec
Time for inference 9: 0.69 sec total, 2967.76 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8297.96 GB/s
FLOPS achieved: 273.83 TF/s

Prefill latency: 0.4573627910576761 sec
Decode latency: 0.229982805904001 sec
Time for inference 10: 0.69 sec total, 2977.19 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.46 sec
Bandwidth achieved: 8324.32 GB/s
FLOPS achieved: 274.70 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2281 sec
Average prefill latency: 0.4594 sec
Average tokens/sec: 2976.14
Memory used: 34.41 GB
Done. we are killing the process
