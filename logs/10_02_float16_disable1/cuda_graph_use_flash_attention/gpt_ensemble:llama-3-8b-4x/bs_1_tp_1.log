flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.03406958607956767 sec
Decode latency: 0.26466188894119114 sec
Compilation time: 0.30 seconds
Prefill latency: 0.03381206595804542 sec
Decode latency: 0.2636883850209415 sec
Prefill latency: 0.033734800992533565 sec
Decode latency: 0.2640943090664223 sec
Prefill latency: 0.03377166704740375 sec
Decode latency: 0.264402766013518 sec
Prefill latency: 0.03376725607085973 sec
Decode latency: 0.2594854140188545 sec
Prefill latency: 0.03391054703388363 sec
Decode latency: 0.2642217450775206 sec
Time for inference 1: 0.30 sec total, 107.19 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1608.83 GB/s
FLOPS achieved: 53.09 TF/s

Prefill latency: 0.03392317099496722 sec
Decode latency: 0.2656274129403755 sec
Time for inference 2: 0.30 sec total, 106.69 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1601.33 GB/s
FLOPS achieved: 52.84 TF/s

Prefill latency: 0.033891947008669376 sec
Decode latency: 0.26397744193673134 sec
Time for inference 3: 0.30 sec total, 107.29 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1610.43 GB/s
FLOPS achieved: 53.14 TF/s

Prefill latency: 0.03385507105849683 sec
Decode latency: 0.2639561400283128 sec
Time for inference 4: 0.30 sec total, 107.31 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1610.77 GB/s
FLOPS achieved: 53.16 TF/s

Prefill latency: 0.03373728191945702 sec
Decode latency: 0.2638251839671284 sec
Time for inference 5: 0.30 sec total, 107.41 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1612.18 GB/s
FLOPS achieved: 53.20 TF/s

Prefill latency: 0.03383065096568316 sec
Decode latency: 0.264386469963938 sec
Time for inference 6: 0.30 sec total, 107.16 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1608.50 GB/s
FLOPS achieved: 53.08 TF/s

Prefill latency: 0.033795773051679134 sec
Decode latency: 0.2663229960016906 sec
Time for inference 7: 0.30 sec total, 106.49 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1598.33 GB/s
FLOPS achieved: 52.74 TF/s

Prefill latency: 0.03381254698615521 sec
Decode latency: 0.26624400296714157 sec
Time for inference 8: 0.30 sec total, 106.50 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1598.62 GB/s
FLOPS achieved: 52.75 TF/s

Prefill latency: 0.033826465951278806 sec
Decode latency: 0.2642628400353715 sec
Time for inference 9: 0.30 sec total, 107.21 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1609.22 GB/s
FLOPS achieved: 53.10 TF/s

Prefill latency: 0.033813855960033834 sec
Decode latency: 0.2646576859988272 sec
Time for inference 10: 0.30 sec total, 107.07 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1607.09 GB/s
FLOPS achieved: 53.03 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2647 sec
Average prefill latency: 0.0338 sec
Average tokens/sec: 107.03
Memory used: 16.92 GB
Done. we are killing the process
