flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.03348039404954761 sec
Decode latency: 0.26903941691853106 sec
Compilation time: 0.30 seconds
Prefill latency: 0.03308236296288669 sec
Decode latency: 0.2682815360603854 sec
Prefill latency: 0.03308560699224472 sec
Decode latency: 0.26887491100933403 sec
Prefill latency: 0.03315183101221919 sec
Decode latency: 0.26889909396413714 sec
Prefill latency: 0.03315820905845612 sec
Decode latency: 0.268282686942257 sec
Prefill latency: 0.03305162605829537 sec
Decode latency: 0.26942780101671815 sec
Time for inference 1: 0.30 sec total, 105.61 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1585.13 GB/s
FLOPS achieved: 52.31 TF/s

Prefill latency: 0.03311168507207185 sec
Decode latency: 0.26908609189558774 sec
Time for inference 2: 0.30 sec total, 105.74 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1587.06 GB/s
FLOPS achieved: 52.37 TF/s

Prefill latency: 0.03316291596274823 sec
Decode latency: 0.26914205111097544 sec
Time for inference 3: 0.30 sec total, 105.71 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1586.63 GB/s
FLOPS achieved: 52.36 TF/s

Prefill latency: 0.033139419043436646 sec
Decode latency: 0.2689207090297714 sec
Time for inference 4: 0.30 sec total, 105.77 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1587.58 GB/s
FLOPS achieved: 52.39 TF/s

Prefill latency: 0.03316450398415327 sec
Decode latency: 0.2689486510353163 sec
Time for inference 5: 0.30 sec total, 105.78 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1587.74 GB/s
FLOPS achieved: 52.40 TF/s

Prefill latency: 0.0331152870785445 sec
Decode latency: 0.2688237800030038 sec
Time for inference 6: 0.30 sec total, 105.85 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1588.70 GB/s
FLOPS achieved: 52.43 TF/s

Prefill latency: 0.03314256691373885 sec
Decode latency: 0.2690121359191835 sec
Time for inference 7: 0.30 sec total, 105.76 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1587.46 GB/s
FLOPS achieved: 52.39 TF/s

Prefill latency: 0.03313831007108092 sec
Decode latency: 0.2692567720077932 sec
Time for inference 8: 0.30 sec total, 105.68 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1586.21 GB/s
FLOPS achieved: 52.35 TF/s

Prefill latency: 0.033169033005833626 sec
Decode latency: 0.26859466498717666 sec
Time for inference 9: 0.30 sec total, 105.90 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1589.57 GB/s
FLOPS achieved: 52.46 TF/s

Prefill latency: 0.033159915008582175 sec
Decode latency: 0.26921191497240216 sec
Time for inference 10: 0.30 sec total, 105.70 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 1586.45 GB/s
FLOPS achieved: 52.35 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2690 sec
Average prefill latency: 0.0331 sec
Average tokens/sec: 105.75
Memory used: 17.09 GB
Done. we are killing the process
