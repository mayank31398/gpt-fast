W1001 20:40:47.533000 23400296322880 torch/distributed/run.py:779] 
W1001 20:40:47.533000 23400296322880 torch/distributed/run.py:779] *****************************************
W1001 20:40:47.533000 23400296322880 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:40:47.533000 23400296322880 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=4352, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.49518884799908847 sec
Decode latency: 0.2727798509877175 sec
Compilation time: 0.76 secondsCompilation time: 0.77 secondsCompilation time: 0.77 seconds


Compilation time: 0.76 secondsCompilation time: 0.77 seconds

Compilation time: 0.77 seconds
Compilation time: 0.76 seconds
Compilation time: 0.77 seconds
Prefill latency: 0.48343730298802257 sec
Decode latency: 0.26388785196468234 sec
Prefill latency: 0.48517385800369084 sec
Decode latency: 0.25604841497261077 sec
Prefill latency: 0.48811961500905454 sec
Decode latency: 0.2626007959479466 sec
Prefill latency: 0.4820397720905021 sec
Decode latency: 0.26839450700208545 sec
Prefill latency: 0.4882874779868871 sec
Decode latency: 0.2683433180209249 sec
Time for inference 1: 0.76 sec total, 2704.85 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7562.14 GB/s
FLOPS achieved: 249.55 TF/s

Prefill latency: 0.48641823104117066 sec
Decode latency: 0.2596769619267434 sec
Time for inference 2: 0.75 sec total, 2742.79 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7668.22 GB/s
FLOPS achieved: 253.05 TF/s

Prefill latency: 0.4872880131006241 sec
Decode latency: 0.2577990429708734 sec
Time for inference 3: 0.75 sec total, 2746.40 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7678.31 GB/s
FLOPS achieved: 253.38 TF/s

Prefill latency: 0.48324885102920234 sec
Decode latency: 0.26551531499717385 sec
Time for inference 4: 0.75 sec total, 2733.08 tokens/sec
Decode latency: 0.27 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 7641.08 GB/s
FLOPS achieved: 252.16 TF/s

Prefill latency: 0.4900952070020139 sec
Decode latency: 0.25236129597760737 sec
Time for inference 5: 0.74 sec total, 2756.44 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7706.39 GB/s
FLOPS achieved: 254.31 TF/s

Prefill latency: 0.48318683507386595 sec
Decode latency: 0.26200186903588474 sec
Time for inference 6: 0.75 sec total, 2745.27 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.48 sec
Bandwidth achieved: 7675.15 GB/s
FLOPS achieved: 253.28 TF/s

Prefill latency: 0.48980266007129103 sec
Decode latency: 0.2528096140595153 sec
Time for inference 7: 0.74 sec total, 2755.14 tokens/sec
Decode latency: 0.25 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7702.76 GB/s
FLOPS achieved: 254.19 TF/s

Prefill latency: 0.488433585036546 sec
Decode latency: 0.2592310189502314 sec
Time for inference 8: 0.75 sec total, 2736.96 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7651.92 GB/s
FLOPS achieved: 252.51 TF/s

Prefill latency: 0.4866799300070852 sec
Decode latency: 0.25749713694676757 sec
Time for inference 9: 0.74 sec total, 2749.95 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7688.23 GB/s
FLOPS achieved: 253.71 TF/s

Prefill latency: 0.48607956408523023 sec
Decode latency: 0.26193463697563857 sec
Time for inference 10: 0.75 sec total, 2735.80 tokens/sec
Decode latency: 0.26 sec
Prefill latency: 0.49 sec
Bandwidth achieved: 7648.67 GB/s
FLOPS achieved: 252.41 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2597 sec
Average prefill latency: 0.4870 sec
Average tokens/sec: 2740.67
Memory used: 55.43 GB
Done. we are killing the process
