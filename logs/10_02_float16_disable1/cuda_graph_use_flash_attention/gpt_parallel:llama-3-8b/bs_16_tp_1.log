flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTParallel(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x ParallelTransformerBlock(
      semi_compiled = False
      (attention): FuseAttentionMLP(
        (wqkv1): Linear(in_features=4096, out_features=34816, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.91 seconds
Prefill latency: 0.5269281809451059 sec
Decode latency: 0.3119665529811755 sec
Compilation time: 0.84 seconds
Prefill latency: 0.5267336490796879 sec
Decode latency: 0.3127361700171605 sec
Prefill latency: 0.5267067130189389 sec
Decode latency: 0.3124298920156434 sec
Prefill latency: 0.5294129850808531 sec
Decode latency: 0.3120363230118528 sec
Prefill latency: 0.5265175700187683 sec
Decode latency: 0.3130261959740892 sec
Prefill latency: 0.5268027801066637 sec
Decode latency: 0.31252954597584903 sec
Time for inference 1: 0.84 sec total, 609.62 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9150.08 GB/s
FLOPS achieved: 301.95 TF/s

Prefill latency: 0.5274022819940001 sec
Decode latency: 0.312072864966467 sec
Time for inference 2: 0.84 sec total, 609.51 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9148.49 GB/s
FLOPS achieved: 301.90 TF/s

Prefill latency: 0.5262494010385126 sec
Decode latency: 0.31263105594553053 sec
Time for inference 3: 0.84 sec total, 609.94 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9154.94 GB/s
FLOPS achieved: 302.11 TF/s

Prefill latency: 0.5280377469025552 sec
Decode latency: 0.3124371899757534 sec
Time for inference 4: 0.84 sec total, 608.79 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9137.68 GB/s
FLOPS achieved: 301.54 TF/s

Prefill latency: 0.5286238839616999 sec
Decode latency: 0.3136714909924194 sec
Time for inference 5: 0.84 sec total, 607.46 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9117.72 GB/s
FLOPS achieved: 300.88 TF/s

Prefill latency: 0.5269199900794774 sec
Decode latency: 0.3118254489963874 sec
Time for inference 6: 0.84 sec total, 610.04 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9156.46 GB/s
FLOPS achieved: 302.16 TF/s

Prefill latency: 0.5278289309935644 sec
Decode latency: 0.3121550490614027 sec
Time for inference 7: 0.84 sec total, 609.15 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9143.06 GB/s
FLOPS achieved: 301.72 TF/s

Prefill latency: 0.5256113960640505 sec
Decode latency: 0.3121214610291645 sec
Time for inference 8: 0.84 sec total, 610.77 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9167.42 GB/s
FLOPS achieved: 302.52 TF/s

Prefill latency: 0.5271008600248024 sec
Decode latency: 0.311978011042811 sec
Time for inference 9: 0.84 sec total, 609.80 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9152.80 GB/s
FLOPS achieved: 302.04 TF/s

Prefill latency: 0.5283918810309842 sec
Decode latency: 0.3134541320614517 sec
Time for inference 10: 0.84 sec total, 607.78 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9122.50 GB/s
FLOPS achieved: 301.04 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.3125 sec
Average prefill latency: 0.5273 sec
Average tokens/sec: 609.28
Memory used: 30.37 GB
Done. we are killing the process
