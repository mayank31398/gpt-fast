W1001 20:22:42.204000 23097064019776 torch/distributed/run.py:779] 
W1001 20:22:42.204000 23097064019776 torch/distributed/run.py:779] *****************************************
W1001 20:22:42.204000 23097064019776 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:22:42.204000 23097064019776 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.15 seconds
Prefill latency: 0.6923882130067796 sec
Decode latency: 0.24005473195575178 sec
Compilation time: 0.93 seconds
Compilation time: 0.93 seconds
Prefill latency: 0.6516771710012108 sec
Decode latency: 0.23980114900041372 sec
Prefill latency: 0.6506292900303379 sec
Decode latency: 0.23877663805615157 sec
Prefill latency: 0.6505272659705952 sec
Decode latency: 0.23886850802227855 sec
Prefill latency: 0.6505594960181043 sec
Decode latency: 0.23878938506823033 sec
Prefill latency: 0.6526347929611802 sec
Decode latency: 0.24075358000118285 sec
Time for inference 1: 0.89 sec total, 572.76 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4599.59 GB/s
FLOPS achieved: 151.79 TF/s

Prefill latency: 0.6480697470251471 sec
Decode latency: 0.23909041797742248 sec
Time for inference 2: 0.89 sec total, 576.78 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4631.89 GB/s
FLOPS achieved: 152.85 TF/s

Prefill latency: 0.6511329060886055 sec
Decode latency: 0.24031239503528923 sec
Time for inference 3: 0.89 sec total, 574.03 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4609.78 GB/s
FLOPS achieved: 152.12 TF/s

Prefill latency: 0.6526066549122334 sec
Decode latency: 0.2393866489874199 sec
Time for inference 4: 0.89 sec total, 573.67 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4606.89 GB/s
FLOPS achieved: 152.03 TF/s

Prefill latency: 0.6548938850173727 sec
Decode latency: 0.23902071197517216 sec
Time for inference 5: 0.89 sec total, 572.45 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4597.04 GB/s
FLOPS achieved: 151.70 TF/s

Prefill latency: 0.6481882589869201 sec
Decode latency: 0.23972292302642018 sec
Time for inference 6: 0.89 sec total, 576.32 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4628.12 GB/s
FLOPS achieved: 152.73 TF/s

Prefill latency: 0.6522465120069683 sec
Decode latency: 0.2391433019656688 sec
Time for inference 7: 0.89 sec total, 574.05 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4609.95 GB/s
FLOPS achieved: 152.13 TF/s

Prefill latency: 0.6534785389667377 sec
Decode latency: 0.2400157629745081 sec
Time for inference 8: 0.89 sec total, 572.72 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4599.21 GB/s
FLOPS achieved: 151.77 TF/s

Prefill latency: 0.6533464810345322 sec
Decode latency: 0.23970120190642774 sec
Time for inference 9: 0.89 sec total, 573.00 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4601.47 GB/s
FLOPS achieved: 151.85 TF/s

Prefill latency: 0.654225863981992 sec
Decode latency: 0.23920269194059074 sec
Time for inference 10: 0.89 sec total, 572.76 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.65 sec
Bandwidth achieved: 4599.57 GB/s
FLOPS achieved: 151.79 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2396 sec
Average prefill latency: 0.6521 sec
Average tokens/sec: 573.85
Memory used: 30.78 GB
Done. we are killing the process
