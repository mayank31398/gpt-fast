W1001 20:21:46.686000 23183418419008 torch/distributed/run.py:779] 
W1001 20:21:46.686000 23183418419008 torch/distributed/run.py:779] *****************************************
W1001 20:21:46.686000 23183418419008 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:21:46.686000 23183418419008 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.25 seconds
Prefill latency: 0.0637551099061966 sec
Decode latency: 0.17226785607635975 sec
Compilation time: 0.22 seconds
Compilation time: 0.22 seconds
Compilation time: 0.23 seconds
Compilation time: 0.24 seconds
Prefill latency: 0.047679758979938924 sec
Decode latency: 0.17270533100236207 sec
Prefill latency: 0.04772411403246224 sec
Decode latency: 0.17303302290383726 sec
Prefill latency: 0.04778834106400609 sec
Decode latency: 0.1738526050467044 sec
Prefill latency: 0.04776360804680735 sec
Decode latency: 0.1732205260777846 sec
Prefill latency: 0.04780157492496073 sec
Decode latency: 0.1720820259070024 sec
Time for inference 1: 0.22 sec total, 580.49 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2635.93 GB/s
FLOPS achieved: 86.99 TF/s

Prefill latency: 0.047700346913188696 sec
Decode latency: 0.17217686190269887 sec
Time for inference 2: 0.22 sec total, 580.56 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2636.25 GB/s
FLOPS achieved: 87.00 TF/s

Prefill latency: 0.047614322043955326 sec
Decode latency: 0.17193946102634072 sec
Time for inference 3: 0.22 sec total, 581.52 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2640.63 GB/s
FLOPS achieved: 87.14 TF/s

Prefill latency: 0.04778898099903017 sec
Decode latency: 0.17267432203516364 sec
Time for inference 4: 0.22 sec total, 579.03 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2629.29 GB/s
FLOPS achieved: 86.77 TF/s

Prefill latency: 0.04789461090695113 sec
Decode latency: 0.17238432203885168 sec
Time for inference 5: 0.22 sec total, 579.35 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2630.74 GB/s
FLOPS achieved: 86.81 TF/s

Prefill latency: 0.04767310991883278 sec
Decode latency: 0.17232616909313947 sec
Time for inference 6: 0.22 sec total, 580.72 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2636.99 GB/s
FLOPS achieved: 87.02 TF/s

Prefill latency: 0.04773470701184124 sec
Decode latency: 0.17159670195542276 sec
Time for inference 7: 0.22 sec total, 582.17 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2643.55 GB/s
FLOPS achieved: 87.24 TF/s

Prefill latency: 0.0476659300038591 sec
Decode latency: 0.17212430201470852 sec
Time for inference 8: 0.22 sec total, 581.00 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2638.26 GB/s
FLOPS achieved: 87.06 TF/s

Prefill latency: 0.04769241297617555 sec
Decode latency: 0.17218798701651394 sec
Time for inference 9: 0.22 sec total, 580.75 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2637.10 GB/s
FLOPS achieved: 87.02 TF/s

Prefill latency: 0.04783957405015826 sec
Decode latency: 0.17252578202169389 sec
Time for inference 10: 0.22 sec total, 579.21 tokens/sec
Decode latency: 0.17 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2630.12 GB/s
FLOPS achieved: 86.79 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1722 sec
Average prefill latency: 0.0477 sec
Average tokens/sec: 580.48
Memory used: 10.14 GB
Done. we are killing the process
