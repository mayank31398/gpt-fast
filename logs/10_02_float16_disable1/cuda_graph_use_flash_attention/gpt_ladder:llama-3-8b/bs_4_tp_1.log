flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.29 seconds
Prefill latency: 0.13143834797665477 sec
Decode latency: 0.29019638104364276 sec
Compilation time: 0.42 seconds
Prefill latency: 0.1314433990046382 sec
Decode latency: 0.2889766850275919 sec
Prefill latency: 0.13092885504011065 sec
Decode latency: 0.28957102296408266 sec
Prefill latency: 0.1293085099896416 sec
Decode latency: 0.28964007506147027 sec
Prefill latency: 0.13034636597149074 sec
Decode latency: 0.28953405504580587 sec
Prefill latency: 0.13107998797204345 sec
Decode latency: 0.28986040595918894 sec
Time for inference 1: 0.42 sec total, 303.79 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4559.79 GB/s
FLOPS achieved: 150.47 TF/s

Prefill latency: 0.13229259010404348 sec
Decode latency: 0.29016105202026665 sec
Time for inference 2: 0.42 sec total, 302.70 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4543.43 GB/s
FLOPS achieved: 149.93 TF/s

Prefill latency: 0.13021696696523577 sec
Decode latency: 0.2909087259322405 sec
Time for inference 3: 0.42 sec total, 303.64 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4557.62 GB/s
FLOPS achieved: 150.40 TF/s

Prefill latency: 0.13038533099461347 sec
Decode latency: 0.2895957139553502 sec
Time for inference 4: 0.42 sec total, 304.49 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4570.35 GB/s
FLOPS achieved: 150.82 TF/s

Prefill latency: 0.13028271403163671 sec
Decode latency: 0.28998905699700117 sec
Time for inference 5: 0.42 sec total, 304.27 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4567.08 GB/s
FLOPS achieved: 150.71 TF/s

Prefill latency: 0.13112495699897408 sec
Decode latency: 0.2904566238867119 sec
Time for inference 6: 0.42 sec total, 303.34 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4553.04 GB/s
FLOPS achieved: 150.25 TF/s

Prefill latency: 0.1310759810730815 sec
Decode latency: 0.2902103940723464 sec
Time for inference 7: 0.42 sec total, 303.54 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4556.06 GB/s
FLOPS achieved: 150.35 TF/s

Prefill latency: 0.13331932795699686 sec
Decode latency: 0.2898682140512392 sec
Time for inference 8: 0.42 sec total, 302.16 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4535.32 GB/s
FLOPS achieved: 149.67 TF/s

Prefill latency: 0.13121307198889554 sec
Decode latency: 0.2890605179127306 sec
Time for inference 9: 0.42 sec total, 304.28 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4567.24 GB/s
FLOPS achieved: 150.72 TF/s

Prefill latency: 0.13231466501019895 sec
Decode latency: 0.2894830430159345 sec
Time for inference 10: 0.42 sec total, 303.17 tokens/sec
Decode latency: 0.29 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 4550.51 GB/s
FLOPS achieved: 150.17 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2900 sec
Average prefill latency: 0.1313 sec
Average tokens/sec: 303.54
Memory used: 20.99 GB
Done. we are killing the process
