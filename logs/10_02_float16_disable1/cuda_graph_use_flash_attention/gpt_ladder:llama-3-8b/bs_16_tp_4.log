W1001 20:23:05.577000 22404656793408 torch/distributed/run.py:779] 
W1001 20:23:05.577000 22404656793408 torch/distributed/run.py:779] *****************************************
W1001 20:23:05.577000 22404656793408 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:23:05.577000 22404656793408 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.18 seconds
[rank2]:[W1001 20:23:14.996302228 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank3]:[W1001 20:23:14.013255703 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.1910792839480564 sec
Decode latency: 0.1949147740378976 sec
Compilation time: 0.39 secondsCompilation time: 0.39 seconds

Compilation time: 0.39 seconds
Compilation time: 0.39 seconds
Prefill latency: 0.19025657407473773 sec
Decode latency: 0.19562834210228175 sec
Prefill latency: 0.1909467849181965 sec
Decode latency: 0.19431841501500458 sec
Prefill latency: 0.19072919606696814 sec
Decode latency: 0.19448633305728436 sec
Prefill latency: 0.19044970499817282 sec
Decode latency: 0.19418500596657395 sec
Prefill latency: 0.18954126501921564 sec
Decode latency: 0.19560288195498288 sec
Time for inference 1: 0.39 sec total, 1327.77 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6029.25 GB/s
FLOPS achieved: 198.97 TF/s

Prefill latency: 0.1904929019510746 sec
Decode latency: 0.19501064508222044 sec
Time for inference 2: 0.39 sec total, 1326.39 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6022.95 GB/s
FLOPS achieved: 198.76 TF/s

Prefill latency: 0.19035231904126704 sec
Decode latency: 0.19657944806385785 sec
Time for inference 3: 0.39 sec total, 1320.83 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 5997.69 GB/s
FLOPS achieved: 197.92 TF/s

Prefill latency: 0.18967469804920256 sec
Decode latency: 0.19563062209635973 sec
Time for inference 4: 0.39 sec total, 1326.56 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6023.74 GB/s
FLOPS achieved: 198.78 TF/s

Prefill latency: 0.19063684903085232 sec
Decode latency: 0.19453022605739534 sec
Time for inference 5: 0.39 sec total, 1327.17 tokens/sec
Decode latency: 0.19 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6026.50 GB/s
FLOPS achieved: 198.87 TF/s

Prefill latency: 0.19093976297881454 sec
Decode latency: 0.19406838400755078 sec
Time for inference 6: 0.39 sec total, 1327.78 tokens/sec
Decode latency: 0.19 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6029.28 GB/s
FLOPS achieved: 198.97 TF/s

Prefill latency: 0.19076611893251538 sec
Decode latency: 0.19493091595359147 sec
Time for inference 7: 0.39 sec total, 1325.43 tokens/sec
Decode latency: 0.19 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6018.60 GB/s
FLOPS achieved: 198.61 TF/s

Prefill latency: 0.190280472044833 sec
Decode latency: 0.19481089303735644 sec
Time for inference 8: 0.39 sec total, 1327.46 tokens/sec
Decode latency: 0.19 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6027.83 GB/s
FLOPS achieved: 198.92 TF/s

Prefill latency: 0.19082129304297268 sec
Decode latency: 0.19494110997766256 sec
Time for inference 9: 0.39 sec total, 1325.27 tokens/sec
Decode latency: 0.19 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6017.85 GB/s
FLOPS achieved: 198.59 TF/s

Prefill latency: 0.1899066800251603 sec
Decode latency: 0.19563461001962423 sec
Time for inference 10: 0.39 sec total, 1326.07 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.19 sec
Bandwidth achieved: 6021.52 GB/s
FLOPS achieved: 198.71 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1952 sec
Average prefill latency: 0.1903 sec
Average tokens/sec: 1326.07
Memory used: 23.44 GB
Done. we are killing the process
