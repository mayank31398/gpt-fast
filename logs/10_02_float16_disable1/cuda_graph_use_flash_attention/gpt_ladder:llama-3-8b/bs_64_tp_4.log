W1001 20:24:28.086000 22395544667968 torch/distributed/run.py:779] 
W1001 20:24:28.086000 22395544667968 torch/distributed/run.py:779] *****************************************
W1001 20:24:28.086000 22395544667968 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:24:28.086000 22395544667968 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.15 seconds
[rank2]:[W1001 20:24:40.271518463 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank0]:[W1001 20:24:40.271857654 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.7480260689044371 sec
Decode latency: 0.2357909269630909 sec
Compilation time: 0.98 seconds
Compilation time: 0.98 seconds
Compilation time: 0.98 seconds
Compilation time: 0.99 seconds
Prefill latency: 0.7447373949689791 sec
Decode latency: 0.23590760305523872 sec
Prefill latency: 0.742395979934372 sec
Decode latency: 0.23693294706754386 sec
Prefill latency: 0.7436369770439342 sec
Decode latency: 0.23550184594932944 sec
Prefill latency: 0.7431735609425232 sec
Decode latency: 0.23676875606179237 sec
Prefill latency: 0.7431145930895582 sec
Decode latency: 0.23635434603784233 sec
Time for inference 1: 0.98 sec total, 2089.70 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 9489.06 GB/s
FLOPS achieved: 313.14 TF/s

Prefill latency: 0.7444491910282522 sec
Decode latency: 0.23626368795521557 sec
Time for inference 2: 0.98 sec total, 2087.27 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 9478.00 GB/s
FLOPS achieved: 312.77 TF/s

Prefill latency: 0.7432096659904346 sec
Decode latency: 0.23771349398884922 sec
Time for inference 3: 0.98 sec total, 2086.75 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 9475.64 GB/s
FLOPS achieved: 312.70 TF/s

Prefill latency: 0.742449619108811 sec
Decode latency: 0.23864612297620624 sec
Time for inference 4: 0.98 sec total, 2086.38 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 9473.99 GB/s
FLOPS achieved: 312.64 TF/s

Prefill latency: 0.7424781320150942 sec
Decode latency: 0.23763004795182496 sec
Time for inference 5: 0.98 sec total, 2088.43 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.74 sec
Bandwidth achieved: 9483.29 GB/s
FLOPS achieved: 312.95 TF/s

Prefill latency: 0.7549957779701799 sec
Decode latency: 0.23609567596577108 sec
Time for inference 6: 0.99 sec total, 2065.38 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.75 sec
Bandwidth achieved: 9378.61 GB/s
FLOPS achieved: 309.49 TF/s

Prefill latency: 0.7479432789841667 sec
Decode latency: 0.2357012809952721 sec
Time for inference 7: 0.98 sec total, 2080.90 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.75 sec
Bandwidth achieved: 9449.10 GB/s
FLOPS achieved: 311.82 TF/s

Prefill latency: 0.7451881660381332 sec
Decode latency: 0.23980097007006407 sec
Time for inference 8: 0.99 sec total, 2078.29 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.75 sec
Bandwidth achieved: 9437.23 GB/s
FLOPS achieved: 311.43 TF/s

Prefill latency: 0.7526727430522442 sec
Decode latency: 0.23687971604522318 sec
Time for inference 9: 0.99 sec total, 2068.55 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.75 sec
Bandwidth achieved: 9393.02 GB/s
FLOPS achieved: 309.97 TF/s

Prefill latency: 0.7463672220474109 sec
Decode latency: 0.23929515399504453 sec
Time for inference 10: 0.99 sec total, 2076.58 tokens/sec
Decode latency: 0.24 sec
Prefill latency: 0.75 sec
Bandwidth achieved: 9429.49 GB/s
FLOPS achieved: 311.17 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2374 sec
Average prefill latency: 0.7463 sec
Average tokens/sec: 2080.82
Memory used: 80.96 GB
Done. we are killing the process
