W1001 20:37:05.042000 22459364538176 torch/distributed/run.py:779] 
W1001 20:37:05.042000 22459364538176 torch/distributed/run.py:779] *****************************************
W1001 20:37:05.042000 22459364538176 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:37:05.042000 22459364538176 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.19 seconds
[rank1]:[W1001 20:37:12.472354155 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.031883019022643566 sec
Decode latency: 1.3459141720086336 sec
Compilation time: 1.42 seconds
Compilation time: 1.36 seconds
Compilation time: 1.39 seconds
Compilation time: 1.38 seconds
Prefill latency: 0.013106013066135347 sec
Decode latency: 1.3452868909807876 sec
Prefill latency: 0.013186199008487165 sec
Decode latency: 1.3447253180202097 sec
Prefill latency: 0.013205321040004492 sec
Decode latency: 1.3443167570512742 sec
Prefill latency: 0.013191894046030939 sec
Decode latency: 1.3437326739076525 sec
Prefill latency: 0.013180448091588914 sec
Decode latency: 1.3459243080578744 sec
Time for inference 1: 1.36 sec total, 188.26 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.51 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.01315245102159679 sec
Decode latency: 1.3447648900328204 sec
Time for inference 2: 1.36 sec total, 188.40 tokens/sec
Decode latency: 1.34 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.78 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.012923946022056043 sec
Decode latency: 1.3450623729731888 sec
Time for inference 3: 1.36 sec total, 188.38 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.73 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013009428046643734 sec
Decode latency: 1.3462263089604676 sec
Time for inference 4: 1.36 sec total, 188.19 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.38 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.01312308106571436 sec
Decode latency: 1.3464181550079957 sec
Time for inference 5: 1.36 sec total, 188.18 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.35 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013158062007278204 sec
Decode latency: 1.346494780969806 sec
Time for inference 6: 1.36 sec total, 188.19 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.36 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013076813076622784 sec
Decode latency: 1.3459782900754362 sec
Time for inference 7: 1.36 sec total, 188.28 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.54 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013134032022207975 sec
Decode latency: 1.3456918770680204 sec
Time for inference 8: 1.36 sec total, 188.29 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.57 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013120904914103448 sec
Decode latency: 1.346753722988069 sec
Time for inference 9: 1.36 sec total, 188.16 tokens/sec
Decode latency: 1.35 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.32 GB/s
FLOPS achieved: 1.81 TF/s

Prefill latency: 0.013285771012306213 sec
Decode latency: 1.3449083409504965 sec
Time for inference 10: 1.36 sec total, 188.39 tokens/sec
Decode latency: 1.34 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 362.76 GB/s
FLOPS achieved: 1.81 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.3458 sec
Average prefill latency: 0.0131 sec
Average tokens/sec: 188.27
Memory used: 3.01 GB
Done. we are killing the process
