W1001 20:37:43.540000 23440796268352 torch/distributed/run.py:779] 
W1001 20:37:43.540000 23440796268352 torch/distributed/run.py:779] *****************************************
W1001 20:37:43.540000 23440796268352 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:37:43.540000 23440796268352 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 0.18 seconds
[rank3]:[W1001 20:37:51.171435159 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.1144600969273597 sec
Decode latency: 1.826850117999129 sec
Compilation time: 1.94 seconds
Compilation time: 1.94 seconds
Compilation time: 1.94 seconds
Compilation time: 1.94 seconds
Prefill latency: 0.11113574495539069 sec
Decode latency: 1.8270721610169858 sec
Prefill latency: 0.11092753801494837 sec
Decode latency: 1.8252349769463763 sec
Prefill latency: 0.11096421198453754 sec
Decode latency: 1.8263963080244139 sec
Prefill latency: 0.11091281997505575 sec
Decode latency: 1.8251829029759392 sec
Prefill latency: 0.1111276940209791 sec
Decode latency: 1.8265777559718117 sec
Time for inference 1: 1.94 sec total, 2113.11 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4068.92 GB/s
FLOPS achieved: 20.34 TF/s

Prefill latency: 0.1108893440105021 sec
Decode latency: 1.8259301820071414 sec
Time for inference 2: 1.94 sec total, 2114.03 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4070.69 GB/s
FLOPS achieved: 20.35 TF/s

Prefill latency: 0.11124729202128947 sec
Decode latency: 1.8255757110891864 sec
Time for inference 3: 1.94 sec total, 2114.00 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4070.64 GB/s
FLOPS achieved: 20.35 TF/s

Prefill latency: 0.11099598207511008 sec
Decode latency: 1.8283659460721537 sec
Time for inference 4: 1.94 sec total, 2111.22 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4065.28 GB/s
FLOPS achieved: 20.33 TF/s

Prefill latency: 0.111062902957201 sec
Decode latency: 1.8255686429329216 sec
Time for inference 5: 1.94 sec total, 2114.28 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4071.18 GB/s
FLOPS achieved: 20.36 TF/s

Prefill latency: 0.1111935890512541 sec
Decode latency: 1.825731719029136 sec
Time for inference 6: 1.94 sec total, 2113.95 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4070.54 GB/s
FLOPS achieved: 20.35 TF/s

Prefill latency: 0.11130979005247355 sec
Decode latency: 1.8249226390616968 sec
Time for inference 7: 1.94 sec total, 2114.65 tokens/sec
Decode latency: 1.82 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4071.87 GB/s
FLOPS achieved: 20.36 TF/s

Prefill latency: 0.1110094339819625 sec
Decode latency: 1.8252798300236464 sec
Time for inference 8: 1.94 sec total, 2114.58 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4071.75 GB/s
FLOPS achieved: 20.36 TF/s

Prefill latency: 0.1111288369866088 sec
Decode latency: 1.824927192996256 sec
Time for inference 9: 1.94 sec total, 2114.78 tokens/sec
Decode latency: 1.82 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4072.13 GB/s
FLOPS achieved: 20.36 TF/s

Prefill latency: 0.11089103703852743 sec
Decode latency: 1.8262456649681553 sec
Time for inference 10: 1.94 sec total, 2113.66 tokens/sec
Decode latency: 1.83 sec
Prefill latency: 0.11 sec
Bandwidth achieved: 4069.98 GB/s
FLOPS achieved: 20.35 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.8259 sec
Average prefill latency: 0.1111 sec
Average tokens/sec: 2113.83
Memory used: 12.84 GB
Done. we are killing the process
