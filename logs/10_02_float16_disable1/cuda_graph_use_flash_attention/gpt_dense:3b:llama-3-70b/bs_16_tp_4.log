W1001 23:14:10.554000 22375427036992 torch/distributed/run.py:779] 
W1001 23:14:10.554000 22375427036992 torch/distributed/run.py:779] *****************************************
W1001 23:14:10.554000 22375427036992 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 23:14:10.554000 22375427036992 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 2304)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=2304, out_features=1728, bias=False)
        (wo): Linear(in_features=576, out_features=2304, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=2304, out_features=4608, bias=False)
        (w2): Linear(in_features=2304, out_features=2304, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=2304, out_features=49152, bias=False)
)
Time to load model: 1.13 seconds
Prefill latency: 0.13255045900586993 sec
Decode latency: 2.3676401359261945 sec
Compilation time: 2.50 seconds
Compilation time: 2.50 seconds
Compilation time: 2.50 seconds
Compilation time: 2.50 seconds
Prefill latency: 0.12762719998136163 sec
Decode latency: 2.3666804869426414 sec
Prefill latency: 0.12771938799414784 sec
Decode latency: 2.366920275031589 sec
Prefill latency: 0.12767142697703093 sec
Decode latency: 2.365690238075331 sec
Prefill latency: 0.12760866002645344 sec
Decode latency: 2.3676206440431997 sec
Prefill latency: 0.12772296404000372 sec
Decode latency: 2.3661919730948284 sec
Time for inference 1: 2.49 sec total, 1641.90 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3161.58 GB/s
FLOPS achieved: 15.81 TF/s

Prefill latency: 0.1277412329800427 sec
Decode latency: 2.367398508009501 sec
Time for inference 2: 2.50 sec total, 1641.14 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3160.11 GB/s
FLOPS achieved: 15.80 TF/s

Prefill latency: 0.1276828870177269 sec
Decode latency: 2.366668602102436 sec
Time for inference 3: 2.50 sec total, 1641.58 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3160.95 GB/s
FLOPS achieved: 15.80 TF/s

Prefill latency: 0.12771109002642334 sec
Decode latency: 2.3663999210111797 sec
Time for inference 4: 2.49 sec total, 1641.79 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3161.36 GB/s
FLOPS achieved: 15.81 TF/s

Prefill latency: 0.12775409198366106 sec
Decode latency: 2.366028179996647 sec
Time for inference 5: 2.49 sec total, 1642.03 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3161.82 GB/s
FLOPS achieved: 15.81 TF/s

Prefill latency: 0.12779211602173746 sec
Decode latency: 2.366655152058229 sec
Time for inference 6: 2.50 sec total, 1641.57 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3160.93 GB/s
FLOPS achieved: 15.80 TF/s

Prefill latency: 0.12769468408077955 sec
Decode latency: 2.3660973799414933 sec
Time for inference 7: 2.49 sec total, 1641.97 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3161.71 GB/s
FLOPS achieved: 15.81 TF/s

Prefill latency: 0.12774340901523829 sec
Decode latency: 2.3689521260093898 sec
Time for inference 8: 2.50 sec total, 1639.93 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3157.79 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.1276956379879266 sec
Decode latency: 2.3683760500280187 sec
Time for inference 9: 2.50 sec total, 1640.43 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3158.74 GB/s
FLOPS achieved: 15.79 TF/s

Prefill latency: 0.1276661460287869 sec
Decode latency: 2.36866390297655 sec
Time for inference 10: 2.50 sec total, 1640.34 tokens/sec
Decode latency: 2.37 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 3158.57 GB/s
FLOPS achieved: 15.79 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.3671 sec
Average prefill latency: 0.1277 sec
Average tokens/sec: 1641.27
Memory used: 12.84 GB
Done. we are killing the process
