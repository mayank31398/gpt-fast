W1002 00:35:24.896000 23010451314496 torch/distributed/run.py:779] 
W1002 00:35:24.896000 23010451314496 torch/distributed/run.py:779] *****************************************
W1002 00:35:24.896000 23010451314496 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1002 00:35:24.896000 23010451314496 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
Time to load model: 1.67 seconds
Prefill latency: 0.9556953200371936 sec
Decode latency: 7.586417819955386 sec
Compilation time: 8.52 secondsCompilation time: 8.50 seconds

Compilation time: 8.54 seconds
Compilation time: 8.51 seconds
Compilation time: 8.51 seconds
Compilation time: 8.54 seconds
Compilation time: 8.54 seconds
Compilation time: 8.55 seconds
Prefill latency: 0.8922558639897034 sec
Decode latency: 7.615076011046767 sec
Prefill latency: 0.8900005300529301 sec
Decode latency: 7.624562110984698 sec
Prefill latency: 0.8926080920500681 sec
Decode latency: 7.6208494520979 sec
Prefill latency: 0.8951030729804188 sec
Decode latency: 7.582204327918589 sec
Prefill latency: 0.8921912999358028 sec
Decode latency: 7.6136983359465376 sec
Time for inference 1: 8.51 sec total, 481.47 tokens/sec
Decode latency: 7.61 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9252.34 GB/s
FLOPS achieved: 46.26 TF/s

Prefill latency: 0.8924462900031358 sec
Decode latency: 7.611563762067817 sec
Time for inference 2: 8.51 sec total, 481.58 tokens/sec
Decode latency: 7.61 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9254.32 GB/s
FLOPS achieved: 46.27 TF/s

Prefill latency: 0.8937968830578029 sec
Decode latency: 7.56307063496206 sec
Time for inference 3: 8.46 sec total, 484.26 tokens/sec
Decode latency: 7.56 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9305.91 GB/s
FLOPS achieved: 46.53 TF/s

Prefill latency: 0.8938972259638831 sec
Decode latency: 7.629356854013167 sec
Time for inference 4: 8.52 sec total, 480.49 tokens/sec
Decode latency: 7.63 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9233.46 GB/s
FLOPS achieved: 46.17 TF/s

Prefill latency: 0.8914325189543888 sec
Decode latency: 7.620816287002526 sec
Time for inference 5: 8.51 sec total, 481.11 tokens/sec
Decode latency: 7.62 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9245.39 GB/s
FLOPS achieved: 46.23 TF/s

Prefill latency: 0.8916956259636208 sec
Decode latency: 7.615553377894685 sec
Time for inference 6: 8.51 sec total, 481.40 tokens/sec
Decode latency: 7.62 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9250.86 GB/s
FLOPS achieved: 46.25 TF/s

Prefill latency: 0.8925287660676986 sec
Decode latency: 7.571791050955653 sec
Time for inference 7: 8.47 sec total, 483.84 tokens/sec
Decode latency: 7.57 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9297.88 GB/s
FLOPS achieved: 46.49 TF/s

Prefill latency: 0.8930262980284169 sec
Decode latency: 7.593023756984621 sec
Time for inference 8: 8.49 sec total, 482.59 tokens/sec
Decode latency: 7.59 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9273.86 GB/s
FLOPS achieved: 46.37 TF/s

Prefill latency: 0.8907413800479844 sec
Decode latency: 7.654736586031504 sec
Time for inference 9: 8.55 sec total, 479.24 tokens/sec
Decode latency: 7.65 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9209.43 GB/s
FLOPS achieved: 46.05 TF/s

Prefill latency: 0.8922544800443575 sec
Decode latency: 7.605465782922693 sec
Time for inference 10: 8.50 sec total, 481.93 tokens/sec
Decode latency: 7.61 sec
Prefill latency: 0.89 sec
Bandwidth achieved: 9261.22 GB/s
FLOPS achieved: 46.31 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 7.6079 sec
Average prefill latency: 0.8924 sec
Average tokens/sec: 481.79
Memory used: 71.11 GB
Done. we are killing the process
