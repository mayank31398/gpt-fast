W1001 20:34:16.884000 22753697408832 torch/distributed/run.py:779] 
W1001 20:34:16.884000 22753697408832 torch/distributed/run.py:779] *****************************************
W1001 20:34:16.884000 22753697408832 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:34:16.884000 22753697408832 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.10 seconds
Prefill latency: 0.28141722397413105 sec
Decode latency: 0.22511621203739196 sec
Compilation time: 0.51 seconds
Compilation time: 0.50 seconds
Prefill latency: 0.28171046101488173 sec
Decode latency: 0.22513363894540817 sec
Prefill latency: 0.28201208799146116 sec
Decode latency: 0.22572680993471295 sec
Prefill latency: 0.27885231899563223 sec
Decode latency: 0.225495012011379 sec
Prefill latency: 0.28284544695634395 sec
Decode latency: 0.22522474196739495 sec
Prefill latency: 0.28123270999640226 sec
Decode latency: 0.22470464301295578 sec
Time for inference 1: 0.51 sec total, 1011.16 tokens/sec
Decode latency: 0.22 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8120.12 GB/s
FLOPS achieved: 267.96 TF/s

Prefill latency: 0.2809493589447811 sec
Decode latency: 0.22557413496542722 sec
Time for inference 2: 0.51 sec total, 1009.99 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8110.73 GB/s
FLOPS achieved: 267.65 TF/s

Prefill latency: 0.2807486349483952 sec
Decode latency: 0.22589701798278838 sec
Time for inference 3: 0.51 sec total, 1009.75 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8108.79 GB/s
FLOPS achieved: 267.59 TF/s

Prefill latency: 0.28197406395338476 sec
Decode latency: 0.2258742379490286 sec
Time for inference 4: 0.51 sec total, 1007.35 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8089.54 GB/s
FLOPS achieved: 266.95 TF/s

Prefill latency: 0.2809622749919072 sec
Decode latency: 0.22575875802431256 sec
Time for inference 5: 0.51 sec total, 1009.52 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8106.99 GB/s
FLOPS achieved: 267.53 TF/s

Prefill latency: 0.2830633179983124 sec
Decode latency: 0.22555034596007317 sec
Time for inference 6: 0.51 sec total, 1005.83 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8077.31 GB/s
FLOPS achieved: 266.55 TF/s

Prefill latency: 0.2834355270024389 sec
Decode latency: 0.22482541797216982 sec
Time for inference 7: 0.51 sec total, 1006.45 tokens/sec
Decode latency: 0.22 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8082.29 GB/s
FLOPS achieved: 266.72 TF/s

Prefill latency: 0.28307830600533634 sec
Decode latency: 0.22534824803005904 sec
Time for inference 8: 0.51 sec total, 1006.02 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8078.91 GB/s
FLOPS achieved: 266.60 TF/s

Prefill latency: 0.28229082794860005 sec
Decode latency: 0.22492550604511052 sec
Time for inference 9: 0.51 sec total, 1008.54 tokens/sec
Decode latency: 0.22 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8099.09 GB/s
FLOPS achieved: 267.27 TF/s

Prefill latency: 0.2828212990425527 sec
Decode latency: 0.22513961093500257 sec
Time for inference 10: 0.51 sec total, 1007.11 tokens/sec
Decode latency: 0.23 sec
Prefill latency: 0.28 sec
Bandwidth achieved: 8087.60 GB/s
FLOPS achieved: 266.89 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2254 sec
Average prefill latency: 0.2821 sec
Average tokens/sec: 1008.17
Memory used: 16.51 GB
Done. we are killing the process
