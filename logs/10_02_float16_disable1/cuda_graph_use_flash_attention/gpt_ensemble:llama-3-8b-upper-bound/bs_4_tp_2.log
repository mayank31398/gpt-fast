W1001 20:33:06.084000 23221794424640 torch/distributed/run.py:779] 
W1001 20:33:06.084000 23221794424640 torch/distributed/run.py:779] *****************************************
W1001 20:33:06.084000 23221794424640 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:33:06.084000 23221794424640 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.26 seconds
Compilation time: 0.28 seconds
Prefill latency: 0.06999565905425698 sec
Decode latency: 0.2030759770423174 sec
Compilation time: 0.27 seconds
Prefill latency: 0.07044505409430712 sec
Decode latency: 0.20319357397966087 sec
Prefill latency: 0.07040481397416443 sec
Decode latency: 0.20461784000508487 sec
Prefill latency: 0.07014532899484038 sec
Decode latency: 0.20358471001964062 sec
Prefill latency: 0.07036391599103808 sec
Decode latency: 0.20310739404521883 sec
Prefill latency: 0.0704578390577808 sec
Decode latency: 0.2037392930360511 sec
Time for inference 1: 0.27 sec total, 466.04 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3742.57 GB/s
FLOPS achieved: 123.50 TF/s

Prefill latency: 0.07032307609915733 sec
Decode latency: 0.20476557803340256 sec
Time for inference 2: 0.28 sec total, 464.60 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3731.00 GB/s
FLOPS achieved: 123.12 TF/s

Prefill latency: 0.07021502300631255 sec
Decode latency: 0.20374513790011406 sec
Time for inference 3: 0.27 sec total, 466.46 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3745.93 GB/s
FLOPS achieved: 123.62 TF/s

Prefill latency: 0.07005354098509997 sec
Decode latency: 0.20391462196130306 sec
Time for inference 4: 0.27 sec total, 466.46 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3745.95 GB/s
FLOPS achieved: 123.62 TF/s

Prefill latency: 0.07001946098171175 sec
Decode latency: 0.20405867404770106 sec
Time for inference 5: 0.27 sec total, 466.28 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3744.50 GB/s
FLOPS achieved: 123.57 TF/s

Prefill latency: 0.06991355889476836 sec
Decode latency: 0.20448417193256319 sec
Time for inference 6: 0.27 sec total, 465.76 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3740.29 GB/s
FLOPS achieved: 123.43 TF/s

Prefill latency: 0.06966304802335799 sec
Decode latency: 0.20385488995816559 sec
Time for inference 7: 0.27 sec total, 467.22 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3752.04 GB/s
FLOPS achieved: 123.82 TF/s

Prefill latency: 0.07034410594496876 sec
Decode latency: 0.20352715405169874 sec
Time for inference 8: 0.27 sec total, 466.63 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3747.29 GB/s
FLOPS achieved: 123.66 TF/s

Prefill latency: 0.07044790405780077 sec
Decode latency: 0.20401743205729872 sec
Time for inference 9: 0.27 sec total, 465.62 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3739.17 GB/s
FLOPS achieved: 123.39 TF/s

Prefill latency: 0.07020580896642059 sec
Decode latency: 0.2038068020483479 sec
Time for inference 10: 0.27 sec total, 466.35 tokens/sec
Decode latency: 0.20 sec
Prefill latency: 0.07 sec
Bandwidth achieved: 3745.00 GB/s
FLOPS achieved: 123.58 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.2040 sec
Average prefill latency: 0.0702 sec
Average tokens/sec: 466.14
Memory used: 11.05 GB
Done. we are killing the process
