W1001 20:32:18.506000 23248248452928 torch/distributed/run.py:779] 
W1001 20:32:18.506000 23248248452928 torch/distributed/run.py:779] *****************************************
W1001 20:32:18.506000 23248248452928 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:32:18.506000 23248248452928 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Compilation time: 0.16 seconds
Compilation time: 0.16 seconds
Prefill latency: 0.014015536056831479 sec
Compilation time: 0.16 seconds
Decode latency: 0.14565825392492115 sec
Compilation time: 0.16 seconds
Prefill latency: 0.013847778085619211 sec
Decode latency: 0.14566045301035047 sec
Prefill latency: 0.013835850986652076 sec
Decode latency: 0.14566309901420027 sec
Prefill latency: 0.013834257028065622 sec
Decode latency: 0.14562686602585018 sec
Prefill latency: 0.013842599000781775 sec
Decode latency: 0.1455602920614183 sec
Prefill latency: 0.013853720971383154 sec
Decode latency: 0.1455734440824017 sec
Time for inference 1: 0.16 sec total, 200.30 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.52 GB/s
FLOPS achieved: 30.01 TF/s

Prefill latency: 0.013832752010785043 sec
Decode latency: 0.1456161179812625 sec
Time for inference 2: 0.16 sec total, 200.24 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.28 GB/s
FLOPS achieved: 30.01 TF/s

Prefill latency: 0.013839683029800653 sec
Decode latency: 0.14565477799624205 sec
Time for inference 3: 0.16 sec total, 200.20 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.08 GB/s
FLOPS achieved: 30.00 TF/s

Prefill latency: 0.013840889907442033 sec
Decode latency: 0.14563729101791978 sec
Time for inference 4: 0.16 sec total, 200.20 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.09 GB/s
FLOPS achieved: 30.00 TF/s

Prefill latency: 0.013853930053301156 sec
Decode latency: 0.1455250270664692 sec
Time for inference 5: 0.16 sec total, 200.34 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.70 GB/s
FLOPS achieved: 30.02 TF/s

Prefill latency: 0.01385196705814451 sec
Decode latency: 0.14571526902727783 sec
Time for inference 6: 0.16 sec total, 200.08 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 908.54 GB/s
FLOPS achieved: 29.98 TF/s

Prefill latency: 0.013826463022269309 sec
Decode latency: 0.14562825905159116 sec
Time for inference 7: 0.16 sec total, 200.22 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.15 GB/s
FLOPS achieved: 30.00 TF/s

Prefill latency: 0.013825368019752204 sec
Decode latency: 0.14565663901157677 sec
Time for inference 8: 0.16 sec total, 200.21 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 909.11 GB/s
FLOPS achieved: 30.00 TF/s

Prefill latency: 0.013840707018971443 sec
Decode latency: 0.14559687301516533 sec
Time for inference 9: 0.16 sec total, 200.15 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 908.84 GB/s
FLOPS achieved: 29.99 TF/s

Prefill latency: 0.013855451950803399 sec
Decode latency: 0.14564763207454234 sec
Time for inference 10: 0.16 sec total, 200.13 tokens/sec
Decode latency: 0.15 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 908.75 GB/s
FLOPS achieved: 29.99 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1456 sec
Average prefill latency: 0.0138 sec
Average tokens/sec: 200.21
Memory used: 6.12 GB
Done. we are killing the process
