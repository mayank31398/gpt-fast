W1001 20:33:34.648000 23210651916096 torch/distributed/run.py:779] 
W1001 20:33:34.648000 23210651916096 torch/distributed/run.py:779] *****************************************
W1001 20:33:34.648000 23210651916096 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:33:34.648000 23210651916096 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.11 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Compilation time: 0.17 seconds
Prefill latency: 0.027622447931207716 sec
Decode latency: 0.13974298199173063 sec
Compilation time: 0.17 seconds
Prefill latency: 0.027461617020890117 sec
Decode latency: 0.13974291796330363 sec
Prefill latency: 0.027463602018542588 sec
Decode latency: 0.1406357520027086 sec
Prefill latency: 0.02745533804409206 sec
Decode latency: 0.13998232397716492 sec
Prefill latency: 0.027538107009604573 sec
Decode latency: 0.1409150209510699 sec
Prefill latency: 0.02749344694893807 sec
Decode latency: 0.14024237997364253 sec
Time for inference 1: 0.17 sec total, 761.23 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2128.42 GB/s
FLOPS achieved: 70.24 TF/s

Prefill latency: 0.027511814958415926 sec
Decode latency: 0.13988367991987616 sec
Time for inference 2: 0.17 sec total, 762.85 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2132.96 GB/s
FLOPS achieved: 70.39 TF/s

Prefill latency: 0.02748552500270307 sec
Decode latency: 0.14020534907467663 sec
Time for inference 3: 0.17 sec total, 761.44 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2129.01 GB/s
FLOPS achieved: 70.26 TF/s

Prefill latency: 0.027505734004080296 sec
Decode latency: 0.14004769700113684 sec
Time for inference 4: 0.17 sec total, 762.16 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2131.02 GB/s
FLOPS achieved: 70.32 TF/s

Prefill latency: 0.027444317005574703 sec
Decode latency: 0.14118683198466897 sec
Time for inference 5: 0.17 sec total, 757.31 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2117.48 GB/s
FLOPS achieved: 69.88 TF/s

Prefill latency: 0.027501572971232235 sec
Decode latency: 0.14016769104637206 sec
Time for inference 6: 0.17 sec total, 761.63 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2129.55 GB/s
FLOPS achieved: 70.28 TF/s

Prefill latency: 0.027501386939547956 sec
Decode latency: 0.1398933830205351 sec
Time for inference 7: 0.17 sec total, 762.91 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2133.12 GB/s
FLOPS achieved: 70.39 TF/s

Prefill latency: 0.02746125601697713 sec
Decode latency: 0.1398368290392682 sec
Time for inference 8: 0.17 sec total, 763.30 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2134.22 GB/s
FLOPS achieved: 70.43 TF/s

Prefill latency: 0.0274836840108037 sec
Decode latency: 0.13983718899544328 sec
Time for inference 9: 0.17 sec total, 763.42 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2134.55 GB/s
FLOPS achieved: 70.44 TF/s

Prefill latency: 0.027453006012365222 sec
Decode latency: 0.14121708902530372 sec
Time for inference 10: 0.17 sec total, 757.10 tokens/sec
Decode latency: 0.14 sec
Prefill latency: 0.03 sec
Bandwidth achieved: 2116.89 GB/s
FLOPS achieved: 69.86 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1403 sec
Average prefill latency: 0.0275 sec
Average tokens/sec: 761.34
Memory used: 5.30 GB
Done. we are killing the process
