flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.92 seconds
Prefill latency: 0.5307156370254233 sec
Decode latency: 0.30986467609182 sec
Compilation time: 0.84 seconds
Prefill latency: 0.5321257109753788 sec
Decode latency: 0.30952512100338936 sec
Prefill latency: 0.5330316169420257 sec
Decode latency: 0.3093217359855771 sec
Prefill latency: 0.5330146719934419 sec
Decode latency: 0.30930467799771577 sec
Prefill latency: 0.5313437170116231 sec
Decode latency: 0.31005357508547604 sec
Prefill latency: 0.5335617599776015 sec
Decode latency: 0.30911519390065223 sec
Time for inference 1: 0.84 sec total, 607.21 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9114.15 GB/s
FLOPS achieved: 300.77 TF/s

Prefill latency: 0.5330904920119792 sec
Decode latency: 0.30966466397512704 sec
Time for inference 2: 0.84 sec total, 607.18 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9113.68 GB/s
FLOPS achieved: 300.75 TF/s

Prefill latency: 0.53402354195714 sec
Decode latency: 0.30976689199451357 sec
Time for inference 3: 0.84 sec total, 606.45 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9102.66 GB/s
FLOPS achieved: 300.39 TF/s

Prefill latency: 0.5336177239660174 sec
Decode latency: 0.3104188700672239 sec
Time for inference 4: 0.84 sec total, 606.26 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9099.82 GB/s
FLOPS achieved: 300.29 TF/s

Prefill latency: 0.5335434339940548 sec
Decode latency: 0.31013266602531075 sec
Time for inference 5: 0.84 sec total, 606.53 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9103.92 GB/s
FLOPS achieved: 300.43 TF/s

Prefill latency: 0.5328394619282335 sec
Decode latency: 0.31067255698144436 sec
Time for inference 6: 0.84 sec total, 606.57 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9104.52 GB/s
FLOPS achieved: 300.45 TF/s

Prefill latency: 0.5347891920246184 sec
Decode latency: 0.3100985190831125 sec
Time for inference 7: 0.85 sec total, 605.60 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.53 sec
Bandwidth achieved: 9089.99 GB/s
FLOPS achieved: 299.97 TF/s

Prefill latency: 0.5376301769865677 sec
Decode latency: 0.3109654710860923 sec
Time for inference 8: 0.85 sec total, 602.96 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.54 sec
Bandwidth achieved: 9050.37 GB/s
FLOPS achieved: 298.66 TF/s

Prefill latency: 0.5357063339324668 sec
Decode latency: 0.3095261181006208 sec
Time for inference 9: 0.85 sec total, 605.39 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.54 sec
Bandwidth achieved: 9086.80 GB/s
FLOPS achieved: 299.86 TF/s

Prefill latency: 0.5354626369662583 sec
Decode latency: 0.309904703986831 sec
Time for inference 10: 0.85 sec total, 605.30 tokens/sec
Decode latency: 0.31 sec
Prefill latency: 0.54 sec
Bandwidth achieved: 9085.44 GB/s
FLOPS achieved: 299.82 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.3100 sec
Average prefill latency: 0.5344 sec
Average tokens/sec: 605.94
Memory used: 26.14 GB
Done. we are killing the process
