W1001 20:20:53.387000 22581578020672 torch/distributed/run.py:779] 
W1001 20:20:53.387000 22581578020672 torch/distributed/run.py:779] *****************************************
W1001 20:20:53.387000 22581578020672 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1001 20:20:53.387000 22581578020672 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(49152, 1536)
  (layers): ModuleList(
    (0-39): 40 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=1536, out_features=576, bias=False)
        (wo): Linear(in_features=192, out_features=1536, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=1536, out_features=1024, bias=False)
        (w2): Linear(in_features=512, out_features=1536, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=1536, out_features=49152, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.20566153700929135 sec
Decode latency: 5.5145169160095975 sec
Compilation time: 5.65 secondsCompilation time: 5.72 seconds

Compilation time: 5.65 seconds
Compilation time: 5.74 seconds
Compilation time: 5.67 secondsCompilation time: 5.73 seconds

Compilation time: 5.74 seconds
Compilation time: 5.70 seconds
Prefill latency: 0.12996264803223312 sec
Decode latency: 5.43342550098896 sec
Prefill latency: 0.12655220902524889 sec
Decode latency: 5.343979594064876 sec
Prefill latency: 0.1253036359557882 sec
Decode latency: 5.366100683924742 sec
Prefill latency: 0.128294637077488 sec
Decode latency: 5.3960667829960585 sec
Prefill latency: 0.12933782394975424 sec
Decode latency: 5.474335407023318 sec
Time for inference 1: 5.61 sec total, 730.34 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 317.23 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.12801809096708894 sec
Decode latency: 5.498386743944138 sec
Time for inference 2: 5.63 sec total, 727.34 tokens/sec
Decode latency: 5.50 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 315.93 GB/s
FLOPS achieved: 1.58 TF/s

Prefill latency: 0.1305692750029266 sec
Decode latency: 5.519381280988455 sec
Time for inference 3: 5.65 sec total, 724.55 tokens/sec
Decode latency: 5.52 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 314.72 GB/s
FLOPS achieved: 1.57 TF/s

Prefill latency: 0.12950942700263113 sec
Decode latency: 5.467570672975853 sec
Time for inference 4: 5.60 sec total, 731.43 tokens/sec
Decode latency: 5.47 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 317.70 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.12344590795692056 sec
Decode latency: 5.3272251460002735 sec
Time for inference 5: 5.46 sec total, 750.71 tokens/sec
Decode latency: 5.33 sec
Prefill latency: 0.12 sec
Bandwidth achieved: 326.08 GB/s
FLOPS achieved: 1.63 TF/s

Prefill latency: 0.13032004598062485 sec
Decode latency: 5.359110310091637 sec
Time for inference 6: 5.49 sec total, 745.56 tokens/sec
Decode latency: 5.36 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 323.84 GB/s
FLOPS achieved: 1.62 TF/s

Prefill latency: 0.1258965419838205 sec
Decode latency: 5.388341624988243 sec
Time for inference 7: 5.52 sec total, 742.28 tokens/sec
Decode latency: 5.39 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 322.41 GB/s
FLOPS achieved: 1.61 TF/s

Prefill latency: 0.12670684896875173 sec
Decode latency: 5.447786970064044 sec
Time for inference 8: 5.58 sec total, 734.12 tokens/sec
Decode latency: 5.45 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 318.87 GB/s
FLOPS achieved: 1.59 TF/s

Prefill latency: 0.1294925460824743 sec
Decode latency: 5.479178071953356 sec
Time for inference 9: 5.61 sec total, 729.66 tokens/sec
Decode latency: 5.48 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 316.93 GB/s
FLOPS achieved: 1.58 TF/s

Prefill latency: 0.12905120197683573 sec
Decode latency: 5.512382310000248 sec
Time for inference 10: 5.65 sec total, 725.43 tokens/sec
Decode latency: 5.51 sec
Prefill latency: 0.13 sec
Bandwidth achieved: 315.10 GB/s
FLOPS achieved: 1.58 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.4474 sec
Average prefill latency: 0.1282 sec
Average tokens/sec: 734.14
Memory used: 7.49 GB
Done. we are killing the process
