flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.15 seconds
[rank0]:[W926 17:58:59.026847976 CUDAGraph.cpp:150] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
Prefill latency: 0.03850450896425173 sec
Decode latency: 2.9061306670191698 sec
Compilation time: 2.95 seconds
Prefill latency: 0.038138996984343976 sec
Decode latency: 2.902476501010824 sec
Prefill latency: 0.037963382026646286 sec
Decode latency: 2.8539867099607363 sec
Prefill latency: 0.038149639032781124 sec
Decode latency: 2.9017190149752423 sec
Prefill latency: 0.038136397022753954 sec
Decode latency: 2.9038802630384453 sec
Prefill latency: 0.038133480004034936 sec
Decode latency: 2.9033843430224806 sec
Time for inference 1: 2.94 sec total, 87.01 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1305.96 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03809165197890252 sec
Decode latency: 2.9028170660021715 sec
Time for inference 2: 2.94 sec total, 87.02 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.19 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03802749898750335 sec
Decode latency: 2.9033455629833043 sec
Time for inference 3: 2.94 sec total, 87.01 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1306.03 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03809679701225832 sec
Decode latency: 2.9048786660423502 sec
Time for inference 4: 2.94 sec total, 86.96 tokens/sec
Decode latency: 2.90 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1305.27 GB/s
FLOPS achieved: 6.53 TF/s

Prefill latency: 0.03804406197741628 sec
Decode latency: 2.8898662030114792 sec
Time for inference 5: 2.93 sec total, 87.41 tokens/sec
Decode latency: 2.89 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1312.00 GB/s
FLOPS achieved: 6.56 TF/s

Prefill latency: 0.038081470993347466 sec
Decode latency: 2.8341308450326324 sec
Time for inference 6: 2.87 sec total, 89.11 tokens/sec
Decode latency: 2.83 sec
Prefill latency: 0.04 sec
Bandwidth achieved: 1337.46 GB/s
FLOPS achieved: 6.69 TF/s

Prefill latency: 0.0380970099940896 sec
