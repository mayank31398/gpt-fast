flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTDense(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x DenseTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.03 seconds
Prefill latency: 0.14753696200205013 sec
Decode latency: 3.546869330049958 sec
Compilation time: 3.70 seconds
Prefill latency: 0.1489037379506044 sec
Decode latency: 3.580457465024665 sec
Prefill latency: 0.14837504900060594 sec
Decode latency: 3.5802762850071304 sec
Prefill latency: 0.14999098901171237 sec
Decode latency: 3.497422610002104 sec
Prefill latency: 0.1492627330007963 sec
Decode latency: 3.581264699983876 sec
Prefill latency: 0.14939793501980603 sec
Decode latency: 3.5823969320044853 sec
Time for inference 1: 3.73 sec total, 274.33 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4117.67 GB/s
FLOPS achieved: 20.59 TF/s

Prefill latency: 0.14904753101291135 sec
Decode latency: 3.4763565929606557 sec
Time for inference 2: 3.63 sec total, 282.38 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4238.53 GB/s
FLOPS achieved: 21.19 TF/s

Prefill latency: 0.14902899495791644 sec
Decode latency: 3.5821570710395463 sec
Time for inference 3: 3.73 sec total, 274.39 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4118.50 GB/s
FLOPS achieved: 20.59 TF/s

Prefill latency: 0.14987675903830677 sec
Decode latency: 3.5810803120257333 sec
Time for inference 4: 3.73 sec total, 274.40 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4118.76 GB/s
FLOPS achieved: 20.59 TF/s

Prefill latency: 0.149133172002621 sec
Decode latency: 3.5437260920298286 sec
Time for inference 5: 3.69 sec total, 277.23 tokens/sec
Decode latency: 3.54 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4161.22 GB/s
FLOPS achieved: 20.81 TF/s

Prefill latency: 0.14956422097748145 sec
Decode latency: 3.5825616410002112 sec
Time for inference 6: 3.73 sec total, 274.32 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4117.53 GB/s
FLOPS achieved: 20.59 TF/s

Prefill latency: 0.14850666699931026 sec
Decode latency: 3.582061930967029 sec
Time for inference 7: 3.73 sec total, 274.44 tokens/sec
Decode latency: 3.58 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4119.23 GB/s
FLOPS achieved: 20.60 TF/s

Prefill latency: 0.14986592397326604 sec
Decode latency: 3.509606791951228 sec
Time for inference 8: 3.66 sec total, 279.75 tokens/sec
Decode latency: 3.51 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4198.97 GB/s
FLOPS achieved: 20.99 TF/s

Prefill latency: 0.14976805401965976 sec
Decode latency: 3.4839545860304497 sec
Time for inference 9: 3.63 sec total, 281.74 tokens/sec
Decode latency: 3.48 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4228.86 GB/s
FLOPS achieved: 21.14 TF/s

Prefill latency: 0.1492404870223254 sec
Decode latency: 3.5736043700017035 sec
Time for inference 10: 3.72 sec total, 274.97 tokens/sec
Decode latency: 3.57 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4127.29 GB/s
FLOPS achieved: 20.64 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5498 sec
Average prefill latency: 0.1493 sec
Average tokens/sec: 276.80
Memory used: 21.23 GB
