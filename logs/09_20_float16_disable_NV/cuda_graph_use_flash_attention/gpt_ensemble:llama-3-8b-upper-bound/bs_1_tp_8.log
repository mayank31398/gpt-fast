W0927 08:26:45.964000 22512089253696 torch/distributed/run.py:779] 
W0927 08:26:45.964000 22512089253696 torch/distributed/run.py:779] *****************************************
W0927 08:26:45.964000 22512089253696 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:26:45.964000 22512089253696 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=768, bias=False)
        (wo): Linear(in_features=512, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=3584, bias=False)
        (w2): Linear(in_features=1792, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.16 seconds
Prefill latency: 0.01112131803529337 sec
Compilation time: 1.51 seconds
Compilation time: 1.52 seconds
Compilation time: 1.51 seconds
Compilation time: 1.51 seconds
Compilation time: 1.51 seconds
Compilation time: 1.51 seconds
Compilation time: 1.51 seconds
Decode latency: 1.4938345269765705 sec
Compilation time: 1.51 seconds
Prefill latency: 0.011102239019237459 sec
Decode latency: 1.4948179550119676 sec
Prefill latency: 0.011103784025181085 sec
Decode latency: 1.4962569189956412 sec
Prefill latency: 0.011098301969468594 sec
Decode latency: 1.4947727909893729 sec
Prefill latency: 0.011097109003458172 sec
Decode latency: 1.4941980369621888 sec
Prefill latency: 0.011097159993369132 sec
Decode latency: 1.4948835319955833 sec
Time for inference 1: 1.51 sec total, 169.92 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.10 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.011105329031124711 sec
Decode latency: 1.4942028930527158 sec
Time for inference 2: 1.51 sec total, 170.00 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.32 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.011122427007649094 sec
Decode latency: 1.4955284819588996 sec
Time for inference 3: 1.51 sec total, 169.85 tokens/sec
Decode latency: 1.50 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 474.90 GB/s
FLOPS achieved: 2.37 TF/s

Prefill latency: 0.011122163035906851 sec
Decode latency: 1.4941173139959574 sec
Time for inference 4: 1.51 sec total, 170.01 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.34 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.011131025035865605 sec
Decode latency: 1.4936746089952067 sec
Time for inference 5: 1.51 sec total, 170.06 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.48 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.01113116298802197 sec
Decode latency: 1.4937840230413713 sec
Time for inference 6: 1.51 sec total, 170.04 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.44 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.011123450007289648 sec
Decode latency: 1.4943615170195699 sec
Time for inference 7: 1.51 sec total, 169.98 tokens/sec
Decode latency: 1.49 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 475.26 GB/s
FLOPS achieved: 2.38 TF/s

Prefill latency: 0.011130985047202557 sec
Decode latency: 1.4953957700054161 sec
Time for inference 8: 1.51 sec total, 169.87 tokens/sec
Decode latency: 1.50 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 474.95 GB/s
FLOPS achieved: 2.37 TF/s

Prefill latency: 0.011130351049359888 sec
Decode latency: 1.4964275829843245 sec
Time for inference 9: 1.51 sec total, 169.74 tokens/sec
Decode latency: 1.50 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 474.61 GB/s
FLOPS achieved: 2.37 TF/s

Prefill latency: 0.011119848000817 sec
Decode latency: 1.4737551810103469 sec
Time for inference 10: 1.49 sec total, 172.34 tokens/sec
Decode latency: 1.47 sec
Prefill latency: 0.01 sec
Bandwidth achieved: 481.86 GB/s
FLOPS achieved: 2.41 TF/s

==========
Batch Size: 1
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 1.4926 sec
Average prefill latency: 0.0111 sec
Average tokens/sec: 170.18
Memory used: 4.35 GB
