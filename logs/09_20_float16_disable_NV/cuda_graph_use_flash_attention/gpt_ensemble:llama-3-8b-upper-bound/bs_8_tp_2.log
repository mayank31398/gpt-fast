W0927 08:32:10.667000 23177702401856 torch/distributed/run.py:779] 
W0927 08:32:10.667000 23177702401856 torch/distributed/run.py:779] *****************************************
W0927 08:32:10.667000 23177702401856 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:32:10.667000 23177702401856 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.95 seconds
Prefill latency: 0.15793169499374926 sec
Compilation time: 3.15 seconds
Decode latency: 2.9530876469798386 sec
Compilation time: 3.11 seconds
Prefill latency: 0.15896061604144052 sec
Decode latency: 2.956142870010808 sec
Prefill latency: 0.15891375101637095 sec
Decode latency: 2.9571612550062127 sec
Prefill latency: 0.15971804194850847 sec
Decode latency: 2.9573734550504014 sec
Prefill latency: 0.16048992099240422 sec
Decode latency: 2.9561982770101167 sec
Prefill latency: 0.15828237001551315 sec
Decode latency: 2.956304032995831 sec
Time for inference 1: 3.12 sec total, 657.41 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5279.32 GB/s
FLOPS achieved: 26.40 TF/s

Prefill latency: 0.15932394604897127 sec
Decode latency: 2.9563198150135577 sec
Time for inference 2: 3.12 sec total, 657.20 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5277.63 GB/s
FLOPS achieved: 26.39 TF/s

Prefill latency: 0.158608830999583 sec
Decode latency: 2.9571438599959947 sec
Time for inference 3: 3.12 sec total, 657.17 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5277.44 GB/s
FLOPS achieved: 26.39 TF/s

Prefill latency: 0.16027220495743677 sec
Decode latency: 2.955629606032744 sec
Time for inference 4: 3.12 sec total, 657.14 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5277.16 GB/s
FLOPS achieved: 26.39 TF/s

Prefill latency: 0.160094149003271 sec
Decode latency: 2.957931209995877 sec
Time for inference 5: 3.12 sec total, 656.69 tokens/sec
Decode latency: 2.96 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5273.59 GB/s
FLOPS achieved: 26.37 TF/s

Prefill latency: 0.15866761899087578 sec
Decode latency: 2.9543603320489638 sec
Time for inference 6: 3.11 sec total, 657.73 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5281.91 GB/s
FLOPS achieved: 26.41 TF/s

Prefill latency: 0.15943072200752795 sec
Decode latency: 2.9535406909999438 sec
Time for inference 7: 3.11 sec total, 657.75 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5282.05 GB/s
FLOPS achieved: 26.41 TF/s

Prefill latency: 0.15820617496501654 sec
Decode latency: 2.952749637013767 sec
Time for inference 8: 3.11 sec total, 658.16 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5285.34 GB/s
FLOPS achieved: 26.43 TF/s

Prefill latency: 0.15978067799005657 sec
Decode latency: 2.954345656966325 sec
Time for inference 9: 3.11 sec total, 657.48 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5279.89 GB/s
FLOPS achieved: 26.40 TF/s

Prefill latency: 0.1590990709955804 sec
Decode latency: 2.95344335003756 sec
Time for inference 10: 3.11 sec total, 657.84 tokens/sec
Decode latency: 2.95 sec
Prefill latency: 0.16 sec
Bandwidth achieved: 5282.77 GB/s
FLOPS achieved: 26.41 TF/s

==========
Batch Size: 8
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.9552 sec
Average prefill latency: 0.1592 sec
Average tokens/sec: 657.45
Memory used: 13.01 GB
