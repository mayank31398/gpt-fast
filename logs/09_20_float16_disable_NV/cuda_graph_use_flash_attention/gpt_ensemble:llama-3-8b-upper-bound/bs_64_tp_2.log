W0927 08:45:27.199000 22737797125952 torch/distributed/run.py:779] 
W0927 08:45:27.199000 22737797125952 torch/distributed/run.py:779] *****************************************
W0927 08:45:27.199000 22737797125952 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:45:27.199000 22737797125952 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 1.378605987993069 sec
Compilation time: 11.67 seconds
Decode latency: 10.2438257279573 sec
Compilation time: 11.62 seconds
Prefill latency: 1.382431915961206 sec
Decode latency: 10.243770024972036 sec
Prefill latency: 1.3710478860302828 sec
Decode latency: 10.243697349971626 sec
Prefill latency: 1.3792060590349138 sec
Decode latency: 10.242893563001417 sec
Prefill latency: 1.3735786880133674 sec
Decode latency: 10.24555351701565 sec
Prefill latency: 1.373773627972696 sec
Decode latency: 10.158375566010363 sec
Time for inference 1: 11.53 sec total, 1420.62 tokens/sec
Decode latency: 10.16 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11408.32 GB/s
FLOPS achieved: 57.04 TF/s

Prefill latency: 1.3835471820202656 sec
Decode latency: 10.243726596003398 sec
Time for inference 2: 11.63 sec total, 1408.99 tokens/sec
Decode latency: 10.24 sec
Prefill latency: 1.38 sec
Bandwidth achieved: 11314.94 GB/s
FLOPS achieved: 56.57 TF/s

Prefill latency: 1.3717778399586678 sec
Decode latency: 10.243640701984987 sec
Time for inference 3: 11.62 sec total, 1410.43 tokens/sec
Decode latency: 10.24 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11326.53 GB/s
FLOPS achieved: 56.63 TF/s

Prefill latency: 1.3773704569903202 sec
Decode latency: 10.248795470048208 sec
Time for inference 4: 11.63 sec total, 1409.13 tokens/sec
Decode latency: 10.25 sec
Prefill latency: 1.38 sec
Bandwidth achieved: 11316.08 GB/s
FLOPS achieved: 56.58 TF/s

Prefill latency: 1.3891897869762033 sec
Decode latency: 10.245321044989396 sec
Time for inference 5: 11.64 sec total, 1408.11 tokens/sec
Decode latency: 10.25 sec
Prefill latency: 1.39 sec
Bandwidth achieved: 11307.89 GB/s
FLOPS achieved: 56.54 TF/s

Prefill latency: 1.3733912780298851 sec
Decode latency: 10.244338804972358 sec
Time for inference 6: 11.62 sec total, 1410.15 tokens/sec
Decode latency: 10.24 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11324.27 GB/s
FLOPS achieved: 56.62 TF/s

Prefill latency: 1.3765779790119268 sec
Decode latency: 10.246565491019282 sec
Time for inference 7: 11.62 sec total, 1409.49 tokens/sec
Decode latency: 10.25 sec
Prefill latency: 1.38 sec
Bandwidth achieved: 11318.91 GB/s
FLOPS achieved: 56.59 TF/s

Prefill latency: 1.373192738974467 sec
Decode latency: 10.243015178013593 sec
Time for inference 8: 11.62 sec total, 1410.34 tokens/sec
Decode latency: 10.24 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11325.77 GB/s
FLOPS achieved: 56.63 TF/s

Prefill latency: 1.3746342220110819 sec
Decode latency: 10.246592671028338 sec
Time for inference 9: 11.62 sec total, 1409.73 tokens/sec
Decode latency: 10.25 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11320.85 GB/s
FLOPS achieved: 56.60 TF/s

Prefill latency: 1.371307668974623 sec
Decode latency: 10.245073003985453 sec
Time for inference 10: 11.62 sec total, 1410.32 tokens/sec
Decode latency: 10.25 sec
Prefill latency: 1.37 sec
Bandwidth achieved: 11325.59 GB/s
FLOPS achieved: 56.63 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 10.2365 sec
Average prefill latency: 1.3765 sec
Average tokens/sec: 1410.73
Memory used: 39.47 GB
