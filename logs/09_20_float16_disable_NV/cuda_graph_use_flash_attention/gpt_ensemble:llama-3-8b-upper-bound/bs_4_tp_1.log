flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.06 seconds
Prefill latency: 0.1478804710204713 sec
Decode latency: 3.550518360978458 sec
Compilation time: 3.70 seconds
Prefill latency: 0.14939379604766145 sec
Decode latency: 3.5195342380320653 sec
Prefill latency: 0.14942107000388205 sec
Decode latency: 3.5508629079558887 sec
Prefill latency: 0.1486636829795316 sec
Decode latency: 3.5422773100435734 sec
Prefill latency: 0.14948011102387682 sec
Decode latency: 3.470586664043367 sec
Prefill latency: 0.14886678295442834 sec
Decode latency: 3.53400003205752 sec
Time for inference 1: 3.68 sec total, 277.97 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4172.28 GB/s
FLOPS achieved: 20.86 TF/s

Prefill latency: 0.148849010001868 sec
Decode latency: 3.5477095139794983 sec
Time for inference 2: 3.70 sec total, 276.95 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.98 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.1491867119912058 sec
Decode latency: 3.546823284996208 sec
Time for inference 3: 3.70 sec total, 276.99 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4157.61 GB/s
FLOPS achieved: 20.79 TF/s

Prefill latency: 0.14936459000455216 sec
Decode latency: 3.526145573006943 sec
Time for inference 4: 3.68 sec total, 278.54 tokens/sec
Decode latency: 3.53 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4180.81 GB/s
FLOPS achieved: 20.90 TF/s

Prefill latency: 0.14879455196205527 sec
Decode latency: 3.5481353639625013 sec
Time for inference 5: 3.70 sec total, 276.93 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.66 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.1488807509886101 sec
Decode latency: 3.5239832689985633 sec
Time for inference 6: 3.67 sec total, 278.75 tokens/sec
Decode latency: 3.52 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4183.93 GB/s
FLOPS achieved: 20.92 TF/s

Prefill latency: 0.14932930801296607 sec
Decode latency: 3.5491432070266455 sec
Time for inference 7: 3.70 sec total, 276.82 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4155.01 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.14905936201103032 sec
Decode latency: 3.548289072001353 sec
Time for inference 8: 3.70 sec total, 276.89 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.14 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.1491005220450461 sec
Decode latency: 3.5484261389938183 sec
Time for inference 9: 3.70 sec total, 276.89 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4156.03 GB/s
FLOPS achieved: 20.78 TF/s

Prefill latency: 0.14871626696549356 sec
Decode latency: 3.5478290379978716 sec
Time for inference 10: 3.70 sec total, 276.95 tokens/sec
Decode latency: 3.55 sec
Prefill latency: 0.15 sec
Bandwidth achieved: 4157.04 GB/s
FLOPS achieved: 20.79 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.5420 sec
Average prefill latency: 0.1490 sec
Average tokens/sec: 277.37
Memory used: 18.88 GB
