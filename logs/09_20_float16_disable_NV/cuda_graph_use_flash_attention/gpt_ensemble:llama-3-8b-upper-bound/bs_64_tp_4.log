W0927 08:48:36.361000 22570983376704 torch/distributed/run.py:779] 
W0927 08:48:36.361000 22570983376704 torch/distributed/run.py:779] *****************************************
W0927 08:48:36.361000 22570983376704 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:48:36.361000 22570983376704 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.05 seconds
Prefill latency: 0.7196019499679096 sec
Compilation time: 6.47 seconds
Compilation time: 6.47 seconds
Decode latency: 5.643997462000698 sec
Compilation time: 6.37 seconds
Compilation time: 6.48 seconds
Prefill latency: 0.7209594900486991 sec
Decode latency: 5.754028037015814 sec
Prefill latency: 0.7235638680285774 sec
Decode latency: 5.746357477037236 sec
Prefill latency: 0.7195203539449722 sec
Decode latency: 5.75228762201732 sec
Prefill latency: 0.7223741749767214 sec
Decode latency: 5.756413060007617 sec
Prefill latency: 0.723878440039698 sec
Decode latency: 5.6714965180144645 sec
Time for inference 1: 6.40 sec total, 2561.59 tokens/sec
Decode latency: 5.67 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11631.82 GB/s
FLOPS achieved: 58.16 TF/s

Prefill latency: 0.7253721909946762 sec
Decode latency: 5.755887122999411 sec
Time for inference 2: 6.48 sec total, 2527.58 tokens/sec
Decode latency: 5.76 sec
Prefill latency: 0.73 sec
Bandwidth achieved: 11477.39 GB/s
FLOPS achieved: 57.39 TF/s

Prefill latency: 0.7224738880177028 sec
Decode latency: 5.753312846994959 sec
Time for inference 3: 6.48 sec total, 2529.77 tokens/sec
Decode latency: 5.75 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11487.37 GB/s
FLOPS achieved: 57.44 TF/s

Prefill latency: 0.7251168200164102 sec
Decode latency: 5.652967196016107 sec
Time for inference 4: 6.38 sec total, 2568.54 tokens/sec
Decode latency: 5.65 sec
Prefill latency: 0.73 sec
Bandwidth achieved: 11663.38 GB/s
FLOPS achieved: 58.32 TF/s

Prefill latency: 0.7258860380388796 sec
Decode latency: 5.756118201010395 sec
Time for inference 5: 6.48 sec total, 2527.35 tokens/sec
Decode latency: 5.76 sec
Prefill latency: 0.73 sec
Bandwidth achieved: 11476.37 GB/s
FLOPS achieved: 57.38 TF/s

Prefill latency: 0.7218358580139466 sec
Decode latency: 5.747691993950866 sec
Time for inference 6: 6.47 sec total, 2532.18 tokens/sec
Decode latency: 5.75 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11498.28 GB/s
FLOPS achieved: 57.49 TF/s

Prefill latency: 0.7244549780152738 sec
Decode latency: 5.683225380023941 sec
Time for inference 7: 6.41 sec total, 2556.64 tokens/sec
Decode latency: 5.68 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11609.37 GB/s
FLOPS achieved: 58.05 TF/s

Prefill latency: 0.7268145940033719 sec
Decode latency: 5.717116296989843 sec
Time for inference 8: 6.44 sec total, 2542.28 tokens/sec
Decode latency: 5.72 sec
Prefill latency: 0.73 sec
Bandwidth achieved: 11544.17 GB/s
FLOPS achieved: 57.72 TF/s

Prefill latency: 0.7227249920251779 sec
Decode latency: 5.644333615025971 sec
Time for inference 9: 6.37 sec total, 2572.98 tokens/sec
Decode latency: 5.64 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11683.58 GB/s
FLOPS achieved: 58.42 TF/s

Prefill latency: 0.7229741039918736 sec
Decode latency: 5.7383548759971745 sec
Time for inference 10: 6.46 sec total, 2535.44 tokens/sec
Decode latency: 5.74 sec
Prefill latency: 0.72 sec
Bandwidth achieved: 11513.10 GB/s
FLOPS achieved: 57.57 TF/s

==========
Batch Size: 64
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 5.7121 sec
Average prefill latency: 0.7242 sec
Average tokens/sec: 2545.44
Memory used: 30.87 GB
