W0927 08:36:41.804000 22879017244480 torch/distributed/run.py:779] 
W0927 08:36:41.804000 22879017244480 torch/distributed/run.py:779] *****************************************
W0927 08:36:41.804000 22879017244480 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:36:41.804000 22879017244480 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=3072, bias=False)
        (wo): Linear(in_features=2048, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=14336, bias=False)
        (w2): Linear(in_features=7168, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.10 seconds
Prefill latency: 0.3166520880185999 sec
Decode latency: 3.912653526000213 sec
Compilation time: 4.23 seconds
Compilation time: 4.25 seconds
Prefill latency: 0.31665706500643864 sec
Decode latency: 3.912892466003541 sec
Prefill latency: 0.3182449210435152 sec
Decode latency: 3.9126351170125417 sec
Prefill latency: 0.31731084105558693 sec
Decode latency: 3.9130168359843083 sec
Prefill latency: 0.315602354996372 sec
Decode latency: 3.9121615479816683 sec
Prefill latency: 0.3188221540185623 sec
Decode latency: 3.914890892978292 sec
Time for inference 1: 4.23 sec total, 967.33 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7768.15 GB/s
FLOPS achieved: 38.84 TF/s

Prefill latency: 0.31766605202574283 sec
Decode latency: 3.9106548790005036 sec
Time for inference 2: 4.23 sec total, 968.56 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7778.06 GB/s
FLOPS achieved: 38.89 TF/s

Prefill latency: 0.31945722602540627 sec
Decode latency: 3.91413744201418 sec
Time for inference 3: 4.23 sec total, 967.34 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7768.22 GB/s
FLOPS achieved: 38.84 TF/s

Prefill latency: 0.3175485350075178 sec
Decode latency: 3.910735765006393 sec
Time for inference 4: 4.23 sec total, 968.52 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7777.75 GB/s
FLOPS achieved: 38.89 TF/s

Prefill latency: 0.3176765990210697 sec
Decode latency: 3.912083046976477 sec
Time for inference 5: 4.23 sec total, 968.20 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7775.13 GB/s
FLOPS achieved: 38.88 TF/s

Prefill latency: 0.3172869029804133 sec
Decode latency: 3.9118423619656824 sec
Time for inference 6: 4.23 sec total, 968.37 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7776.50 GB/s
FLOPS achieved: 38.88 TF/s

Prefill latency: 0.3181452439748682 sec
Decode latency: 3.91188355704071 sec
Time for inference 7: 4.23 sec total, 968.16 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7774.84 GB/s
FLOPS achieved: 38.87 TF/s

Prefill latency: 0.3199023969937116 sec
Decode latency: 3.8771431549685076 sec
Time for inference 8: 4.20 sec total, 975.76 tokens/sec
Decode latency: 3.88 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7835.87 GB/s
FLOPS achieved: 39.18 TF/s

Prefill latency: 0.31973741500405595 sec
Decode latency: 3.9113878100179136 sec
Time for inference 9: 4.23 sec total, 967.90 tokens/sec
Decode latency: 3.91 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7772.76 GB/s
FLOPS achieved: 38.86 TF/s

Prefill latency: 0.3177901530289091 sec
Decode latency: 3.81569453998236 sec
Time for inference 10: 4.13 sec total, 990.76 tokens/sec
Decode latency: 3.82 sec
Prefill latency: 0.32 sec
Bandwidth achieved: 7956.31 GB/s
FLOPS achieved: 39.78 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 3.8990 sec
Average prefill latency: 0.3184 sec
Average tokens/sec: 971.09
Memory used: 16.79 GB
