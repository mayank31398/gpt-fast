W0927 08:29:21.752000 23315355547456 torch/distributed/run.py:779] 
W0927 08:29:21.752000 23315355547456 torch/distributed/run.py:779] *****************************************
W0927 08:29:21.752000 23315355547456 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0927 08:29:21.752000 23315355547456 torch/distributed/run.py:779] *****************************************
flash_kv_decode is set to True
Using device=cuda
Loading model ...
GPTEnsemble(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x EnsembleTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 1.08 seconds
Prefill latency: 0.04599319101544097 sec
Compilation time: 2.07 seconds
Compilation time: 1.99 seconds
Compilation time: 2.07 seconds
Decode latency: 1.985974759038072 sec
Compilation time: 2.03 seconds
Prefill latency: 0.045710636011790484 sec
Decode latency: 1.9149909249972552 sec
Prefill latency: 0.04571112198755145 sec
Decode latency: 2.0151909550186247 sec
Prefill latency: 0.04561428097076714 sec
Decode latency: 2.01608730800217 sec
Prefill latency: 0.04562859295401722 sec
Decode latency: 2.014126271009445 sec
Prefill latency: 0.045616351009812206 sec
Decode latency: 2.0157380320015363 sec
Time for inference 1: 2.06 sec total, 496.60 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2255.01 GB/s
FLOPS achieved: 11.28 TF/s

Prefill latency: 0.0456885090097785 sec
Decode latency: 2.0146943340077996 sec
Time for inference 2: 2.06 sec total, 496.83 tokens/sec
Decode latency: 2.01 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2256.04 GB/s
FLOPS achieved: 11.28 TF/s

Prefill latency: 0.045720705995336175 sec
Decode latency: 2.016213140974287 sec
Time for inference 3: 2.06 sec total, 496.47 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2254.39 GB/s
FLOPS achieved: 11.27 TF/s

Prefill latency: 0.04571931000100449 sec
Decode latency: 2.017532006953843 sec
Time for inference 4: 2.06 sec total, 496.15 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2252.93 GB/s
FLOPS achieved: 11.26 TF/s

Prefill latency: 0.04563880298519507 sec
Decode latency: 2.015794465027284 sec
Time for inference 5: 2.06 sec total, 496.59 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2254.95 GB/s
FLOPS achieved: 11.27 TF/s

Prefill latency: 0.04587791895028204 sec
Decode latency: 2.0161427599960007 sec
Time for inference 6: 2.06 sec total, 496.42 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2254.16 GB/s
FLOPS achieved: 11.27 TF/s

Prefill latency: 0.045637062983587384 sec
Decode latency: 2.0133985549909994 sec
Time for inference 7: 2.06 sec total, 497.15 tokens/sec
Decode latency: 2.01 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2257.51 GB/s
FLOPS achieved: 11.29 TF/s

Prefill latency: 0.045650328043848276 sec
Decode latency: 1.923976160993334 sec
Time for inference 8: 1.97 sec total, 519.67 tokens/sec
Decode latency: 1.92 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2359.75 GB/s
FLOPS achieved: 11.80 TF/s

Prefill latency: 0.045958983013406396 sec
Decode latency: 2.0181565749808215 sec
Time for inference 9: 2.06 sec total, 495.91 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2251.85 GB/s
FLOPS achieved: 11.26 TF/s

Prefill latency: 0.04581042699282989 sec
Decode latency: 2.0161542660207488 sec
Time for inference 10: 2.06 sec total, 496.42 tokens/sec
Decode latency: 2.02 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 2254.18 GB/s
FLOPS achieved: 11.27 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 256
Average decode latency: 2.0068 sec
Average prefill latency: 0.0457 sec
Average tokens/sec: 498.82
Memory used: 7.31 GB
