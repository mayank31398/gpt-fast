[2024-09-13 12:46:18,642] torch.distributed.run: [WARNING] 
[2024-09-13 12:46:18,642] torch.distributed.run: [WARNING] *****************************************
[2024-09-13 12:46:18,642] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-09-13 12:46:18,642] torch.distributed.run: [WARNING] *****************************************
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8
88
8
our tp world size is
our tp world size is our tp world size is our tp world size is  our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
our tp world size isour tp world size is Using device=cuda
our tp world size isour tp world size is 8
8
our tp world size is  88
Loading model ...our tp world size is 88
our tp world size is our tp world size is 8


 8
our tp world size is 8
8
our tp world size isour tp world size is our tp world size is 
our tp world size is 8
our tp world size is our tp world size is  888
our tp world size is 8
our tp world size is 8
8


our tp world size is8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8our tp world size is 8
our tp world size is 8
8
8
 8
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is 
our tp world size is our tp world size is 8
our tp world size is 8
8
8
our tp world size is 8
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
our tp world size is 8
8
8
our tp world size is8
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is  8our tp world size is our tp world size is 8
our tp world size is 8
8
8

8
8our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size isour tp world size is
8
our tp world size is 8
8
8
  8our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is 8

8
8
our tp world size is 8
8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size isour tp world size is our tp world size is 8
8
88
our tp world size is  88
8
our tp world size isour tp world size is 
our tp world size isour tp world size is 8

our tp world size is our tp world size is  88
 88
our tp world size is our tp world size is 8
8
our tp world size is 
our tp world size is 8
8
our tp world size is 
our tp world size is 8
our tp world size is 8
our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
8
our tp world size is 8
our tp world size is8
our tp world size is 8our tp world size is our tp world size is 8
our tp world size is  8our tp world size is 8

8
8our tp world size is 8

8our tp world size is our tp world size is our tp world size is 
8
our tp world size is 8
our tp world size is our tp world size is
8
8
8
our tp world size is our tp world size is 8
 8our tp world size is our tp world size is our tp world size is our tp world size is 8
8

our tp world size is 8
8
8
8
our tp world size isour tp world size is our tp world size is 8our tp world size is our tp world size is our tp world size is our tp world size is  88
8

8
8
8
8

our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8
8
8
88
8
8
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size isour tp world size is our tp world size is our tp world size is 8
8
8
8
 88
8
8
our tp world size isour tp world size isour tp world size is our tp world size is our tp world size is 
our tp world size is our tp world size is  8 88
8
8
our tp world size is 8
8


our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
8our tp world size is 8
8
8
8
our tp world size is our tp world size is 
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is 
8
8
8
8
our tp world size is our tp world size is 8
our tp world size isour tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is  88
8
8
8
our tp world size is our tp world size is 8

our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is our tp world size is 8
8
8
8
our tp world size is our tp world size is8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
 our tp world size is our tp world size is 8
8
88
our tp world size is88
8
our tp world size isour tp world size is
our tp world size is 8
our tp world size is our tp world size is   8 8our tp world size is
our tp world size is8
8
8

 8our tp world size is  8our tp world size isour tp world size is 
our tp world size is 
our tp world size is8

our tp world size is 8
our tp world size is8
our tp world size is our tp world size is 88our tp world size is  8our tp world size is 88 

8

 8

our tp world size is8
our tp world size is our tp world size is our tp world size is our tp world size is
our tp world size is 8our tp world size is8
8our tp world size is8
  our tp world size is
 8
 our tp world size is 8
8 our tp world size is
8
our tp world size isour tp world size is8
our tp world size is 
8
 our tp world size is  8 8our tp world size is 8
our tp world size isour tp world size is88


8our tp world size is   8
our tp world size is our tp world size is our tp world size is 
8
8
our tp world size is 8
88
our tp world size isour tp world size is 
our tp world size is 8
our tp world size is 
our tp world size is 8
our tp world size is8
our tp world size is 8 8our tp world size is 8
our tp world size is  our tp world size is 8


8
our tp world size is 8
88
our tp world size isour tp world size isour tp world size is our tp world size is 8
our tp world size is 
our tp world size is  8 88
our tp world size is8
our tp world size is8

our tp world size is8
our tp world size is  our tp world size is  8our tp world size is 8
our tp world size is8
8
8

our tp world size is 
our tp world size is  our tp world size is our tp world size isour tp world size is  88our tp world size is 8
88
 8

our tp world size is
8

our tp world size isour tp world size is our tp world size is 8
our tp world size is  8our tp world size is our tp world size is  88
8
our tp world size is8

our tp world size is8
8

our tp world size isour tp world size is our tp world size is  our tp world size is  8our tp world size is our tp world size is  88
8
88

our tp world size is8
8

our tp world size is our tp world size is 
our tp world size isour tp world size is 8our tp world size is our tp world size is our tp world size is 8
8
 8 8
8
8
8
our tp world size is our tp world size is 

our tp world size isour tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is  88
8
8
8
our tp world size is our tp world size is 8

our tp world size isour tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is  88
8
8
8
our tp world size is our tp world size is 8

our tp world size isour tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is 88
8
8
8
our tp world size is our tp world size is  8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8

our tp world size isour tp world size is 8
8
8
8
our tp world size is our tp world size is  88
our tp world size is our tp world size isour tp world size isour tp world size is 8
8

our tp world size isour tp world size is 8
 8 88
our tp world size is our tp world size is  88
our tp world size is 

our tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is our tp world size is 8
our tp world size is our tp world size is  88
our tp world size is 8
8
our tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is our tp world size is 8
our tp world size is our tp world size is  88
our tp world size is 8
8
our tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is our tp world size is 8
our tp world size is our tp world size is  88
our tp world size is 8
8
our tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is our tp world size is 8
our tp world size is our tp world size is  88
our tp world size is 8
8our tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is 
8
our tp world size is our tp world size is  88
our tp world size is 8
our tp world size isour tp world size is 8
8

our tp world size is 8
our tp world size is  88
our tp world size is our tp world size is our tp world size is 8our tp world size is 8

our tp world size is 8
8
8

8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is 8
8
8
8
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8our tp world size is 8
8
8
8
8
our tp world size is 
our tp world size is8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
 8our tp world size is 8
8
8
8
8
our tp world size isour tp world size is
our tp world size is8
our tp world size is our tp world size is our tp world size is our tp world size is  8 8 8our tp world size is 8
8
8
8



our tp world size is8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is  8our tp world size is 8
8
8
8
8
8

8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8
8
8
88
8
8
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is our tp world size is our tp world size is 8
8
8
8
our tp world size is 8
8
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size isour tp world size isour tp world size is applying tp to block 0
8
8
8
8
 8 88applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is 

our tp world size is
applying tp to block 08
8
8
8
our tp world size is  8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8

applying tp to block 0
8
8
8
8
8
our tp world size is our tp world size is applying tp to block 0our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8

8
8
8
8
8
our tp world size is our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
8
applying tp to block 0
8
8
8
8
8
our tp world size is our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 88
applying tp to block 0
8
8
8
8
8

our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
applying tp to block 0
8
8
8
8
8
8
our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
applying tp to block 0
8
8
8
8
8
8
our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
applying tp to block 0
8
8
8
8
8
8
our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
applying tp to block 0
8
8
8
8
8
8
our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
applying tp to block 0
8
8
8
8
88
our tp world size is applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is 8
applying tp to block 0
8
8
8
8
our tp world size is 8
our tp world size is applying tp to block 0our tp world size is 8
our tp world size isour tp world size isour tp world size is 8our tp world size is 8

our tp world size is  8 88
8
our tp world size is applying tp to block 0
8



our tp world size isour tp world size isour tp world size is 8
applying tp to block 0
our tp world size is our tp world size isour tp world size is  8 88
our tp world size is applying tp to block 0
8
 88


our tp world size is 8
applying tp to block 0our tp world size is 
our tp world size is our tp world size is our tp world size is8
our tp world size is 
8
our tp world size is8
8
 our tp world size is 8
applying tp to block 0
our tp world size is  our tp world size is our tp world size is 88
our tp world size is applying tp to block 0
8
88
8

our tp world size is8
applying tp to block 0
our tp world size is 
applying tp to block 0
our tp world size is our tp world size is 8our tp world size is applying tp to block 08
our tp world size is applying tp to block 08
 
8

applying tp to block 0
8
our tp world size is 8
our tp world size is our tp world size isapplying tp to block 0

applying tp to block 0
applying tp to block 0
8our tp world size is8
 8applying tp to block 0
our tp world size isapplying tp to block 0
applying tp to block 0

 8our tp world size is 
applying tp to block 0
 applying tp to block 0
applying tp to block 0
our tp world size is 
8
our tp world size is applying tp to block 0
8
applying tp to block 0
applying tp to block 0
8
our tp world size is our tp world size is 8
applying tp to block 0
our tp world size is applying tp to block 0
applying tp to block 0
applying tp to block 08
8
applying tp to block 0applying tp to block 0
8
applying tp to block 0
applying tp to block 0

applying tp to block 0our tp world size is our tp world size is 
applying tp to block 0applying tp to block 0
our tp world size is applying tp to block 0
applying tp to block 0

8
8

applying tp to block 0applying tp to block 0
8
applying tp to block 0applying tp to block 0
applying tp to block 0
our tp world size is applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 08
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0Applying tensor parallel to model ...
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0


applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
we finish operating the TP!
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0

applying tp to block 0


applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0


applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0we finish operating the TP!
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0
we finish operating the TP!applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0

applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
we finish operating the TP!applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0we finish operating the TP!

applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0we finish operating the TP!
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0we finish operating the TP!

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
we finish operating the TP!
GPTResidual(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x TurboTransformerBlock(
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
we comment comm is False
models all reduce stream is None
Time to load model: 3.88 seconds
the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 623.99 sec
Time for inference -4: 1316.98 sec total, 0.78 tokens/sec
Bandwidth achieved: 14.94 GB/s
FLOPS achieved: 0.03 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 2.75 sec
Time for inference -3: 22.68 sec total, 45.16 tokens/sec
Bandwidth achieved: 867.74 GB/s
FLOPS achieved: 1.74 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference -2: 19.96 sec total, 51.31 tokens/sec
Bandwidth achieved: 985.92 GB/s
FLOPS achieved: 1.97 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference -1: 19.76 sec total, 51.83 tokens/sec
Bandwidth achieved: 995.92 GB/s
FLOPS achieved: 1.99 TF/s

the shape of input is torch.Size([1, 1024])
Compilation time: 19.79 seconds
the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference 1: 19.79 sec total, 51.76 tokens/sec
Bandwidth achieved: 994.59 GB/s
FLOPS achieved: 1.99 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference 2: 19.92 sec total, 51.42 tokens/sec
Bandwidth achieved: 988.08 GB/s
FLOPS achieved: 1.98 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference 3: 19.80 sec total, 51.71 tokens/sec
Bandwidth achieved: 993.75 GB/s
FLOPS achieved: 1.99 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference 4: 19.74 sec total, 51.86 tokens/sec
Bandwidth achieved: 996.65 GB/s
FLOPS achieved: 1.99 TF/s

the shape of input is torch.Size([1, 1024])
tokens we generated: 1024
Time for prefill: 0.09 sec
Time for inference 5: 19.80 sec total, 51.72 tokens/sec
Bandwidth achieved: 993.89 GB/s
FLOPS achieved: 1.99 TF/s

the shape of input is torch.Size([1, 1024])
Traceback (most recent call last):
  File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 381, in <module>
    main(
  File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 307, in main
    y, prefill_latency = generate(
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 155, in generate
    generated_tokens, _ = decode_n_tokens(model, next_token.view(batch_size, -1), input_pos, max_new_tokens - 1, callback=callback, **sampling_kwargs)
  File "/home/charlie/skip-residual/gpt-fast/benchmark.py", line 98, in decode_n_tokens
    input_pos += 1
RuntimeError: CUDA error: unspecified launch failure
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2024-09-13 13:12:00,414] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388624 closing signal SIGTERM
[2024-09-13 13:12:00,422] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388625 closing signal SIGTERM
[2024-09-13 13:12:00,430] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388626 closing signal SIGTERM
[2024-09-13 13:12:00,439] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388628 closing signal SIGTERM
[2024-09-13 13:12:00,453] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388629 closing signal SIGTERM
[2024-09-13 13:12:00,472] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388630 closing signal SIGTERM
[2024-09-13 13:12:00,521] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 1388631 closing signal SIGTERM
[2024-09-13 13:12:02,330] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 3 (pid: 1388627) of binary: /home/charlie/anaconda3/envs/gpt-fast/bin/python
Traceback (most recent call last):
  File "/home/charlie/anaconda3/envs/gpt-fast/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==2.2.2', 'console_scripts', 'torchrun')())
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/charlie/anaconda3/envs/gpt-fast/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
benchmark.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-09-13_13:12:00
  host      : mk-xii-11.cloud.together.ai
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1388627)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
