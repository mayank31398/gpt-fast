[2024-09-13 13:41:25,382] torch.distributed.run: [WARNING] 
[2024-09-13 13:41:25,382] torch.distributed.run: [WARNING] *****************************************
[2024-09-13 13:41:25,382] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-09-13 13:41:25,382] torch.distributed.run: [WARNING] *****************************************
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is 8
our tp world size is our tp world size is our tp world size is 8
8
8
our tp world size is our tp world size is our tp world size is 8
88our tp world size is 

8
our tp world size is our tp world size isour tp world size is 8
 88
our tp world size is 
our tp world size is 8
our tp world size is8
our tp world size is  8our tp world size is 8

8
our tp world size is our tp world size is our tp world size is 8
88
our tp world size is our tp world size is 
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is Using device=cuda
our tp world size is 8
our tp world size is our tp world size is 8
8
8
Loading model ...
8our tp world size is 8
8
our tp world size is our tp world size is our tp world size is 
our tp world size is 8our tp world size is our tp world size is 8
8
8our tp world size is 8

8
8
our tp world size is our tp world size is 
8
our tp world size is our tp world size isour tp world size is our tp world size is 8
8
our tp world size isour tp world size is 8
 8
8
our tp world size is our tp world size is  88
our tp world size is 8
our tp world size isour tp world size is 8
8

our tp world size isour tp world size is 8
our tp world size is  8
our tp world size is our tp world size is  8
our tp world size is 8
8
our tp world size is 8
8
8
our tp world size is 8our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is 8
8
8
our tp world size is 8
8
8

our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
8
our tp world size is 8
8
88
our tp world size is our tp world size is our tp world size is 8our tp world size is our tp world size is 
our tp world size is 8
8
8

our tp world size is8
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is  8our tp world size is our tp world size is 8
our tp world size is 8
8
8

our tp world size is8
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is  8our tp world size is our tp world size is 8
our tp world size is8
8
8

8
8
our tp world size is  8our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8

888
88
8our tp world size is our tp world size is 
our tp world size is
our tp world size isour tp world size is 
our tp world size is 
88 8 88
our tp world size is8
our tp world size is 



our tp world size isour tp world size is  8our tp world size is 8
our tp world size is our tp world size isour tp world size is  88

8
our tp world size is 8
 88

our tp world size is our tp world size is our tp world size is 8
our tp world size is 
our tp world size isour tp world size is 8
8
8
our tp world size is 8
 8our tp world size is 8our tp world size is our tp world size is our tp world size is 8
our tp world size is 
8

8
8
8
our tp world size is 8
our tp world size isour tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is  88
8
8
8
8
our tp world size is 8

our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
88
8our tp world size is8
our tp world size is 8
8
our tp world size is 
our tp world size is
 our tp world size isour tp world size is 8
our tp world size is our tp world size is 8 88
 88
our tp world size is 8
8


our tp world size is 
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is 8
8our tp world size is8
8
our tp world size is 8
our tp world size is 8

 8our tp world size is our tp world size is 8
our tp world size is 8
our tp world size is our tp world size is 
our tp world size is8
8
our tp world size is 8
our tp world size is 8
8
 8our tp world size is our tp world size is 8our tp world size is 8
our tp world size is our tp world size is 
8
8

8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
8
8
8
8
our tp world size is 8
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8our tp world size is our tp world size is 8
8
8
8
8

our tp world size is8
8
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is  8our tp world size is our tp world size is applying tp to block 0
8
8
8
8

our tp world size is8
8
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is  8our tp world size is our tp world size is applying tp to block 0
8
8
8
8

8
8
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
8
8
8
8
8
8
8
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
8
8
8
8
8
88
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is applying tp to block 0
8
8
8
8
8
our tp world size is 8
applying tp to block 0
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8
our tp world size is applying tp to block 0
8
8
8
8
8
our tp world size is 8applying tp to block 0our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 8

our tp world size is
applying tp to block 08
8
8
8
8our tp world size is 8our tp world size is 
applying tp to block 0our tp world size is our tp world size is our tp world size is 
 8
our tp world size is8

applying tp to block 08
8
8
our tp world size is 
 8our tp world size is 
applying tp to block 0our tp world size is our tp world size is our tp world size is 8
our tp world size is 
our tp world size is8

applying tp to block 08
8
8
our tp world size is 8
 8our tp world size is 
applying tp to block 0our tp world size is our tp world size is our tp world size is 8
our tp world size is 
8

8
88
our tp world size is 8
our tp world size is our tp world size is applying tp to block 0

our tp world size is our tp world size is 8our tp world size is 8
8
applying tp to block 0
our tp world size is 8
8

8
our tp world size is our tp world size is applying tp to block 0
8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8our tp world size isapplying tp to block 0
our tp world size is 8
8
88

 8applying tp to block 0
8
our tp world size is our tp world size is 
our tp world size isour tp world size is our tp world size is 
applying tp to block 0
our tp world size is 8
8
 88
8
our tp world size is applying tp to block 0
8
our tp world size is our tp world size is 
our tp world size is our tp world size is 8
applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
our tp world size is applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is 8
applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
our tp world size is applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is 8applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8

applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size isour tp world size is8
8
8
applying tp to block 0
8
our tp world size is  8 our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8

8
8
8
8
applying tp to block 0
8
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
88
8
8
applying tp to block 0
8
our tp world size is our tp world size is 
our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
8
our tp world size is 8
8
8
applying tp to block 08
our tp world size is our tp world size is 8our tp world size is our tp world size is our tp world size is 
our tp world size is 8
8

our tp world size is8
8
8
applying tp to block 08
our tp world size is our tp world size is  8our tp world size is our tp world size is our tp world size is 
our tp world size is 8
8

8
8
8
applying tp to block 08
our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is 8
88
8
8
8
applying tp to block 08
our tp world size is 
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 0
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 0
8
our tp world size is 8
our tp world size isour tp world size is our tp world size is our tp world size is applying tp to block 0our tp world size is 8
our tp world size is  88
8
8

8
our tp world size is 8

our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is our tp world size is 8
8
8
applying tp to block 0
8
our tp world size is 8
8our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 
our tp world size is8
8
8
applying tp to block 0
8
our tp world size is 8
 8our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 
8
8
8
applying tp to block 08
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 0
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 0
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 08
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 
our tp world size is 8
our tp world size is 8
8
8
8
applying tp to block 0
8
our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is applying tp to block 0
our tp world size is 8
our tp world size is 8
8
8
8
we finish operating the TP!
8our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 
8
our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 8
8
our tp world size is 8
8
8
8
our tp world size is our tp world size is 8
our tp world size is our tp world size is our tp world size is our tp world size is 88
our tp world size is 8
8
8
8
our tp world size is 8our tp world size isapplying tp to block 0
our tp world size is 
our tp world size is 8

 8applying tp to block 0
8
our tp world size is8
our tp world size is our tp world size is 
applying tp to block 0
applying tp to block 0
 8our tp world size is 8
8
our tp world size is applying tp to block 0
applying tp to block 0

8
our tp world size is our tp world size is 8applying tp to block 0
applying tp to block 0
our tp world size is our tp world size is 8
8

applying tp to block 0
applying tp to block 0
8
8our tp world size is our tp world size is our tp world size is applying tp to block 0
applying tp to block 0
our tp world size is 
8
8
8
applying tp to block 0applying tp to block 0
8
our tp world size isour tp world size isour tp world size is our tp world size is 
applying tp to block 0
our tp world size is  8
8applying tp to block 0applying tp to block 0 888our tp world size is





 our tp world size isapplying tp to block 0applying tp to block 0our tp world size is our tp world size is our tp world size is8
 8
applying tp to block 0
applying tp to block 088
 our tp world size is



our tp world size is8 our tp world size isapplying tp to block 0
applying tp to block 0our tp world size is  
8
 8applying tp to block 0

applying tp to block 08
8
our tp world size is our tp world size is 
our tp world size isapplying tp to block 0

applying tp to block 0
our tp world size is 88
 8applying tp to block 0
applying tp to block 0applying tp to block 08

our tp world size isapplying tp to block 0
applying tp to block 0

our tp world size is 
applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0
 8
applying tp to block 0


applying tp to block 08

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

our tp world size is applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
8
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
Applying tensor parallel to model ...

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0




applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0applying tp to block 0applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0



applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0


applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0


applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0
we finish operating the TP!
applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0

we finish operating the TP!
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0


applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0

applying tp to block 0

applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0applying tp to block 0

applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0

applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0applying tp to block 0
applying tp to block 0
we finish operating the TP!applying tp to block 0

applying tp to block 0
applying tp to block 0

we finish operating the TP!
applying tp to block 0
applying tp to block 0
applying tp to block 0
applying tp to block 0
we finish operating the TP!
applying tp to block 0
applying tp to block 0applying tp to block 0

we finish operating the TP!applying tp to block 0

applying tp to block 0
applying tp to block 0
applying tp to block 0
we finish operating the TP!
GPTResidual(
  (tok_embeddings): Embedding(128256, 8192)
  (layers): ModuleList(
    (0-79): 80 x TurboTransformerBlock(
      (attention): Attention(
        (wqkv): Linear(in_features=8192, out_features=1280, bias=False)
        (wo): Linear(in_features=1024, out_features=8192, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=8192, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=8192, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=8192, out_features=128256, bias=False)
)
we comment comm is True
models all reduce stream is None
Time to load model: 4.13 seconds
the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 555.54 sec
Time for inference -4: 1137.07 sec total, 0.90 tokens/sec
Bandwidth achieved: 17.31 GB/s
FLOPS achieved: 0.55 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 2.50 sec
Time for inference -3: 20.36 sec total, 50.30 tokens/sec
Bandwidth achieved: 966.66 GB/s
FLOPS achieved: 30.93 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference -2: 18.27 sec total, 56.06 tokens/sec
Bandwidth achieved: 1077.31 GB/s
FLOPS achieved: 34.47 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.66 sec
Time for inference -1: 18.26 sec total, 56.08 tokens/sec
Bandwidth achieved: 1077.61 GB/s
FLOPS achieved: 34.48 TF/s

the shape of input is torch.Size([16, 1024])
Compilation time: 18.22 seconds
the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 1: 18.21 sec total, 56.24 tokens/sec
Bandwidth achieved: 1080.66 GB/s
FLOPS achieved: 34.58 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 2: 18.20 sec total, 56.25 tokens/sec
Bandwidth achieved: 1081.01 GB/s
FLOPS achieved: 34.59 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 3: 18.27 sec total, 56.05 tokens/sec
Bandwidth achieved: 1077.01 GB/s
FLOPS achieved: 34.46 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.66 sec
Time for inference 4: 18.23 sec total, 56.17 tokens/sec
Bandwidth achieved: 1079.37 GB/s
FLOPS achieved: 34.54 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 5: 18.22 sec total, 56.19 tokens/sec
Bandwidth achieved: 1079.88 GB/s
FLOPS achieved: 34.56 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 6: 18.22 sec total, 56.19 tokens/sec
Bandwidth achieved: 1079.84 GB/s
FLOPS achieved: 34.56 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 7: 18.22 sec total, 56.19 tokens/sec
Bandwidth achieved: 1079.82 GB/s
FLOPS achieved: 34.55 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.66 sec
Time for inference 8: 18.23 sec total, 56.18 tokens/sec
Bandwidth achieved: 1079.62 GB/s
FLOPS achieved: 34.55 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 9: 18.23 sec total, 56.17 tokens/sec
Bandwidth achieved: 1079.49 GB/s
FLOPS achieved: 34.54 TF/s

the shape of input is torch.Size([16, 1024])
tokens we generated: 1024
Time for prefill: 0.65 sec
Time for inference 10: 18.23 sec total, 56.18 tokens/sec
Bandwidth achieved: 1079.63 GB/s
FLOPS achieved: 34.55 TF/s

==========
Batch Size: 16
Prompt Length: 1024
Generated tokens: 1024
Average prefill latency: 0.79 sec
Average tokens/sec: 55.71
Memory used: 35.97 GB
