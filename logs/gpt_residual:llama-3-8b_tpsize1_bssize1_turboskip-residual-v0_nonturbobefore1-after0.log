Using device=cuda
Loading model ...
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
our tp world size is 1
GPTResidual(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x TurboTransformerBlock(
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=6144, bias=False)
        (wo): Linear(in_features=4096, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=28672, bias=False)
        (w2): Linear(in_features=14336, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
model s all reduce stream is None
Time to load model: 0.26 seconds
tokens we generated: 1024
Time for prefill: 54.45 sec
Time for inference -4: 122.56 sec total, 8.35 tokens/sec
Bandwidth achieved: 125.40 GB/s
FLOPS achieved: 0.25 TF/s

tokens we generated: 1024
Time for prefill: 0.38 sec
Time for inference -3: 7.23 sec total, 141.58 tokens/sec
Bandwidth achieved: 2125.03 GB/s
FLOPS achieved: 4.25 TF/s

tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference -2: 6.78 sec total, 151.01 tokens/sec
Bandwidth achieved: 2266.57 GB/s
FLOPS achieved: 4.53 TF/s

tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference -1: 6.80 sec total, 150.63 tokens/sec
Bandwidth achieved: 2260.89 GB/s
FLOPS achieved: 4.52 TF/s

Compilation time: 6.78 seconds
tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference 1: 6.78 sec total, 151.08 tokens/sec
Bandwidth achieved: 2267.73 GB/s
FLOPS achieved: 4.54 TF/s

tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference 2: 6.78 sec total, 151.03 tokens/sec
Bandwidth achieved: 2266.89 GB/s
FLOPS achieved: 4.53 TF/s

tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference 3: 6.78 sec total, 150.96 tokens/sec
Bandwidth achieved: 2265.86 GB/s
FLOPS achieved: 4.53 TF/s

tokens we generated: 1024
Time for prefill: 0.04 sec
Time for inference 4: 6.80 sec total, 150.49 tokens/sec
Bandwidth achieved: 2258.88 GB/s
FLOPS achieved: 4.52 TF/s

