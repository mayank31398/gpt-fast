flash_kv_decode is set to False
Using device=cuda
Loading model ...
GPTLadder(
  (tok_embeddings): Embedding(128256, 4096)
  (layers): ModuleList(
    (0-31): 32 x LadderTransformerBlock(
      semi_compiled = False
      (attention): Attention(
        (wqkv): Linear(in_features=4096, out_features=1536, bias=False)
        (wo): Linear(in_features=1024, out_features=4096, bias=False)
      )
      (feed_forward): FeedForward(
        (w1): Linear(in_features=4096, out_features=7168, bias=False)
        (w2): Linear(in_features=3584, out_features=4096, bias=False)
      )
      (ffn_norm): RMSNorm()
      (attention_norm): RMSNorm()
    )
  )
  (norm): RMSNorm()
  (output): Linear(in_features=4096, out_features=128256, bias=False)
)
Time to load model: 0.06 seconds
Compiling prefill with dynamic=False
Prefill latency: 72.9416152650083 sec
Decode latency: 68.4879574959923 sec
Compilation time: 141.44 seconds
Compilation time: 141.44 secondsCompilation time: 141.44 secondsCompilation time: 141.44 seconds


Prefill latency: 1.0541584349994082 sec
Decode latency: 0.11553676999756135 sec
Prefill latency: 0.05108224099967629 sec
Decode latency: 0.11546240400639363 sec
Prefill latency: 0.05120536402682774 sec
Decode latency: 0.11531956298858859 sec
Prefill latency: 0.05088934500236064 sec
Decode latency: 0.11494240799220279 sec
Prefill latency: 0.050902064016554505 sec
Decode latency: 0.11495273499167524 sec
Time for inference 1: 0.17 sec total, 187.00 tokens/sec
Decode latency: 0.11 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 849.15 GB/s
FLOPS achieved: 112.09 TF/s

Prefill latency: 0.05098137998720631 sec
Decode latency: 0.11527432000730187 sec
Time for inference 2: 0.17 sec total, 186.59 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 847.26 GB/s
FLOPS achieved: 111.84 TF/s

Prefill latency: 0.05095430000801571 sec
Decode latency: 0.11527169600594789 sec
Time for inference 3: 0.17 sec total, 186.52 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 846.95 GB/s
FLOPS achieved: 111.80 TF/s

Prefill latency: 0.05098434799583629 sec
Decode latency: 0.11539134697522968 sec
Time for inference 4: 0.17 sec total, 186.49 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 846.85 GB/s
FLOPS achieved: 111.78 TF/s

Prefill latency: 0.05098402997828089 sec
Decode latency: 0.11535495400312357 sec
Time for inference 5: 0.17 sec total, 185.41 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 841.92 GB/s
FLOPS achieved: 111.13 TF/s

Prefill latency: 0.05114136901102029 sec
Decode latency: 0.11514652500045486 sec
Time for inference 6: 0.17 sec total, 186.05 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 844.83 GB/s
FLOPS achieved: 111.52 TF/s

Prefill latency: 0.05107028997736052 sec
Decode latency: 0.1152618009946309 sec
Time for inference 7: 0.17 sec total, 185.44 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 842.07 GB/s
FLOPS achieved: 111.15 TF/s

Prefill latency: 0.05127811600686982 sec
Decode latency: 0.11576818200410344 sec
Time for inference 8: 0.17 sec total, 184.25 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 836.67 GB/s
FLOPS achieved: 110.44 TF/s

Prefill latency: 0.05113330000312999 sec
Decode latency: 0.1160486759908963 sec
Time for inference 9: 0.17 sec total, 184.69 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 838.64 GB/s
FLOPS achieved: 110.70 TF/s

Prefill latency: 0.05171450198395178 sec
Decode latency: 0.11744927198742516 sec
Time for inference 10: 2.44 sec total, 13.13 tokens/sec
Decode latency: 0.12 sec
Prefill latency: 0.05 sec
Bandwidth achieved: 59.64 GB/s
FLOPS achieved: 7.87 TF/s

==========
Batch Size: 4
Prompt Length: 1024
Generated tokens: 32
Average decode latency: 0.1156 sec
Average prefill latency: 0.0511 sec
Average tokens/sec: 168.56
Memory used: 7.68 GB
